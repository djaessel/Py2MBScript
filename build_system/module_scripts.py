# -*- coding: cp1254 -*-
from header_common import *
from header_operations import *
from module_constants import *
from header_parties import *
from header_skills import *
from header_mission_templates import *
from header_items import *
from header_triggers import *
from header_terrain_types import *
from header_music import *
from header_map_icons import *
from header_presentations import *
from ID_animations import *

scripts = [

("game_start", [
(faction_set_slot,"fac_player_supporters_faction",21,2),
(assign,"$g_player_luck",200),
(assign,"$g_player_luck",200),
(troop_set_slot,"trp_player",2,2),
(store_random_in_range,":random_x_001","p_training_ground_1","p_bridge_1"),
(party_relocate_near_party,"p_main_party",":random_x_001",3),
(str_store_string,s5,":str_store_troop_name("trp_player")"),
(party_set_name, "p_main_party", 5),
(call_script, "script_update_party_creation_random_limits"),
(assign,"$g_player_party_icon",-1),
(try_for_range, ":troop_id_002", 0, ":trp.heroes_end"),
    (this_or_next|eq,":troop_id_002","trp_player"),
    (is_between,":troop_id_002","trp_npc1","trp_heroes_end"),
    (troop_set_slot,":troop_id_002",31,-1),
    (troop_set_slot,":troop_id_002",32,-1),
    (troop_set_slot,":troop_id_002",33,-1),
    (troop_set_slot,":troop_id_002",30,-1),
    (troop_set_slot,":troop_id_002",34,-1),
    (troop_set_slot,":troop_id_002",8,-1),
    (troop_set_slot,":troop_id_002",38,-1),
    (troop_set_slot,":troop_id_002",154,-1),
    (store_random_in_range,":random_x_003",0,10000),
    (troop_set_slot,":troop_id_002",48,":random_x_003"),
    (troop_set_slot,":troop_id_002",49,":random_x_003"),
(try_end),
(assign,"$g_lord_long_term_count",0),
(call_script, "script_initialize_banner_info"),
(call_script, "script_initialize_item_info"),
(call_script, "script_initialize_aristocracy"),
(call_script, "script_initialize_npcs"),
(assign,"$disable_npc_complaints",0),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
    (store_random_in_range,":random_x_005",0,312),
    (val_mul, ":random_x_005", -1),
    (faction_set_slot,":fac_004",94,":random_x_005"),
(try_end),
(assign,":var006","p_castle_1"),
(assign,":var006 -","p_town_1"),
(assign,":var007",":var006"),
(try_for_range, ":slot_no_008", 0, ":var006"),
    (troop_set_slot,"trp_random_town_sequence",":slot_no_008",-1),
(try_end),
(assign,":slot_no_008",0),
(try_for_range, ":var009", 0, ":var007"),
    (store_random_in_range,":random_x_010",0,":var006"),
    (assign,":var011",1),
    (try_for_range, ":var012", 0, ":var006"),
        (troop_slot_eq,"trp_random_town_sequence",":var012",":random_x_010"),
    (try_end),
    (try_begin),
        (eq,0,1), # var011
        (troop_set_slot,"trp_random_town_sequence",":slot_no_008",":random_x_010"),
        (val_add, ":slot_no_008", 1),
    (else_try),
        (val_add, ":var007", 1),
    (try_end),
(try_end),
(faction_set_slot,"fac_culture_1",41,"trp_swadian_recruit"),
(faction_set_slot,"fac_culture_1",42,"trp_swadian_militia"),
(faction_set_slot,"fac_culture_1",43,"trp_swadian_footman"),
(faction_set_slot,"fac_culture_1",44,"trp_swadian_infantry"),
(faction_set_slot,"fac_culture_1",45,"trp_swadian_knight"),
(faction_set_slot,"fac_culture_2",41,"trp_vaegir_recruit"),
(faction_set_slot,"fac_culture_2",42,"trp_vaegir_footman"),
(faction_set_slot,"fac_culture_2",43,"trp_vaegir_veteran"),
(faction_set_slot,"fac_culture_2",44,"trp_vaegir_infantry"),
(faction_set_slot,"fac_culture_2",45,"trp_vaegir_knight"),
(faction_set_slot,"fac_culture_3",41,"trp_khergit_tribesman"),
(faction_set_slot,"fac_culture_3",42,"trp_khergit_skirmisher"),
(faction_set_slot,"fac_culture_3",43,"trp_khergit_horseman"),
(faction_set_slot,"fac_culture_3",44,"trp_khergit_horse_archer"),
(faction_set_slot,"fac_culture_3",45,"trp_khergit_veteran_horse_archer"),
(faction_set_slot,"fac_culture_4",41,"trp_nord_recruit"),
(faction_set_slot,"fac_culture_4",42,"trp_nord_footman"),
(faction_set_slot,"fac_culture_4",43,"trp_nord_trained_footman"),
(faction_set_slot,"fac_culture_4",44,"trp_nord_warrior"),
(faction_set_slot,"fac_culture_4",45,"trp_nord_veteran"),
(faction_set_slot,"fac_culture_5",41,"trp_rhodok_tribesman"),
(faction_set_slot,"fac_culture_5",42,"trp_rhodok_spearman"),
(faction_set_slot,"fac_culture_5",43,"trp_rhodok_trained_spearman"),
(faction_set_slot,"fac_culture_5",44,"trp_rhodok_veteran_spearman"),
(faction_set_slot,"fac_culture_5",45,"trp_rhodok_sergeant"),
(faction_set_slot,"fac_culture_6",41,"trp_sarranid_recruit"),
(faction_set_slot,"fac_culture_6",42,"trp_sarranid_footman"),
(faction_set_slot,"fac_culture_6",43,"trp_sarranid_archer"),
(faction_set_slot,"fac_culture_6",44,"trp_sarranid_horseman"),
(faction_set_slot,"fac_culture_6",45,"trp_sarranid_mamluke"),
(faction_set_slot,"fac_culture_1",53,"trp_town_walker_1"),
(faction_set_slot,"fac_culture_1",54,"trp_town_walker_2"),
(faction_set_slot,"fac_culture_1",55,"trp_village_walker_1"),
(faction_set_slot,"fac_culture_1",56,"trp_village_walker_2"),
(faction_set_slot,"fac_culture_1",57,"trp_spy_walker_1"),
(faction_set_slot,"fac_culture_1",58,"trp_spy_walker_2"),
(faction_set_slot,"fac_culture_2",53,"trp_town_walker_1"),
(faction_set_slot,"fac_culture_2",54,"trp_town_walker_2"),
(faction_set_slot,"fac_culture_2",55,"trp_village_walker_1"),
(faction_set_slot,"fac_culture_2",56,"trp_village_walker_2"),
(faction_set_slot,"fac_culture_2",57,"trp_spy_walker_1"),
(faction_set_slot,"fac_culture_2",58,"trp_spy_walker_2"),
(faction_set_slot,"fac_culture_3",53,"trp_khergit_townsman"),
(faction_set_slot,"fac_culture_3",54,"trp_khergit_townswoman"),
(faction_set_slot,"fac_culture_3",55,"trp_khergit_townsman"),
(faction_set_slot,"fac_culture_3",56,"trp_khergit_townswoman"),
(faction_set_slot,"fac_culture_3",57,"trp_spy_walker_1"),
(faction_set_slot,"fac_culture_3",58,"trp_spy_walker_2"),
(faction_set_slot,"fac_culture_4",53,"trp_town_walker_1"),
(faction_set_slot,"fac_culture_4",54,"trp_town_walker_2"),
(faction_set_slot,"fac_culture_4",55,"trp_village_walker_1"),
(faction_set_slot,"fac_culture_4",56,"trp_village_walker_2"),
(faction_set_slot,"fac_culture_4",57,"trp_spy_walker_1"),
(faction_set_slot,"fac_culture_4",58,"trp_spy_walker_2"),
(faction_set_slot,"fac_culture_5",53,"trp_town_walker_1"),
(faction_set_slot,"fac_culture_5",54,"trp_town_walker_2"),
(faction_set_slot,"fac_culture_5",55,"trp_village_walker_1"),
(faction_set_slot,"fac_culture_5",56,"trp_village_walker_2"),
(faction_set_slot,"fac_culture_5",57,"trp_spy_walker_1"),
(faction_set_slot,"fac_culture_5",58,"trp_spy_walker_2"),
(faction_set_slot,"fac_culture_6",53,"trp_sarranid_townsman"),
(faction_set_slot,"fac_culture_6",54,"trp_sarranid_townswoman"),
(faction_set_slot,"fac_culture_6",55,"trp_sarranid_townsman"),
(faction_set_slot,"fac_culture_6",56,"trp_sarranid_townswoman"),
(faction_set_slot,"fac_culture_6",57,"trp_spy_walker_1"),
(faction_set_slot,"fac_culture_6",58,"trp_spy_walker_2"),
(try_begin),
    (eq,":::cheat_mode",1),
    (assign,reg3,"$cheat_mode"),
    (display_message, "@@{!}DEBUG : Completed faction troop assignments - cheat mode: {reg3}"),
(try_end),
(faction_set_slot,"fac_kingdom_1",10,"fac_culture_1"),
(faction_set_slot,"fac_kingdom_1",11,"trp_kingdom_1_lord"),
(troop_set_slot,"trp_kingdom_1_lord",7,1200),
(faction_set_slot,"fac_kingdom_2",10,"fac_culture_2"),
(faction_set_slot,"fac_kingdom_2",11,"trp_kingdom_2_lord"),
(troop_set_slot,"trp_kingdom_2_lord",7,1200),
(faction_set_slot,"fac_kingdom_3",10,"fac_culture_3"),
(faction_set_slot,"fac_kingdom_3",11,"trp_kingdom_3_lord"),
(troop_set_slot,"trp_kingdom_3_lord",7,1200),
(faction_set_slot,"fac_kingdom_4",10,"fac_culture_4"),
(faction_set_slot,"fac_kingdom_4",11,"trp_kingdom_4_lord"),
(troop_set_slot,"trp_kingdom_4_lord",7,1200),
(faction_set_slot,"fac_kingdom_5",10,"fac_culture_5"),
(faction_set_slot,"fac_kingdom_5",11,"trp_kingdom_5_lord"),
(troop_set_slot,"trp_kingdom_5_lord",7,1200),
(faction_set_slot,"fac_kingdom_6",10,"fac_culture_6"),
(faction_set_slot,"fac_kingdom_6",11,"trp_kingdom_6_lord"),
(troop_set_slot,"trp_kingdom_6_lord",7,1200),
(assign,":var013","fac_culture_1"),
(faction_set_slot,"fac_player_supporters_faction",10,":var013"),
(faction_set_slot,"fac_player_faction",10,":var013"),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
    (faction_set_slot,":fac_004",8,-1),
(try_end),
(faction_set_slot,"fac_player_supporters_faction",8,"trp_player"),
(call_script, "script_initialize_faction_troop_types"),
(try_for_range, ":itm_014", ":itm.spice", ":itm.siege_supply"),
    (store_sub, ":slot_no_015", ":itm_014", ":itm.spice"),
    (val_add, ":slot_no_015", 250),
    (try_for_range, ":p_016", ":p.town_1", ":p.salt_mine"),
        (party_set_slot,":p_016",":slot_no_015",1000),
    (try_end),
(try_end),
(call_script, "script_initialize_trade_routes"),
(call_script, "script_initialize_town_arena_info"),
(try_for_range, ":p_017", ":p.town_1", ":p.castle_1"),
    (store_random_in_range,":random_x_018",0,100),
    (try_begin),
        (lt,":random_x_018",20),
        (store_random_in_range,":random_x_019",12,15),
        (party_set_slot,":p_017",156,":random_x_019"),
    (try_end),
(try_end),
(try_for_range, ":p_020", ":p.castle_1", ":p.village_1"),
    (assign,":var021",999999),
    (assign,":party_id_022",-1),
    (try_for_range, ":p_023", ":p.village_1", ":p.salt_mine"),
        (neg|party_slot_ge,":p_023",120,1),
        (store_distance_to_party_from_party,":distance_parties_024",":p_023",":p_023"),
        (lt,":distance_parties_024",":var021"),
        (assign,":var021",":distance_parties_024"),
        (assign,":party_id_022",":p_023"),
    (try_end),
(try_end),
(party_set_slot,":party_id_022",120,":p_020"),
(store_faction_of_party, ":party_faction_025", ":p_020"),
(call_script, "script_give_center_to_faction_aux", ":party_id_022", ":party_faction_025"),
(try_end),
(try_for_range, ":p_023", ":p.village_1", ":p.salt_mine"),
(neg|party_slot_ge,":p_023",120,1),
(assign,":var021",999999),
(assign,":var026",-1),
(try_for_range, ":p_027", ":p.town_1", ":p.castle_1"),
    (store_distance_to_party_from_party,":distance_parties_024",":p_023",":p_023"),
    (lt,":distance_parties_024",":var021"),
    (assign,":var021",":distance_parties_024"),
    (assign,":var026",":p_027"),
(try_end),
(try_end),
(party_set_slot,":p_023",120,":var026"),
(store_faction_of_party, ":party_faction_025", ":var026"),
(call_script, "script_give_center_to_faction_aux", ":p_023", ":party_faction_025"),
(try_end),
(try_for_range, ":p_017", ":p.town_1", ":p.castle_1"),
(store_sub, ":slot_no_015", ":p_017", ":p.town_1"),
(party_set_slot,":p_017",0,3),
(assign,":var028","scn_town_1_center"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",10,":var028"),
(assign,":var028","scn_town_1_castle"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",11,":var028"),
(assign,":var028","scn_town_1_prison"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",12,":var028"),
(assign,":var028","scn_town_1_walls"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",18,":var028"),
(assign,":var028","scn_town_1_tavern"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",13,":var028"),
(assign,":var028","scn_town_1_store"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",14,":var028"),
(assign,":var028","scn_town_1_arena"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",16,":var028"),
(assign,":var028","scn_town_1_alley"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",17,":var028"),
(assign,":var028","trp_town_1_mayor"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",25,":var028"),
(assign,":var028","trp_town_1_tavernkeeper"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",20,":var028"),
(assign,":var028","trp_town_1_weaponsmith"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",21,":var028"),
(assign,":var028","trp_town_1_armorer"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",22,":var028"),
(assign,":var028","trp_town_1_merchant"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",23,":var028"),
(assign,":var028","trp_town_1_horse_merchant"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",24,":var028"),
(assign,":var028","scn_town_1_center"),
(val_add, ":var028", ":slot_no_015"),
(party_set_slot,":p_017",10,":var028"),
(party_set_slot,":p_017",60,"pt_center_reinforcements"),
(try_end),
(try_for_range, ":p_029", ":p.castle_1", ":p.village_1"),
(store_sub, ":slot_no_015", ":p_029", ":p.castle_1"),
(val_mul, ":slot_no_015", 3),
(assign,":var030","scn_castle_1_exterior"),
(val_add, ":var030", ":slot_no_015"),
(party_set_slot,":p_029",10,":var030"),
(assign,":var031","scn_castle_1_interior"),
(val_add, ":var031", ":slot_no_015"),
(party_set_slot,":p_029",11,":var031"),
(assign,":var031","scn_castle_1_prison"),
(val_add, ":var031", ":slot_no_015"),
(party_set_slot,":p_029",12,":var031"),
(party_set_slot,":p_029",60,"pt_center_reinforcements"),
(party_set_slot,":p_029",0,2),
(party_set_slot,":p_029",54,-1),
(try_end),
(party_set_slot,"p_town_13",27,1),
(party_set_slot,"p_town_16",27,1),
(party_set_slot,"p_castle_1",27,1),
(party_set_slot,"p_castle_2",27,1),
(party_set_slot,"p_castle_4",27,1),
(party_set_slot,"p_castle_7",27,1),
(party_set_slot,"p_castle_8",27,1),
(party_set_slot,"p_castle_9",27,1),
(party_set_slot,"p_castle_11",27,1),
(party_set_slot,"p_castle_13",27,1),
(party_set_slot,"p_castle_21",27,1),
(party_set_slot,"p_castle_25",27,1),
(party_set_slot,"p_castle_34",27,1),
(party_set_slot,"p_castle_35",27,1),
(party_set_slot,"p_castle_38",27,1),
(party_set_slot,"p_castle_40",27,1),
(party_set_slot,"p_castle_41",27,1),
(party_set_slot,"p_castle_42",27,1),
(party_set_slot,"p_castle_43",27,1),
(try_for_range, ":p_032", ":p.village_1", ":p.salt_mine"),
(store_sub, ":slot_no_015", ":p_032", ":p.village_1"),
(assign,":var030","scn_village_1"),
(val_add, ":var030", ":slot_no_015"),
(party_set_slot,":p_032",10,":var030"),
(assign,":var033","trp_village_1_elder"),
(val_add, ":var033", ":slot_no_015"),
(party_set_slot,":p_032",25,":var033"),
(party_set_slot,":p_032",0,4),
(party_set_slot,":p_032",34,-1),
(call_script, "script_refresh_village_defenders", ":p_032"),
(call_script, "script_refresh_village_defenders", ":p_032"),
(call_script, "script_refresh_village_defenders", ":p_032"),
(call_script, "script_refresh_village_defenders", ":p_032"),
(try_end),
(try_for_range, ":p_016", ":p.town_1", ":p.salt_mine"),
(party_set_slot,":p_016",55,-1),
(party_set_slot,":p_016",54,-1),
(party_set_slot,":p_016",28,-1),
(try_end),
(faction_set_slot,"fac_kingdom_1",15,"mesh_banner_kingdom_f"),
(faction_set_slot,"fac_kingdom_2",15,"mesh_banner_kingdom_b"),
(faction_set_slot,"fac_kingdom_3",15,"mesh_banner_kingdom_c"),
(faction_set_slot,"fac_kingdom_4",15,"mesh_banner_kingdom_a"),
(faction_set_slot,"fac_kingdom_5",15,"mesh_banner_kingdom_d"),
(faction_set_slot,"fac_kingdom_6",15,"mesh_banner_kingdom_e"),
(try_for_range, ":fac_034", ":fac.kingdom_1", ":fac.kingdoms_end"),
(faction_get_slot,":faction_slot_035",":fac_034",11),
(faction_get_slot,":faction_slot_036",":fac_034",15),
(assign,":faction_slot_036 -","mesh_banner_a01"),
(assign,":faction_slot_036 +","spr_banner_a"),
(troop_set_slot,":faction_slot_035",13,":faction_slot_036"),
(try_end),
(assign,":var037",0),
(assign,":var038",0),
(assign,":var039",0),
(try_for_range, ":trp_040", ":trp.npc1", ":trp.knight_1_1_wife"),
(this_or_next|troop_slot_eq,":trp_040",2,2),
(troop_slot_eq,":trp_040",2,9),
(store_troop_faction,":troop_faction_041",":trp_040"),
(try_begin),
(neg|faction_slot_eq,":troop_faction_041",11,":trp_040"),
(try_begin),
    (eq,":troop_faction_041","fac_kingdom_3"),
    (assign,":var042","spr_banner_a"),
    (val_add, ":var042", 63),
    (store_add, ":var043", ":var042", ":var037"),
    (troop_set_slot,":trp_040",13,":var043"),
    (val_add, ":var037", 1),
(else_try),
    (eq,":troop_faction_041","fac_kingdom_6"),
    (assign,":var044","spr_banner_a"),
    (val_add, ":var044", 105),
    (store_add, ":var043", ":var044", ":var038"),
    (troop_set_slot,":trp_040",13,":var043"),
    (val_add, ":var038", 1),
(else_try),
    (assign,":var045",":var039"),
    (try_begin),
        (gt,":var045",63),
        (val_add, ":var045", 84),
        (val_sub, ":var045", 63),
    (try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var045",105),
(val_add, ":var045", 125),
(val_sub, ":var045", 105),
(try_end),
(assign,":var043","spr_banner_a"),
(val_add, ":var043", ":var045"),
(troop_set_slot,":trp_040",13,":var043"),
(val_add, ":var039", 1),
(try_begin),
(this_or_next|ge,":var043","spr_banner_a"),
(gt,":var043","spr_banner_f21"),
(display_message, "@@{!}ERROR: Not enough banners for heroes!"),
(try_end),
(store_character_level,":character_lvl_046",":trp_040"),
(store_mul, ":var047", ":character_lvl_046", ":character_lvl_046"),
(val_div, ":var047", 4),
(troop_get_slot,":troop_slot_048",":trp_040",18),
(store_mul, ":var049", ":troop_slot_048", ":troop_slot_048"),
(val_div, ":var049", 8),
(val_add, ":var047", ":var049"),
(try_begin),
(faction_slot_eq,":troop_faction_041",11,":trp_040"),
(store_random_in_range,":random_x_050",250,400),
(else_try),
(store_random_in_range,":random_x_050",0,100),
(try_end),
(val_add, ":var047", ":random_x_050"),
(troop_set_slot,":trp_040",7,":var047"),
(try_end),
(try_for_range, ":trp_051", ":trp.player", ":trp.merchants_end"),
(add_troop_note_tableau_mesh,":trp_051"),
(try_end),
(try_for_range, ":p_016", ":p.town_1", ":p.salt_mine"),
(add_party_note_tableau_mesh,":p_016"),
(try_end),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(is_between,":fac_004","fac_kingdom_1","fac_kingdoms_end"),
(add_faction_note_tableau_mesh,":fac_004"),
(else_try),
(add_faction_note_tableau_mesh,":fac_004"),
(try_end),
(call_script, "script_give_center_to_faction_aux", "p_town_1", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_town_2", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_town_3", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_town_4", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_town_5", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_town_6", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_town_7", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_town_8", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_town_9", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_town_10", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_town_11", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_town_12", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_town_13", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_town_14", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_town_15", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_town_16", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_town_17", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_town_18", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_town_19", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_town_20", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_town_21", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_town_22", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_castle_1", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_castle_2", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_castle_3", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_castle_4", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_castle_5", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_castle_6", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_7", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_castle_8", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_castle_9", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_castle_10", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_castle_11", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_castle_12", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_castle_13", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_14", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_castle_15", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_castle_16", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_castle_17", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_castle_18", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_castle_19", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_castle_20", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_21", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_castle_22", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_castle_23", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_24", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_25", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_26", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_27", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_28", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_castle_29", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_castle_30", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_castle_31", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_32", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_castle_33", "fac_kingdom_5"),
(call_script, "script_give_center_to_faction_aux", "p_castle_34", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_castle_35", "fac_kingdom_1"),
(call_script, "script_give_center_to_faction_aux", "p_castle_36", "fac_kingdom_4"),
(call_script, "script_give_center_to_faction_aux", "p_castle_37", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_castle_38", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_castle_39", "fac_kingdom_2"),
(call_script, "script_give_center_to_faction_aux", "p_castle_40", "fac_kingdom_3"),
(call_script, "script_give_center_to_faction_aux", "p_castle_41", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_castle_42", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_castle_43", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_castle_44", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_castle_45", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_castle_46", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_castle_47", "fac_kingdom_6"),
(call_script, "script_give_center_to_faction_aux", "p_castle_48", "fac_kingdom_6"),
(call_script, "script_give_center_to_lord", "p_town_1", "trp_kingdom_4_lord", 0),
(call_script, "script_give_center_to_lord", "p_town_2", "trp_knight_4_1", 0),
(call_script, "script_give_center_to_lord", "p_town_3", "trp_knight_5_1", 0),
(call_script, "script_give_center_to_lord", "p_town_4", "trp_knight_1_1", 0),
(call_script, "script_give_center_to_lord", "p_town_5", "trp_kingdom_5_lord", 0),
(call_script, "script_give_center_to_lord", "p_town_6", "trp_kingdom_1_lord", 0),
(call_script, "script_give_center_to_lord", "p_town_7", "trp_knight_1_2", 0),
(call_script, "script_give_center_to_lord", "p_town_8", "trp_kingdom_2_lord", 0),
(call_script, "script_give_center_to_lord", "p_town_9", "trp_knight_2_1", 0),
(call_script, "script_give_center_to_lord", "p_town_10", "trp_kingdom_3_lord", 0),
(call_script, "script_give_center_to_lord", "p_town_11", "trp_knight_2_2", 0),
(call_script, "script_give_center_to_lord", "p_town_12", "trp_knight_4_2", 0),
(call_script, "script_give_center_to_lord", "p_town_13", "trp_knight_2_3", 0),
(call_script, "script_give_center_to_lord", "p_town_14", "trp_knight_3_1", 0),
(call_script, "script_give_center_to_lord", "p_town_15", "trp_knight_5_2", 0),
(call_script, "script_give_center_to_lord", "p_town_16", "trp_knight_1_4", 0),
(call_script, "script_give_center_to_lord", "p_town_17", "trp_knight_3_2", 0),
(call_script, "script_give_center_to_lord", "p_town_18", "trp_knight_3_3", 0),
(call_script, "script_give_center_to_lord", "p_town_19", "trp_kingdom_6_lord", 0),
(call_script, "script_give_center_to_lord", "p_town_20", "trp_knight_6_1", 0),
(call_script, "script_give_center_to_lord", "p_town_21", "trp_knight_6_2", 0),
(call_script, "script_give_center_to_lord", "p_town_22", "trp_knight_6_3", 0),
(call_script, "script_give_center_to_lord", "p_castle_29", "trp_knight_2_10", 0),
(call_script, "script_give_center_to_lord", "p_castle_30", "trp_knight_3_4", 0),
(call_script, "script_give_center_to_lord", "p_castle_35", "trp_knight_1_3", 0),
(call_script, "script_assign_lords_to_empty_centers"),
(try_for_range, ":p_016", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_052", ":p_016"),
(faction_get_slot,":faction_slot_053",":party_faction_052",10),
(party_set_slot,":p_016",19,":faction_slot_053"),
(party_set_slot,":p_016",61,":party_faction_052"),
(party_set_slot,":p_016",62,":party_faction_052"),
(try_end),
(party_set_slot,"p_castle_10",62,"fac_kingdom_2"),
(party_set_slot,"p_castle_13",62,"fac_kingdom_4"),
(party_set_slot,"p_castle_15",62,"fac_kingdom_1"),
(party_set_slot,"p_castle_46",62,"fac_kingdom_5"),
(party_set_slot,"p_castle_40",62,"fac_kingdom_6"),
(party_set_slot,"p_town_11",62,"fac_kingdom_3"),
(party_set_slot,"p_castle_15",62,"fac_kingdom_1"),
(party_set_slot,"p_castle_22",62,"fac_kingdom_1"),
(call_script, "script_update_village_market_towns"),
(try_for_range, ":var009", 0, 70),
(eq,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- initial war/peace check begins"),
(call_script, "script_randomly_start_war_peace_new", 0),
(try_end),
(try_for_range, ":p_016", ":p.town_1", ":p.salt_mine"),
(this_or_next|party_slot_eq,":p_016",0,3),
(party_slot_eq,":p_016",0,4),
(try_for_range, ":var054", 0, 8),
(call_script, "script_center_set_walker_to_type", ":p_016", ":var054", 0),
(try_end),
(try_end),
(call_script, "script_initialize_economic_information"),
(try_for_range, ":p_032", ":p.village_1", ":p.salt_mine"),
(call_script, "script_refresh_village_merchant_inventory", ":p_032"),
(try_end),
(try_for_range, ":trp_055", ":trp.kingdom_1_lord", ":trp.knight_1_1_wife"),
(eq,1,1),
(store_troop_faction,":troop_faction_056",":trp_055"),
(try_begin),
(is_between,":troop_faction_056","fac_player_supporters_faction","fac_kingdoms_end"),
(troop_set_slot,":trp_055",14,":troop_faction_056"),
(is_between,":trp_055","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(faction_set_slot,":troop_faction_056",60,1),
(try_end),
(assign,":var057",6000),
(eq,1,1),
(store_troop_faction,":troop_faction_058",":trp_055"),
(try_begin),
(faction_slot_eq,":troop_faction_058",11,":trp_055"),
(assign,":var057",20000),
(try_end),
(try_end),
(troop_set_slot,":trp_055",11,":var057"),
(try_for_range, ":p_016", ":p.town_1", ":p.village_1"),
(assign,":var057",2000),
(try_begin),
(is_between,":p_016","p_town_1","p_castle_1"),
(val_mul, ":var057", 2),
(try_end),
(party_set_slot,":p_016",49,":var057"),
(assign,":var059",15),
(try_begin),
(party_slot_eq,":p_016",0,3),
(assign,":var059",40),
(try_end),
(try_for_range, ":var009", 0, ":var059"),
(call_script,"script_cf_reinforce_party"),
(try_end),
(store_div, ":var___x1", ":var059", 5),
(assign,":var060",":var___x1"),
(val_add, ":var060", 2),
(game_get_reduce_campaign_ai, ":campaign_ai"),
(try_begin),
(eq,":campaign_ai",0),
(assign,":var062",7500),
(else_try),
(eq,":campaign_ai",1),
(assign,":var062",5000),
(else_try),
(eq,":campaign_ai",2),
(try_end),
(try_for_range, ":var009", 0, ":var060"),
(party_upgrade_with_xp, ":p_016", 2500, 0), # var062
(try_end),
(call_script, "script_center_get_food_store_limit", ":p_016"),
(assign,":var063",reg0),
(val_div, ":var063", 2),
(party_set_slot,":p_016",53,":var063"),
(party_get_slot,":party_slot_064",":p_016",7),
(try_begin),
(ge,":party_slot_064",1),
(troop_slot_eq,":party_slot_064",10,0),
(assign,"$g_there_is_no_avaliable_centers",0),
(call_script, "script_create_kingdom_hero_party", ":party_slot_064", ":p_016"),
(assign,":var065","$pout_party"),
(party_attach_to_party, ":var065", ":p_016"),
(party_set_slot,":p_016",51,1000),
(try_end),
(try_end),
(try_for_range, ":trp_066", ":trp.npc1", ":trp.kingdom_1_lord"),
(try_for_range, ":trp_067", ":trp.npc1", ":trp.kingdom_1_lord"),
(neq,":trp_067",":trp_066"),
(neg|troop_slot_eq,":trp_066",71,":trp_067"),
(neg|troop_slot_eq,":trp_066",73,":trp_067"),
(call_script, "script_troop_change_relation_with_troop", ":trp_066", ":trp_067", 7),
(try_end),
(try_end),
(try_for_range, ":trp_068", ":trp.kingdom_1_lord", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_068",2,2),
(troop_get_slot,":troop_slot_069",":trp_068",14),
(try_for_range, ":trp_070", ":trp.kingdom_1_lord", ":trp.knight_1_1_wife"),
(this_or_next|troop_slot_eq,":trp_070",2,2),
(troop_slot_eq,":trp_070",2,9),
(troop_get_slot,":troop_slot_071",":trp_070",14),
(eq,":troop_slot_071",":troop_slot_069"),
(call_script, "script_troop_get_family_relation_to_troop", ":trp_068", ":trp_070"),
(call_script, "script_troop_change_relation_with_troop", ":trp_068", ":trp_070", reg0),
(store_random_in_range,":random_x_072",0,11),
(call_script, "script_troop_change_relation_with_troop", ":trp_068", ":trp_070", ":random_x_072"),
(try_end),
(try_end),
(try_end),
(try_for_range, ":var009", 0, 5000),
(call_script,"script_cf_random_political_event"),
(try_end),
(assign,"$total_random_quarrel_changes",0),
(assign,"$total_relation_adds",0),
(assign,"$total_relation_subs",0),
(try_for_range, ":fac_073", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(call_script, "script_evaluate_realm_stability", ":fac_073"),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg3,"$cheat_mode"),
(display_message, "@@{!}DEBUG : Completed political events - cheat mode: {reg3}"),
(try_end),
(try_for_range, ":trp_074", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(troop_slot_eq,":trp_074",30,-1),
(neg|is_between,":trp_074","trp_kingdom_1_lord","trp_knight_1_1"),
(neg|is_between,":trp_074","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(call_script, "script_assign_troop_love_interests", ":trp_074"),
(try_end),
(store_random_in_range,"$romantic_attraction_seed",0,5),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg3,"$romantic_attraction_seed"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_for_range, ":var009", 0, 10),
(call_script, "script_spawn_bandits"),
(try_end),
(set_spawn_radius,5),
(try_for_range, ":p_023", ":p.village_1", ":p.salt_mine"),
(store_random_in_range,":random_x_075",0,5),
(try_begin),
(eq,":random_x_075",0),
(spawn_around_party,":p_023","pt_looters"),
(try_end),
(try_end),
(call_script, "script_update_mercenary_units_of_towns"),
(call_script, "script_update_companion_candidates_in_taverns"),
(call_script, "script_update_ransom_brokers"),
(call_script, "script_update_tavern_travellers"),
(call_script, "script_update_tavern_minstrels"),
(call_script, "script_update_booksellers"),
(try_for_range, ":p_032", ":p.village_1", ":p.salt_mine"),
(call_script, "script_update_volunteer_troops_in_village", ":p_032"),
(try_end),
(try_for_range, ":fac_076", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(call_script, "script_update_faction_notes", ":fac_076"),
(store_random_in_range,":random_x_010",-60,0),
(faction_set_slot,":fac_004",95,":random_x_010"),
(try_end),
(try_for_range, ":trp_074", ":trp.kingdom_1_lord", ":trp.knight_1_1_wife"),
(call_script, "script_update_troop_notes", ":trp_074"),
(try_end),
(try_for_range, ":p_020", ":p.town_1", ":p.salt_mine"),
(call_script, "script_update_center_notes", ":p_020"),
(try_end),
(call_script, "script_update_troop_notes", "trp_player"),
(try_for_range, ":trp_055", ":trp.knight_1_1_wife", ":trp.heroes_end"),
(call_script, "script_get_kingdom_lady_social_determinants", ":trp_055"),
(troop_set_slot,":trp_055",12,reg1),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg3,"$cheat_mode"),
(display_message, "@@{!}DEBUG : Located kingdom ladies - cheat mode: {reg3}"),
(try_end),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(call_script, "script_faction_recalculate_strength", ":fac_004"),
(try_end),
(faction_set_slot,"fac_kingdom_1",22,"str_kingdom_1_adjective"),
(faction_set_slot,"fac_kingdom_2",22,"str_kingdom_2_adjective"),
(faction_set_slot,"fac_kingdom_3",22,"str_kingdom_3_adjective"),
(faction_set_slot,"fac_kingdom_4",22,"str_kingdom_4_adjective"),
(faction_set_slot,"fac_kingdom_5",22,"str_kingdom_5_adjective"),
(faction_set_slot,"fac_kingdom_6",22,"str_kingdom_6_adjective"),
(call_script, "script_get_player_party_morale_values"),
(party_set_morale, "p_main_party", reg0),
(troop_set_note_available, "trp_player", 1),
(try_for_range, ":trp_051", ":trp.kingdom_1_lord", ":trp.knight_1_1"),
(troop_set_note_available, ":trp_051", 1),
(try_end),
(try_for_range, ":trp_051", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(troop_set_note_available, ":trp_051", 1),
(try_end),
(try_for_range, ":trp_051", ":trp.knight_1_1_wife", ":trp.heroes_end"),
(troop_set_note_available, ":trp_051", 1),
(try_end),
(troop_set_note_available, "trp_knight_1_1_wife", 0),
(try_for_range, ":trp_051", ":trp.kingdom_1_pretender", ":trp.knight_1_1_wife"),
(troop_set_note_available, ":trp_051", 1),
(try_end),
(try_for_range, ":fac_004", ":fac.kingdom_1", ":fac.kingdoms_end"),
(faction_set_note_available, ":fac_004", 1),
(try_end),
(faction_set_note_available, "fac_neutral", 0),
(try_for_range, ":p_077", ":p.town_1", ":p.salt_mine"),
(party_set_note_available, ":p_077", 1),
(try_end),
]),

("game_get_use_string", [
(store_script_param, ":scene_prop_instance_id_001", 1),
(prop_instance_get_scene_prop_kind, ":scene_prop_kind_002", ":scene_prop_instance_id_001"),
(try_begin),
(this_or_next|eq,":scene_prop_kind_002","spr_winch"),
(eq,":scene_prop_kind_002","spr_winch_b"),
(assign,":var003","spr_portcullis"),
(else_try),
(this_or_next|eq,":scene_prop_kind_002","spr_siege_ladder_move_14m"),
(this_or_next|eq,":scene_prop_kind_002","spr_siege_ladder_move_12m"),
(this_or_next|eq,":scene_prop_kind_002","spr_siege_ladder_move_10m"),
(this_or_next|eq,":scene_prop_kind_002","spr_siege_ladder_move_8m"),
(this_or_next|eq,":scene_prop_kind_002","spr_siege_ladder_move_6m"),
(this_or_next|eq,":scene_prop_kind_002","spr_castle_f_door_a"),
(this_or_next|eq,":scene_prop_kind_002","spr_viking_keep_destroy_sally_door_right"),
(this_or_next|eq,":scene_prop_kind_002","spr_viking_keep_destroy_sally_door_left"),
(this_or_next|eq,":scene_prop_kind_002","spr_earth_sally_gate_right"),
(this_or_next|eq,":scene_prop_kind_002","spr_earth_sally_gate_left"),
(this_or_next|eq,":scene_prop_kind_002","spr_castle_f_sally_door_a"),
(this_or_next|eq,":scene_prop_kind_002","spr_castle_e_sally_door_a"),
(this_or_next|eq,":scene_prop_kind_002","spr_castle_f_door_b"),
(eq,":scene_prop_kind_002","spr_door_destructible"),
(assign,":var003",":scene_prop_kind_002"),
(try_end),
(scene_prop_get_slot,":scene_prop_slot_004",":scene_prop_instance_id_001",1),
(try_begin),
(eq,":var003","spr_portcullis"),
(try_begin),
(eq,":scene_prop_slot_004",0),
(str_store_string,s0,":str_store_string("str_open_gate")"),
(else_try),
(str_store_string,s0,":str_store_string("str_close_gate")"),
(try_end),
(else_try),
(this_or_next|eq,":var003","spr_castle_f_door_a"),
(this_or_next|eq,":var003","spr_viking_keep_destroy_sally_door_right"),
(this_or_next|eq,":var003","spr_viking_keep_destroy_sally_door_left"),
(this_or_next|eq,":var003","spr_earth_sally_gate_right"),
(this_or_next|eq,":var003","spr_earth_sally_gate_left"),
(this_or_next|eq,":var003","spr_castle_f_sally_door_a"),
(this_or_next|eq,":var003","spr_castle_e_sally_door_a"),
(this_or_next|eq,":var003","spr_castle_f_door_b"),
(eq,":var003","spr_door_destructible"),
(try_begin),
(eq,":scene_prop_slot_004",0),
(str_store_string,s0,":str_store_string("str_open_door")"),
(else_try),
(str_store_string,s0,":str_store_string("str_close_door")"),
(try_end),
(else_try),
(eq,":scene_prop_kind_002","spr_multiplayer_coop_item_drop"),
(str_store_string,s0,":str_store_string("str_coop_open_chest")"),
(multiplayer_get_my_player, ":my_player"),
(try_for_range, ":slot_no_006", 50, 60),
(player_get_slot,":player_slot_007",":my_player",":slot_no_006"),
(try_begin),
(eq,":player_slot_007",":scene_prop_instance_id_001"),
(neg|is_presentation_active, ":"),
(str_store_string,s0,":str_store_string("str_coop_already_opened")"),
(try_end),
(try_end),
(else_try),
(try_begin),
(eq,":scene_prop_slot_004",0),
(str_store_string,s0,":str_store_string("str_raise_ladder")"),
(else_try),
(str_store_string,s0,":str_store_string("str_drop_ladder")"),
(try_end),
(try_end),
]),

("game_quick_start", [
(assign,"$g_is_quick_battle",0),
(assign,"$g_quick_battle_game_type",0),
(assign,"$g_quick_battle_troop","trp_quick_battle_troop_1"),
(assign,"$g_quick_battle_map","scn_quick_battle_scene_1"),
(assign,"$g_quick_battle_team_1_faction","fac_kingdom_1"),
(assign,"$g_quick_battle_team_2_faction","fac_kingdom_2"),
(assign,"$g_quick_battle_army_1_size",25),
(assign,"$g_quick_battle_army_2_size",25),
(faction_set_slot,"fac_outlaws",41,"trp_mountain_bandit"),
(faction_set_slot,"fac_outlaws",42,"trp_sea_raider"),
(faction_set_slot,"fac_outlaws",43,"trp_forest_bandit"),
(faction_set_slot,"fac_outlaws",44,"trp_taiga_bandit"),
(faction_set_slot,"fac_outlaws",45,"trp_steppe_bandit"),
(faction_set_slot,"fac_outlaws",46,"trp_desert_bandit"),
(faction_set_slot,"fac_kingdom_1",41,"trp_swadian_footman"),
(faction_set_slot,"fac_kingdom_1",42,"trp_swadian_infantry"),
(faction_set_slot,"fac_kingdom_1",43,"trp_swadian_skirmisher"),
(faction_set_slot,"fac_kingdom_1",44,"trp_swadian_crossbowman"),
(faction_set_slot,"fac_kingdom_1",45,"trp_swadian_man_at_arms"),
(faction_set_slot,"fac_kingdom_1",46,"trp_swadian_knight"),
(faction_set_slot,"fac_kingdom_2",41,"trp_vaegir_footman"),
(faction_set_slot,"fac_kingdom_2",42,"trp_vaegir_infantry"),
(faction_set_slot,"fac_kingdom_2",43,"trp_vaegir_skirmisher"),
(faction_set_slot,"fac_kingdom_2",44,"trp_vaegir_archer"),
(faction_set_slot,"fac_kingdom_2",45,"trp_vaegir_horseman"),
(faction_set_slot,"fac_kingdom_2",46,"trp_vaegir_knight"),
(faction_set_slot,"fac_kingdom_3",41,"trp_khergit_dismounted_lancer_multiplayer_ai"),
(faction_set_slot,"fac_kingdom_3",42,"trp_khergit_dismounted_lancer_multiplayer_ai"),
(faction_set_slot,"fac_kingdom_3",43,"trp_khergit_horse_archer"),
(faction_set_slot,"fac_kingdom_3",44,"trp_khergit_veteran_horse_archer"),
(faction_set_slot,"fac_kingdom_3",45,"trp_khergit_lancer"),
(faction_set_slot,"fac_kingdom_3",46,"trp_khergit_lancer"),
(faction_set_slot,"fac_kingdom_4",41,"trp_nord_warrior"),
(faction_set_slot,"fac_kingdom_4",42,"trp_nord_champion"),
(faction_set_slot,"fac_kingdom_4",43,"trp_nord_archer"),
(faction_set_slot,"fac_kingdom_4",44,"trp_nord_veteran_archer"),
(faction_set_slot,"fac_kingdom_4",45,"trp_nord_scout_multiplayer_ai"),
(faction_set_slot,"fac_kingdom_4",46,"trp_nord_scout_multiplayer_ai"),
(faction_set_slot,"fac_kingdom_5",41,"trp_rhodok_veteran_spearman"),
(faction_set_slot,"fac_kingdom_5",42,"trp_rhodok_sergeant"),
(faction_set_slot,"fac_kingdom_5",43,"trp_rhodok_crossbowman"),
(faction_set_slot,"fac_kingdom_5",44,"trp_rhodok_veteran_crossbowman"),
(faction_set_slot,"fac_kingdom_5",45,"trp_rhodok_scout_multiplayer_ai"),
(faction_set_slot,"fac_kingdom_5",46,"trp_rhodok_scout_multiplayer_ai"),
(faction_set_slot,"fac_kingdom_6",41,"trp_sarranid_veteran_footman"),
(faction_set_slot,"fac_kingdom_6",42,"trp_sarranid_infantry"),
(faction_set_slot,"fac_kingdom_6",43,"trp_sarranid_skirmisher"),
(faction_set_slot,"fac_kingdom_6",44,"trp_sarranid_archer"),
(faction_set_slot,"fac_kingdom_6",45,"trp_sarranid_horseman"),
(faction_set_slot,"fac_kingdom_6",46,"trp_sarranid_mamluke"),
(assign,"$g_multiplayer_selected_map","scn_multi_scene_1"),
(assign,"$g_multiplayer_respawn_period",5),
(assign,"$g_multiplayer_round_max_seconds",300),
(assign,"$g_multiplayer_game_max_minutes",30),
(assign,"$g_multiplayer_game_max_points",300),
(server_get_renaming_server_allowed, "$g_multiplayer_renaming_server_allowed"),
(server_get_changing_game_type_allowed, "$g_multiplayer_changing_game_type_allowed"),
(assign,"$g_multiplayer_point_gained_from_flags",100),
(assign,"$g_multiplayer_point_gained_from_capturing_flag",5),
(assign,"$g_multiplayer_game_type",0),
(assign,"$g_multiplayer_team_1_faction","fac_kingdom_1"),
(assign,"$g_multiplayer_team_2_faction","fac_kingdom_2"),
(assign,"$g_multiplayer_next_team_1_faction","$g_multiplayer_team_1_faction"),
(assign,"$g_multiplayer_next_team_2_faction","$g_multiplayer_team_2_faction"),
(assign,"$g_multiplayer_num_bots_team_1",0),
(assign,"$g_multiplayer_num_bots_team_2",0),
(assign,"$g_multiplayer_number_of_respawn_count",0),
(assign,"$g_multiplayer_num_bots_voteable",50),
(assign,"$g_multiplayer_max_num_bots",101),
(assign,"$g_multiplayer_factions_voteable",1),
(assign,"$g_multiplayer_maps_voteable",1),
(assign,"$g_multiplayer_kick_voteable",1),
(assign,"$g_multiplayer_ban_voteable",1),
(assign,"$g_multiplayer_valid_vote_ratio",51),
(assign,"$g_multiplayer_auto_team_balance_limit",3),
(assign,"$g_multiplayer_player_respawn_as_bot",1),
(assign,"$g_multiplayer_stats_chart_opened_manually",0),
(assign,"$g_multiplayer_mission_end_screen",0),
(assign,"$g_multiplayer_ready_for_spawning_agent",1),
(assign,"$g_multiplayer_welcome_message_shown",0),
(assign,"$g_multiplayer_allow_player_banners",1),
(assign,"$g_multiplayer_force_default_armor",1),
(assign,"$g_multiplayer_disallow_ranged_weapons",0),
(assign,"$g_multiplayer_initial_gold_multiplier",100),
(assign,"$g_multiplayer_battle_earnings_multiplier",100),
(assign,"$g_multiplayer_round_earnings_multiplier",100),
(assign,"$g_multiplayer_is_game_type_captain",0),
(assign,"$g_multiplayer_ccoop_difficulty",1),
(faction_set_slot,"fac_kingdom_1",15,"mesh_banner_kingdom_f"),
(faction_set_slot,"fac_kingdom_2",15,"mesh_banner_kingdom_b"),
(faction_set_slot,"fac_kingdom_3",15,"mesh_banner_kingdom_c"),
(faction_set_slot,"fac_kingdom_4",15,"mesh_banner_kingdom_a"),
(faction_set_slot,"fac_kingdom_5",15,"mesh_banner_kingdom_d"),
(faction_set_slot,"fac_kingdom_6",15,"mesh_banner_kingdom_e"),
(try_for_range, ":item_id_001", 0, ":itm.items_end"),
(try_for_range, ":fac_002", ":fac.kingdom_1", ":fac.kingdoms_end"),
(store_sub, ":slot_no_003", ":fac_002", ":fac.kingdom_1"),
(val_add, ":slot_no_003", 30),
(item_set_slot,":item_id_001",":slot_no_003",100),
(try_end),
(try_end),
(assign,":slot_no_004","fac_kingdom_1"),
(assign,":slot_no_004 -","fac_kingdom_1"),
(val_add, ":slot_no_004", 30),
(assign,":slot_no_005","fac_kingdom_2"),
(assign,":slot_no_005 -","fac_kingdom_1"),
(val_add, ":slot_no_005", 30),
(assign,":slot_no_006","fac_kingdom_3"),
(assign,":slot_no_006 -","fac_kingdom_1"),
(val_add, ":slot_no_006", 30),
(assign,":var007","fac_kingdom_4"),
(assign,":var007 -","fac_kingdom_1"),
(val_add, ":var007", 30),
(assign,":var008","fac_kingdom_5"),
(assign,":var008 -","fac_kingdom_1"),
(val_add, ":var008", 30),
(assign,":slot_no_009","fac_kingdom_6"),
(assign,":slot_no_009 -","fac_kingdom_1"),
(val_add, ":slot_no_009", 30),
(item_set_slot,"itm_awlpike",":slot_no_004",80),
(item_set_slot,"itm_awlpike_long",":slot_no_004",90),
(item_set_slot,"itm_sword_medieval_a",":slot_no_004",80),
(item_set_slot,"itm_sword_medieval_b",":slot_no_004",80),
(item_set_slot,"itm_sword_medieval_b_small",":slot_no_004",80),
(item_set_slot,"itm_sword_medieval_c",":slot_no_004",80),
(item_set_slot,"itm_sword_medieval_c_small",":slot_no_004",80),
(item_set_slot,"itm_leather_boots",":slot_no_004",90),
(item_set_slot,"itm_mail_chausses",":slot_no_004",80),
(item_set_slot,"itm_splinted_greaves",":slot_no_004",80),
(item_set_slot,"itm_plate_boots",":slot_no_004",80),
(item_set_slot,"itm_courser",":slot_no_004",90),
(item_set_slot,"itm_hunter",":slot_no_004",75),
(item_set_slot,"itm_norman_helmet",":slot_no_004",75),
(item_set_slot,"itm_helmet_with_neckguard",":slot_no_004",75),
(item_set_slot,"itm_red_gambeson",":slot_no_004",75),
(item_set_slot,"itm_darts",":slot_no_004",50),
(item_set_slot,"itm_war_darts",":slot_no_004",50),
(item_set_slot,"itm_tab_shield_heater_d",":slot_no_004",80),
(item_set_slot,"itm_brigandine_red",":slot_no_004",75),
(item_set_slot,"itm_bastard_sword_b",":slot_no_004",65),
(item_set_slot,"itm_bastard_sword_a",":slot_no_004",85),
(item_set_slot,"itm_steppe_horse",":slot_no_006",120),
(item_set_slot,"itm_courser",":slot_no_006",80),
(item_set_slot,"itm_hunter",":slot_no_006",80),
(item_set_slot,"itm_warhorse_steppe",":slot_no_006",120),
(item_set_slot,"itm_one_handed_war_axe_a",":slot_no_006",300),
(item_set_slot,"itm_tribal_warrior_outfit",":slot_no_006",140),
(item_set_slot,"itm_leather_gloves",":slot_no_009",50),
(item_set_slot,"itm_short_bow",":slot_no_009",50),
(item_set_slot,"itm_barbed_arrows",":slot_no_009",80),
(item_set_slot,"itm_jarid",":slot_no_009",85),
(item_set_slot,"itm_javelin",":slot_no_009",85),
(item_set_slot,"itm_lamellar_vest",":slot_no_005",130),
(item_set_slot,"itm_awlpike",":slot_no_005",150),
(item_set_slot,"itm_scimitar",":slot_no_005",130),
(item_set_slot,"itm_scimitar_b",":slot_no_005",150),
(item_set_slot,"itm_tab_shield_kite_a",":slot_no_005",120),
(item_set_slot,"itm_tab_shield_kite_b",":slot_no_005",120),
(item_set_slot,"itm_tab_shield_kite_c",":slot_no_005",120),
(item_set_slot,"itm_tab_shield_kite_d",":slot_no_005",120),
(item_set_slot,"itm_javelin",":slot_no_005",120),
(item_set_slot,"itm_arrows",60,14),
(item_set_slot,"itm_barbed_arrows",60,14),
(item_set_slot,"itm_bodkin_arrows",60,14),
(item_set_slot,"itm_khergit_arrows",60,14),
(item_set_slot,"itm_bolts",60,15),
(item_set_slot,"itm_steel_bolts",60,15),
(item_set_slot,"itm_crossbow",60,12),
(item_set_slot,"itm_heavy_crossbow",60,12),
(item_set_slot,"itm_sniper_crossbow",60,12),
(item_set_slot,"itm_nomad_bow",60,12),
(item_set_slot,"itm_khergit_bow",60,12),
(item_set_slot,"itm_strong_bow",60,12),
(item_set_slot,"itm_war_bow",60,12),
(item_set_slot,"itm_short_bow",60,12),
(item_set_slot,"itm_long_bow",60,12),
(item_set_slot,"itm_light_crossbow",60,12),
(item_set_slot,"itm_sword_medieval_a",60,1),
(item_set_slot,"itm_sword_medieval_b",60,1),
(item_set_slot,"itm_sword_medieval_b_small",60,1),
(item_set_slot,"itm_sword_medieval_c",60,1),
(item_set_slot,"itm_sword_medieval_c_small",60,1),
(item_set_slot,"itm_scimitar",60,1),
(item_set_slot,"itm_scimitar_b",60,1),
(item_set_slot,"itm_dagger",60,1),
(item_set_slot,"itm_sword_khergit_1",60,1),
(item_set_slot,"itm_sword_khergit_2",60,1),
(item_set_slot,"itm_sword_khergit_3",60,1),
(item_set_slot,"itm_sword_khergit_4",60,1),
(item_set_slot,"itm_sword_viking_1",60,1),
(item_set_slot,"itm_sword_viking_2",60,1),
(item_set_slot,"itm_sword_viking_2_small",60,1),
(item_set_slot,"itm_sword_viking_3",60,1),
(item_set_slot,"itm_sword_viking_3_small",60,1),
(item_set_slot,"itm_bastard_sword_a",60,6),
(item_set_slot,"itm_bastard_sword_b",60,6),
(item_set_slot,"itm_sword_two_handed_a",60,6),
(item_set_slot,"itm_sword_two_handed_b",60,6),
(item_set_slot,"itm_arabian_sword_a",60,6),
(item_set_slot,"itm_arabian_sword_b",60,6),
(item_set_slot,"itm_sarranid_cavalry_sword",60,6),
(item_set_slot,"itm_arabian_sword_d",60,6),
(item_set_slot,"itm_axe",60,2),
(item_set_slot,"itm_battle_axe",60,2),
(item_set_slot,"itm_one_handed_war_axe_a",60,2),
(item_set_slot,"itm_one_handed_war_axe_b",60,2),
(item_set_slot,"itm_one_handed_battle_axe_a",60,2),
(item_set_slot,"itm_one_handed_battle_axe_b",60,2),
(item_set_slot,"itm_one_handed_battle_axe_c",60,2),
(item_set_slot,"itm_two_handed_axe",60,7),
(item_set_slot,"itm_two_handed_battle_axe_2",60,7),
(item_set_slot,"itm_shortened_voulge",60,7),
(item_set_slot,"itm_bardiche",60,7),
(item_set_slot,"itm_great_axe",60,7),
(item_set_slot,"itm_great_bardiche",60,7),
(item_set_slot,"itm_long_axe",60,7),
(item_set_slot,"itm_long_axe_b",60,7),
(item_set_slot,"itm_long_axe_c",60,7),
(item_set_slot,"itm_voulge",60,7),
(item_set_slot,"itm_long_bardiche",60,7),
(item_set_slot,"itm_great_long_bardiche",60,7),
(item_set_slot,"itm_mace_1",60,3),
(item_set_slot,"itm_mace_2",60,3),
(item_set_slot,"itm_mace_3",60,3),
(item_set_slot,"itm_mace_4",60,3),
(item_set_slot,"itm_long_spiked_club",60,3),
(item_set_slot,"itm_long_hafted_spiked_mace",60,3),
(item_set_slot,"itm_maul",60,3),
(item_set_slot,"itm_sledgehammer",60,3),
(item_set_slot,"itm_warhammer",60,3),
(item_set_slot,"itm_morningstar",60,3),
(item_set_slot,"itm_military_sickle_a",60,4),
(item_set_slot,"itm_fighting_pick",60,4),
(item_set_slot,"itm_military_pick",60,4),
(item_set_slot,"itm_club_with_spike_head",60,4),
(item_set_slot,"itm_falchion",60,5),
(item_set_slot,"itm_military_cleaver_b",60,5),
(item_set_slot,"itm_military_cleaver_c",60,5),
(item_set_slot,"itm_two_handed_cleaver",60,5),
(item_set_slot,"itm_hafted_blade_a",60,5),
(item_set_slot,"itm_hafted_blade_b",60,5),
(item_set_slot,"itm_shortened_military_scythe",60,5),
(item_set_slot,"itm_sarranid_mace_1",60,3),
(item_set_slot,"itm_sarranid_axe_a",60,3),
(item_set_slot,"itm_sarranid_axe_b",60,3),
(item_set_slot,"itm_sarranid_two_handed_axe_a",60,7),
(item_set_slot,"itm_sarranid_two_handed_axe_b",60,7),
(item_set_slot,"itm_sarranid_two_handed_mace_1",60,7),
(item_set_slot,"itm_bamboo_spear",60,8),
(item_set_slot,"itm_double_sided_lance",60,8),
(item_set_slot,"itm_glaive",60,8),
(item_set_slot,"itm_poleaxe",60,8),
(item_set_slot,"itm_polehammer",60,8),
(item_set_slot,"itm_staff",60,8),
(item_set_slot,"itm_quarter_staff",60,8),
(item_set_slot,"itm_iron_staff",60,8),
(item_set_slot,"itm_shortened_spear",60,8),
(item_set_slot,"itm_spear",60,8),
(item_set_slot,"itm_war_spear",60,8),
(item_set_slot,"itm_military_scythe",60,8),
(item_set_slot,"itm_pike",60,8),
(item_set_slot,"itm_ashwood_pike",60,8),
(item_set_slot,"itm_awlpike",60,8),
(item_set_slot,"itm_awlpike_long",60,8),
(item_set_slot,"itm_light_lance",60,9),
(item_set_slot,"itm_lance",60,9),
(item_set_slot,"itm_heavy_lance",60,9),
(item_set_slot,"itm_great_lance",60,9),
(item_set_slot,"itm_tab_shield_round_a",60,10),
(item_set_slot,"itm_tab_shield_round_b",60,10),
(item_set_slot,"itm_tab_shield_round_c",60,10),
(item_set_slot,"itm_tab_shield_round_d",60,10),
(item_set_slot,"itm_tab_shield_round_e",60,10),
(item_set_slot,"itm_tab_shield_kite_a",60,10),
(item_set_slot,"itm_tab_shield_kite_b",60,10),
(item_set_slot,"itm_tab_shield_kite_c",60,10),
(item_set_slot,"itm_tab_shield_kite_d",60,10),
(item_set_slot,"itm_tab_shield_kite_cav_a",60,10),
(item_set_slot,"itm_tab_shield_kite_cav_b",60,10),
(item_set_slot,"itm_tab_shield_heater_a",60,10),
(item_set_slot,"itm_tab_shield_heater_b",60,10),
(item_set_slot,"itm_tab_shield_heater_c",60,10),
(item_set_slot,"itm_tab_shield_heater_d",60,10),
(item_set_slot,"itm_tab_shield_heater_cav_a",60,10),
(item_set_slot,"itm_tab_shield_heater_cav_b",60,10),
(item_set_slot,"itm_tab_shield_pavise_a",60,10),
(item_set_slot,"itm_tab_shield_pavise_b",60,10),
(item_set_slot,"itm_tab_shield_pavise_c",60,10),
(item_set_slot,"itm_tab_shield_pavise_d",60,10),
(item_set_slot,"itm_tab_shield_small_round_a",60,10),
(item_set_slot,"itm_tab_shield_small_round_b",60,10),
(item_set_slot,"itm_tab_shield_small_round_c",60,10),
(item_set_slot,"itm_spear",60,8),
(item_set_slot,"itm_darts",60,16),
(item_set_slot,"itm_war_darts",60,16),
(item_set_slot,"itm_javelin",60,16),
(item_set_slot,"itm_jarid",60,16),
(item_set_slot,"itm_throwing_spears",60,16),
(item_set_slot,"itm_throwing_axes",60,17),
(item_set_slot,"itm_light_throwing_axes",60,17),
(item_set_slot,"itm_heavy_throwing_axes",60,17),
(item_set_slot,"itm_red_shirt",60,19),
(item_set_slot,"itm_red_tunic",60,19),
(item_set_slot,"itm_aketon_green",60,19),
(item_set_slot,"itm_padded_cloth",60,19),
(item_set_slot,"itm_red_gambeson",60,19),
(item_set_slot,"itm_leather_armor",60,19),
(item_set_slot,"itm_haubergeon",60,19),
(item_set_slot,"itm_coat_of_plates_red",60,19),
(item_set_slot,"itm_brigandine_red",60,19),
(item_set_slot,"itm_mail_with_surcoat",60,19),
(item_set_slot,"itm_linen_tunic",60,19),
(item_set_slot,"itm_leather_vest",60,19),
(item_set_slot,"itm_leather_jerkin",60,19),
(item_set_slot,"itm_studded_leather_coat",60,19),
(item_set_slot,"itm_lamellar_vest",60,19),
(item_set_slot,"itm_lamellar_armor",60,19),
(item_set_slot,"itm_coarse_tunic",60,19),
(item_set_slot,"itm_tribal_warrior_outfit",60,19),
(item_set_slot,"itm_khergit_guard_armor",60,19),
(item_set_slot,"itm_blue_tunic",60,19),
(item_set_slot,"itm_mail_hauberk",60,19),
(item_set_slot,"itm_mail_shirt",60,19),
(item_set_slot,"itm_byrnie",60,19),
(item_set_slot,"itm_lamellar_vest_khergit",60,19),
(item_set_slot,"itm_steppe_armor",60,19),
(item_set_slot,"itm_banded_armor",60,19),
(item_set_slot,"itm_cuir_bouilli",60,19),
(item_set_slot,"itm_scale_armor",60,19),
(item_set_slot,"itm_padded_leather",60,19),
(item_set_slot,"itm_green_tunic",60,19),
(item_set_slot,"itm_tunic_with_green_cape",60,19),
(item_set_slot,"itm_aketon_green",60,19),
(item_set_slot,"itm_ragged_outfit",60,19),
(item_set_slot,"itm_surcoat_over_mail",60,19),
(item_set_slot,"itm_sarranid_elite_armor",60,19),
(item_set_slot,"itm_skirmisher_armor",60,19),
(item_set_slot,"itm_archers_vest",60,19),
(item_set_slot,"itm_sarranid_leather_armor",60,19),
(item_set_slot,"itm_sarranid_cloth_robe",60,19),
(item_set_slot,"itm_sarranid_mail_shirt",60,19),
(item_set_slot,"itm_sarranid_cavalry_robe",60,19),
(item_set_slot,"itm_arabian_armor_b",60,19),
(item_set_slot,"itm_mamluke_mail",60,19),
(item_set_slot,"itm_khergit_elite_armor",60,19),
(item_set_slot,"itm_vaegir_elite_armor",60,19),
(item_set_slot,"itm_khergit_armor",60,19),
(item_set_slot,"itm_hide_boots",60,24),
(item_set_slot,"itm_ankle_boots",60,24),
(item_set_slot,"itm_nomad_boots",60,24),
(item_set_slot,"itm_leather_boots",60,24),
(item_set_slot,"itm_splinted_leather_greaves",60,24),
(item_set_slot,"itm_mail_chausses",60,24),
(item_set_slot,"itm_splinted_leather_greaves",60,24),
(item_set_slot,"itm_splinted_greaves",60,24),
(item_set_slot,"itm_mail_boots",60,24),
(item_set_slot,"itm_iron_greaves",60,24),
(item_set_slot,"itm_sarranid_boots_b",60,24),
(item_set_slot,"itm_sarranid_boots_c",60,24),
(item_set_slot,"itm_sarranid_boots_d",60,24),
(item_set_slot,"itm_plate_boots",60,24),
(item_set_slot,"itm_khergit_leather_boots",60,24),
(item_set_slot,"itm_khergit_guard_boots",60,24),
(item_set_slot,"itm_leather_steppe_cap_a",60,22),
(item_set_slot,"itm_leather_steppe_cap_b",60,22),
(item_set_slot,"itm_steppe_cap",60,22),
(item_set_slot,"itm_khergit_war_helmet",60,22),
(item_set_slot,"itm_khergit_guard_helmet",60,22),
(item_set_slot,"itm_arming_cap",60,22),
(item_set_slot,"itm_padded_coif",60,22),
(item_set_slot,"itm_mail_coif",60,22),
(item_set_slot,"itm_footman_helmet",60,22),
(item_set_slot,"itm_norman_helmet",60,22),
(item_set_slot,"itm_kettle_hat",60,22),
(item_set_slot,"itm_helmet_with_neckguard",60,22),
(item_set_slot,"itm_bascinet_2",60,22),
(item_set_slot,"itm_bascinet_3",60,22),
(item_set_slot,"itm_flat_topped_helmet",60,22),
(item_set_slot,"itm_guard_helmet",60,22),
(item_set_slot,"itm_full_helm",60,22),
(item_set_slot,"itm_great_helmet",60,22),
(item_set_slot,"itm_nomad_cap_b",60,22),
(item_set_slot,"itm_skullcap",60,22),
(item_set_slot,"itm_leather_cap",60,22),
(item_set_slot,"itm_spiked_helmet",60,22),
(item_set_slot,"itm_nordic_archer_helmet",60,22),
(item_set_slot,"itm_nordic_veteran_archer_helmet",60,22),
(item_set_slot,"itm_nordic_footman_helmet",60,22),
(item_set_slot,"itm_nordic_fighter_helmet",60,22),
(item_set_slot,"itm_nordic_huscarl_helmet",60,22),
(item_set_slot,"itm_nordic_warlord_helmet",60,22),
(item_set_slot,"itm_sarranid_helmet1",60,22),
(item_set_slot,"itm_sarranid_horseman_helmet",60,22),
(item_set_slot,"itm_sarranid_felt_hat",60,22),
(item_set_slot,"itm_sarranid_veiled_helmet",60,22),
(item_set_slot,"itm_turban",60,22),
(item_set_slot,"itm_desert_turban",60,22),
(item_set_slot,"itm_sarranid_warrior_cap",60,22),
(item_set_slot,"itm_sarranid_mail_coif",60,22),
(item_set_slot,"itm_vaegir_fur_cap",60,22),
(item_set_slot,"itm_vaegir_fur_helmet",60,22),
(item_set_slot,"itm_vaegir_spiked_helmet",60,22),
(item_set_slot,"itm_vaegir_lamellar_helmet",60,22),
(item_set_slot,"itm_vaegir_noble_helmet",60,22),
(item_set_slot,"itm_vaegir_war_helmet",60,22),
(item_set_slot,"itm_vaegir_mask",60,22),
(item_set_slot,"itm_leather_gloves",60,26),
(item_set_slot,"itm_mail_mittens",60,26),
(item_set_slot,"itm_scale_gauntlets",60,26),
(item_set_slot,"itm_lamellar_gauntlets",60,26),
(item_set_slot,"itm_gauntlets",60,26),
(item_set_slot,"itm_saddle_horse",60,18),
(item_set_slot,"itm_hunter",60,18),
(item_set_slot,"itm_courser",60,18),
(item_set_slot,"itm_hunter",60,18),
(item_set_slot,"itm_warhorse",60,18),
(item_set_slot,"itm_charger",60,18),
(item_set_slot,"itm_steppe_horse",60,18),
(item_set_slot,"itm_arabian_horse_a",60,18),
(item_set_slot,"itm_arabian_horse_b",60,18),
(item_set_slot,"itm_warhorse_steppe",60,18),
(item_set_slot,"itm_warhorse_sarranid",60,18),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bolts", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steel_bolts", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_crossbow", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_heavy_crossbow", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sniper_crossbow", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_a", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_b", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_b_small", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_a", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_b", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_c", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_red_shirt", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_padded_cloth", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_armor", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_haubergeon", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_ankle_boots", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_boots", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_chausses", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arming_cap", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_norman_helmet", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_helmet_with_neckguard", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_flat_topped_helmet", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_guard_helmet", "trp_swadian_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_awlpike", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_awlpike_long", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_a", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_b", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_b_small", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_c", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_c_small", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bastard_sword_a", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bastard_sword_b", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_two_handed_a", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_two_handed_b", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_darts", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_darts", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_a", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_b", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_c", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_d", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_red_tunic", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_red_gambeson", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_armor", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_haubergeon", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_brigandine_red", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_ankle_boots", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_boots", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_chausses", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arming_cap", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_norman_helmet", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_helmet_with_neckguard", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_flat_topped_helmet", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_guard_helmet", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_great_helmet", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_gauntlets", "trp_swadian_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_darts", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_darts", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lance", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_heavy_lance", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_great_lance", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_a", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_b", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_b_small", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_c", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_c_small", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bastard_sword_a", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bastard_sword_b", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_a", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_b", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_c", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_d", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_red_tunic", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_padded_cloth", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_armor", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_with_surcoat", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_coat_of_plates_red", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_ankle_boots", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_boots", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_chausses", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_plate_boots", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arming_cap", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_norman_helmet", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_helmet_with_neckguard", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_flat_topped_helmet", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_guard_helmet", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_great_helmet", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_gauntlets", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_saddle_horse", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_courser", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hunter", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_warhorse", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_charger", "trp_swadian_man_at_arms_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arrows", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_barbed_arrows", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_1", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_2", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_falchion", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_bow", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_bow", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_strong_bow", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_bow", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_linen_tunic", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_jerkin", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_vest", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_vest", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hide_boots", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_boots", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_leather_greaves", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_cap", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_fur_cap", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_fur_helmet", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_spiked_helmet", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_lamellar_helmet", "trp_vaegir_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_spear", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_spear", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_awlpike", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_a", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_b", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_c", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_d", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_1", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_2", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_3", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_4", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_long_hafted_spiked_mace", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_long_spiked_club", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scimitar", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scimitar_b", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bardiche", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_great_bardiche", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_long_bardiche", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_great_long_bardiche", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_javelin", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_linen_tunic", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_jerkin", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_vest", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_vest", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_armor", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_elite_armor", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hide_boots", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_boots", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_leather_greaves", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_fur_cap", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_fur_helmet", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_spiked_helmet", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_lamellar_helmet", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_noble_helmet", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_war_helmet", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_vaegir_spearman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_darts", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_darts", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bardiche", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scimitar", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scimitar_b", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lance", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_heavy_lance", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_cav_a", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_cav_b", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_c", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_d", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_linen_tunic", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_vest", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_vest", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_studded_leather_coat", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_armor", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_elite_armor", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hide_boots", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_boots", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_leather_greaves", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_plate_boots", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_fur_cap", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_fur_helmet", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_spiked_helmet", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_lamellar_helmet", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_noble_helmet", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_war_helmet", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_vaegir_mask", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_saddle_horse", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_courser", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hunter", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_warhorse_steppe", "trp_vaegir_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_1", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_2", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_3", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_4", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_bow", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_bow", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_strong_bow", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arrows", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_arrows", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_steppe_cap_a", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_cap_b", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_steppe_cap_b", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steppe_cap", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_armor", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steppe_armor", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tribal_warrior_outfit", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_vest_khergit", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hide_boots", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_boots", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_leather_boots", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_leather_greaves", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steppe_horse", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_khergit_veteran_horse_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_javelin", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_jarid", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_1", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_2", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_3", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_4", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_a", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_b", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_c", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_round_b", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_round_c", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_spear", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hafted_blade_a", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hafted_blade_b", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_1", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_2", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_3", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_cap_b", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_steppe_cap_b", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steppe_cap", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_war_helmet", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_guard_helmet", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steppe_armor", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tribal_warrior_outfit", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_armor", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_elite_armor", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hide_boots", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_boots", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_leather_boots", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_leather_greaves", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_gauntlets", "trp_khergit_infantry_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_javelin", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_1", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_2", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_3", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_khergit_4", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_a", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_b", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_c", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lance", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_heavy_lance", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hafted_blade_a", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hafted_blade_b", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_one_handed_war_axe_a", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_steppe_cap_a", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_cap_b", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_steppe_cap_b", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steppe_cap", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_war_helmet", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_armor", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steppe_armor", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tribal_warrior_outfit", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_armor", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hide_boots", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_boots", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_khergit_leather_boots", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_leather_greaves", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lamellar_gauntlets", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steppe_horse", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_courser", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hunter", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_warhorse_steppe", "trp_khergit_lancer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arrows", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_barbed_arrows", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bodkin_arrows", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_1", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_2", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_2_small", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_3", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_3_small", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_one_handed_war_axe_a", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_one_handed_war_axe_b", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_two_handed_axe", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_short_bow", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_long_bow", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_blue_tunic", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_jerkin", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_byrnie", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_boots", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_leather_greaves", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_chausses", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_boots", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_archer_helmet", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_veteran_archer_helmet", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_footman_helmet", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_fighter_helmet", "trp_nord_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_1", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_2", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_2_small", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_3", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_3_small", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_one_handed_war_axe_a", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_one_handed_war_axe_b", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_one_handed_battle_axe_a", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_one_handed_battle_axe_b", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_one_handed_battle_axe_c", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_two_handed_axe", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_two_handed_battle_axe_2", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_great_axe", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_long_axe", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_long_axe_b", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_long_axe_c", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_spear", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_spear", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_round_a", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_round_b", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_round_c", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_round_d", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_round_e", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_light_throwing_axes", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_throwing_axes", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_heavy_throwing_axes", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_veteran_archer_helmet", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_footman_helmet", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_fighter_helmet", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_huscarl_helmet", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_warlord_helmet", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_blue_tunic", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_jerkin", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_shirt", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_hauberk", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_banded_armor", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_boots", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_leather_greaves", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_chausses", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_boots", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_nord_veteran_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_darts", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_darts", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_javelin", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_throwing_spears", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_light_throwing_axes", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_throwing_axes", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_1", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_2", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_viking_3", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_two_handed_axe", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_two_handed_battle_axe_2", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_shortened_voulge", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_spear", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_spear", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_light_lance", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lance", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_a", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_b", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_c", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_archer_helmet", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_veteran_archer_helmet", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_footman_helmet", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_fighter_helmet", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nordic_huscarl_helmet", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_blue_tunic", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_jerkin", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_shirt", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_hauberk", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_boots", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_leather_greaves", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_chausses", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_boots", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_saddle_horse", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_courser", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hunter", "trp_nord_scout_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_crossbow", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_heavy_crossbow", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sniper_crossbow", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bolts", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_steel_bolts", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_fighting_pick", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_military_pick", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_club_with_spike_head", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_maul", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sledgehammer", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_a", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_b", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_b_small", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_pavise_a", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_pavise_b", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_pavise_c", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_pavise_d", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_cap", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_padded_coif", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_footman_helmet", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_kettle_hat", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tunic_with_green_cape", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_aketon_green", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_armor", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_ankle_boots", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_boots", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_rhodok_veteran_crossbowman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_darts", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_darts", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_javelin", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_fighting_pick", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_military_pick", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_morningstar", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_club_with_spike_head", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_military_cleaver_b", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_military_cleaver_c", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_two_handed_cleaver", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_military_sickle_a", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_maul", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sledgehammer", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_warhammer", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_spear", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_pike", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_ashwood_pike", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_spear", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_glaive", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_pavise_a", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_pavise_b", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_pavise_c", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_pavise_d", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_cap", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_padded_coif", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_footman_helmet", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_kettle_hat", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bascinet_2", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_full_helm", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_green_tunic", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_aketon_green", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_ragged_outfit", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_armor", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_surcoat_over_mail", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_ankle_boots", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_boots", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_iron_greaves", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_gauntlets", "trp_rhodok_sergeant_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_darts", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_war_darts", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_javelin", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_a", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_b", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sword_medieval_c", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_fighting_pick", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_military_pick", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_morningstar", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_military_cleaver_b", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_military_cleaver_c", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_two_handed_cleaver", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_shortened_military_scythe", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_light_lance", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lance", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_heavy_lance", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_cav_a", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_heater_cav_b", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_padded_coif", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_footman_helmet", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_kettle_hat", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bascinet_3", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_green_tunic", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_aketon_green", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_ragged_outfit", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_armor", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_surcoat_over_mail", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_ankle_boots", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_boots", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_splinted_greaves", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_plate_boots", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_gauntlets", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_saddle_horse", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_courser", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_hunter", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_warhorse", "trp_rhodok_horseman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_cloth_robe", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_skirmisher_armor", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_archers_vest", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_armor_b", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_felt_hat", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_turban", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_desert_turban", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_mail_coif", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_horseman_helmet", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_warrior_cap", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_boots_b", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_boots_c", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_short_bow", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_nomad_bow", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arrows", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_barbed_arrows", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scimitar", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mace_1", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_sword_a", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_sword_b", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_sarranid_archer_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_cloth_robe", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_skirmisher_armor", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_archers_vest", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_leather_armor", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_armor_b", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_elite_armor", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_felt_hat", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_turban", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_desert_turban", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_mail_coif", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_warrior_cap", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_veiled_helmet", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_boots_b", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_boots_c", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_boots_d", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_sword_a", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_sword_b", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_sword_d", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_mace_1", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_axe_a", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_axe_b", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_two_handed_axe_a", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_two_handed_axe_b", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_two_handed_mace_1", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_bamboo_spear", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_spear", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_jarid", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_javelin", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_a", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_b", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_c", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_kite_d", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_sarranid_footman_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_cloth_robe", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_skirmisher_armor", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_archers_vest", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_mail_shirt", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_cavalry_robe", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mamluke_mail", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_elite_armor", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_turban", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_desert_turban", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_horseman_helmet", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_mail_coif", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_veiled_helmet", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_boots_b", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_boots_c", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_boots_d", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_sword_a", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_sword_b", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_cavalry_sword", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_sword_d", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_mace_1", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_axe_a", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_axe_b", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_sarranid_two_handed_axe_a", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_lance", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_heavy_lance", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_jarid", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_javelin", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_a", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_b", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_tab_shield_small_round_c", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_saddle_horse", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_horse_a", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_arabian_horse_b", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_warhorse_sarranid", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_leather_gloves", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_mail_mittens", "trp_sarranid_mamluke_multiplayer"),
(call_script, "script_multiplayer_set_item_available_for_troop", "itm_scale_gauntlets", "trp_sarranid_mamluke_multiplayer"),
(scene_set_slot,"scn_multi_scene_11",1,1),
(scene_set_slot,"scn_multi_scene_12",1,1),
(scene_set_slot,"scn_multi_scene_18",1,1),
(scene_set_slot,"scn_multi_scene_20",1,1),
(item_set_slot,"itm_javelin_bow",59,1),
]),

("get_army_size_from_slider_value", [
(store_script_param, ":var001", 1),
(assign,":var002",":var001"),
(try_begin),
(gt,":var001",25),
(store_sub, ":var003", ":var001", 25),
(val_add, ":var002", ":var003"),
(try_begin),
(gt,":var001",50),
(store_sub, ":var003", ":var001", 50),
(val_mul, ":var003", 3),
(val_add, ":var002", ":var003"),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("spawn_quick_battle_army", [
(store_script_param, ":entry_no_001", 1),
(store_script_param, ":faction_id_002", 2),
(store_script_param, ":var003", 3),
(store_script_param, ":var004", 4),
(store_script_param, ":var005", 5),
(store_script_param, ":var006", 6),
(store_script_param, ":var007", 7),
(try_begin),
(eq,":var007",1),
(call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_1_size"),
(assign,":var008",reg0),
(set_player_troop,"$g_quick_battle_troop"),
(set_visitor,":entry_no_001","$g_quick_battle_troop"),
(try_begin),
(eq,":entry_no_001",0),
(try_begin),
(is_between,":faction_id_002","fac_kingdom_1","fac_kingdoms_end"),
(faction_get_slot,"$g_quick_battle_team_0_banner",":faction_id_002",15),
(else_try),
(assign,"$g_quick_battle_team_0_banner","mesh_banners_default_b"),
(try_end),
(else_try),
(try_begin),
(is_between,":faction_id_002","fac_kingdom_1","fac_kingdoms_end"),
(faction_get_slot,"$g_quick_battle_team_1_banner",":faction_id_002",15),
(else_try),
(assign,"$g_quick_battle_team_1_banner","mesh_banners_default_b"),
(try_end),
(try_end),
(val_add, ":entry_no_001", 1),
(else_try),
(call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_2_size"),
(assign,":var008",reg0),
(try_begin),
(eq,":entry_no_001",0),
(assign,"$g_quick_battle_team_0_banner","mesh_banners_default_a"),
(else_try),
(assign,"$g_quick_battle_team_1_banner","mesh_banners_default_a"),
(try_end),
(val_add, ":entry_no_001", 1),
(try_end),
(store_mul, ":var009", ":var003", ":var008"),
(val_div, ":var009", 100),
(store_mul, ":var010", ":var004", ":var008"),
(val_div, ":var010", 100),
(store_mul, ":var011", ":var005", ":var008"),
(val_div, ":var011", 100),
(try_begin),
(eq,1,1),
(store_add, ":var012", ":var009", ":var010"),
(val_add, ":var012", ":var011"),
(try_begin),
(neq,":var012",":var008"),
(store_sub, ":var013", ":var008", ":var012"),
(try_begin),
(gt,":var003",":var004"),
(gt,":var003",":var005"),
(val_add, ":var009", ":var013"),
(else_try),
(gt,":var004",":var005"),
(val_add, ":var010", ":var013"),
(else_try),
(val_add, ":var011", ":var013"),
(try_end),
(try_end),
(try_end),
(store_mul, ":var014", ":var009", 15),
(val_div, ":var014", 100),
(store_mul, ":var015", ":var009", 45),
(val_div, ":var015", 100),
(store_random_in_range,":random_x_016",":var014",":var015"),
(store_sub, ":number_of_troops_017", ":var009", ":random_x_016"),
(store_mul, ":var014", ":var010", 15),
(val_div, ":var014", 100),
(store_mul, ":var015", ":var010", 45),
(val_div, ":var015", 100),
(store_random_in_range,":random_x_018",":var014",":var015"),
(store_sub, ":number_of_troops_019", ":var010", ":random_x_018"),
(store_mul, ":var014", ":var011", 15),
(val_div, ":var014", 100),
(store_mul, ":var015", ":var011", 45),
(val_div, ":var015", 100),
(store_random_in_range,":random_x_020",":var014",":var015"),
(store_sub, ":number_of_troops_021", ":var011", ":random_x_020"),
(faction_get_slot,":faction_slot_022",":faction_id_002",42),
(set_visitors,":entry_no_001",":faction_slot_022",":random_x_016"),
(val_add, ":entry_no_001", 1),
(faction_get_slot,":faction_slot_022",":faction_id_002",41),
(set_visitors,":entry_no_001",":faction_slot_022",":number_of_troops_017"),
(val_add, ":entry_no_001", 1),
(faction_get_slot,":faction_slot_022",":faction_id_002",46),
(set_visitors,":entry_no_001",":faction_slot_022",":random_x_020"),
(val_add, ":entry_no_001", 1),
(faction_get_slot,":faction_slot_022",":faction_id_002",45),
(set_visitors,":entry_no_001",":faction_slot_022",":number_of_troops_021"),
(val_add, ":entry_no_001", 1),
(try_begin),
(eq,":var006",0),
(faction_get_slot,":faction_slot_022",":faction_id_002",44),
(set_visitors,":entry_no_001",":faction_slot_022",":random_x_018"),
(val_add, ":entry_no_001", 1),
(faction_get_slot,":faction_slot_022",":faction_id_002",43),
(set_visitors,":entry_no_001",":faction_slot_022",":number_of_troops_019"),
(val_add, ":entry_no_001", 1),
(else_try),
(assign,":entry_no_001",40),
(store_div, ":var___x1", ":number_of_troops_019", 8),
(assign,":var023",":var___x1"),
(val_mul, ":var023", 8),
(try_begin),
(neq,":var023",":number_of_troops_019"),
(val_div, ":var023", 8),
(val_add, ":var023", 1),
(val_mul, ":var023", 8),
(try_end),
(store_div, ":var___x1", ":random_x_018", 8),
(assign,":var024",":var___x1"),
(val_mul, ":var024", 8),
(try_begin),
(neq,":var024",":random_x_018"),
(val_div, ":var024", 8),
(val_add, ":var024", 1),
(val_mul, ":var024", 8),
(try_end),
(store_add, ":var025", ":var023", ":var024"),
(store_div, ":var___x1", ":var025", 8),
(assign,":var026",":var___x1"),
(assign,":var027",":number_of_troops_019"),
(assign,":var028",":random_x_018"),
(assign,":var029",1000),
(try_for_range, ":var030", 0, ":var029"),
(gt,":var028",0),
(assign,":number_of_troops_031",":var026"),
(val_min,":number_of_troops_031",":var028"),
(faction_get_slot,":faction_slot_022",":faction_id_002",44),
(set_visitors,":entry_no_001",":faction_slot_022",":number_of_troops_031"),
(val_add, ":entry_no_001", 1),
(val_sub, ":var028", ":number_of_troops_031"),
(else_try),
(gt,":var027",0),
(assign,":number_of_troops_032",":var026"),
(val_min,":number_of_troops_032",":var027"),
(faction_get_slot,":faction_slot_022",":faction_id_002",43),
(set_visitors,":entry_no_001",":faction_slot_022",":number_of_troops_032"),
(val_add, ":entry_no_001", 1),
(val_sub, ":var027", ":number_of_troops_032"),
(else_try),
(assign,":var029",0),
(try_end),
(try_end),
]),

("player_arrived", [
(assign,":var001","fac_culture_1"),
(faction_set_slot,"fac_player_supporters_faction",10,":var001"),
(faction_set_slot,"fac_player_faction",10,":var001"),
]),

("game_set_multiplayer_mission_end", [
(assign,"$g_multiplayer_mission_end_screen",1),
]),

("game_enable_cheat_menu", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,":var001",0),
(assign,"$cheat_mode",0),
(else_try),
(eq,":var001",1),
(assign,"$cheat_mode",1),
(try_end),
]),

("game_get_console_command", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(try_begin),
(eq,":var001",2),
(try_end),
(try_begin),
(eq,":var001",1),
(assign,reg0,":var002"),
(try_begin),
(eq,":var002",1),
(assign,reg1,"$g_multiplayer_num_bots_team_1"),
(str_store_string,s0,":str_store_string("str_team_reg0_bot_count_is_reg1")"),
(else_try),
(eq,":var002",2),
(assign,reg1,"$g_multiplayer_num_bots_team_2"),
(str_store_string,s0,":str_store_string("str_team_reg0_bot_count_is_reg1")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",2),
(assign,reg0,":var002"),
(assign,reg1,":var003"),
(try_begin),
(eq,":var002",1),
(ge,":var003",0),
(assign,"$g_multiplayer_num_bots_team_1",":var003"),
(str_store_string,s0,":str_store_string("str_team_reg0_bot_count_is_reg1")"),
(else_try),
(eq,":var002",2),
(ge,":var003",0),
(assign,"$g_multiplayer_num_bots_team_2",":var003"),
(str_store_string,s0,":str_store_string("str_team_reg0_bot_count_is_reg1")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",3),
(assign,reg0,"$g_multiplayer_round_max_seconds"),
(str_store_string,s0,":str_store_string("str_maximum_seconds_for_round_is_reg0")"),
(else_try),
(eq,":var001",4),
(assign,reg0,":var002"),
(try_begin),
(is_between,":var002",60,901),
(assign,"$g_multiplayer_round_max_seconds",":var002"),
(str_store_string,s0,":str_store_string("str_maximum_seconds_for_round_is_reg0")"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 59, ":var002"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",5),
(assign,reg0,"$g_multiplayer_respawn_period"),
(str_store_string,s0,":str_store_string("str_respawn_period_is_reg0_seconds")"),
(else_try),
(eq,":var001",6),
(assign,reg0,":var002"),
(try_begin),
(is_between,":var002",3,31),
(assign,"$g_multiplayer_respawn_period",":var002"),
(str_store_string,s0,":str_store_string("str_respawn_period_is_reg0_seconds")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",7),
(assign,reg0,"$g_multiplayer_num_bots_voteable"),
(str_store_string,s0,":str_store_string("str_bots_upper_limit_for_votes_is_reg0")"),
(else_try),
(eq,":var001",8),
(try_begin),
(is_between,":var002",0,51),
(assign,"$g_multiplayer_num_bots_voteable",":var002"),
(store_add, "$g_multiplayer_max_num_bots", ":var002", 1),
(assign,reg0,"$g_multiplayer_num_bots_voteable"),
(str_store_string,s0,":str_store_string("str_bots_upper_limit_for_votes_is_reg0")"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 81, ":var002"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",9),
(try_begin),
(eq,":::g_multiplayer_maps_voteable",1),
(str_store_string,s0,":str_store_string("str_map_is_voteable")"),
(else_try),
(str_store_string,s0,":str_store_string("str_map_is_not_voteable")"),
(try_end),
(else_try),
(eq,":var001",10),
(try_begin),
(is_between,":var002",0,2),
(assign,"$g_multiplayer_maps_voteable",":var002"),
(try_begin),
(eq,":var002",1),
(str_store_string,s0,":str_store_string("str_map_is_voteable")"),
(else_try),
(str_store_string,s0,":str_store_string("str_map_is_not_voteable")"),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 83, ":var002"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",11),
(try_begin),
(eq,":::g_multiplayer_factions_voteable",1),
(str_store_string,s0,":str_store_string("str_factions_are_voteable")"),
(else_try),
(str_store_string,s0,":str_store_string("str_factions_are_not_voteable")"),
(try_end),
(else_try),
(eq,":var001",12),
(try_begin),
(is_between,":var002",0,2),
(assign,"$g_multiplayer_factions_voteable",":var002"),
(try_begin),
(eq,":var002",1),
(str_store_string,s0,":str_store_string("str_factions_are_voteable")"),
(else_try),
(str_store_string,s0,":str_store_string("str_factions_are_not_voteable")"),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 82, ":var002"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",13),
(try_begin),
(eq,":::g_multiplayer_player_respawn_as_bot",1),
(str_store_string,s0,":str_store_string("str_players_respawn_as_bot")"),
(else_try),
(str_store_string,s0,":str_store_string("str_players_do_not_respawn_as_bot")"),
(try_end),
(else_try),
(eq,":var001",14),
(try_begin),
(is_between,":var002",0,2),
(assign,"$g_multiplayer_player_respawn_as_bot",":var002"),
(try_begin),
(eq,":var002",1),
(str_store_string,s0,":str_store_string("str_players_respawn_as_bot")"),
(else_try),
(str_store_string,s0,":str_store_string("str_players_do_not_respawn_as_bot")"),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 85, ":var002"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",15),
(try_begin),
(eq,":::g_multiplayer_kick_voteable",1),
(str_store_string,s0,":str_store_string("str_kicking_a_player_is_voteable")"),
(else_try),
(str_store_string,s0,":str_store_string("str_kicking_a_player_is_not_voteable")"),
(try_end),
(else_try),
(eq,":var001",16),
(try_begin),
(is_between,":var002",0,2),
(assign,"$g_multiplayer_kick_voteable",":var002"),
(try_begin),
(eq,":var002",1),
(str_store_string,s0,":str_store_string("str_kicking_a_player_is_voteable")"),
(else_try),
(str_store_string,s0,":str_store_string("str_kicking_a_player_is_not_voteable")"),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 90, ":var002"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",17),
(try_begin),
(eq,":::g_multiplayer_ban_voteable",1),
(str_store_string,s0,":str_store_string("str_banning_a_player_is_voteable")"),
(else_try),
(str_store_string,s0,":str_store_string("str_banning_a_player_is_not_voteable")"),
(try_end),
(else_try),
(eq,":var001",18),
(try_begin),
(is_between,":var002",0,2),
(assign,"$g_multiplayer_ban_voteable",":var002"),
(try_begin),
(eq,":var002",1),
(str_store_string,s0,":str_store_string("str_banning_a_player_is_voteable")"),
(else_try),
(str_store_string,s0,":str_store_string("str_banning_a_player_is_not_voteable")"),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 91, ":var002"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",19),
(assign,reg0,"$g_multiplayer_valid_vote_ratio"),
(str_store_string,s0,":str_store_string("str_percentage_of_yes_votes_required_for_a_poll_to_get_accepted_is_reg0")"),
(else_try),
(eq,":var001",20),
(try_begin),
(is_between,":var002",50,101),
(assign,"$g_multiplayer_valid_vote_ratio",":var002"),
(assign,reg0,":var002"),
(str_store_string,s0,":str_store_string("str_percentage_of_yes_votes_required_for_a_poll_to_get_accepted_is_reg0")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",21),
(assign,reg0,"$g_multiplayer_auto_team_balance_limit"),
(str_store_string,s0,":str_store_string("str_auto_team_balance_threshold_is_reg0")"),
(else_try),
(eq,":var001",22),
(try_begin),
(is_between,":var002",2,7),
(assign,"$g_multiplayer_auto_team_balance_limit",":var002"),
(assign,reg0,"$g_multiplayer_auto_team_balance_limit"),
(str_store_string,s0,":str_store_string("str_auto_team_balance_threshold_is_reg0")"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 93, ":var002"),
(try_end),
(else_try),
(ge,":var002",7),
(assign,"$g_multiplayer_auto_team_balance_limit",1000),
(assign,reg0,"$g_multiplayer_auto_team_balance_limit"),
(str_store_string,s0,":str_store_string("str_auto_team_balance_threshold_is_reg0")"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 93, ":var002"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",23),
(assign,reg0,"$g_multiplayer_initial_gold_multiplier"),
(str_store_string,s0,":str_store_string("str_starting_gold_ratio_is_reg0")"),
(else_try),
(eq,":var001",24),
(try_begin),
(is_between,":var002",0,1001),
(assign,"$g_multiplayer_initial_gold_multiplier",":var002"),
(assign,reg0,"$g_multiplayer_initial_gold_multiplier"),
(str_store_string,s0,":str_store_string("str_starting_gold_ratio_is_reg0")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",25),
(assign,reg0,"$g_multiplayer_battle_earnings_multiplier"),
(str_store_string,s0,":str_store_string("str_combat_gold_bonus_ratio_is_reg0")"),
(else_try),
(eq,":var001",26),
(try_begin),
(is_between,":var002",0,1001),
(assign,"$g_multiplayer_battle_earnings_multiplier",":var002"),
(assign,reg0,"$g_multiplayer_battle_earnings_multiplier"),
(str_store_string,s0,":str_store_string("str_combat_gold_bonus_ratio_is_reg0")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",27),
(assign,reg0,"$g_multiplayer_round_earnings_multiplier"),
(str_store_string,s0,":str_store_string("str_round_gold_bonus_ratio_is_reg0")"),
(else_try),
(eq,":var001",28),
(try_begin),
(is_between,":var002",0,1001),
(assign,"$g_multiplayer_round_earnings_multiplier",":var002"),
(assign,reg0,"$g_multiplayer_round_earnings_multiplier"),
(str_store_string,s0,":str_store_string("str_round_gold_bonus_ratio_is_reg0")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",29),
(try_begin),
(eq,":::g_multiplayer_allow_player_banners",1),
(str_store_string,s0,":str_store_string("str_player_banners_are_allowed")"),
(else_try),
(str_store_string,s0,":str_store_string("str_player_banners_are_not_allowed")"),
(try_end),
(else_try),
(eq,":var001",30),
(try_begin),
(is_between,":var002",0,2),
(assign,"$g_multiplayer_allow_player_banners",":var002"),
(try_begin),
(eq,":var002",1),
(str_store_string,s0,":str_store_string("str_player_banners_are_allowed")"),
(else_try),
(str_store_string,s0,":str_store_string("str_player_banners_are_not_allowed")"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",31),
(try_begin),
(eq,":::g_multiplayer_force_default_armor",1),
(str_store_string,s0,":str_store_string("str_default_armor_is_forced")"),
(else_try),
(str_store_string,s0,":str_store_string("str_default_armor_is_not_forced")"),
(try_end),
(else_try),
(eq,":var001",32),
(try_begin),
(is_between,":var002",0,2),
(assign,"$g_multiplayer_force_default_armor",":var002"),
(try_begin),
(eq,":var002",1),
(str_store_string,s0,":str_store_string("str_default_armor_is_forced")"),
(else_try),
(str_store_string,s0,":str_store_string("str_default_armor_is_not_forced")"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",33),
(assign,reg0,"$g_multiplayer_point_gained_from_flags"),
(str_store_string,s0,":str_store_string("str_point_gained_from_flags_is_reg0")"),
(else_try),
(eq,":var001",34),
(try_begin),
(is_between,":var002",25,401),
(assign,"$g_multiplayer_point_gained_from_flags",":var002"),
(assign,reg0,"$g_multiplayer_point_gained_from_flags"),
(str_store_string,s0,":str_store_string("str_point_gained_from_flags_is_reg0")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",35),
(assign,reg0,"$g_multiplayer_point_gained_from_capturing_flag"),
(str_store_string,s0,":str_store_string("str_point_gained_from_capturing_flag_is_reg0")"),
(else_try),
(eq,":var001",36),
(try_begin),
(is_between,":var002",0,11),
(assign,"$g_multiplayer_point_gained_from_capturing_flag",":var002"),
(assign,reg0,"$g_multiplayer_point_gained_from_capturing_flag"),
(str_store_string,s0,":str_store_string("str_point_gained_from_capturing_flag_is_reg0")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",37),
(assign,reg0,"$g_multiplayer_game_max_minutes"),
(str_store_string,s0,":str_store_string("str_map_time_limit_is_reg0")"),
(else_try),
(eq,":var001",38),
(try_begin),
(is_between,":var002",5,121),
(assign,"$g_multiplayer_game_max_minutes",":var002"),
(assign,reg0,"$g_multiplayer_game_max_minutes"),
(str_store_string,s0,":str_store_string("str_map_time_limit_is_reg0")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",39),
(assign,reg0,"$g_multiplayer_game_max_points"),
(str_store_string,s0,":str_store_string("str_team_points_limit_is_reg0")"),
(else_try),
(eq,":var001",40),
(try_begin),
(is_between,":var002",3,1001),
(assign,"$g_multiplayer_game_max_points",":var002"),
(assign,reg0,"$g_multiplayer_game_max_points"),
(str_store_string,s0,":str_store_string("str_team_points_limit_is_reg0")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",41),
(assign,reg0,"$g_multiplayer_number_of_respawn_count"),
(try_begin),
(eq,reg0,0),
(str_store_string,s1,":str_store_string("str_unlimited")"),
(else_try),
(str_store_string,s1,":str_store_string("str_reg0")"),
(try_end),
(str_store_string,s0,":str_store_string("str_defender_spawn_count_limit_is_s1")"),
(else_try),
(eq,":var001",42),
(try_begin),
(is_between,":var002",0,6),
(assign,"$g_multiplayer_number_of_respawn_count",":var002"),
(assign,reg0,"$g_multiplayer_number_of_respawn_count"),
(try_begin),
(eq,reg0,0),
(str_store_string,s1,":str_store_string("str_unlimited")"),
(else_try),
(str_store_string,s1,":str_store_string("str_reg0")"),
(try_end),
(str_store_string,s0,":str_store_string("str_defender_spawn_count_limit_is_s1")"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 1, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 88, ":var002"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",43),
(try_begin),
(eq,":::g_multiplayer_disallow_ranged_weapons",1),
(str_store_string,s0,":str_store_string("str_ranged_weapons_are_disallowed")"),
(else_try),
(str_store_string,s0,":str_store_string("str_ranged_weapons_are_allowed")"),
(try_end),
(else_try),
(eq,":var001",44),
(try_begin),
(is_between,":var002",0,2),
(assign,"$g_multiplayer_disallow_ranged_weapons",":var002"),
(try_begin),
(eq,":var002",1),
(str_store_string,s0,":str_store_string("str_ranged_weapons_are_disallowed")"),
(else_try),
(str_store_string,s0,":str_store_string("str_ranged_weapons_are_allowed")"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(eq,":var001",83),
(assign,":var006","$g_multiplayer_ccoop_difficulty"),
(assign,":var006 +","str_ccoop_easy"),
(str_store_string,s0,":str_store_string(var006)"),
(str_store_string,s0,":str_store_string("str_ccoop_difficulty_s0")"),
(else_try),
(eq,":var001",84),
(try_begin),
(is_between,":var002",0,3),
(assign,"$g_multiplayer_ccoop_difficulty",":var002"),
(assign,":var006","str_ccoop_easy"),
(val_add, ":var006", ":::g_multiplayer_ccoop_difficulty"),
(str_store_string,s0,":str_store_string(var006)"),
(str_store_string,s0,":str_store_string("str_ccoop_difficulty_s0")"),
(else_try),
(str_store_string,s0,":str_store_string("str_input_is_not_correct_for_the_command_type_help_for_more_information")"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("@{!}DEBUG : SYSTEM ERROR!")"),
(try_end),
]),

("game_event_party_encounter", [
(store_script_param, "$g_encountered_party", 1),
(store_script_param, "$g_encountered_party_2", 2),
(store_faction_of_party, "$g_encountered_party_faction", "$g_encountered_party"),
(store_relation,"$g_encountered_party_relation","$g_encountered_party_faction","fac_player_faction"),
(party_get_slot,"$g_encountered_party_type","$g_encountered_party",0),
(party_get_template_id,"$g_encountered_party_template","$g_encountered_party"),
(call_script, "script_party_count_fit_regulars", "p_main_party"),
(assign,"$playerparty_prebattle_regulars",reg0),
(assign,"$g_last_rest_center",-1),
(assign,"$talk_context",0),
(assign,"$g_player_surrenders",0),
(assign,"$g_enemy_surrenders",0),
(assign,"$g_leave_encounter",0),
(assign,"$g_engaged_enemy",0),
(try_begin),
(neg|is_between,"$g_encountered_party","p_town_1","p_salt_mine"),
(rest_for_hours,0),
(assign,"$g_infinite_camping",0),
(try_end),
(assign,"$new_encounter",1),
(try_begin),
(lt,":::g_encountered_party_2",0),
(try_begin),
(party_slot_eq,"$g_encountered_party",0,3),
(jump_to_menu,"mnu_castle_outside"),
(else_try),
(party_slot_eq,"$g_encountered_party",0,2),
(jump_to_menu,"mnu_castle_outside"),
(else_try),
(party_slot_eq,"$g_encountered_party",0,16),
(jump_to_menu,"mnu_ship_reembark"),
(else_try),
(party_slot_eq,"$g_encountered_party",0,4),
(jump_to_menu,"mnu_village"),
(else_try),
(party_slot_eq,"$g_encountered_party",0,17),
(jump_to_menu,"mnu_cattle_herd"),
(else_try),
(is_between,"$g_encountered_party","p_training_ground_1","p_bridge_1"),
(jump_to_menu,"mnu_training_ground"),
(else_try),
(party_get_template_id,":party_template_id_001","$g_encountered_party"),
(try_begin),
(ge,":party_template_id_001","pt_steppe_bandit_lair"),
(lt,":party_template_id_001","pt_bandit_lair_templates_end"),
(assign,"$loot_screen_shown",0),
(jump_to_menu,"mnu_bandit_lair"),
(else_try),
(eq,":::g_encountered_party","p_zendar"),
(jump_to_menu,"mnu_zendar"),
(else_try),
(eq,":::g_encountered_party","p_salt_mine"),
(jump_to_menu,"mnu_salt_mine"),
(else_try),
(eq,":::g_encountered_party","p_four_ways_inn"),
(jump_to_menu,"mnu_four_ways_inn"),
(else_try),
(eq,":::g_encountered_party","p_test_scene"),
(jump_to_menu,"mnu_test_scene"),
(else_try),
(eq,":::g_encountered_party","p_battlefields"),
(jump_to_menu,"mnu_battlefields"),
(else_try),
(eq,":::g_encountered_party","p_training_ground"),
(jump_to_menu,"mnu_tutorial"),
(else_try),
(eq,":::g_encountered_party","p_camp_bandits"),
(jump_to_menu,"mnu_camp"),
(else_try),
(jump_to_menu,"mnu_simple_encounter"),
(try_end),
(try_end),
(else_try),
(try_begin),
(this_or_next|party_slot_eq,"$g_encountered_party",0,3),
(party_slot_eq,"$g_encountered_party",0,2),
(try_begin),
(eq,":::auto_enter_town",":::g_encountered_party"),
(jump_to_menu,"mnu_town"),
(else_try),
(eq,":::auto_besiege_town",":::g_encountered_party"),
(jump_to_menu,"mnu_besiegers_camp_with_allies"),
(else_try),
(jump_to_menu,"mnu_join_siege_outside"),
(try_end),
(else_try),
(jump_to_menu,"mnu_pre_join"),
(try_end),
(try_end),
(assign,"$auto_enter_town",0),
(assign,"$auto_besiege_town",0),
]),

("game_event_simulate_battle", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":party_id_002", 2),
(assign,"$marshall_defeated_in_battle",-1),
(store_current_hours,":cur_hours_003"),
(try_for_parties, ":cur_party"),
(party_get_battle_opponent, ":party_battle_opponent_005", ":cur_party"),
(try_begin),
(gt,":party_battle_opponent_005",0),
(party_set_slot,":cur_party",68,":cur_hours_003"),
(try_end),
(try_end),
(assign,":trigger_result_006",1),
(try_begin),
(ge,":party_id_001",0),
(ge,":party_id_002",0),
(party_is_active,":party_id_001"),
(party_is_active,":party_id_002"),
(store_faction_of_party, ":party_faction_007", ":party_id_001"),
(store_faction_of_party, ":party_faction_008", ":party_id_002"),
(store_relation,":faction_relation_009",":party_faction_007",":party_faction_008"),
(try_begin),
(lt,":faction_relation_009",0),
(assign,":trigger_result_006",0),
(try_begin),
(this_or_next|eq,":::g_battle_simulation_cancel_for_party",":party_id_002"),
(eq,":::g_battle_simulation_cancel_for_party",":party_id_001"),
(assign,"$g_battle_simulation_cancel_for_party",-1),
(assign,"$auto_enter_town","$g_battle_simulation_auto_enter_town_after_battle"),
(assign,":trigger_result_006",1),
(else_try),
(try_begin),
    (this_or_next|party_slot_eq,":party_id_001",2,1),
    (party_slot_eq,":party_id_002",2,1),
    (assign,":trigger_result_006",1),
(try_end),
(try_end),
(party_set_slot,":party_id_002",2,0),
(party_collect_attachments_to_party, ":party_id_001", "p_collective_ally"),
(party_collect_attachments_to_party, ":party_id_002", "p_collective_enemy"),
(call_script, "script_party_calculate_strength", "p_collective_ally", 0),
(assign,":var010",reg0),
(call_script, "script_party_calculate_strength", "p_collective_enemy", 0),
(assign,":var011",reg0),
(store_div, ":var___x1", ":var010", 20),
(assign,":var010",":var___x1"),
(val_min,":var010",50),
(val_max,":var010",1),
(store_div, ":var___x1", ":var011", 20),
(assign,":var011",":var___x1"),
(val_min,":var011",50),
(val_add, ":var011", 1),
(try_begin),
(this_or_next|party_slot_eq,":party_id_001",0,2),
(party_slot_eq,":party_id_001",0,3),
(val_mul, ":var010", 123),
(val_div, ":var010", 100),
(val_mul, ":var011", 100),
(val_div, ":var011", 123),
(try_end),
(call_script, "script_party_count_fit_for_battle", "p_collective_ally", 0),
(assign,":var012",reg0),
(try_begin),
(neg|is_currently_night),
(inflict_casualties_to_party, ":party_id_002", ":var010", "p_temp_casualties"),
(party_collect_attachments_to_party, ":party_id_002", "p_collective_enemy"),
(try_end),
(call_script, "script_party_count_fit_for_battle", "p_collective_enemy", 0),
(assign,":var013",reg0),
(try_begin),
(gt,":var013",0),
(neg|is_currently_night),
(inflict_casualties_to_party, ":party_id_001", ":var011", "p_temp_casualties"),
(party_collect_attachments_to_party, ":party_id_001", "p_collective_ally"),
(try_end),
(call_script, "script_party_count_fit_for_battle", "p_collective_ally", 0),
(assign,":var014",reg0),
(try_begin),
(this_or_next|eq,":var013",0),
(eq,":var014",0),
(assign,":var015",0),
(try_begin),
    (neg|troop_is_wounded,"trp_player"),
    (eq,":var014",0),
    (eq,":::auto_enter_town",":::g_encountered_party"),
    (eq,":var012",":var014"),
    (assign,":var015",1),
(try_end),
(try_begin),
    (eq,":var015",0),
    (try_begin),
        (eq,":var013",0),
        (eq,":var014",0),
        (assign,":party_id_016",-1),
        (assign,":party_id_017",-1),
        (assign,":party_id_018",-1),
    (else_try),
        (eq,":var013",0),
        (assign,":party_id_016",":party_id_001"),
        (assign,":party_id_017",":party_id_002"),
        (assign,":party_id_018","p_collective_enemy"),
    (else_try),
        (assign,":party_id_016",":party_id_002"),
        (assign,":party_id_017",":party_id_001"),
        (assign,":party_id_018","p_collective_ally"),
    (try_end),
(try_end),
(try_begin),
    (ge,":party_id_016",0),
    (call_script, "script_get_nonempty_party_in_group", ":party_id_016"),
    (assign,":party_id_019",reg0),
    (store_faction_of_party, ":party_faction_020", ":party_id_019"),
    (store_faction_of_party, ":party_faction_021", ":party_id_017"),
(else_try),
    (assign,":party_id_019",-1),
(try_end),
(try_begin),
    (ge,":party_id_018",0),
    (party_get_num_companion_stacks,":party_num_companions_stacks_022",":party_id_018"),
(else_try),
    (assign,":party_num_companions_stacks_022",0),
(try_end),
(try_for_range, ":stack_no_023", 0, ":party_num_companions_stacks_022"),
    (party_stack_get_troop_id,      ":troop_id_024",":party_id_018",":stack_no_023"),
    (try_begin),
        (troop_is_hero,":troop_id_024"),
        (try_begin),
            (check_quest_active,"qst_lend_surgeon"),
            (quest_slot_eq,"qst_lend_surgeon",6,":troop_id_024"),
            (call_script, "script_abort_quest", "qst_lend_surgeon", 0),
        (try_end),
    (try_end),
    (call_script, "script_remove_troop_from_prison", ":troop_id_024"),
    (troop_set_slot,":troop_id_024",10,-1),
    (store_random_in_range,":random_x_025",0,100),
    (str_store_string,s1,":str_store_troop_name_link(troop_id_024)"),
    (str_store_string,s2,":str_store_faction_name_link(party_faction_020)"),
    (store_troop_faction,":troop_faction_026",":troop_id_024"),
    (str_store_string,s3,":str_store_faction_name_link(troop_faction_026)"),
    (try_begin),
        (ge,":random_x_025",70),
        (party_stack_get_troop_id,      ":troop_id_027",":party_id_019",0),
        (try_begin),
            (is_between,":troop_id_027","trp_npc1","trp_knight_1_1_wife"),
            (party_add_prisoners,":party_id_019",":troop_id_024",1),
            (try_begin),
                (gt,reg0,0),
                (troop_set_slot,":troop_id_024",8,":party_id_019"),
                (display_log_message,"str_hero_taken_prisoner"),
                (try_begin),
                    (call_script, "script_cf_prisoner_offered_parole", ":troop_id_024"),
                    (eq,":::cheat_mode",1),
                    (display_message, "@@{!}DEBUG : Prisoner granted parole"),
                (try_end),
            (try_end),
            (call_script, "script_troop_change_relation_with_troop", ":troop_id_027", ":troop_id_024", 3),
            (val_add, ":::total_battle_enemy_changes", 3),
        (else_try),
            (try_begin),
                (eq,":::cheat_mode",1),
                (display_message, "@@{!}DEBUG : Prisoner not offered parole"),
            (try_end),
            (call_script, "script_troop_change_relation_with_troop", ":troop_id_027", ":troop_id_024", -5),
            (val_add, ":::total_battle_enemy_changes", -5),
        (try_end),
        (store_faction_of_party, ":party_faction_028", ":party_id_019"),
        (call_script, "script_update_troop_location_notes_prisoned", ":troop_id_024", ":party_faction_028"),
    (else_try),
        (assign, reg0, ":"),
        (display_message, "@{reg0}"),
    (try_end),
    (eq,1,1),
    (store_troop_faction,":troop_faction_029",":troop_id_024"),
    (is_between,":troop_faction_029","fac_player_supporters_faction","fac_kingdoms_end"),
    (faction_slot_eq,":troop_faction_029",8,":troop_id_024"),
    (is_between,":troop_faction_029","fac_player_supporters_faction","fac_kingdoms_end"),
    (assign,"$marshall_defeated_in_battle",":troop_id_024"),
    (assign,"$g_recalculate_ais",1),
(try_end),
(try_begin),
    (ge,":party_id_018",0),
    (party_get_num_prisoner_stacks, ":party_num_companions_stacks_022",":party_id_018"),
(else_try),
    (assign,":party_num_companions_stacks_022",0),
(try_end),
(try_for_range, ":stack_no_023", 0, ":party_num_companions_stacks_022"),
    (party_get_prisoner_stack_troop,":troop_id_024",":party_id_018",":stack_no_023"),
    (try_begin),
        (troop_is_hero,":troop_id_024"),
        (call_script, "script_remove_troop_from_prison", ":troop_id_024"),
        (store_troop_faction,":troop_faction_029",":troop_id_024"),
        (str_store_string,s1,":str_store_troop_name_link(troop_id_024)"),
        (str_store_string,s2,":str_store_faction_name_link(party_faction_020)"),
        (str_store_string,s3,":str_store_faction_name_link(troop_faction_029)"),
        (display_log_message,"str_hero_freed"),
    (try_end),
(try_end),
(try_begin),
    (ge,":party_id_018",0),
    (party_clear,"p_temp_party"),
    (assign,"$g_move_heroes",0),
    (call_script, "script_party_add_party_prisoners", "p_temp_party", ":party_id_018"),
    (call_script, "script_party_prisoners_add_party_companions", "p_temp_party", ":party_id_018"),
    (distribute_party_among_party_group, "p_temp_party", ":party_id_016"),
    (call_script, "script_battle_political_consequences", ":party_id_017", ":party_id_016"),
    (call_script, "script_clear_party_group", ":party_id_017"),
(try_end),
(assign,":trigger_result_006",1),
(try_begin),
    (ge,":party_id_018",0),
    (party_get_slot,":party_slot_030",":party_id_017",0),
    (try_begin),
        (this_or_next|eq,":party_slot_030",2),
        (eq,":party_slot_030",3),
        (assign,"$g_recalculate_ais",1),
        (store_faction_of_party, ":party_faction_031", ":party_id_016"),
        (store_faction_of_party, ":party_faction_021", ":party_id_017"),
        (str_store_string,s1,":str_store_party_name(party_id_017)"),
        (str_store_string,s2,":str_store_faction_name(party_faction_031)"),
        (str_store_string,s3,":str_store_faction_name(party_faction_021)"),
        (display_log_message,"str_center_captured"),
        (store_current_hours,":cur_hours_003"),
        (faction_set_slot,":party_faction_031",98,":cur_hours_003"),
        (try_begin),
            (eq,":::g_encountered_party",":party_id_017"),
            (call_script, "script_add_log_entry", 18, "trp_player", "$g_encountered_party", 0, "$g_encountered_party"_faction),
        (try_end),
    (try_end),
    (try_begin),
        (eq,1,1),
        (party_get_num_companion_stacks,":party_num_companions_stacks_022",":party_id_016"),
        (try_begin),
            (gt,":party_num_companions_stacks_022",0),
            (party_stack_get_troop_id,      ":troop_id_032",":party_id_016",0),
            (try_begin),
                (is_between,":troop_id_032","trp_npc1","trp_knight_1_1_wife"),
                (party_set_slot,":party_id_017",28,":troop_id_032"),
            (else_try),
                (party_set_slot,":party_id_017",28,-1),
            (try_end),
        (try_end),
    (try_end),
    (call_script, "script_lift_siege", ":party_id_017", 0),
    (store_faction_of_party, ":party_faction_033", ":party_id_017"),
    (try_begin),
        (is_between,":party_id_017","p_town_1","p_castle_1"),
        (assign,":var034",40),
    (else_try),
        (assign,":var034",20),
    (try_end),
    (call_script, "script_faction_inflict_war_damage_on_faction", ":party_faction_031", ":party_faction_033", ":var034"),
    (call_script, "script_give_center_to_faction", ":party_id_017", ":party_faction_031"),
    (eq,":party_faction_021","fac_player_supporters_faction"),
    (call_script, "script_add_notification_menu", "mnu_notification_center_lost", ":party_id_017", ":party_faction_031"),
(try_end),
(party_get_num_attached_parties, ":party_num_attached_parties_035", ":party_id_002"),
(try_for_range, ":var036", 0, ":party_num_attached_parties_035"),
    (party_get_attached_party_with_rank, ":party_attached_party_with_rank_037", ":party_id_002", ":var036"),
    (party_get_num_companion_stacks,":party_num_companions_stacks_022",":party_attached_party_with_rank_037"),
    (assign,":var038",0),
    (try_for_range, ":var039", 0, ":party_num_companions_stacks_022"),
        (party_stack_get_size,          ":party_stack_size_040",":party_attached_party_with_rank_037",":var039"),
        (val_add, ":var038", ":party_stack_size_040"),
    (try_end),
    (try_begin),
        (ge,":var038",10),
        (assign,":var041",0),
        (assign,":var042",-1),
        (assign,":var043",10),
        (try_for_range, ":var044", 0, ":var043"),
            (store_random_in_range,":random_x_045",1,":party_num_companions_stacks_022"),
            (party_stack_get_troop_id,      ":troop_id_046",":party_attached_party_with_rank_037",":random_x_045"),
            (party_stack_get_size,          ":party_stack_size_040",":party_attached_party_with_rank_037",":random_x_045"),
            (try_begin),
                (ge,":party_stack_size_040",4),
                (neq,":random_x_045",":var042"),
                (store_mul, ":var047", ":var038", 2),
                (assign,":var048",":var047"),
                (val_min,":var048",100),
                (val_mul, ":party_stack_size_040", ":var048"),
                (val_div, ":party_stack_size_040", 100),
                (party_stack_get_troop_id,      ":troop_id_049",":party_attached_party_with_rank_037",0),
                (try_begin),
                    (this_or_next|troop_slot_eq,":troop_id_049",52,6),
                    (this_or_next|troop_slot_eq,":troop_id_049",52,7),
                    (troop_slot_eq,":troop_id_049",52,1),
                    (assign,reg2,0),
                    (store_random_in_range,":random_x_050",40,50),
                (else_try),
                    (this_or_next|troop_slot_eq,":troop_id_049",52,2),
                    (troop_slot_eq,":troop_id_049",52,4),
                    (assign,reg2,1),
                    (store_random_in_range,":random_x_050",30,40),
                (else_try),
                    (this_or_next|troop_slot_eq,":troop_id_049",52,3),
                    (this_or_next|troop_slot_eq,":troop_id_049",52,8),
                    (troop_slot_eq,":troop_id_049",52,5),
                    (assign,reg2,2),
                    (store_random_in_range,":random_x_050",20,30),
                (else_try),
                    (this_or_next|troop_slot_eq,":troop_id_049",52,9),
                    (troop_slot_eq,":troop_id_049",52,10),
                    (assign,reg2,3),
                    (store_random_in_range,":random_x_050",50,60),
                (try_end),
            (try_end),
            (val_min,":random_x_050",100),
            (val_mul, ":party_stack_size_040", ":random_x_050"),
            (val_div, ":party_stack_size_040", 100),
            (party_add_members,":party_id_001",":troop_id_046",":party_stack_size_040"),
            (party_remove_members,":party_attached_party_with_rank_037",":troop_id_046",":party_stack_size_040"),
            (val_add, ":var041", 1),
            (assign,":var042",":random_x_045"),
            (try_begin),
                (eq,":var041",3),
                (assign,":var043",0),
            (try_end),
        (try_end),
    (try_end),
(try_end),
(try_begin),
    (neg|is_between,":party_id_017","p_castle_1","p_village_1"),
    (call_script, "script_change_center_prosperity", ":party_id_017", -5),
    (val_add, ":::newglob_total_prosperity_from_townloot", -5),
(try_end),
(call_script, "script_order_best_besieger_party_to_guard_center", ":party_id_017", ":party_faction_031"),
(try_begin),
    (call_script,"script_cf_reinforce_party"),
    (call_script,"script_cf_reinforce_party"),
(try_end),
(try_end),
(try_begin),
(party_slot_eq,":party_id_002",0,13),
(assign,":var051",200),
(game_get_reduce_campaign_ai, ":campaign_ai"),
(store_faction_of_party, ":party_faction_053", ":party_id_002"),
(try_begin),
    (this_or_next|eq,":party_id_002","p_main_party"),
    (this_or_next|eq,":party_faction_053","fac_player_supporters_faction"),
    (eq,":party_faction_053",":::players_kingdom"),
(else_try),
    (eq,":campaign_ai",0),
    (val_mul, ":var051", 3),
    (val_div, ":var051", 2),
(else_try),
    (eq,":campaign_ai",1),
(else_try),
    (eq,":campaign_ai",2),
    (val_div, ":var051", 2),
(try_end),
(try_begin),
    (gt,":var013",0),
    (call_script, "script_upgrade_hero_party", ":party_id_002", ":var051"),
(try_end),
(try_end),
(try_begin),
(party_slot_eq,":party_id_001",0,13),
(assign,":var054",200),
(store_faction_of_party, ":party_faction_055", ":party_id_001"),
(game_get_reduce_campaign_ai, ":campaign_ai"),
(try_begin),
    (this_or_next|eq,":party_id_001","p_main_party"),
    (this_or_next|eq,":party_faction_055","fac_player_supporters_faction"),
    (eq,":party_faction_055",":::players_kingdom"),
(else_try),
    (eq,":campaign_ai",0),
    (val_mul, ":var054", 3),
    (val_div, ":var054", 2),
(else_try),
    (eq,":campaign_ai",1),
(else_try),
    (eq,":campaign_ai",2),
    (val_div, ":var054", 2),
(try_end),
(try_begin),
    (gt,":var014",0),
    (call_script, "script_upgrade_hero_party", ":party_id_001", ":var054"),
(try_end),
(try_end),
(try_begin),
(neg|party_slot_eq,":party_id_001",0,2),
(neg|party_slot_eq,":party_id_001",0,3),
(party_get_slot,":party_slot_056",":party_id_002",56),
(party_get_slot,":party_slot_057",":party_id_002",57),
(party_get_slot,":party_slot_058",":party_id_002",59),
(store_add, ":var059", ":party_slot_056", ":party_slot_057"),
(val_add, ":var059", ":party_slot_058"),
(party_get_slot,":party_slot_060",":party_id_001",56),
(party_get_slot,":party_slot_061",":party_id_001",57),
(party_get_slot,":party_slot_062",":party_id_001",59),
(store_add, ":var063", ":party_slot_060", ":party_slot_061"),
(val_add, ":var059", ":party_slot_062"),
(store_random_in_range,":random_x_064",0,100),
(try_begin),
    (lt,":random_x_064",10),
    (assign,":trigger_result_006",1),
(try_end),
(else_try),
(party_get_slot,":party_slot_056",":party_id_002",56),
(party_get_slot,":party_slot_057",":party_id_002",57),
(party_get_slot,":party_slot_065",":party_id_002",59),
(store_add, ":var059", ":party_slot_056", ":party_slot_057"),
(val_add, ":var059", ":party_slot_065"),
(party_get_slot,":party_slot_060",":party_id_001",56),
(party_get_slot,":party_slot_061",":party_id_001",57),
(store_add, ":var063", ":party_slot_060", ":party_slot_061"),
(val_mul, ":var063", 13),
(val_div, ":var063", 10),
(try_begin),
    (gt,":var063",":var059"),
    (gt,":var063",3),
    (store_random_in_range,":random_x_064",0,100),
    (try_begin),
        (lt,":random_x_064",15),
        (assign,":trigger_result_006",1),
        (assign,"$g_recalculate_ais",1),
        (try_begin),
            (eq,":::cheat_mode",1),
            (display_message, "@@{!}DEBUG : Siege attackers are running away"),
        (try_end),
    (try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(set_trigger_result, ":trigger_result_006"),
]),

("game_event_battle_end", [
(try_for_range, ":trp_001", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_001",2,2),
(troop_get_slot,":troop_slot_002",":trp_001",10),
(troop_get_slot,":troop_slot_003",":trp_001",8),
(try_begin),
(ge,":troop_slot_002",0),
(assign,":var004",0),
(try_begin),
(neg|party_is_active,":troop_slot_002"),
(assign,":var004",1),
(else_try),
(party_count_companions_of_type,":party_companions_of_type_005",":troop_slot_002",":trp_001"),
(try_begin),
    (le,":party_companions_of_type_005",0),
    (assign,":var004",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var004",1),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s1,":str_store_troop_name(trp_001)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_end),
(troop_set_slot,":trp_001",10,-1),
(try_begin),
(ge,":troop_slot_003",0),
(assign,":var004",0),
(try_begin),
(neg|party_is_active,":troop_slot_003"),
(assign,":var004",1),
(else_try),
(party_count_prisoners_of_type,":party_companions_of_type_005",":troop_slot_003",":trp_001"),
(try_begin),
    (le,":party_companions_of_type_005",0),
    (assign,":var004",1),
(try_end),
(try_end),
(try_begin),
(eq,":var004",1),
(try_begin),
    (eq,":::cheat_mode",1),
    (str_store_string,s1,":str_store_troop_name(trp_001)"),
    (assign, reg0, ":"),
    (display_message, "@{reg0}"),
(try_end),
(try_end),
(call_script, "script_remove_troop_from_prison", ":trp_001"),
(try_begin),
(eq,1,1),
(party_count_prisoners_of_type,":party_companions_of_type_005","p_main_party",":trp_001"),
(gt,":party_companions_of_type_005",0),
(troop_set_slot,":trp_001",8,"p_main_party"),
(assign,":var004",0),
(eq,":::cheat_mode",1),
(str_store_string,s1,":str_store_troop_name(trp_001)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(eq,":var004",1),
(try_for_range, ":trp_006", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_006",2,2),
(eq,":var004",1),
(troop_get_slot,":troop_slot_007",":trp_006",10),
(party_is_active,":troop_slot_007"),
(party_count_prisoners_of_type,":party_companions_of_type_005",":troop_slot_007",":trp_001"),
(gt,":party_companions_of_type_005",0),
(troop_set_slot,":trp_001",8,":troop_slot_007"),
(assign,":var004",0),
(eq,":::cheat_mode",1),
(str_store_string,s1,":str_store_troop_name(trp_001)"),
(str_store_string,s2,":str_store_party_name(troop_slot_007)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_end),
(try_end),
(try_for_range, ":troop_slot_007", ":p.town_1", ":p.village_1"),
(eq,":var004",1),
(party_count_prisoners_of_type,":party_companions_of_type_005",":troop_slot_007",":trp_001"),
(gt,":party_companions_of_type_005",0),
(troop_set_slot,":trp_001",8,":troop_slot_007"),
(assign,":var004",0),
(eq,":::cheat_mode",1),
(str_store_string,s1,":str_store_troop_name(trp_001)"),
(str_store_string,s2,":str_store_party_name(troop_slot_007)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_end),
(try_end),
]),

("order_best_besieger_party_to_guard_center", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":party_id_003",-1),
(assign,":var004",0),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_get_slot,":troop_slot_006",":trp_005",10),
(try_begin),
(gt,":troop_slot_006",0),
(party_is_active,":troop_slot_006"),
(store_faction_of_party, ":party_faction_007", ":troop_slot_006"),
(eq,":var002",":party_faction_007"),
(store_distance_to_party_from_party,":distance_parties_008",":troop_slot_006",":troop_slot_006"),
(lt,":distance_parties_008",5),
(neg|faction_slot_eq,":var002",8,":trp_005"),
(assign,":var009",0),
(try_begin),
(party_slot_eq,":troop_slot_006",4,1),
(party_slot_eq,":troop_slot_006",5,":var001"),
(assign,":var009",1),
(else_try),
(party_slot_eq,":troop_slot_006",4,11),
(party_get_slot,":party_slot_010",":troop_slot_006",5),
(try_begin),
(party_slot_eq,":party_slot_010",4,1),
(party_slot_eq,":party_slot_010",5,":var001"),
(assign,":var009",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var009",1),
(party_get_slot,":party_slot_011",":troop_slot_006",56),
(gt,":party_slot_011",":var004"),
(assign,":var004",":party_slot_011"),
(assign,":party_id_003",":troop_slot_006"),
(try_end),
(try_end),
(try_begin),
(gt,":party_id_003",0),
(call_script, "script_party_set_ai_state", ":party_id_003", 7, ":var001"),
(party_set_flags, ":party_id_003", 65536, 1),
(try_end),
]),

("game_get_item_buy_price_factor", [
(store_script_param, ":var001", 1),
(assign,":party_slot_002",100),
(call_script, "script_get_trade_penalty", ":var001"),
(assign,":var003",reg0),
(try_begin),
(is_between,"$g_encountered_party","p_town_1","p_salt_mine"),
(is_between,":var001","itm_spice","itm_siege_supply"),
(store_sub, ":slot_no_004", ":var001", ":itm.spice"),
(val_add, ":slot_no_004", 250),
(party_get_slot,":party_slot_002","$g_encountered_party",":slot_no_004"),
(val_mul, ":party_slot_002", 100),
(val_div, ":party_slot_002", 1000),
(try_end),
(store_add, ":var005", 100, ":var003"),
(val_mul, ":party_slot_002", ":var005"),
(val_div, ":party_slot_002", 100),
(assign,reg0,":party_slot_002"),
(set_trigger_result, reg0),
]),

("game_get_item_sell_price_factor", [
(store_script_param, ":var001", 1),
(assign,":party_slot_002",100),
(call_script, "script_get_trade_penalty", ":var001"),
(assign,":var003",reg0),
(try_begin),
(is_between,"$g_encountered_party","p_town_1","p_salt_mine"),
(is_between,":var001","itm_spice","itm_siege_supply"),
(store_sub, ":slot_no_004", ":var001", ":itm.spice"),
(val_add, ":slot_no_004", 250),
(party_get_slot,":party_slot_002","$g_encountered_party",":slot_no_004"),
(val_mul, ":party_slot_002", 100),
(val_div, ":party_slot_002", 1000),
(else_try),
(val_mul, ":var003", 4),
(try_end),
(store_add, ":var005", 100, ":var003"),
(val_mul, ":party_slot_002", 100),
(val_div, ":party_slot_002", ":var005"),
(assign,reg0,":party_slot_002"),
(set_trigger_result, reg0),
]),

("get_trade_penalty", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(party_get_skill_level, ":party_skill_lvl_003", "p_main_party", 0),
(try_begin),
(is_between,":var001","itm_spice","itm_siege_supply"),
(assign,":var002",12),
(store_mul, ":var004", ":party_skill_lvl_003", 1),
(val_sub, ":var002", ":var004"),
(val_max,":var002",3),
(else_try),
(assign,":var002",100),
(store_mul, ":var004", ":party_skill_lvl_003", 5),
(val_sub, ":var002", ":var004"),
(try_end),
(assign,":var005",1000),
(try_begin),
(is_between,"$g_encountered_party","p_town_1","p_salt_mine"),
(party_get_slot,":party_slot_006","$g_encountered_party",26),
(store_mul, ":var007", ":party_slot_006", -3),
(val_add, ":var005", ":var007"),
(try_begin),
(lt,":party_slot_006",0),
(store_sub, ":var008", 100, ":party_slot_006"),
(val_mul, ":var005", ":var008"),
(val_div, ":var005", 100),
(try_end),
(try_end),
(call_script, "script_troop_get_player_relation", "$g_talk_troop"),
(assign,":var009",reg0),
(try_begin),
(lt,":var009",0),
(store_sub, ":var010", 0, ":var009"),
(store_mul, ":var011", ":var010", 20),
(val_add, ":var005", ":var011"),
(try_end),
(try_begin),
(is_between,"$g_encountered_party","p_village_1","p_salt_mine"),
(val_mul, ":var002", 5),
(val_div, ":var002", 4),
(try_end),
(val_mul, ":var002", ":var005"),
(val_div, ":var002", 1000),
(val_max,":var002",1),
(assign,reg0,":var002"),
]),

("game_event_buy_item", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(is_between,":var001","itm_spice","itm_siege_supply"),
(store_sub, ":slot_no_003", ":var001", ":itm.spice"),
(val_add, ":slot_no_003", 250),
(party_get_slot,":party_slot_004","$g_encountered_party",":slot_no_003"),
(try_begin),
(eq,":var002",0),
(val_add, ":party_slot_004", 20),
(else_try),
(val_add, ":party_slot_004", 30),
(try_end),
(store_item_value,":item_value_005",":var001"),
(try_begin),
(ge,":item_value_005",100),
(store_sub, ":var006", ":item_value_005", 100),
(store_div, ":var___x1", ":var006", 8),
(assign,":var007",":var___x1"),
(val_add, ":party_slot_004", ":var007"),
(try_end),
(val_min,":party_slot_004",10000),
(party_set_slot,"$g_encountered_party",":slot_no_003",":party_slot_004"),
(try_end),
]),

("game_event_sell_item", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(is_between,":var001","itm_spice","itm_siege_supply"),
(store_sub, ":slot_no_003", ":var001", ":itm.spice"),
(val_add, ":slot_no_003", 250),
(party_get_slot,":party_slot_004","$g_encountered_party",":slot_no_003"),
(try_begin),
(eq,":var002",0),
(val_sub, ":party_slot_004", 30),
(else_try),
(val_sub, ":party_slot_004", 20),
(try_end),
(store_item_value,":item_value_005",":var001"),
(try_begin),
(ge,":item_value_005",100),
(store_sub, ":var006", ":item_value_005", 100),
(store_div, ":var___x1", ":var006", 8),
(assign,":var007",":var___x1"),
(val_sub, ":party_slot_004", ":var007"),
(try_end),
(val_max,":party_slot_004",100),
(party_set_slot,"$g_encountered_party",":slot_no_003",":party_slot_004"),
(try_end),
]),

("start_wedding_cutscene", [
(store_script_param, "$g_wedding_groom_troop", 1),
(store_script_param, "$g_wedding_bride_troop", 2),
(assign,"$g_wedding_bishop_troop","trp_temporary_minister"),
(try_begin),
(is_between,"$players_kingdom","fac_player_supporters_faction","fac_kingdoms_end"),
(neg|faction_slot_eq,"$players_kingdom",11,"$g_wedding_groom_troop"),
(neg|faction_slot_eq,"$players_kingdom",11,"$g_wedding_bride_troop"),
(faction_get_slot,":faction_slot_001","$players_kingdom",11),
(troop_get_type,":troop_type_002",":faction_slot_001"),
(try_begin),
(eq,":troop_type_002",0),
(neq,":faction_slot_001",":::g_wedding_groom_troop"),
(assign,"$g_wedding_bishop_troop",":faction_slot_001"),
(else_try),
(eq,":::players_kingdom","fac_player_supporters_faction"),
(faction_slot_eq,"$players_kingdom",11,"trp_player"),
(gt,":::g_player_minister",0),
(troop_get_type,":troop_type_002","$g_player_minister"),
(try_begin),
(eq,":troop_type_002",0),
(neq,":::g_player_minister",":::g_wedding_groom_troop"),
(assign,"$g_wedding_bishop_troop","$g_player_minister"),
(try_end),
(try_end),
(try_end),
(assign,"$g_wedding_brides_dad_troop","trp_temporary_minister"),
(try_begin),
(neq,":::g_wedding_bride_troop","trp_player"),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_003","$g_wedding_bride_troop",31),
(gt,":troop_slot_003",0),
(troop_get_type,":troop_type_002",":troop_slot_003"),
(try_begin),
(eq,":troop_type_002",0),
(neq,":troop_slot_003",":::g_wedding_groom_troop"),
(neq,":troop_slot_003",":::g_wedding_bishop_troop"),
(assign,"$g_wedding_brides_dad_troop",":troop_slot_003"),
(else_try),
(troop_get_slot,":troop_slot_004","$g_wedding_bride_troop",33),
(try_begin),
(gt,":troop_slot_004",0),
(troop_get_type,":troop_type_002",":troop_slot_004"),
(try_begin),
(eq,":troop_type_002",0),
(neq,":troop_slot_004",":::g_wedding_groom_troop"),
(neq,":troop_slot_004",":::g_wedding_bishop_troop"),
(assign,"$g_wedding_brides_dad_troop",":troop_slot_004"),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.kingdom_1_lord"),
(this_or_next|troop_slot_eq,":trp_005",2,5),
(troop_slot_eq,":trp_005",2,2),
(troop_get_type,":troop_type_002",":trp_005"),
(try_begin),
(eq,":troop_type_002",0),
(neq,":trp_005",":::g_wedding_groom_troop"),
(neq,":trp_005",":::g_wedding_bishop_troop"),
(assign,"$g_wedding_brides_dad_troop",":trp_005"),
(try_end),
(try_end),
(try_end),
(modify_visitors_at_site,"scn_wedding"),
(reset_visitors),
(set_visitor,0,"$g_wedding_groom_troop"),
(set_visitor,1,"$g_wedding_bride_troop"),
(set_visitor,2,"$g_wedding_brides_dad_troop"),
(set_visitor,3,"$g_wedding_bishop_troop"),
(assign,":entry_no_006",4),
(assign,":var007",0),
(try_for_range, ":trp_008", ":trp.npc1", ":trp.heroes_end"),
(lt,":entry_no_006",32),
(neq,":trp_008",":::g_wedding_groom_troop"),
(neq,":trp_008",":::g_wedding_bride_troop"),
(neq,":trp_008",":::g_wedding_brides_dad_troop"),
(neq,":trp_008",":::g_wedding_bishop_troop"),
(store_troop_faction,":troop_faction_009",":trp_008"),
(is_between,":troop_faction_009","fac_player_supporters_faction","fac_kingdoms_end"),
(eq,":troop_faction_009",":::players_kingdom"),
(this_or_next|troop_slot_eq,":trp_008",2,5),
(this_or_next|troop_slot_eq,":trp_008",2,2),
(troop_slot_eq,":trp_008",2,6),
(troop_get_type,":troop_type_002",":trp_008"),
(assign,":var010",1),
(eq,":troop_type_002",0),
(assign,":var010",0),
(lt,":var007",16),
(assign,":var010",1),
(val_add, ":var007", 1),
(try_end),
(eq,":var010",1),
(set_visitor,":entry_no_006",":trp_008"),
(val_add, ":entry_no_006", 1),
(try_end),
(set_jump_mission,"mt_wedding"),
(jump_to_scene,"scn_wedding"),
(change_screen_mission),
]),

("game_get_troop_wage", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(try_begin),
(this_or_next|eq,":var001","trp_kidnapped_girl"),
(eq,":var001","trp_player"),
(else_try),
(is_between,":var001","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(else_try),
(store_character_level,":character_lvl_004",":var001"),
(assign,":var003",":character_lvl_004"),
(val_add, ":var003", 3),
(val_mul, ":var003", ":var003"),
(val_div, ":var003", 25),
(try_end),
(try_begin),
(neg|is_between,":var001","trp_npc1","trp_kingdom_1_lord"),
(troop_is_mounted,":var001"),
(val_mul, ":var003", 5),
(val_div, ":var003", 3),
(try_end),
(try_begin),
(is_between,":var001","trp_watchman","trp_mercenaries_end"),
(val_mul, ":var003", 3),
(val_div, ":var003", 2),
(try_end),
(try_begin),
(is_between,":var001","trp_npc1","trp_kingdom_1_lord"),
(val_mul, ":var003", 2),
(try_end),
(store_skill_level,":skill_lvl_005","skl_leadership","trp_player"),
(store_mul, ":var006", 5, ":skill_lvl_005"),
(store_sub, ":var007", 100, ":var006"),
(val_mul, ":var003", ":var007"),
(val_div, ":var003", 100),
(try_begin),
(neq,":var001","trp_player"),
(neq,":var001","trp_kidnapped_girl"),
(neg|is_between,":var001","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(val_max,":var003",1),
(try_end),
(assign,reg0,":var003"),
(set_trigger_result, reg0),
]),

("game_get_total_wage", [
(assign,":var001",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_002","p_main_party"),
(try_for_range, ":stack_no_003", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004","p_main_party",":stack_no_003"),
(party_stack_get_size,          ":party_stack_size_005","p_main_party",":stack_no_003"),
(call_script, "script_game_get_troop_wage", ":troop_id_004", 0),
(val_mul, reg0, ":party_stack_size_005"),
(val_add, ":var001", reg0),
(try_end),
(assign,reg0,":var001"),
(set_trigger_result, reg0),
]),

("game_get_join_cost", [
(store_script_param, ":troop_id_001", 1),
(assign,":var002",0),
(try_begin),
(troop_is_hero,":troop_id_001"),
(else_try),
(store_character_level,":character_lvl_003",":troop_id_001"),
(assign,":var002",":character_lvl_003"),
(val_add, ":var002", 5),
(val_mul, ":var002", ":var002"),
(val_add, ":var002", 40),
(val_div, ":var002", 5),
(try_begin),
(troop_is_mounted,":troop_id_001"),
(val_mul, ":var002", 2),
(try_end),
(try_end),
(assign,reg0,":var002"),
(set_trigger_result, reg0),
]),

("game_get_upgrade_xp", [
(store_script_param, ":var001", 1),
(assign,":level_no_002",0),
(store_character_level,":character_lvl_003",":var001"),
(store_add, ":level_no_002", ":character_lvl_003", 3),
(get_level_boundary, reg0, ":level_no_002"),
(val_mul, reg0, 6),
(val_div, reg0, 1000),
(val_add, reg0, 30),
(try_begin),
(ge,":var001","trp_bandit"),
(lt,":var001","trp_black_khergit_horseman"),
(val_mul, reg0, 2),
(try_end),
(set_trigger_result, reg0),
]),

("game_get_upgrade_cost", [
(store_script_param, ":var001", 1),
(store_character_level,":character_lvl_002",":var001"),
(try_begin),
(is_between,":character_lvl_002",0,6),
(assign,reg0,10),
(else_try),
(is_between,":character_lvl_002",6,11),
(assign,reg0,20),
(else_try),
(is_between,":character_lvl_002",11,16),
(assign,reg0,40),
(else_try),
(is_between,":character_lvl_002",16,21),
(assign,reg0,80),
(else_try),
(is_between,":character_lvl_002",21,26),
(assign,reg0,120),
(else_try),
(is_between,":character_lvl_002",26,31),
(assign,reg0,160),
(else_try),
(assign,reg0,200),
(try_end),
(set_trigger_result, reg0),
]),

("game_get_prisoner_price", [
(store_script_param, ":var001", 1),
(try_begin),
(is_between,"$g_talk_troop","trp_ransom_broker_1","trp_tavern_traveler_1"),
(store_character_level,":character_lvl_002",":var001"),
(assign,":var003",":character_lvl_002"),
(val_add, ":var003", 10),
(val_mul, ":var003", ":var003"),
(val_div, ":var003", 6),
(else_try),
(assign,":var003",50),
(try_end),
(assign,reg0,":var003"),
(set_trigger_result, reg0),
]),

("game_check_prisoner_can_be_sold", [
(store_script_param, ":var001", 1),
(assign,reg0,0),
(try_begin),
(neg|troop_is_hero,":var001"),
(assign,reg0,1),
(try_end),
(set_trigger_result, reg0),
]),

("game_get_morale_of_troops_from_faction", [
(store_script_param, ":troop_id_001", 1),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(try_begin),
(ge,":troop_faction_002","fac_kingdom_1"),
(lt,":troop_faction_002","fac_kingdoms_end"),
(faction_get_slot,reg0,":troop_faction_002",99),
(else_try),
(assign,reg0,0),
(try_end),
(val_div, reg0, 100),
(party_get_morale, reg1,"p_main_party"),
(val_add, reg0, reg1),
(set_trigger_result, reg0),
]),

("game_event_detect_party", [
(store_script_param, ":party_id_001", 1),
(try_begin),
(party_slot_eq,":party_id_001",0,13),
(party_stack_get_troop_id,      ":troop_id_002",":party_id_001",0),
(try_begin),
(is_between,":troop_id_002","trp_npc1","trp_knight_1_1_wife"),
(call_script, "script_update_troop_location_notes", ":troop_id_002", 0),
(else_try),
(is_between,":party_id_001","p_town_1","p_village_1"),
(party_get_num_attached_parties, ":party_num_attached_parties_003", ":party_id_001"),
(try_for_range, ":var004", 0, ":party_num_attached_parties_003"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_005", ":party_id_001", ":var004"),
(party_stack_get_troop_id,      ":troop_id_002",":party_attached_party_with_rank_005",0),
(try_begin),
(is_between,":troop_id_002","trp_npc1","trp_knight_1_1_wife"),
(call_script, "script_update_troop_location_notes", ":troop_id_002", 0),
(try_end),
(try_end),
(try_end),
(try_end),
]),

("game_event_undetect_party", [
(store_script_param, ":party_id_001", 1),
(try_begin),
(party_slot_eq,":party_id_001",0,13),
(party_stack_get_troop_id,      ":troop_id_002",":party_id_001",0),
(try_begin),
(is_between,":troop_id_002","trp_npc1","trp_knight_1_1_wife"),
(call_script, "script_update_troop_location_notes", ":troop_id_002", 0),
(try_end),
(try_end),
]),

("game_get_statistics_line", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,":var001",0),
(get_player_agent_kill_count,reg1,":"),
(str_store_string,s1,":str_store_string("str_number_of_troops_killed_reg1")"),
sets the result string for game scripts that need one (set_result_string, 1),
(else_try),
(eq,":var001",1),
(get_player_agent_kill_count,reg1,1),
(str_store_string,s1,":str_store_string("str_number_of_troops_wounded_reg1")"),
sets the result string for game scripts that need one (set_result_string, 1),
(else_try),
(eq,":var001",2),
(get_player_agent_own_troop_kill_count,reg1,":"),
(str_store_string,s1,":str_store_string("str_number_of_own_troops_killed_reg1")"),
sets the result string for game scripts that need one (set_result_string, 1),
(else_try),
(eq,":var001",3),
(get_player_agent_own_troop_kill_count,reg1,1),
(str_store_string,s1,":str_store_string("str_number_of_own_troops_wounded_reg1")"),
sets the result string for game scripts that need one (set_result_string, 1),
(try_end),
]),

("game_get_date_text", [
(store_script_param, ":var001", 1),
(store_div, ":var___x1", ":var001", 24),
(assign,":var002",":var___x1"),
(store_add, ":var003", ":var002", 23),
(assign,":var004",3),
(assign,":var005",1257),
(assign,":var006",99999),
(try_for_range, ":var007", 0, ":var006"),
(this_or_next|eq,":var004",12),
(this_or_next|eq,":var004",10),
(this_or_next|eq,":var004",8),
(this_or_next|eq,":var004",7),
(this_or_next|eq,":var004",5),
(this_or_next|eq,":var004",3),
(eq,":var004",1),
(assign,":var008",31),
(else_try),
(this_or_next|eq,":var004",11),
(this_or_next|eq,":var004",9),
(this_or_next|eq,":var004",6),
(eq,":var004",4),
(assign,":var008",30),
(else_try),
(try_begin),
(eq,1,1),
(store_div, ":var___x1", ":var005", 4),
(assign,":var009",":var___x1"),
(val_mul, ":var009", 4),
(try_begin),
(eq,":var009",":var005"),
(assign,":var008",29),
(else_try),
(assign,":var008",28),
(try_end),
(try_end),
(gt,":var003",":var008"),
(val_sub, ":var003", ":var008"),
(val_add, ":var004", 1),
(try_begin),
(gt,":var004",12),
(val_sub, ":var004", 12),
(val_add, ":var005", 1),
(try_end),
(else_try),
(assign,":var006",0),
(try_end),
(assign,reg1,":var003"),
(assign,reg2,":var005"),
(try_begin),
(eq,":var004",1),
(str_store_string,s1,":str_store_string("str_january_reg1_reg2")"),
(else_try),
(eq,":var004",2),
(str_store_string,s1,":str_store_string("str_february_reg1_reg2")"),
(else_try),
(eq,":var004",3),
(str_store_string,s1,":str_store_string("str_march_reg1_reg2")"),
(else_try),
(eq,":var004",4),
(str_store_string,s1,":str_store_string("str_april_reg1_reg2")"),
(else_try),
(eq,":var004",5),
(str_store_string,s1,":str_store_string("str_may_reg1_reg2")"),
(else_try),
(eq,":var004",6),
(str_store_string,s1,":str_store_string("str_june_reg1_reg2")"),
(else_try),
(eq,":var004",7),
(str_store_string,s1,":str_store_string("str_july_reg1_reg2")"),
(else_try),
(eq,":var004",8),
(str_store_string,s1,":str_store_string("str_august_reg1_reg2")"),
(else_try),
(eq,":var004",9),
(str_store_string,s1,":str_store_string("str_september_reg1_reg2")"),
(else_try),
(eq,":var004",10),
(str_store_string,s1,":str_store_string("str_october_reg1_reg2")"),
(else_try),
(eq,":var004",11),
(str_store_string,s1,":str_store_string("str_november_reg1_reg2")"),
(else_try),
(eq,":var004",12),
(str_store_string,s1,":str_store_string("str_december_reg1_reg2")"),
(try_end),
sets the result string for game scripts that need one (set_result_string, 1),
]),

("game_get_money_text", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,":var001",1),
(str_store_string,s1,":str_store_string("str_1_denar")"),
(else_try),
(assign,reg1,":var001"),
(str_store_string,s1,":str_store_string("str_reg1_denars")"),
(try_end),
sets the result string for game scripts that need one (set_result_string, 1),
]),

("game_get_party_companion_limit", [
(assign,":[troop_id_001]","trp_player"),
(assign,":var002",30),
(store_skill_level,":skill_lvl_003","skl_leadership",":[troop_id_001]"),
(store_attribute_level,":attribute_lvl_004",":[troop_id_001]",3),
(val_mul, ":skill_lvl_003", 5),
(val_add, ":var002", ":skill_lvl_003"),
(val_add, ":var002", ":attribute_lvl_004"),
(troop_get_slot,":troop_slot_005",":[troop_id_001]",7),
(store_div, ":var___x1", ":troop_slot_005", 25),
(assign,":var006",":var___x1"),
(val_add, ":var002", ":var006"),
(assign,reg0,":var002"),
(set_trigger_result, reg0),
]),

("game_reset_player_party_name", [
(str_store_string,s5,":str_store_troop_name("trp_player")"),
(party_set_name, "p_main_party", 5),
]),

("game_get_troop_note", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(set_trigger_result, 0),
(str_store_string,s54,":str_store_troop_name(troop_id_001)"),
(try_begin),
(eq,":troop_id_001","trp_player"),
(this_or_next|eq,":::player_has_homage",1),
(eq,":::players_kingdom","fac_player_supporters_faction"),
(assign,":troop_faction_003","$players_kingdom"),
(else_try),
(store_troop_faction,":troop_faction_003",":troop_id_001"),
(try_end),
(str_clear, 49),
(try_begin),
(this_or_next|is_between,":troop_id_001","trp_knight_1_1","trp_heroes_end"),
(eq,":troop_id_001","trp_player"),
(neg|is_between,":troop_id_001","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(assign,":var004",0),
(try_begin),
(eq,1,1),
(call_script, "script_troop_get_family_relation_to_troop", "trp_player", ":troop_id_001"),
(gt,reg0,0),
(val_add, ":var004", 1),
(try_end),
(try_for_range, ":trp_005", ":trp.knight_1_1", ":trp.heroes_end"),
(call_script, "script_troop_get_family_relation_to_troop", ":trp_005", ":troop_id_001"),
(gt,reg0,0),
(val_add, ":var004", 1),
(try_end),
(gt,":var004",0),
(try_begin),
(eq,":troop_id_001","trp_player"),
(str_store_string,s49,":str_store_string("str__family_")"),
(else_try),
(troop_get_slot,reg1,":troop_id_001",18),
(str_store_string,s49,":str_store_string("str__age_reg1_family_")"),
(try_end),
(eq,1,1),
(call_script, "script_troop_get_family_relation_to_troop", "trp_player", ":troop_id_001"),
(gt,reg0,0),
(str_store_string,s12,":str_store_troop_name_link("trp_player")"),
(val_sub, ":var004", 1),
(try_begin),
(eq,":var004",0),
(str_store_string,s49,":str_store_string("str_s49_s12_s11_end")"),
(else_try),
(str_store_string,s49,":str_store_string("str_s49_s12_s11")"),
(try_end),
(try_end),
(try_for_range, ":trp_005", ":trp.knight_1_1", ":trp.heroes_end"),
(call_script, "script_troop_get_family_relation_to_troop", ":trp_005", ":troop_id_001"),
(gt,reg0,0),
(try_begin),
(neg|is_between,":trp_005","trp_knight_1_1_wife","trp_heroes_end"),
(eq,":::cheat_mode",1),
(str_store_string,s12,":str_store_troop_name_link(trp_005)"),
(call_script, "script_troop_get_relation_with_troop", ":trp_005", ":troop_id_001"),
(str_store_string,s49,":str_store_string("str_s49_s12_s11_rel_reg0")"),
(else_try),
(str_store_string,s12,":str_store_troop_name_link(trp_005)"),
(val_sub, ":var004", 1),
(try_begin),
(eq,":var004",0),
(str_store_string,s49,":str_store_string("str_s49_s12_s11_end")"),
(else_try),
(str_store_string,s49,":str_store_string("str_s49_s12_s11")"),
(try_end),
(try_end),
(try_end),
(try_begin),
(neq,":troop_id_001","trp_player"),
(neg|is_between,":troop_faction_003","fac_player_supporters_faction","fac_kingdoms_end"),
(neg|is_between,":troop_id_001","trp_npc1","trp_kingdom_1_lord"),
(neg|is_between,":troop_id_001","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(try_begin),
(eq,":var002",0),
(str_store_string,s0,":str_store_string("str_s54_has_left_the_realm")"),
(set_trigger_result, 1),
(else_try),
(str_clear, 0),
(try_begin),
(this_or_next|eq,":var002",2),
(eq,":var002",1),
(set_trigger_result, 1),
(try_end),
(try_end),
(else_try),
(is_between,":troop_id_001","trp_npc1","trp_kingdom_1_lord"),
(neg|troop_slot_eq,":troop_id_001",2,2),
(eq,":var002",0),
(set_trigger_result, 1),
(str_clear, 0),
(assign,":troop_id_006",":troop_id_001"),
(str_store_string,s4,":str_store_troop_name(troop_id_006)"),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_007",":troop_id_006",150),
(try_begin),
(this_or_next|main_party_has_troop,":troop_id_006"),
(this_or_next|troop_slot_ge,":troop_id_006",151,1),
(eq,":::g_player_minister",":troop_id_006"),
(try_begin),
(troop_slot_eq,":troop_id_006",151,1),
(str_store_string,s8,":str_store_string("str_gathering_support")"),
(try_begin),
(eq,":troop_slot_007",1),
(str_store_string,s5,":str_store_string("str_expected_back_imminently")"),
(else_try),
(assign,reg3,":troop_slot_007"),
(str_store_string,s5,":str_store_string("str_expected_back_in_approximately_reg3_days")"),
(try_end),
(try_end),
(else_try),
(troop_slot_eq,":troop_id_006",151,2),
(troop_get_slot,":troop_slot_008",":troop_id_006",67),
(str_store_string,s11,":str_store_party_name(troop_slot_008)"),
(str_store_string,s8,":str_store_string("str_gathering_intelligence")"),
(try_begin),
(eq,":troop_slot_007",1),
(str_store_string,s5,":str_store_string("str_expected_back_imminently")"),
(else_try),
(assign,reg3,":troop_slot_007"),
(str_store_string,s5,":str_store_string("str_expected_back_in_approximately_reg3_days")"),
(try_end),
(else_try),
(troop_slot_ge,":troop_id_006",151,3),
(neg|troop_slot_ge,":troop_id_006",151,8),
(troop_get_slot,":troop_slot_009",":troop_id_006",152),
(str_store_string,s9,":str_store_faction_name(troop_slot_009)"),
(str_store_string,s8,":str_store_string("str_diplomatic_embassy_to_s9")"),
(try_begin),
(eq,":troop_slot_007",1),
(str_store_string,s5,":str_store_string("str_expected_back_imminently")"),
(else_try),
(assign,reg3,":troop_slot_007"),
(str_store_string,s5,":str_store_string("str_expected_back_in_approximately_reg3_days")"),
(try_end),
(else_try),
(eq,":troop_id_006",":::g_player_minister"),
(str_store_string,s8,":str_store_string("str_serving_as_minister")"),
(str_store_string,s9,":str_store_party_name(_g_player_court)"),
(try_begin),
(is_between,"$g_player_court","p_town_1","p_salt_mine"),
(str_store_string,s5,":str_store_string("str_in_your_court_at_s9")"),
(else_try),
(eq,":troop_id_006",":::g_player_minister"),
(str_store_string,s8,":str_store_string("str_serving_as_minister")"),
(str_store_string,s5,":str_store_string("str_awaiting_the_capture_of_a_fortress_which_can_serve_as_your_court")"),
(else_try),
(main_party_has_troop,":troop_id_006"),
(str_store_string,s8,":str_store_string("str_under_arms")"),
(str_store_string,s5,":str_store_string("str_in_your_party")"),
(try_end),
(try_end),
(str_store_string,s0,":str_store_string("str_s4_s8_s5")"),
(else_try),
(str_store_string,s0,":str_store_string("str_whereabouts_unknown")"),
(try_end),
(else_try),
(is_between,":troop_id_001","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(neg|troop_slot_eq,":troop_id_001",2,2),
(neq,":troop_id_001",":::supported_pretender"),
(troop_get_slot,":troop_slot_010",":troop_id_001",14),
(try_begin),
(faction_slot_eq,":troop_slot_010",21,0),
(faction_slot_eq,":troop_slot_010",60,1),
(try_begin),
(eq,":var002",0),
(str_store_string,s56,":str_store_faction_name_link(troop_slot_010)"),
(str_store_string,s0,":str_store_string(0)"),
(set_trigger_result, 1),
(try_end),
(else_try),
(try_begin),
(eq,1,1),
(str_clear, 0),
(try_begin),
(this_or_next|eq,":var002",2),
(eq,":var002",1),
(set_trigger_result, 1),
(try_end),
(try_end),
(try_end),
(else_try),
(try_begin),
(eq,":var002",0),
(faction_get_slot,":faction_slot_011",":troop_faction_003",11),
(str_store_string,s55,":str_store_troop_name_link(faction_slot_011)"),
(str_store_string,s56,":str_store_faction_name_link(troop_faction_003)"),
(assign,":var012",0),
(assign,":var013",0),
(try_begin),
(eq,":troop_faction_003","fac_player_faction"),
(assign,":var012",1),
(else_try),
(eq,":faction_slot_011",":troop_id_001"),
(assign,":var013",1),
(try_end),
(assign,":var014",0),
(str_store_string,s58,":str_store_string("@nowhere")"),
(try_for_range, ":p_015", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_015",7,":troop_id_001"),
(try_begin),
(eq,":var014",0),
(str_store_string,s58,":str_store_party_name_link(p_015)"),
(else_try),
(eq,":var014",1),
(str_store_string,s57,":str_store_party_name_link(p_015)"),
(str_store_string,s58,":str_store_string("@{s57} and {s58}")"),
(else_try),
(str_store_string,s57,":str_store_party_name_link(p_015)"),
(str_store_string,s58,":str_store_string("@{!}{s57}, {s58}")"),
(try_end),
(val_add, ":var014", 1),
(try_end),
(troop_get_type,reg3,":troop_id_001"),
(troop_get_slot,reg5,":troop_id_001",7),
(troop_get_slot,reg15,":troop_id_001",150),
(str_clear, 59),
(try_begin),
(eq,1,1),
(call_script, "script_troop_get_player_relation", ":troop_id_001"),
(assign,":var016",reg0),
(store_add, ":var017", ":var016", 100),
(val_add, ":var017", 5),
(store_div, ":var___x1", ":var017", 10),
(assign,":var018",":var___x1"),
(val_clamp,":var018",0, 20),
(assign,":var019","str_relation_mnus_100_ns"),
(val_add, ":var019", ":var018"),
(try_begin),
(neq,":var019","str_relation_plus_0_ns"),
(str_store_string,s60,":str_store_string("@{reg3?She:He}")"),
(str_store_string,s59,":str_store_string(var019)"),
(str_store_string,s59,":str_store_string("@{!}^{s59}")"),
(try_end),
(try_end),
(assign,reg9,":var014"),
(troop_get_type,reg3,":troop_id_001"),
(troop_get_slot,reg5,":troop_id_001",7),
(assign,reg4,":var013"),
(assign,reg6,":var012"),
(troop_get_slot,reg17,":troop_id_001",11),
(str_store_string,s0,":str_store_string("str_lord_info_string",0)"),
(add_troop_note_tableau_mesh,":troop_id_001"),
(set_trigger_result, 1),
(try_end),
(try_end),
]),

("game_get_center_note", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(set_trigger_result, 0),
(try_begin),
(eq,":var002",0),
(party_get_slot,":party_slot_003",":party_id_001",7),
(try_begin),
(ge,":party_slot_003",0),
(store_troop_faction,":troop_faction_004",":party_slot_003"),
(str_store_string,s1,":str_store_troop_name_link(party_slot_003)"),
(try_begin),
(eq,":party_slot_003","trp_player"),
(gt,":::players_kingdom",0),
(str_store_string,s2,":str_store_faction_name_link(_players_kingdom)"),
(else_try),
(str_store_string,s2,":str_store_faction_name_link(troop_faction_004)"),
(try_end),
(str_store_string,s50,":str_store_party_name(party_id_001)"),
(try_begin),
(party_slot_eq,":party_id_001",0,3),
(str_store_string,s51,":str_store_string("@The town of {s50}")"),
(else_try),
(party_slot_eq,":party_id_001",0,4),
(party_get_slot,":party_slot_005",":party_id_001",120),
(str_store_string,s52,":str_store_party_name_link(party_slot_005)"),
(str_store_string,s51,":str_store_string("@The village of {s50} near {s52}")"),
(else_try),
(str_store_string,s51,":str_store_string("@{!}{s50}")"),
(try_end),
(str_store_string,s2,":str_store_string()"),
(else_try),
(str_clear, 2),
(try_end),
(try_begin),
(is_between,":party_id_001","p_village_1","p_salt_mine"),
(else_try),
(assign,":var006",0),
(try_for_range, ":p_007", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_007",120,":party_id_001"),
(try_begin),
(eq,":var006",0),
(str_store_string,s8,":str_store_party_name_link(p_007)"),
(else_try),
(eq,":var006",1),
(str_store_string,s7,":str_store_party_name_link(p_007)"),
(str_store_string,s8,":str_store_string("@{s7} and {s8}")"),
(else_try),
(str_store_string,s7,":str_store_party_name_link(p_007)"),
(str_store_string,s8,":str_store_string("@{!}{s7}, {s8}")"),
(try_end),
(val_add, ":var006", 1),
(try_end),
(try_begin),
(eq,":var006",0),
(str_store_string,s2,":str_store_string()"),
(else_try),
(store_sub, reg0, ":var006", 1),
(str_store_string,s2,":str_store_string()"),
(try_end),
(try_end),
(call_script, "script_get_prosperity_text_to_s50", ":party_id_001"),
(str_store_string,s0,":str_store_string("@{s2}Its prosperity is: {s50}",0)"),
(set_trigger_result, 1),
(try_end),
]),

("game_get_faction_note", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":var002", 2),
(set_trigger_result, 0),
(try_begin),
(is_between,":faction_id_001","fac_player_supporters_faction","fac_kingdoms_end"),
(faction_slot_eq,":faction_id_001",21,0),
(try_begin),
(eq,":var002",0),
(faction_get_slot,":faction_slot_003",":faction_id_001",11),
(str_store_string,s5,":str_store_faction_name(faction_id_001)"),
(str_store_string,s6,":str_store_troop_name_link(faction_slot_003)"),
(assign,":var004",0),
(str_store_string,s8,":str_store_string("@nowhere")"),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(try_begin),
(eq,":party_faction_006",":faction_id_001"),
(try_begin),
(eq,":var004",0),
(str_store_string,s8,":str_store_party_name_link(p_005)"),
(else_try),
(eq,":var004",1),
(str_store_string,s7,":str_store_party_name_link(p_005)"),
(str_store_string,s8,":str_store_string("@{s7} and {s8}")"),
(else_try),
(str_store_string,s7,":str_store_party_name_link(p_005)"),
(str_store_string,s8,":str_store_string("@{!}{s7}, {s8}")"),
(try_end),
(try_end),
(val_add, ":var004", 1),
(try_end),
(assign,":var007",0),
(str_store_string,s10,":str_store_string("@noone")"),
(try_for_range, ":trp_008", ":trp.kingdom_heroes_including_player_begin", ":trp.knight_1_1_wife"),
(assign,":troop_id_009",":trp_008"),
(try_begin),
(eq,":trp_008","trp_kingdom_heroes_including_player_begin"),
(assign,":troop_id_009","trp_player"),
(assign,":troop_faction_010","$players_kingdom"),
(else_try),
(store_troop_faction,":troop_faction_010",":troop_id_009"),
(try_end),
(try_begin),
(eq,":troop_faction_010",":faction_id_001"),
(neq,":troop_id_009",":faction_slot_003"),
(troop_slot_eq,":troop_id_009",2,2),
(try_begin),
(eq,":var007",0),
(str_store_string,s10,":str_store_troop_name_link(troop_id_009)"),
(else_try),
(eq,":var007",1),
(str_store_string,s9,":str_store_troop_name_link(troop_id_009)"),
(str_store_string,s10,":str_store_string("@{s9} and {s10}")"),
(else_try),
(str_store_string,s9,":str_store_troop_name_link(troop_id_009)"),
(str_store_string,s10,":str_store_string("@{!}{s9}, {s10}")"),
(try_end),
(try_end),
(val_add, ":var007", 1),
(try_end),
(str_store_string,s12,":str_store_string("@noone")"),
(str_store_string,s21,":str_store_string("str_foreign_relations__")"),
(try_for_range, ":fac_011", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_slot_eq,":fac_011",21,0),
(neq,":faction_id_001",":fac_011"),
(str_store_string,s14,":str_store_faction_name_link(fac_011)"),
(call_script, "script_diplomacy_faction_get_diplomatic_status_with_faction", ":faction_id_001", ":fac_011"),
(assign,":var012",reg0),
(assign,":var013",reg1),
(call_script, "script_diplomacy_faction_get_diplomatic_status_with_faction", ":fac_011", ":faction_id_001"),
(assign,":var014",reg0),
(try_begin),
(eq,":var012",-2),
(str_store_string,s21,":str_store_string("str_s21__the_s5_is_at_war_with_the_s14")"),
(store_add, ":slot_no_015", ":fac_011", 140),
(assign,":slot_no_015 -","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_016",":faction_id_001",":slot_no_015"),
(store_mul, ":var017", ":faction_slot_016", 2),
(store_add, ":slot_no_018", ":faction_id_001", 140),
(assign,":slot_no_018 -","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_019",":fac_011",":slot_no_018"),
(store_mul, ":var020", ":faction_slot_019", 2),
(assign,":var021",0),
(assign,":var022",0),
(try_for_range, ":slot_no_023", 0, ":::num_log_entries"),
(troop_get_slot,":troop_slot_024","trp_log_array_entry_type",":slot_no_023"),
(is_between,":troop_slot_024",91,95),
(troop_get_slot,":troop_slot_025","trp_log_array_actor",":slot_no_023"),
(troop_get_slot,":troop_slot_026","trp_log_array_faction_object",":slot_no_023"),
(try_begin),
(eq,":troop_slot_025",":fac_011"),
(eq,":troop_slot_026",":faction_id_001"),
(assign,":var021",":troop_slot_024"),
(assign,":var022",":troop_slot_025"),
(else_try),
(eq,":troop_slot_025",":faction_id_001"),
(eq,":troop_slot_026",":fac_011"),
(assign,":var021",":troop_slot_024"),
(assign,":var022",":troop_slot_025"),
(try_end),
(try_end),
(str_store_string,s25,":str_store_string(8)"),
(gt,":var021",0),
(str_store_string,s8,":str_store_faction_name(var022)"),
(try_begin),
(eq,":var021",91),
(str_store_string,s21,":str_store_string("str_s21_the_s8_declared_war_out_of_personal_enmity")"),
(else_try),
(eq,":var021",94),
(str_store_string,s21,":str_store_string("str_s21_the_s8_declared_war_in_response_to_border_provocations")"),
(else_try),
(eq,":var021",93),
(str_store_string,s21,":str_store_string("str_s21_the_s8_declared_war_to_curb_the_other_realms_power")"),
(else_try),
(eq,":var021",92),
(str_store_string,s21,":str_store_string("str_s21_the_s8_declared_war_to_regain_lost_territory")"),
(else_try),
(eq,":var021",90),
(neq,":var022","fac_player_supporters_faction"),
(str_store_string,s21,":str_store_string("str_s21_the_s8_declared_war_as_part_of_a_bid_to_conquer_all_calradia")"),
(try_end),
(try_end),
(str_store_string,s8,":str_store_string(25)"),
(try_begin),
(gt,":faction_slot_016",":var020"),
(str_store_string,s21,":str_store_string("str_s21_the_s5_has_had_the_upper_hand_in_the_fighting")"),
(else_try),
(gt,":faction_slot_019",":var017"),
(str_store_string,s21,":str_store_string("str_s21_the_s5_has_gotten_the_worst_of_the_fighting")"),
(else_try),
(gt,":faction_slot_016",100),
(gt,":faction_slot_016",100),
(str_store_string,s21,":str_store_string("str_s21_the_fighting_has_gone_on_for_some_time_and_the_war_may_end_soon_with_a_truce")"),
(else_try),
(str_store_string,s21,":str_store_string("str_s21_the_fighting_has_begun_relatively_recently_and_the_war_may_continue_for_some_time")"),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg4,":faction_slot_016"),
(assign,reg5,":faction_slot_019"),
(str_store_string,s21,":str_store_string("str_s21_reg4reg5")"),
(try_end),
(else_try),
(eq,":var012",1),
(str_clear, 18),
(try_begin),
(neq,":var014",1),
(str_store_string,s18,":str_store_string("str__however_the_truce_is_no_longer_binding_on_the_s14")"),
(try_end),
(assign,reg1,":var013"),
(str_store_string,s21,":str_store_string("str_s21__the_s5_is_bound_by_truce_not_to_attack_the_s14s18_the_truce_will_expire_in_reg1_days")"),
(else_try),
(eq,":var012",-1),
(str_store_string,s21,":str_store_string("str_s21__the_s5_has_recently_suffered_provocation_by_subjects_of_the_s14_and_there_is_a_risk_of_war")"),
(else_try),
(eq,":var012",0),
(str_store_string,s21,":str_store_string("str_s21__the_s5_has_no_outstanding_issues_with_the_s14")"),
(try_begin),
(eq,":var014",-1),
(str_store_string,s21,":str_store_string("str_s21_the_s14_was_recently_provoked_by_subjects_of_the_s5_and_there_is_a_risk_of_war_")"),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(call_script, "script_npc_decision_checklist_peace_or_war", ":faction_id_001", ":fac_011", -1),
(str_store_string,s21,":str_store_string()"),
(try_end),
(try_end),
(str_store_string,s0,":str_store_string("str_the_s5_is_ruled_by_s6_it_occupies_s8_its_vassals_are_s10__s21",0)"),
(set_trigger_result, 1),
(try_end),
(else_try),
(is_between,":faction_id_001","fac_player_supporters_faction","fac_kingdoms_end"),
(faction_slot_eq,":faction_id_001",21,1),
(try_begin),
(eq,":var002",0),
(str_store_string,s5,":str_store_faction_name(faction_id_001)"),
(str_store_string,s0,":str_store_string("@{s5} has been defeated!",0)"),
(set_trigger_result, 1),
(else_try),
(eq,":var002",1),
(str_clear, 0),
(set_trigger_result, 1),
(try_end),
(else_try),
(try_begin),
(this_or_next|eq,":var002",1),
(eq,":var002",0),
(str_clear, 0),
(set_trigger_result, 1),
(try_end),
(try_end),
]),

("game_get_quest_note", [
(set_trigger_result, 0),
]),

("game_get_info_page_note", [
(set_trigger_result, 0),
]),

("game_get_scene_name", [
(store_script_param, ":var001", 1),
(try_begin),
(is_between,":var001","scn_multi_scene_1","scn_multiplayer_maps_end"),
(store_sub, ":var002", ":var001", ":scn.multi_scene_1"),
(assign,":var002 +","str_multi_scene_1"),
(str_store_string,s0,":str_store_string(var002)"),
(try_end),
]),

("game_get_mission_template_name", [
(store_script_param, ":var001", 1),
(call_script, "script_multiplayer_get_mission_template_game_type", ":var001"),
(assign,":var002",reg0),
(try_begin),
(is_between,":var002",0,9),
(store_add, ":var003", ":var002", ":gstr.multi_game_type_1"),
(str_store_string,s0,":str_store_string(var003)"),
(try_end),
]),

("add_kill_death_counts", [
(store_script_param, ":agent_id_001", 1),
(store_script_param, ":agent_id_002", 2),
(try_begin),
(eq,":::g_multiplayer_is_game_type_captain",1),
(try_begin),
(ge,":agent_id_001",0),
(agent_is_human,":agent_id_001"),
(agent_get_group, ":agent_group_003", ":agent_id_001"),
(player_is_active, ":agent_group_003"),
(player_get_agent_id, ":agent_id_001", ":agent_group_003"),
(try_end),
(ge,":agent_id_002",0),
(agent_is_human,":agent_id_002"),
(agent_get_group, ":agent_group_003", ":agent_id_002"),
(player_is_active, ":agent_group_003"),
(player_get_agent_id, ":agent_id_002", ":agent_group_003"),
(try_end),
(try_begin),
(ge,":agent_id_001",0),
(agent_get_team, ":agent_team_no_004", ":agent_id_001"),
(else_try),
(assign,":agent_team_no_004",-1),
(try_end),
(try_begin),
(ge,":agent_id_002",0),
(agent_get_team, ":agent_team_no_005", ":agent_id_002"),
(else_try),
(assign,":agent_team_no_005",-1),
(try_end),
(try_begin),
(eq,1,1),
(try_begin),
(ge,":agent_id_001",0),
(ge,":agent_id_002",0),
(agent_is_human,":agent_id_001"),
(agent_is_human,":agent_id_002"),
(neq,":agent_id_001",":agent_id_002"),
(this_or_next|eq,":agent_team_no_004",":agent_team_no_005"),
(this_or_next|eq,":::g_multiplayer_game_type",0),
(eq,":::g_multiplayer_game_type",7),
(agent_get_player_id,":agent_player_id_006",":agent_id_001"),
(try_begin),
(agent_is_non_player, ":agent_id_001"),
(agent_get_team, ":agent_team_no_004", ":agent_id_001"),
(team_get_bot_kill_count, ":team_bot_kill_count_007", ":agent_team_no_004"),
(val_add, ":team_bot_kill_count_007", 1),
(team_get_bot_kill_count, ":agent_team_no_004", ":team_bot_kill_count_007"),
(else_try),
(player_is_active, ":agent_player_id_006"),
(player_get_kill_count, ":kill_count_008", ":agent_player_id_006"),
(val_add, ":kill_count_008", 1),
(call_script, "script_player_set_kill_count", ":agent_player_id_006", ":kill_count_008"),
(try_end),
(try_end),
(ge,":agent_id_002",0),
(agent_is_human,":agent_id_002"),
(try_begin),
(agent_is_non_player, ":agent_id_002"),
(agent_get_team, ":agent_team_no_005", ":agent_id_002"),
(team_get_bot_death_count, ":team_bot_death_count_009", ":agent_team_no_005"),
(val_add, ":team_bot_death_count_009", 1),
(team_get_bot_death_count, ":agent_team_no_005", ":team_bot_death_count_009"),
(else_try),
(agent_get_player_id,":agent_player_id_010",":agent_id_002"),
(try_begin),
(player_is_active, ":agent_player_id_010"),
(player_get_death_count, ":death_count_011", ":agent_player_id_010"),
(val_add, ":death_count_011", 1),
(call_script, "script_player_set_death_count", ":agent_player_id_010", ":death_count_011"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(assign,":var012",0),
(this_or_next|ge,":agent_id_001",0),
(eq,":agent_id_001",":agent_id_002"),
(assign,":var012",1),
(try_end),
(eq,":agent_team_no_004",":agent_team_no_005"),
(neq,":::g_multiplayer_game_type",0),
(neq,":::g_multiplayer_game_type",7),
(assign,":var012",1),
(try_end),
(eq,":var012",1),
(try_begin),
(ge,":agent_id_001",0),
(assign,":var013",":agent_id_001"),
(else_try),
(assign,":var013",":agent_id_002"),
(try_end),
(try_end),
(ge,":var013",0),
(neg|agent_is_non_player, ":var013"),
(agent_get_player_id,":agent_player_id_014",":var013"),
(ge,":agent_player_id_014",0),
(player_get_kill_count, ":kill_count_015", ":agent_player_id_014"),
(val_add, ":kill_count_015", -1),
(call_script, "script_player_set_kill_count", ":agent_player_id_014", ":kill_count_015"),
(try_end),
(try_end),
]),

("warn_player_about_auto_team_balance", [
(assign,"$g_multiplayer_message_type",3),
(start_presentation, ":"),
]),

("check_team_balance", [
(try_begin),
(multiplayer_is_server),
(assign,":var001",0),
(assign,":var002",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_004", 0, ":max_players"),
(player_is_active, ":player_id_004"),
(player_get_team_no,  ":team_no_005", ":player_id_004"),
(try_begin),
(eq,":team_no_005",0),
(val_add, ":var001", 1),
(else_try),
(eq,":team_no_005",1),
(val_add, ":var002", 1),
(try_end),
(try_end),
(store_sub, ":var006", ":var001", ":var002"),
(assign,":var007",0),
(eq,1,1),
(try_begin),
(eq,1,1),
(store_mul, ":var008", "$g_multiplayer_auto_team_balance_limit", -1),
(try_begin),
(le,":var006",":var008"),
(store_div, ":var___x1", ":var006", -2),
(assign,":var007",":var___x1"),
(assign,":var009",1),
(assign,":team_no_010",0),
(else_try),
(ge,":var006",":::g_multiplayer_auto_team_balance_limit"),
(store_div, ":var___x1", ":var006", 2),
(assign,":var007",":var___x1"),
(assign,":var009",0),
(assign,":team_no_010",1),
(try_end),
(try_end),
(try_end),
(gt,":var007",0),
(try_begin),
(eq,":::g_team_balance_next_round",1),
(try_for_range, ":var011", 0, ":var007"),
(assign,":var012",0),
(assign,":player_id_013",-1),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_014", 0, ":max_players"),
(player_is_active, ":player_id_014"),
(player_get_team_no,  ":team_no_005", ":player_id_014"),
(eq,":team_no_005",":var009"),
(player_get_slot,":player_slot_015",":player_id_014",21),
(gt,":player_slot_015",":var012"),
(assign,":var012",":player_slot_015"),
(assign,":player_id_013",":player_id_014"),
(try_end),
(try_end),
(ge,":player_id_013",0),
(try_begin),
(eq,1,1),
(player_get_agent_id, ":agent_id_016", ":player_id_013"),
(try_begin),
(ge,":agent_id_016",0),
(agent_is_alive,":agent_id_016"),
(player_get_kill_count, ":kill_count_017", ":player_id_013"),
(val_add, ":kill_count_017", 1),
(call_script, "script_player_set_kill_count", ":player_id_013", ":kill_count_017"),
(player_get_death_count, ":death_count_018", ":player_id_013"),
(val_sub, ":death_count_018", 1),
(call_script, "script_player_set_death_count", ":player_id_013", ":death_count_018"),
(player_get_score, ":score_019", ":player_id_013"),
(val_add, ":score_019", 1),
(call_script, "script_player_set_score", ":player_id_013", ":score_019"),
(try_for_range, ":player_id_014", 1, ":max_players"),
(player_is_active, ":player_id_014"),
(multiplayer_send_4_int_to_player, ":player_id_014", 86, ":player_id_013", ":score_019", ":kill_count_017", ":death_count_018"),
(try_end),
(try_end),
(player_get_value_of_original_items, ":player_id_013"),
(player_get_gold, ":gold_021", ":player_id_013"),
(val_add, ":gold_021", ":var020"),
(player_set_gold, ":player_id_013", ":gold_021", 15000),
(try_end),
(player_set_troop_id, ":player_id_013", -1),
(player_get_team_no,  ":player_id_013", ":team_no_010"),
(multiplayer_send_message_to_player, ":player_id_013", 79),
(try_end),
(call_script, "script_show_multiplayer_message", 2, 0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_014", 1, ":max_players"),
(player_is_active, ":player_id_014"),
(multiplayer_send_int_to_player, ":player_id_014", 68, 2),
(try_end),
(assign,"$g_team_balance_next_round",0),
(else_try),
(assign,"$g_team_balance_next_round",1),
(call_script, "script_show_multiplayer_message", 3, 0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_014", 1, ":max_players"),
(player_is_active, ":player_id_014"),
(multiplayer_send_int_to_player, ":player_id_014", 68, 3),
(try_end),
(try_end),
(else_try),
(assign,"$g_team_balance_next_round",0),
(try_end),
]),

("check_creating_ladder_dust_effect", [
(store_script_param, ":scene_prop_instance_id_001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(lt,":var002",15),
(gt,":var002",3),
(scene_prop_get_slot,":scene_prop_slot_003",":scene_prop_instance_id_001",2),
(scene_prop_get_slot,":scene_prop_slot_004",":scene_prop_instance_id_001",1),
(try_begin),
(eq,":scene_prop_slot_003",0),
(eq,":scene_prop_slot_004",0),
(prop_instance_get_position, pos0, ":scene_prop_instance_id_001"),
(assign,":var005",-1),
(try_for_range, ":var006", 100, 110),
(entry_point_get_position, pos1, ":var006"),
(get_sq_distance_between_positions,":sq_distance_007",0,1),
(this_or_next|eq,":var005",-1),
(lt,":sq_distance_007",":var005"),
(assign,":var005",":sq_distance_007"),
(assign,":var008",":var006"),
(try_end),
(eq,1,1),
(set_fixed_point_multiplier, 100),
(try_begin),
(ge,":var005",0),
(lt,":var005",22500),
(entry_point_get_position, pos1, ":var008"),
(position_rotate_x,1,-90),
(prop_instance_get_scene_prop_kind, ":scene_prop_kind_009", ":scene_prop_instance_id_001"),
(try_begin),
(eq,":scene_prop_kind_009","spr_siege_ladder_move_6m"),
(init_position,2),
(position_set_z,2,300),
(position_transform_position_to_parent,3,1,2),
(particle_system_burst,"psys_ladder_dust_6m",3,100),
(particle_system_burst,"psys_ladder_straw_6m",3,100),
(else_try),
(eq,":scene_prop_kind_009","spr_siege_ladder_move_8m"),
(init_position,2),
(position_set_z,2,400),
(position_transform_position_to_parent,3,1,2),
(particle_system_burst,"psys_ladder_dust_8m",3,100),
(particle_system_burst,"psys_ladder_straw_8m",3,100),
(else_try),
(eq,":scene_prop_kind_009","spr_siege_ladder_move_10m"),
(init_position,2),
(position_set_z,2,500),
(position_transform_position_to_parent,3,1,2),
(particle_system_burst,"psys_ladder_dust_10m",3,100),
(particle_system_burst,"psys_ladder_straw_10m",3,100),
(else_try),
(eq,":scene_prop_kind_009","spr_siege_ladder_move_12m"),
(init_position,2),
(position_set_z,2,600),
(position_transform_position_to_parent,3,1,2),
(particle_system_burst,"psys_ladder_dust_12m",3,100),
(particle_system_burst,"psys_ladder_straw_12m",3,100),
(else_try),
(eq,":scene_prop_kind_009","spr_siege_ladder_move_14m"),
(init_position,2),
(position_set_z,2,700),
(position_transform_position_to_parent,3,1,2),
(particle_system_burst,"psys_ladder_dust_14m",3,100),
(particle_system_burst,"psys_ladder_straw_14m",3,100),
(try_end),
(try_end),
(scene_prop_set_slot,":scene_prop_instance_id_001",2,1),
(try_end),
(try_end),
]),

("money_management_after_agent_death", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":agent_player_id_003",-1),
(try_begin),
(multiplayer_is_server),
(ge,":var001",0),
(ge,":var002",0),
(agent_is_human,":var002"),
(agent_is_human,":var001"),
(agent_get_team, ":agent_team_no_004", ":var001"),
(agent_get_team, ":agent_team_no_005", ":var002"),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",0),
(this_or_next|eq,":::g_multiplayer_game_type",7),
(neq,":agent_team_no_004",":agent_team_no_005"),
(neq,":var002",":var001"),
(try_begin),
(neg|agent_is_non_player, ":var002"),
(agent_get_player_id,":agent_player_id_006",":var002"),
(player_get_slot,":player_slot_007",":agent_player_id_006",27),
(else_try),
(assign,":player_slot_007",0),
(try_end),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_010", 0, ":max_players"),
(player_is_active, ":player_id_010"),
(player_get_team_no,  ":team_no_011", ":player_id_010"),
(eq,":team_no_011",":agent_team_no_005"),
(val_add, 0, 1), # var008
(try_end),
(try_end),
(try_for_range, ":player_id_010", 0, ":max_players"),
(player_is_active, ":player_id_010"),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",3),
(eq,":::g_multiplayer_game_type",2),
(assign,":var012",1),
(else_try),
(assign,":var012",0),
(try_end),
(try_begin),
(this_or_next|eq,":var012",0),
(this_or_next|player_slot_eq,":player_id_010",0,0),
(player_slot_eq,":player_id_010",0,1),
(player_get_agent_id, ":agent_id_013", ":player_id_010"),
(try_begin),
(eq,":agent_id_013",":var002"),
(player_get_gold, ":gold_014", ":player_id_010"),
(assign,":agent_player_id_003",":player_id_010"),
(store_mul, ":var015", ":player_slot_007", 48),
(val_div, ":var015", 100),
(val_mul, ":var015", ":::g_multiplayer_battle_earnings_multiplier"),
(val_div, ":var015", 100),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",3),
(eq,":::g_multiplayer_game_type",2),
(val_mul, ":var015", 4),
(val_div, ":var015", 3),
(val_add, ":gold_014", ":var015"),
(else_try),
(this_or_next|eq,":::g_multiplayer_game_type",3),
(eq,":::g_multiplayer_game_type",2),
(val_mul, ":var015", 2),
(val_div, ":var015", 3),
(val_add, ":gold_014", ":var015"),
(else_try),
(val_add, ":gold_014", ":var015"),
(try_end),
(try_end),
(player_set_gold, ":player_id_010", ":gold_014", 15000),
(else_try),
(eq,":agent_id_013",":var001"),
(player_get_gold, ":gold_014", ":player_id_010"),
(assign,":var016",150),
(val_mul, ":var016", ":::g_multiplayer_battle_earnings_multiplier"),
(val_div, ":var016", 100),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",3),
(eq,":::g_multiplayer_game_type",2),
(val_mul, ":var016", 4),
(val_div, ":var016", 3),
(val_add, ":gold_014", ":var016"),
(else_try),
(this_or_next|eq,":::g_multiplayer_game_type",3),
(eq,":::g_multiplayer_game_type",2),
(val_mul, ":var016", 2),
(val_div, ":var016", 3),
(val_add, ":gold_014", ":var016"),
(else_try),
(val_add, ":gold_014", ":var016"),
(try_end),
(store_mul, ":var017", ":player_slot_007", 12),
(val_div, ":var017", 100),
(val_mul, ":var017", ":::g_multiplayer_battle_earnings_multiplier"),
(val_div, ":var017", 100),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",3),
(eq,":::g_multiplayer_game_type",2),
(val_mul, ":var017", 4),
(val_div, ":var017", 3),
(val_add, ":gold_014", ":var017"),
(else_try),
(this_or_next|eq,":::g_multiplayer_game_type",3),
(eq,":::g_multiplayer_game_type",2),
(val_mul, ":var017", 2),
(val_div, ":var017", 3),
(val_add, ":gold_014", ":var017"),
(else_try),
(val_add, ":gold_014", ":var017"),
(try_end),
(try_begin),
(eq,":::g_multiplayer_game_type",8),
(player_get_gold, ":gold_014", ":player_id_010"),
(store_mul, ":var017", "$g_multiplayer_ccoop_wave_no", 20),
(val_sub, ":var017", 20),
(val_add, ":var017", 200),
(val_mul, ":var017", ":::g_multiplayer_battle_earnings_multiplier"),
(val_div, ":var017", 100),
(val_add, ":gold_014", ":var017"),
(try_end),
(player_set_gold, ":player_id_010", ":gold_014", 15000),
(else_try),
(agent_get_player_id,":player_id_010",":var001"),
(try_begin),
(eq,":player_id_010",-1),
(eq,":::g_multiplayer_is_game_type_captain",1),
(agent_get_group, ":agent_group_018", ":var001"),
(try_begin),
(player_is_active, ":agent_group_018"),
(player_get_gold, ":gold_014", ":agent_group_018"),
(try_begin),
(eq,":::g_multiplayer_game_type",8),
(store_mul, ":var017", "$g_multiplayer_ccoop_wave_no", 20),
(val_sub, ":var017", 20),
(val_add, ":var017", 200),
(val_mul, ":var017", ":::g_multiplayer_battle_earnings_multiplier"),
(val_div, ":var017", 100),
(val_add, ":gold_014", ":var017"),
(else_try),
(val_add, ":gold_014", 60),
(try_end),
(try_end),
(try_end),
(player_set_gold, ":agent_group_018", ":gold_014", 15000),
(try_end),
(try_end),
(try_end),
(try_begin),
(multiplayer_is_server),
(neq,":::g_multiplayer_game_type",2),
(neq,":::g_multiplayer_game_type",3),
(ge,":var002",0),
(agent_is_human,":var002"),
(agent_get_player_id,":agent_player_id_003",":var002"),
(try_begin),
(ge,":agent_player_id_003",0),
(player_get_gold, ":gold_014", ":agent_player_id_003"),
(try_begin),
(eq,1,1),
(store_mul, ":var019", "$g_multiplayer_initial_gold_multiplier", 10),
(lt,":gold_014",":var019"),
(assign,":gold_014",":var019"),
(try_end),
(try_end),
(player_set_gold, ":agent_player_id_003", ":gold_014"),
(try_end),
(try_begin),
(multiplayer_is_server),
(eq,":::g_multiplayer_is_game_type_captain",1),
(ge,":var001",0),
(ge,":var002",0),
(agent_is_human,":var001"),
(agent_is_non_player, ":var001"),
(agent_get_group, ":agent_group_018", ":var001"),
(agent_get_team, ":agent_team_no_020", ":var001"),
(agent_get_team, ":agent_team_no_021", ":var002"),
(try_begin),
(neq,":agent_team_no_020",":agent_team_no_021"),
(player_is_active, ":agent_group_018"),
(player_get_gold, ":gold_014", ":agent_group_018"),
(try_begin),
(neq,":::g_multiplayer_game_type",8),
(val_add, ":gold_014", 60),
(try_end),
(try_end),
(player_set_gold, ":agent_group_018", ":gold_014", 15000),
(try_end),
]),

("initialize_aristocracy", [
(try_for_range, ":trp_001", ":trp.kingdom_1_lord", ":trp.knight_1_1"),
(troop_set_slot,":trp_001",2,2),
(store_random_in_range,":random_x_002",50,60),
(troop_set_slot,":trp_001",18,":random_x_002"),
(try_begin),
(eq,":trp_001","trp_kingdom_5_lord"),
(troop_set_slot,":trp_001",18,47),
(try_end),
(try_end),
(try_for_range, ":trp_001", ":trp.knight_1_1_wife", ":trp.heroes_end"),
(troop_set_slot,":trp_001",2,6),
(try_end),
(assign,":troop_id_003","trp_kingdom_1_lady_1"),
(try_for_range, ":trp_001", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(troop_set_slot,":trp_001",2,2),
(store_random_in_range,":random_x_004",23,26),
(try_begin),
(is_between,":trp_001","trp_knight_1_1","trp_knight_2_1"),
(store_sub, ":var005", ":trp_001", ":trp.knight_1_1"),
(assign,":var006",1),
(else_try),
(is_between,":trp_001","trp_knight_2_1","trp_knight_3_1"),
(store_sub, ":var005", ":trp_001", ":trp.knight_2_1"),
(assign,":var006",7),
(else_try),
(is_between,":trp_001","trp_knight_3_1","trp_knight_4_1"),
(store_sub, ":var005", ":trp_001", ":trp.knight_3_1"),
(assign,":var006",13),
(else_try),
(is_between,":trp_001","trp_knight_4_1","trp_knight_5_1"),
(store_sub, ":var005", ":trp_001", ":trp.knight_4_1"),
(assign,":var006",19),
(else_try),
(is_between,":trp_001","trp_knight_5_1","trp_knight_6_1"),
(store_sub, ":var005", ":trp_001", ":trp.knight_5_1"),
(assign,":var006",25),
(else_try),
(is_between,":trp_001","trp_knight_6_1","trp_kingdom_1_pretender"),
(store_sub, ":var005", ":trp_001", ":trp.knight_6_1"),
(assign,":var006",31),
(try_end),
(try_begin),
(lt,":var005",8),
(assign,":random_x_007",":var005"),
(store_random_in_range,":random_x_002",45,64),
(store_random_in_range,":random_x_008",0,6),
(val_add, ":random_x_008", ":var006"),
(troop_set_slot,":trp_001",31,":random_x_008"),
(troop_set_slot,":trp_001",30,":troop_id_003"),
(troop_set_slot,":troop_id_003",30,":trp_001"),
(store_random_in_range,":random_x_009",20,26),
(try_begin),
(eq,":random_x_009",20),
(assign,":random_x_009",21),
(try_end),
(troop_set_slot,":troop_id_003",52,":random_x_009"),
(call_script, "script_init_troop_age", ":troop_id_003", 49),
(call_script, "script_add_lady_items", ":troop_id_003"),
(val_add, ":troop_id_003", 1),
(troop_set_slot,":troop_id_003",31,":trp_001"),
(store_sub, ":troop_slot_010", ":troop_id_003", 1),
(call_script, "script_init_troop_age", ":troop_id_003", 19),
(troop_set_slot,":troop_id_003",32,":troop_slot_010"),
(store_random_in_range,":random_x_011",21,34),
(try_begin),
(le,":random_x_011",25),
(troop_set_slot,":troop_id_003",52,":random_x_011"),
(else_try),
(eq,":random_x_011",26),
(troop_set_slot,":troop_id_003",52,21),
(else_try),
(eq,":random_x_011",27),
(troop_set_slot,":troop_id_003",52,25),
(else_try),
(assign,":var012",":random_x_007"),
(try_begin),
(this_or_next|eq,":var012",0),
(eq,":var012",1),
(troop_set_slot,":troop_id_003",52,21),
(else_try),
(eq,":var012",2),
(troop_set_slot,":troop_id_003",52,23),
(else_try),
(eq,":var012",3),
(troop_set_slot,":troop_id_003",52,24),
(else_try),
(eq,":var012",4),
(troop_set_slot,":troop_id_003",52,22),
(else_try),
(eq,":var012",6),
(troop_set_slot,":troop_id_003",52,22),
(else_try),
(eq,":var012",5),
(troop_set_slot,":troop_id_003",52,24),
(else_try),
(eq,":var012",7),
(troop_set_slot,":troop_id_003",52,25),
(try_end),
(try_end),
(call_script, "script_add_lady_items", ":troop_id_003"),
(val_add, ":troop_id_003", 1),
(else_try),
(is_between,":var005",8,12),
(store_random_in_range,":random_x_002",25,36),
(store_random_in_range,":random_x_007",0,8),
(store_random_in_range,":random_x_013",20,26),
(try_begin),
(eq,":random_x_013",20),
(assign,":random_x_013",21),
(try_end),
(troop_set_slot,":troop_id_003",52,":random_x_013"),
(troop_set_slot,":troop_id_003",33,":trp_001"),
(call_script, "script_init_troop_age", ":troop_id_003", 21),
(call_script, "script_add_lady_items", ":troop_id_003"),
(val_add, ":troop_id_003", 1),
(else_try),
(store_sub, ":random_x_008", ":trp_001", 12),
(troop_set_slot,":trp_001",31,":random_x_008"),
(troop_get_slot,":troop_slot_010",":random_x_008",30),
(troop_set_slot,":trp_001",32,":troop_slot_010"),
(troop_get_slot,":troop_slot_014",":random_x_008",18),
(store_sub, ":random_x_002", ":troop_slot_014", ":random_x_004"),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_007",0,16),
(try_begin),
(gt,":random_x_007",7),
(troop_get_slot,":random_x_007",":random_x_008",52),
(try_end),
(try_end),
(try_end),
(eq,":random_x_007",0),
(assign,":random_x_007",1),
(try_end),
(troop_set_slot,":trp_001",52,":random_x_007"),
(call_script, "script_init_troop_age", ":trp_001", ":random_x_002"),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg3,"$cheat_mode"),
(display_message, "@@{!}DEBUG -- Assigned lord reputation and relations"),
(try_end),
(try_for_range, ":trp_001", ":trp.kingdom_1_pretender", ":trp.knight_1_1_wife"),
(troop_set_slot,":trp_001",2,9),
(store_random_in_range,":random_x_002",25,30),
(troop_set_slot,":trp_001",18,":random_x_002"),
(try_begin),
(eq,":trp_001","trp_kingdom_5_pretender"),
(troop_set_slot,":trp_001",18,45),
(try_end),
(try_end),
]),

("initialize_trade_routes", [
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_2"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_4"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_12"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_11"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_8"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_13"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_7"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_9"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_6"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_15"),
(call_script, "script_set_trade_route_between_centers", "p_town_1", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_2", "p_town_4"),
(call_script, "script_set_trade_route_between_centers", "p_town_2", "p_town_6"),
(call_script, "script_set_trade_route_between_centers", "p_town_2", "p_town_7"),
(call_script, "script_set_trade_route_between_centers", "p_town_2", "p_town_15"),
(call_script, "script_set_trade_route_between_centers", "p_town_2", "p_town_12"),
(call_script, "script_set_trade_route_between_centers", "p_town_2", "p_town_8"),
(call_script, "script_set_trade_route_between_centers", "p_town_2", "p_town_11"),
(call_script, "script_set_trade_route_between_centers", "p_town_2", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_3", "p_town_7"),
(call_script, "script_set_trade_route_between_centers", "p_town_3", "p_town_5"),
(call_script, "script_set_trade_route_between_centers", "p_town_3", "p_town_15"),
(call_script, "script_set_trade_route_between_centers", "p_town_3", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_3", "p_town_14"),
(call_script, "script_set_trade_route_between_centers", "p_town_3", "p_town_4"),
(call_script, "script_set_trade_route_between_centers", "p_town_3", "p_town_19"),
(call_script, "script_set_trade_route_between_centers", "p_town_3", "p_town_6"),
(call_script, "script_set_trade_route_between_centers", "p_town_4", "p_town_12"),
(call_script, "script_set_trade_route_between_centers", "p_town_4", "p_town_8"),
(call_script, "script_set_trade_route_between_centers", "p_town_4", "p_town_11"),
(call_script, "script_set_trade_route_between_centers", "p_town_4", "p_town_6"),
(call_script, "script_set_trade_route_between_centers", "p_town_4", "p_town_7"),
(call_script, "script_set_trade_route_between_centers", "p_town_4", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_4", "p_town_5"),
(call_script, "script_set_trade_route_between_centers", "p_town_4", "p_town_15"),
(call_script, "script_set_trade_route_between_centers", "p_town_5", "p_town_15"),
(call_script, "script_set_trade_route_between_centers", "p_town_5", "p_town_6"),
(call_script, "script_set_trade_route_between_centers", "p_town_5", "p_town_7"),
(call_script, "script_set_trade_route_between_centers", "p_town_5", "p_town_19"),
(call_script, "script_set_trade_route_between_centers", "p_town_6", "p_town_7"),
(call_script, "script_set_trade_route_between_centers", "p_town_6", "p_town_15"),
(call_script, "script_set_trade_route_between_centers", "p_town_6", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_7", "p_town_15"),
(call_script, "script_set_trade_route_between_centers", "p_town_7", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_7", "p_town_19"),
(call_script, "script_set_trade_route_between_centers", "p_town_7", "p_town_14"),
(call_script, "script_set_trade_route_between_centers", "p_town_8", "p_town_9"),
(call_script, "script_set_trade_route_between_centers", "p_town_8", "p_town_11"),
(call_script, "script_set_trade_route_between_centers", "p_town_8", "p_town_12"),
(call_script, "script_set_trade_route_between_centers", "p_town_8", "p_town_13"),
(call_script, "script_set_trade_route_between_centers", "p_town_8", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_8", "p_town_18"),
(call_script, "script_set_trade_route_between_centers", "p_town_8", "p_town_17"),
(call_script, "script_set_trade_route_between_centers", "p_town_9", "p_town_11"),
(call_script, "script_set_trade_route_between_centers", "p_town_9", "p_town_13"),
(call_script, "script_set_trade_route_between_centers", "p_town_9", "p_town_12"),
(call_script, "script_set_trade_route_between_centers", "p_town_9", "p_town_17"),
(call_script, "script_set_trade_route_between_centers", "p_town_9", "p_town_10"),
(call_script, "script_set_trade_route_between_centers", "p_town_9", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_9", "p_town_18"),
(call_script, "script_set_trade_route_between_centers", "p_town_10", "p_town_17"),
(call_script, "script_set_trade_route_between_centers", "p_town_10", "p_town_18"),
(call_script, "script_set_trade_route_between_centers", "p_town_10", "p_town_22"),
(call_script, "script_set_trade_route_between_centers", "p_town_10", "p_town_21"),
(call_script, "script_set_trade_route_between_centers", "p_town_10", "p_town_14"),
(call_script, "script_set_trade_route_between_centers", "p_town_10", "p_town_20"),
(call_script, "script_set_trade_route_between_centers", "p_town_11", "p_town_12"),
(call_script, "script_set_trade_route_between_centers", "p_town_11", "p_town_13"),
(call_script, "script_set_trade_route_between_centers", "p_town_11", "p_town_14"),
(call_script, "script_set_trade_route_between_centers", "p_town_11", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_11", "p_town_17"),
(call_script, "script_set_trade_route_between_centers", "p_town_12", "p_town_13"),
(call_script, "script_set_trade_route_between_centers", "p_town_13", "p_town_17"),
(call_script, "script_set_trade_route_between_centers", "p_town_14", "p_town_17"),
(call_script, "script_set_trade_route_between_centers", "p_town_14", "p_town_18"),
(call_script, "script_set_trade_route_between_centers", "p_town_14", "p_town_21"),
(call_script, "script_set_trade_route_between_centers", "p_town_14", "p_town_22"),
(call_script, "script_set_trade_route_between_centers", "p_town_14", "p_town_20"),
(call_script, "script_set_trade_route_between_centers", "p_town_14", "p_town_19"),
(call_script, "script_set_trade_route_between_centers", "p_town_14", "p_town_16"),
(call_script, "script_set_trade_route_between_centers", "p_town_16", "p_town_18"),
(call_script, "script_set_trade_route_between_centers", "p_town_16", "p_town_20"),
(call_script, "script_set_trade_route_between_centers", "p_town_16", "p_town_19"),
(call_script, "script_set_trade_route_between_centers", "p_town_17", "p_town_18"),
(call_script, "script_set_trade_route_between_centers", "p_town_18", "p_town_20"),
(call_script, "script_set_trade_route_between_centers", "p_town_18", "p_town_21"),
(call_script, "script_set_trade_route_between_centers", "p_town_18", "p_town_22"),
(call_script, "script_set_trade_route_between_centers", "p_town_19", "p_town_20"),
(call_script, "script_set_trade_route_between_centers", "p_town_19", "p_town_21"),
(call_script, "script_set_trade_route_between_centers", "p_town_19", "p_town_22"),
(call_script, "script_set_trade_route_between_centers", "p_town_20", "p_town_21"),
(call_script, "script_set_trade_route_between_centers", "p_town_20", "p_town_22"),
(call_script, "script_set_trade_route_between_centers", "p_town_21", "p_town_22"),
]),

("initialize_faction_troop_types", [
(try_for_range, ":fac_001", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_get_slot,":faction_slot_002",":fac_001",10),
(faction_get_slot,":faction_slot_003",":faction_slot_002",41),
(faction_set_slot,":fac_001",41,":faction_slot_003"),
(faction_get_slot,":faction_slot_003",":faction_slot_002",42),
(faction_set_slot,":fac_001",42,":faction_slot_003"),
(faction_get_slot,":faction_slot_003",":faction_slot_002",43),
(faction_set_slot,":fac_001",43,":faction_slot_003"),
(faction_get_slot,":faction_slot_003",":faction_slot_002",44),
(faction_set_slot,":fac_001",44,":faction_slot_003"),
(faction_get_slot,":faction_slot_003",":faction_slot_002",45),
(faction_set_slot,":fac_001",45,":faction_slot_003"),
(try_begin),
(faction_slot_eq,":fac_001",10,"fac_culture_1"),
(faction_set_slot,":fac_001",48,"trp_swadian_deserter"),
(faction_set_slot,":fac_001",49,"trp_swadian_sergeant"),
(faction_set_slot,":fac_001",50,"trp_swadian_messenger"),
(faction_set_slot,":fac_001",51,"trp_swadian_prison_guard"),
(faction_set_slot,":fac_001",52,"trp_swadian_castle_guard"),
(faction_set_slot,":fac_001",77,"pt_kingdom_1_reinforcements_a"),
(faction_set_slot,":fac_001",78,"pt_kingdom_1_reinforcements_b"),
(faction_set_slot,":fac_001",79,"pt_kingdom_1_reinforcements_c"),
(else_try),
(faction_slot_eq,":fac_001",10,"fac_culture_2"),
(faction_set_slot,":fac_001",48,"trp_vaegir_deserter"),
(faction_set_slot,":fac_001",49,"trp_vaegir_guard"),
(faction_set_slot,":fac_001",50,"trp_vaegir_messenger"),
(faction_set_slot,":fac_001",51,"trp_vaegir_prison_guard"),
(faction_set_slot,":fac_001",52,"trp_vaegir_castle_guard"),
(faction_set_slot,":fac_001",77,"pt_kingdom_2_reinforcements_a"),
(faction_set_slot,":fac_001",78,"pt_kingdom_2_reinforcements_b"),
(faction_set_slot,":fac_001",79,"pt_kingdom_2_reinforcements_c"),
(else_try),
(faction_slot_eq,":fac_001",10,"fac_culture_3"),
(faction_set_slot,":fac_001",48,"trp_khergit_deserter"),
(faction_set_slot,":fac_001",49,"trp_khergit_horseman"),
(faction_set_slot,":fac_001",50,"trp_khergit_messenger"),
(faction_set_slot,":fac_001",51,"trp_khergit_prison_guard"),
(faction_set_slot,":fac_001",52,"trp_khergit_castle_guard"),
(faction_set_slot,":fac_001",77,"pt_kingdom_3_reinforcements_a"),
(faction_set_slot,":fac_001",78,"pt_kingdom_3_reinforcements_b"),
(faction_set_slot,":fac_001",79,"pt_kingdom_3_reinforcements_c"),
(else_try),
(faction_slot_eq,":fac_001",10,"fac_culture_4"),
(faction_set_slot,":fac_001",48,"trp_nord_deserter"),
(faction_set_slot,":fac_001",49,"trp_nord_warrior"),
(faction_set_slot,":fac_001",50,"trp_nord_messenger"),
(faction_set_slot,":fac_001",51,"trp_nord_prison_guard"),
(faction_set_slot,":fac_001",52,"trp_nord_castle_guard"),
(faction_set_slot,":fac_001",77,"pt_kingdom_4_reinforcements_a"),
(faction_set_slot,":fac_001",78,"pt_kingdom_4_reinforcements_b"),
(faction_set_slot,":fac_001",79,"pt_kingdom_4_reinforcements_c"),
(else_try),
(faction_slot_eq,":fac_001",10,"fac_culture_5"),
(faction_set_slot,":fac_001",48,"trp_rhodok_deserter"),
(faction_set_slot,":fac_001",49,"trp_rhodok_veteran_spearman"),
(faction_set_slot,":fac_001",50,"trp_rhodok_messenger"),
(faction_set_slot,":fac_001",51,"trp_rhodok_prison_guard"),
(faction_set_slot,":fac_001",52,"trp_rhodok_castle_guard"),
(faction_set_slot,":fac_001",77,"pt_kingdom_5_reinforcements_a"),
(faction_set_slot,":fac_001",78,"pt_kingdom_5_reinforcements_b"),
(faction_set_slot,":fac_001",79,"pt_kingdom_5_reinforcements_c"),
(else_try),
(faction_slot_eq,":fac_001",10,"fac_culture_6"),
(faction_set_slot,":fac_001",48,"trp_sarranid_deserter"),
(faction_set_slot,":fac_001",49,"trp_sarranid_castle_guard"),
(faction_set_slot,":fac_001",50,"trp_sarranid_messenger"),
(faction_set_slot,":fac_001",51,"trp_sarranid_prison_guard"),
(faction_set_slot,":fac_001",52,"trp_sarranid_castle_guard"),
(faction_set_slot,":fac_001",77,"pt_kingdom_6_reinforcements_a"),
(faction_set_slot,":fac_001",78,"pt_kingdom_6_reinforcements_b"),
(faction_set_slot,":fac_001",79,"pt_kingdom_6_reinforcements_c"),
(try_end),
(try_end),
]),

("initialize_item_info", [
(item_set_slot,"itm_bread",1,8),
(item_set_slot,"itm_grain",1,2),
(item_set_slot,"itm_smoked_fish",1,4),
(item_set_slot,"itm_dried_meat",1,5),
(item_set_slot,"itm_cheese",1,5),
(item_set_slot,"itm_sausages",1,5),
(item_set_slot,"itm_butter",1,4),
(item_set_slot,"itm_chicken",1,8),
(item_set_slot,"itm_cattle_meat",1,7),
(item_set_slot,"itm_pork",1,6),
(item_set_slot,"itm_raw_olives",1,1),
(item_set_slot,"itm_cabbages",1,2),
(item_set_slot,"itm_raw_grapes",1,3),
(item_set_slot,"itm_apples",1,4),
(item_set_slot,"itm_raw_date_fruit",1,4),
(item_set_slot,"itm_honey",1,6),
(item_set_slot,"itm_wine",1,5),
(item_set_slot,"itm_ale",1,4),
(item_set_slot,"itm_grain",11,20),
(item_set_slot,"itm_grain",12,20),
(item_set_slot,"itm_grain",13,20),
(item_set_slot,"itm_grain",14,209),
(item_set_slot,"itm_grain",15,"str_acres_grain"),
(item_set_slot,"itm_grain",53,30),
(item_set_slot,"itm_bread",11,30),
(item_set_slot,"itm_bread",12,30),
(item_set_slot,"itm_bread",13,30),
(item_set_slot,"itm_bread",14,221),
(item_set_slot,"itm_bread",15,"str_mills"),
(item_set_slot,"itm_bread",50,"itm_grain"),
(item_set_slot,"itm_bread",52,6),
(item_set_slot,"itm_bread",55,6),
(item_set_slot,"itm_bread",56,30),
(item_set_slot,"itm_bread",53,50),
(item_set_slot,"itm_bread",58,1500),
(item_set_slot,"itm_ale",11,10),
(item_set_slot,"itm_ale",12,15),
(item_set_slot,"itm_ale",13,0),
(item_set_slot,"itm_ale",14,222),
(item_set_slot,"itm_ale",15,"str_breweries"),
(item_set_slot,"itm_ale",53,120),
(item_set_slot,"itm_ale",50,"itm_grain"),
(item_set_slot,"itm_ale",52,1),
(item_set_slot,"itm_ale",55,2),
(item_set_slot,"itm_ale",56,50),
(item_set_slot,"itm_ale",53,120),
(item_set_slot,"itm_ale",58,2500),
(item_set_slot,"itm_wine",11,15),
(item_set_slot,"itm_wine",12,10),
(item_set_slot,"itm_wine",13,25),
(item_set_slot,"itm_wine",14,223),
(item_set_slot,"itm_wine",15,"str_presses"),
(item_set_slot,"itm_wine",50,"itm_raw_grapes"),
(item_set_slot,"itm_wine",52,4),
(item_set_slot,"itm_wine",55,2),
(item_set_slot,"itm_wine",56,60),
(item_set_slot,"itm_wine",53,220),
(item_set_slot,"itm_wine",58,5000),
(item_set_slot,"itm_raw_grapes",11,0),
(item_set_slot,"itm_raw_grapes",12,0),
(item_set_slot,"itm_raw_grapes",13,0),
(item_set_slot,"itm_raw_grapes",14,211),
(item_set_slot,"itm_raw_grapes",15,"str_acres_orchard"),
(item_set_slot,"itm_raw_grapes",51,"itm_wine"),
(item_set_slot,"itm_raw_grapes",53,75),
(item_set_slot,"itm_apples",11,4),
(item_set_slot,"itm_apples",12,4),
(item_set_slot,"itm_apples",13,0),
(item_set_slot,"itm_apples",14,211),
(item_set_slot,"itm_apples",15,"str_acres_orchard"),
(item_set_slot,"itm_apples",53,44),
(item_set_slot,"itm_smoked_fish",11,16),
(item_set_slot,"itm_smoked_fish",12,16),
(item_set_slot,"itm_smoked_fish",13,16),
(item_set_slot,"itm_smoked_fish",14,214),
(item_set_slot,"itm_smoked_fish",15,"str_boats"),
(item_set_slot,"itm_salt",11,5),
(item_set_slot,"itm_salt",12,3),
(item_set_slot,"itm_salt",13,-1),
(item_set_slot,"itm_salt",14,215),
(item_set_slot,"itm_salt",15,"str_pans"),
(item_set_slot,"itm_dried_meat",11,20),
(item_set_slot,"itm_dried_meat",12,5),
(item_set_slot,"itm_dried_meat",13,-1),
(item_set_slot,"itm_dried_meat",14,205),
(item_set_slot,"itm_dried_meat",15,"str_head_cattle"),
(item_set_slot,"itm_cattle_meat",11,12),
(item_set_slot,"itm_cattle_meat",12,3),
(item_set_slot,"itm_cattle_meat",13,-1),
(item_set_slot,"itm_cattle_meat",14,205),
(item_set_slot,"itm_cattle_meat",15,"str_head_cattle"),
(item_set_slot,"itm_cheese",11,10),
(item_set_slot,"itm_cheese",12,10),
(item_set_slot,"itm_cheese",13,10),
(item_set_slot,"itm_cheese",14,205),
(item_set_slot,"itm_cheese",15,"str_head_cattle"),
(item_set_slot,"itm_butter",11,2),
(item_set_slot,"itm_butter",12,2),
(item_set_slot,"itm_butter",13,2),
(item_set_slot,"itm_butter",14,205),
(item_set_slot,"itm_butter",15,"str_head_cattle"),
(item_set_slot,"itm_leatherwork",11,10),
(item_set_slot,"itm_leatherwork",12,10),
(item_set_slot,"itm_leatherwork",13,10),
(item_set_slot,"itm_leatherwork",14,230),
(item_set_slot,"itm_leatherwork",15,"str_tanneries"),
(item_set_slot,"itm_leatherwork",50,"itm_raw_leather"),
(item_set_slot,"itm_leatherwork",52,3),
(item_set_slot,"itm_leatherwork",55,3),
(item_set_slot,"itm_leatherwork",56,50),
(item_set_slot,"itm_leatherwork",53,220),
(item_set_slot,"itm_leatherwork",58,8000),
(item_set_slot,"itm_raw_leather",11,0),
(item_set_slot,"itm_raw_leather",12,0),
(item_set_slot,"itm_raw_leather",13,0),
(item_set_slot,"itm_raw_leather",14,205),
(item_set_slot,"itm_raw_leather",15,"str_head_cattle"),
(item_set_slot,"itm_raw_leather",51,"itm_leatherwork"),
(item_set_slot,"itm_raw_leather",53,120),
(item_set_slot,"itm_sausages",11,12),
(item_set_slot,"itm_sausages",12,3),
(item_set_slot,"itm_sausages",13,-1),
(item_set_slot,"itm_sausages",14,206),
(item_set_slot,"itm_sausages",15,"str_head_sheep"),
(item_set_slot,"itm_wool",11,0),
(item_set_slot,"itm_wool",12,0),
(item_set_slot,"itm_wool",13,0),
(item_set_slot,"itm_wool",14,206),
(item_set_slot,"itm_wool",15,"str_head_sheep"),
(item_set_slot,"itm_wool",51,"itm_wool_cloth"),
(item_set_slot,"itm_wool",53,130),
(item_set_slot,"itm_wool_cloth",11,15),
(item_set_slot,"itm_wool_cloth",12,20),
(item_set_slot,"itm_wool_cloth",13,5),
(item_set_slot,"itm_wool_cloth",14,227),
(item_set_slot,"itm_wool_cloth",15,"str_looms"),
(item_set_slot,"itm_wool_cloth",50,"itm_wool"),
(item_set_slot,"itm_wool_cloth",52,2),
(item_set_slot,"itm_wool_cloth",55,2),
(item_set_slot,"itm_wool_cloth",56,120),
(item_set_slot,"itm_wool_cloth",53,250),
(item_set_slot,"itm_wool_cloth",58,6000),
(item_set_slot,"itm_raw_flax",11,0),
(item_set_slot,"itm_raw_flax",12,0),
(item_set_slot,"itm_raw_flax",13,0),
(item_set_slot,"itm_raw_flax",14,212),
(item_set_slot,"itm_raw_flax",15,"str_acres_flax"),
(item_set_slot,"itm_raw_flax",51,"itm_linen"),
(item_set_slot,"itm_raw_flax",53,150),
(item_set_slot,"itm_linen",11,7),
(item_set_slot,"itm_linen",12,3),
(item_set_slot,"itm_linen",13,15),
(item_set_slot,"itm_linen",14,225),
(item_set_slot,"itm_linen",15,"str_looms"),
(item_set_slot,"itm_linen",50,"itm_raw_flax"),
(item_set_slot,"itm_linen",52,2),
(item_set_slot,"itm_linen",55,2),
(item_set_slot,"itm_linen",56,120),
(item_set_slot,"itm_linen",53,250),
(item_set_slot,"itm_linen",58,6000),
(item_set_slot,"itm_iron",11,0),
(item_set_slot,"itm_iron",12,0),
(item_set_slot,"itm_iron",13,0),
(item_set_slot,"itm_iron",14,219),
(item_set_slot,"itm_iron",15,"str_deposits"),
(item_set_slot,"itm_iron",51,"itm_tools"),
(item_set_slot,"itm_iron",53,264),
(item_set_slot,"itm_tools",11,7),
(item_set_slot,"itm_tools",12,7),
(item_set_slot,"itm_tools",13,7),
(item_set_slot,"itm_tools",14,229),
(item_set_slot,"itm_tools",15,"str_smithies"),
(item_set_slot,"itm_tools",50,"itm_iron"),
(item_set_slot,"itm_tools",52,2),
(item_set_slot,"itm_tools",55,2),
(item_set_slot,"itm_tools",56,60),
(item_set_slot,"itm_tools",53,410),
(item_set_slot,"itm_tools",58,3500),
(item_set_slot,"itm_pottery",11,15),
(item_set_slot,"itm_pottery",12,5),
(item_set_slot,"itm_pottery",13,-1),
(item_set_slot,"itm_pottery",14,228),
(item_set_slot,"itm_pottery",15,"str_kilns"),
(item_set_slot,"itm_oil",11,10),
(item_set_slot,"itm_oil",12,5),
(item_set_slot,"itm_oil",13,-1),
(item_set_slot,"itm_oil",14,224),
(item_set_slot,"itm_oil",15,"str_presses"),
(item_set_slot,"itm_oil",50,"itm_raw_olives"),
(item_set_slot,"itm_oil",52,6),
(item_set_slot,"itm_oil",55,2),
(item_set_slot,"itm_oil",56,80),
(item_set_slot,"itm_oil",53,450),
(item_set_slot,"itm_oil",58,4500),
(item_set_slot,"itm_raw_olives",11,0),
(item_set_slot,"itm_raw_olives",12,0),
(item_set_slot,"itm_raw_olives",13,0),
(item_set_slot,"itm_raw_olives",14,210),
(item_set_slot,"itm_raw_olives",15,"str_olive_groves"),
(item_set_slot,"itm_raw_olives",51,"itm_oil"),
(item_set_slot,"itm_raw_olives",53,100),
(item_set_slot,"itm_velvet",11,5),
(item_set_slot,"itm_velvet",12,0),
(item_set_slot,"itm_velvet",13,-1),
(item_set_slot,"itm_velvet",14,226),
(item_set_slot,"itm_velvet",15,"str_looms"),
(item_set_slot,"itm_velvet",50,"itm_raw_silk"),
(item_set_slot,"itm_velvet",52,2),
(item_set_slot,"itm_velvet",55,2),
(item_set_slot,"itm_velvet",56,160),
(item_set_slot,"itm_velvet",53,1025),
(item_set_slot,"itm_velvet",57,"itm_raw_dyes"),
(item_set_slot,"itm_velvet",58,10000),
(item_set_slot,"itm_raw_silk",11,0),
(item_set_slot,"itm_raw_silk",12,0),
(item_set_slot,"itm_raw_silk",14,217),
(item_set_slot,"itm_raw_silk",15,"str_mulberry_groves"),
(item_set_slot,"itm_raw_silk",51,"itm_velvet"),
(item_set_slot,"itm_raw_silk",53,600),
(item_set_slot,"itm_raw_dyes",11,3),
(item_set_slot,"itm_raw_dyes",12,0),
(item_set_slot,"itm_raw_dyes",13,-1),
(item_set_slot,"itm_raw_dyes",15,"str_caravans"),
(item_set_slot,"itm_raw_dyes",53,200),
(item_set_slot,"itm_spice",11,5),
(item_set_slot,"itm_spice",12,0),
(item_set_slot,"itm_spice",13,5),
(item_set_slot,"itm_spice",15,"str_caravans"),
(item_set_slot,"itm_furs",11,5),
(item_set_slot,"itm_furs",12,0),
(item_set_slot,"itm_furs",13,-1),
(item_set_slot,"itm_furs",14,220),
(item_set_slot,"itm_furs",15,"str_traps"),
(item_set_slot,"itm_honey",11,12),
(item_set_slot,"itm_honey",12,3),
(item_set_slot,"itm_honey",13,-1),
(item_set_slot,"itm_honey",14,216),
(item_set_slot,"itm_honey",15,"str_hives"),
(item_set_slot,"itm_cabbages",11,7),
(item_set_slot,"itm_cabbages",12,7),
(item_set_slot,"itm_cabbages",13,7),
(item_set_slot,"itm_cabbages",14,232),
(item_set_slot,"itm_cabbages",15,"str_gardens"),
(item_set_slot,"itm_raw_date_fruit",11,7),
(item_set_slot,"itm_raw_date_fruit",12,7),
(item_set_slot,"itm_raw_date_fruit",13,7),
(item_set_slot,"itm_raw_date_fruit",14,232),
(item_set_slot,"itm_raw_date_fruit",15,"str_acres_oasis"),
(item_set_slot,"itm_chicken",11,40),
(item_set_slot,"itm_chicken",12,10),
(item_set_slot,"itm_chicken",13,-1),
(item_set_slot,"itm_pork",11,40),
(item_set_slot,"itm_pork",12,10),
(item_set_slot,"itm_pork",13,-1),
(item_set_slot,"itm_book_tactics",4,9),
(item_set_slot,"itm_book_persuasion",4,8),
(item_set_slot,"itm_book_leadership",4,7),
(item_set_slot,"itm_book_intelligence",4,10),
(item_set_slot,"itm_book_trade",4,11),
(item_set_slot,"itm_book_weapon_mastery",4,9),
(item_set_slot,"itm_book_engineering",4,12),
(item_set_slot,"itm_book_wound_treatment_reference",4,10),
(item_set_slot,"itm_book_training_reference",4,10),
(item_set_slot,"itm_book_surgery_reference",4,10),
]),

("initialize_town_arena_info", [
(try_for_range, ":p_001", ":p.town_1", ":p.castle_1"),
(party_set_slot,":p_001",157,4),
(party_set_slot,":p_001",158,8),
(try_end),
(party_set_slot,"p_town_6",158,2),
(party_set_slot,"p_town_1",80,2),
(party_set_slot,"p_town_1",81,1),
(party_set_slot,"p_town_1",82,4),
(party_set_slot,"p_town_1",83,1),
(party_set_slot,"p_town_1",84,4),
(party_set_slot,"p_town_1",85,1),
(party_set_slot,"p_town_2",80,4),
(party_set_slot,"p_town_2",81,4),
(party_set_slot,"p_town_2",82,4),
(party_set_slot,"p_town_2",83,6),
(party_set_slot,"p_town_2",84,4),
(party_set_slot,"p_town_2",85,8),
(party_set_slot,"p_town_3",80,2),
(party_set_slot,"p_town_3",81,8),
(party_set_slot,"p_town_3",82,2),
(party_set_slot,"p_town_3",83,8),
(party_set_slot,"p_town_3",84,2),
(party_set_slot,"p_town_3",85,8),
(party_set_slot,"p_town_4",80,2),
(party_set_slot,"p_town_4",81,8),
(party_set_slot,"p_town_4",82,3),
(party_set_slot,"p_town_4",83,8),
(party_set_slot,"p_town_4",84,2),
(party_set_slot,"p_town_4",85,5),
(party_set_slot,"p_town_5",80,2),
(party_set_slot,"p_town_5",81,3),
(party_set_slot,"p_town_5",82,2),
(party_set_slot,"p_town_5",83,5),
(party_set_slot,"p_town_5",84,2),
(party_set_slot,"p_town_5",85,8),
(party_set_slot,"p_town_6",80,2),
(party_set_slot,"p_town_6",81,4),
(party_set_slot,"p_town_6",82,3),
(party_set_slot,"p_town_6",83,4),
(party_set_slot,"p_town_6",84,3),
(party_set_slot,"p_town_6",85,6),
(party_set_slot,"p_town_7",80,4),
(party_set_slot,"p_town_7",81,4),
(party_set_slot,"p_town_7",82,4),
(party_set_slot,"p_town_7",83,6),
(party_set_slot,"p_town_7",84,4),
(party_set_slot,"p_town_7",85,8),
(party_set_slot,"p_town_8",80,3),
(party_set_slot,"p_town_8",81,1),
(party_set_slot,"p_town_8",82,3),
(party_set_slot,"p_town_8",83,3),
(party_set_slot,"p_town_8",84,3),
(party_set_slot,"p_town_8",85,7),
(party_set_slot,"p_town_9",80,2),
(party_set_slot,"p_town_9",81,2),
(party_set_slot,"p_town_9",82,2),
(party_set_slot,"p_town_9",83,5),
(party_set_slot,"p_town_9",84,2),
(party_set_slot,"p_town_9",85,8),
(party_set_slot,"p_town_10",80,2),
(party_set_slot,"p_town_10",81,3),
(party_set_slot,"p_town_10",82,2),
(party_set_slot,"p_town_10",83,5),
(party_set_slot,"p_town_10",84,2),
(party_set_slot,"p_town_10",85,8),
(party_set_slot,"p_town_11",80,2),
(party_set_slot,"p_town_11",81,8),
(party_set_slot,"p_town_11",82,3),
(party_set_slot,"p_town_11",83,4),
(party_set_slot,"p_town_11",84,3),
(party_set_slot,"p_town_11",85,6),
(party_set_slot,"p_town_12",80,3),
(party_set_slot,"p_town_12",81,8),
(party_set_slot,"p_town_12",82,4),
(party_set_slot,"p_town_12",83,6),
(party_set_slot,"p_town_12",84,4),
(party_set_slot,"p_town_12",85,5),
(party_set_slot,"p_town_13",80,2),
(party_set_slot,"p_town_13",81,8),
(party_set_slot,"p_town_13",82,4),
(party_set_slot,"p_town_13",83,5),
(party_set_slot,"p_town_13",84,4),
(party_set_slot,"p_town_13",85,7),
(party_set_slot,"p_town_14",80,2),
(party_set_slot,"p_town_14",81,4),
(party_set_slot,"p_town_14",82,2),
(party_set_slot,"p_town_14",83,5),
(party_set_slot,"p_town_14",84,2),
(party_set_slot,"p_town_14",85,6),
(party_set_slot,"p_town_15",80,2),
(party_set_slot,"p_town_15",81,8),
(party_set_slot,"p_town_15",82,3),
(party_set_slot,"p_town_15",83,4),
(party_set_slot,"p_town_15",84,3),
(party_set_slot,"p_town_15",85,6),
(party_set_slot,"p_town_16",80,3),
(party_set_slot,"p_town_16",81,8),
(party_set_slot,"p_town_16",82,4),
(party_set_slot,"p_town_16",83,6),
(party_set_slot,"p_town_16",84,4),
(party_set_slot,"p_town_16",85,5),
(party_set_slot,"p_town_17",80,2),
(party_set_slot,"p_town_17",81,8),
(party_set_slot,"p_town_17",82,4),
(party_set_slot,"p_town_17",83,5),
(party_set_slot,"p_town_17",84,4),
(party_set_slot,"p_town_17",85,7),
(party_set_slot,"p_town_18",80,2),
(party_set_slot,"p_town_18",81,4),
(party_set_slot,"p_town_18",82,2),
(party_set_slot,"p_town_18",83,5),
(party_set_slot,"p_town_18",84,2),
(party_set_slot,"p_town_18",85,6),
(party_set_slot,"p_town_19",80,2),
(party_set_slot,"p_town_19",81,8),
(party_set_slot,"p_town_19",82,4),
(party_set_slot,"p_town_19",83,4),
(party_set_slot,"p_town_19",84,4),
(party_set_slot,"p_town_19",85,6),
(party_set_slot,"p_town_20",80,4),
(party_set_slot,"p_town_20",81,2),
(party_set_slot,"p_town_20",82,4),
(party_set_slot,"p_town_20",83,4),
(party_set_slot,"p_town_20",84,4),
(party_set_slot,"p_town_20",85,6),
(party_set_slot,"p_town_21",80,3),
(party_set_slot,"p_town_21",81,3),
(party_set_slot,"p_town_21",82,2),
(party_set_slot,"p_town_21",83,6),
(party_set_slot,"p_town_21",84,2),
(party_set_slot,"p_town_21",85,8),
(party_set_slot,"p_town_22",80,4),
(party_set_slot,"p_town_22",81,3),
(party_set_slot,"p_town_22",82,3),
(party_set_slot,"p_town_22",83,4),
(party_set_slot,"p_town_22",84,2),
(party_set_slot,"p_town_22",85,6),
]),

("initialize_banner_info", [
(try_for_range, ":trp_001", ":trp.npc1", ":trp.heroes_end"),
(troop_set_slot,":trp_001",96,-1),
(troop_set_slot,":trp_001",99,-1),
(try_end),
(troop_set_slot,"trp_player",96,-1),
(troop_set_slot,"trp_player",99,-1),
(store_random_in_range,"$g_election_date",0,45),
(troop_set_slot,"trp_player",85,4294967295),
(troop_set_slot,"trp_player",86,4294967295),
(troop_set_slot,"trp_player",87,4294967295),
(troop_set_slot,"trp_player",88,4294967295),
(troop_set_slot,"trp_player",89,4294967295),
(troop_set_slot,"trp_player",90,4294967295),
(troop_set_slot,"trp_banner_background_color_array",0,4287579441),
(troop_set_slot,"trp_banner_background_color_array",1,4292466641),
(troop_set_slot,"trp_banner_background_color_array",2,4281808694),
(troop_set_slot,"trp_banner_background_color_array",3,4288973608),
(troop_set_slot,"trp_banner_background_color_array",4,4283004725),
(troop_set_slot,"trp_banner_background_color_array",5,4286723629),
(troop_set_slot,"trp_banner_background_color_array",6,4286133033),
(troop_set_slot,"trp_banner_background_color_array",7,4280689953),
(troop_set_slot,"trp_banner_background_color_array",8,4292467409),
(troop_set_slot,"trp_banner_background_color_array",9,4283581795),
(troop_set_slot,"trp_banner_background_color_array",10,4287705388),
(troop_set_slot,"trp_banner_background_color_array",11,4289700401),
(troop_set_slot,"trp_banner_background_color_array",12,4285558076),
(troop_set_slot,"trp_banner_background_color_array",13,4292269006),
(troop_set_slot,"trp_banner_background_color_array",14,4283571208),
(troop_set_slot,"trp_banner_background_color_array",15,4281943428),
(troop_set_slot,"trp_banner_background_color_array",16,4282541614),
(troop_set_slot,"trp_banner_background_color_array",17,4292861654),
(troop_set_slot,"trp_banner_background_color_array",18,4280887076),
(troop_set_slot,"trp_banner_background_color_array",19,4283982107),
(troop_set_slot,"trp_banner_background_color_array",20,4281416295),
(troop_set_slot,"trp_banner_background_color_array",21,4288451146),
(troop_set_slot,"trp_banner_background_color_array",22,4288252729),
(troop_set_slot,"trp_banner_background_color_array",23,4281749864),
(troop_set_slot,"trp_banner_background_color_array",24,4292269006),
(troop_set_slot,"trp_banner_background_color_array",25,4287931970),
(troop_set_slot,"trp_banner_background_color_array",26,4287906097),
(troop_set_slot,"trp_banner_background_color_array",27,4287183668),
(troop_set_slot,"trp_banner_background_color_array",28,4282537232),
(troop_set_slot,"trp_banner_background_color_array",29,4287907118),
(troop_set_slot,"trp_banner_background_color_array",30,4282866324),
(troop_set_slot,"trp_banner_background_color_array",31,4291932721),
(troop_set_slot,"trp_banner_background_color_array",32,4292993759),
(troop_set_slot,"trp_banner_background_color_array",33,4288248862),
(troop_set_slot,"trp_banner_background_color_array",34,4291213133),
(troop_set_slot,"trp_banner_background_color_array",35,4289567256),
(troop_set_slot,"trp_banner_background_color_array",36,4280362017),
(troop_set_slot,"trp_banner_background_color_array",37,4287373345),
(troop_set_slot,"trp_banner_background_color_array",38,4283265334),
(troop_set_slot,"trp_banner_background_color_array",39,4281949572),
(troop_set_slot,"trp_banner_background_color_array",40,4283594041),
(troop_set_slot,"trp_banner_background_color_array",41,4288429113),
(troop_set_slot,"trp_banner_background_color_array",42,4282536332),
(troop_set_slot,"trp_banner_background_color_array",43,4288965164),
(troop_set_slot,"trp_banner_background_color_array",44,4288631105),
(troop_set_slot,"trp_banner_background_color_array",45,4281098633),
(troop_set_slot,"trp_banner_background_color_array",46,4283786273),
(troop_set_slot,"trp_banner_background_color_array",47,4288504350),
(troop_set_slot,"trp_banner_background_color_array",48,4292796118),
(troop_set_slot,"trp_banner_background_color_array",49,4285417617),
(troop_set_slot,"trp_banner_background_color_array",50,4286994985),
(troop_set_slot,"trp_banner_background_color_array",51,4292796377),
(troop_set_slot,"trp_banner_background_color_array",52,4283581043),
(troop_set_slot,"trp_banner_background_color_array",53,4287379489),
(troop_set_slot,"trp_banner_background_color_array",54,4291940038),
(troop_set_slot,"trp_banner_background_color_array",55,4281413681),
(troop_set_slot,"trp_banner_background_color_array",56,4282868237),
(troop_set_slot,"trp_banner_background_color_array",57,4285219129),
(troop_set_slot,"trp_banner_background_color_array",58,4292270038),
(troop_set_slot,"trp_banner_background_color_array",59,4281216812),
(troop_set_slot,"trp_banner_background_color_array",60,4284498563),
(troop_set_slot,"trp_banner_background_color_array",61,4281947524),
(troop_set_slot,"trp_banner_background_color_array",62,4281413681),
(troop_set_slot,"trp_banner_background_color_array",63,4286463790),
(troop_set_slot,"trp_banner_background_color_array",64,4281611316),
(troop_set_slot,"trp_banner_background_color_array",65,4282141035),
(troop_set_slot,"trp_banner_background_color_array",66,4292466897),
(troop_set_slot,"trp_banner_background_color_array",67,4288250428),
(troop_set_slot,"trp_banner_background_color_array",68,4288643630),
(troop_set_slot,"trp_banner_background_color_array",69,4281940025),
(troop_set_slot,"trp_banner_background_color_array",70,4289022257),
(troop_set_slot,"trp_banner_background_color_array",71,4292861142),
(troop_set_slot,"trp_banner_background_color_array",72,4288629302),
(troop_set_slot,"trp_banner_background_color_array",73,4287395105),
(troop_set_slot,"trp_banner_background_color_array",74,4288628273),
(troop_set_slot,"trp_banner_background_color_array",75,4286133028),
(troop_set_slot,"trp_banner_background_color_array",76,4281946230),
(troop_set_slot,"trp_banner_background_color_array",77,4281084716),
(troop_set_slot,"trp_banner_background_color_array",78,4284838177),
(troop_set_slot,"trp_banner_background_color_array",79,4286460193),
(troop_set_slot,"trp_banner_background_color_array",80,4285944110),
(troop_set_slot,"trp_banner_background_color_array",81,4293387230),
(troop_set_slot,"trp_banner_background_color_array",82,4287920417),
(troop_set_slot,"trp_banner_background_color_array",83,4283267964),
(troop_set_slot,"trp_banner_background_color_array",84,4281611057),
(troop_set_slot,"trp_banner_background_color_array",85,4289154358),
(troop_set_slot,"trp_banner_background_color_array",86,4293387230),
(troop_set_slot,"trp_banner_background_color_array",87,4292270286),
(troop_set_slot,"trp_banner_background_color_array",88,4282273127),
(troop_set_slot,"trp_banner_background_color_array",89,4288644142),
(troop_set_slot,"trp_banner_background_color_array",90,4283263380),
(troop_set_slot,"trp_banner_background_color_array",91,4283064600),
(troop_set_slot,"trp_banner_background_color_array",92,4287904809),
(troop_set_slot,"trp_banner_background_color_array",93,4281943161),
(troop_set_slot,"trp_banner_background_color_array",94,4281611057),
(troop_set_slot,"trp_banner_background_color_array",95,4282338653),
(troop_set_slot,"trp_banner_background_color_array",96,4283065481),
(troop_set_slot,"trp_banner_background_color_array",97,4281413681),
(troop_set_slot,"trp_banner_background_color_array",98,4292270030),
(troop_set_slot,"trp_banner_background_color_array",99,4291206656),
(troop_set_slot,"trp_banner_background_color_array",100,4284714578),
(troop_set_slot,"trp_banner_background_color_array",101,4292664275),
(troop_set_slot,"trp_banner_background_color_array",102,4292598995),
(troop_set_slot,"trp_banner_background_color_array",103,4286855217),
(troop_set_slot,"trp_banner_background_color_array",104,4291743686),
(troop_set_slot,"trp_banner_background_color_array",105,4291009841),
(troop_set_slot,"trp_banner_background_color_array",106,4291540592),
(troop_set_slot,"trp_banner_background_color_array",107,4281944600),
(troop_set_slot,"trp_banner_background_color_array",108,4281804552),
(troop_set_slot,"trp_banner_background_color_array",109,4288309264),
(troop_set_slot,"trp_banner_background_color_array",110,4289886480),
(troop_set_slot,"trp_banner_background_color_array",111,4287399457),
(troop_set_slot,"trp_banner_background_color_array",112,4288109059),
(troop_set_slot,"trp_banner_background_color_array",113,4281084196),
(troop_set_slot,"trp_banner_background_color_array",114,4289369644),
(troop_set_slot,"trp_banner_background_color_array",115,4288840238),
(troop_set_slot,"trp_banner_background_color_array",116,4286286476),
(troop_set_slot,"trp_banner_background_color_array",117,4282124552),
(troop_set_slot,"trp_banner_background_color_array",118,4294902015),
(troop_set_slot,"trp_banner_background_color_array",119,4284947988),
(troop_set_slot,"trp_banner_background_color_array",120,4279251010),
(troop_set_slot,"trp_banner_background_color_array",121,4283057408),
(troop_set_slot,"trp_banner_background_color_array",122,4285543204),
(troop_set_slot,"trp_banner_background_color_array",123,4280559932),
(troop_set_slot,"trp_banner_background_color_array",124,4284311910),
(troop_set_slot,"trp_banner_background_color_array",125,4290614833),
(troop_set_slot,"trp_banner_background_color_array",126,4291211883),
(troop_set_slot,"trp_banner_background_color_array",127,4281944344),
(troop_set_slot,"trp_banner_background_color_array",128,4280361505),
(troop_set_slot,"trp_banner_background_color_array",129,4280361505),
(troop_set_slot,"trp_banner_background_color_array",130,4281219856),
(troop_set_slot,"trp_banner_background_color_array",131,4282539387),
(troop_set_slot,"trp_banner_background_color_array",132,4281943560),
]),

("initialize_economic_information", [
(try_for_range, ":p_001", ":p.town_1", ":p.castle_1"),
(store_random_in_range,":random_x_002",10,31),
(party_set_slot,":p_001",227,":random_x_002"),
(store_random_in_range,":random_x_003",1,4),
(party_set_slot,":p_001",222,":random_x_003"),
(store_random_in_range,":random_x_004",3,9),
(party_set_slot,":p_001",228,":random_x_004"),
(store_random_in_range,":random_x_005",6,25),
(party_set_slot,":p_001",229,":random_x_005"),
(store_random_in_range,":random_x_004",3,9),
(party_set_slot,":p_001",221,":random_x_004"),
(store_random_in_range,":random_x_003",1,4),
(party_set_slot,":p_001",230,":random_x_003"),
(store_random_in_range,":random_x_006",0,3),
(party_set_slot,":p_001",223,":random_x_006"),
(store_random_in_range,":random_x_003",1,4),
(party_set_slot,":p_001",224,":random_x_003"),
(store_random_in_range,":random_x_007",0,2001),
(party_set_slot,":p_001",209,":random_x_007"),
(store_random_in_range,":random_x_007",0,2001),
(party_set_slot,":p_001",211,":random_x_007"),
(try_end),
(party_set_slot,"p_town_1",225,15),
(party_set_slot,"p_town_1",223,4),
(party_set_slot,"p_town_2",215,3),
(party_set_slot,"p_town_2",214,25),
(party_set_slot,"p_town_2",225,15),
(party_set_slot,"p_town_3",223,10),
(party_set_slot,"p_town_3",226,12),
(party_set_slot,"p_town_4",226,12),
(party_set_slot,"p_town_4",224,15),
(party_set_slot,"p_town_5",226,24),
(party_set_slot,"p_town_5",214,30),
(party_set_slot,"p_town_6",222,10),
(party_set_slot,"p_town_6",230,4),
(party_set_slot,"p_town_6",214,10),
(party_set_slot,"p_town_7",221,15),
(party_set_slot,"p_town_7",230,4),
(party_set_slot,"p_town_7",224,5),
(party_set_slot,"p_town_8",229,25),
(party_set_slot,"p_town_8",227,35),
(party_set_slot,"p_town_8",223,4),
(party_set_slot,"p_town_9",229,18),
(party_set_slot,"p_town_9",230,3),
(party_set_slot,"p_town_9",214,5),
(party_set_slot,"p_town_10",215,2),
(party_set_slot,"p_town_11",229,19),
(party_set_slot,"p_town_11",219,10),
(party_set_slot,"p_town_11",214,10),
(party_set_slot,"p_town_12",215,3),
(party_set_slot,"p_town_12",214,25),
(party_set_slot,"p_town_13",227,30),
(party_set_slot,"p_town_13",230,5),
(party_set_slot,"p_town_13",214,20),
(party_set_slot,"p_town_14",230,3),
(party_set_slot,"p_town_14",228,18),
(party_set_slot,"p_town_15",229,20),
(party_set_slot,"p_town_15",223,6),
(party_set_slot,"p_town_15",224,5),
(party_set_slot,"p_town_15",214,25),
(party_set_slot,"p_town_16",229,30),
(party_set_slot,"p_town_16",230,4),
(party_set_slot,"p_town_17",227,40),
(party_set_slot,"p_town_18",227,35),
(party_set_slot,"p_town_18",224,10),
(party_set_slot,"p_town_19",230,5),
(party_set_slot,"p_town_19",222,0),
(party_set_slot,"p_town_19",223,0),
(party_set_slot,"p_town_19",214,5),
(party_set_slot,"p_town_19",224,5),
(party_set_slot,"p_town_20",222,0),
(party_set_slot,"p_town_20",223,0),
(party_set_slot,"p_town_20",225,15),
(party_set_slot,"p_town_20",228,12),
(party_set_slot,"p_town_19",224,3),
(party_set_slot,"p_town_21",222,0),
(party_set_slot,"p_town_21",223,0),
(party_set_slot,"p_town_21",228,24),
(party_set_slot,"p_town_21",215,1),
(party_set_slot,"p_town_22",222,0),
(party_set_slot,"p_town_22",223,0),
(party_set_slot,"p_town_22",228,12),
(party_set_slot,"p_town_22",215,2),
(try_for_range, ":p_008", ":p.village_1", ":p.salt_mine"),
(this_or_next|eq,":p_008","p_village_92"),
(this_or_next|eq,":p_008","p_village_108"),
(this_or_next|eq,":p_008","p_village_110"),
(this_or_next|eq,":p_008","p_village_104"),
(this_or_next|eq,":p_008","p_village_101"),
(this_or_next|eq,":p_008","p_village_107"),
(this_or_next|eq,":p_008","p_village_100"),
(this_or_next|eq,":p_008","p_village_99"),
(this_or_next|eq,":p_008","p_village_105"),
(this_or_next|eq,":p_008","p_village_103"),
(this_or_next|eq,":p_008","p_village_98"),
(this_or_next|eq,":p_008","p_village_109"),
(this_or_next|eq,":p_008","p_village_102"),
(this_or_next|eq,":p_008","p_village_97"),
(this_or_next|eq,":p_008","p_village_96"),
(this_or_next|eq,":p_008","p_village_95"),
(this_or_next|eq,":p_008","p_village_94"),
(eq,":p_008","p_village_93"),
(assign,":var009",1),
(else_try),
(assign,":var009",0),
(store_random_in_range,":random_x_010",20,100),
(try_begin),
(eq,":var009",1),
(val_div, ":random_x_010", 5),
(try_end),
(party_set_slot,":p_008",205,":random_x_010"),
(store_random_in_range,":random_x_011",40,200),
(try_begin),
(eq,":var009",1),
(val_div, ":random_x_011", 5),
(try_end),
(party_set_slot,":p_008",206,":random_x_011"),
(store_random_in_range,":random_x_012",0,40000),
(store_random_in_range,":random_x_013",0,":random_x_012"),
(try_begin),
(eq,":var009",1),
(val_div, ":random_x_013", 5),
(try_end),
(party_set_slot,":p_008",209,":random_x_013"),
(store_random_in_range,":random_x_014",0,2000),
(store_random_in_range,":random_x_015",0,":random_x_014"),
(try_begin),
(eq,":var009",1),
(val_div, ":random_x_015", 5),
(try_end),
(party_set_slot,":p_008",211,":random_x_015"),
(store_random_in_range,":random_x_014",0,2000),
(store_random_in_range,":random_x_015",0,":random_x_014"),
(try_begin),
(eq,":var009",1),
(val_div, ":random_x_015", 5),
(try_end),
(party_set_slot,":p_008",210,":random_x_015"),
(store_random_in_range,":random_x_016",0,3),
(try_begin),
(eq,":var009",1),
(assign,":random_x_016",0),
(try_end),
(party_set_slot,":p_008",216,":random_x_016"),
(store_random_in_range,":random_x_017",0,5),
(try_begin),
(eq,":var009",1),
(assign,":random_x_017",0),
(try_end),
(party_set_slot,":p_008",232,":random_x_017"),
(store_random_in_range,":random_x_016",0,3),
(party_set_slot,":p_008",221,":random_x_016"),
(store_random_in_range,":random_x_017",0,5),
(try_begin),
(eq,":var009",1),
(val_mul, ":random_x_017", 5),
(try_end),
(party_set_slot,":p_008",228,":random_x_017"),
(try_begin),
(party_slot_eq,":p_008",121,"p_town_1"),
(party_set_slot,":p_008",212,4000),
(party_set_slot,":p_008",211,8000),
(else_try),
(party_slot_eq,":p_008",121,"p_town_2"),
(party_set_slot,":p_008",211,8000),
(party_set_slot,":p_008",232,10),
(else_try),
(party_slot_eq,":p_008",121,"p_town_3"),
(party_set_slot,":p_008",211,6000),
(party_set_slot,":p_008",210,6000),
(else_try),
(party_slot_eq,":p_008",121,"p_town_4"),
(party_set_slot,":p_008",220,2),
(party_set_slot,":p_008",210,8000),
(else_try),
(party_slot_eq,":p_008",121,"p_town_5"),
(party_set_slot,":p_008",217,1500),
(party_set_slot,":p_008",218,1500),
(else_try),
(party_slot_eq,":p_008",121,"p_town_6"),
(party_set_slot,":p_008",212,4000),
(party_set_slot,":p_008",222,4),
(else_try),
(party_slot_eq,":p_008",121,"p_town_7"),
(party_set_slot,":p_008",220,1),
(party_set_slot,":p_008",210,8000),
(party_set_slot,":p_008",216,8),
(else_try),
(party_slot_eq,":p_008",121,"p_town_8"),
(party_set_slot,":p_008",220,2),
(party_set_slot,":p_008",205,100),
(party_set_slot,":p_008",219,6),
(else_try),
(party_slot_eq,":p_008",121,"p_town_9"),
(party_set_slot,":p_008",220,2),
(party_set_slot,":p_008",210,4000),
(else_try),
(party_slot_eq,":p_008",121,"p_town_10"),
(party_set_slot,":p_008",206,150),
(party_set_slot,":p_008",215,1),
(party_set_slot,":p_008",220,1),
(party_set_slot,":p_008",216,8),
(else_try),
(party_slot_eq,":p_008",121,"p_town_11"),
(party_set_slot,":p_008",219,6),
(party_set_slot,":p_008",220,2),
(else_try),
(party_slot_eq,":p_008",121,"p_town_12"),
(party_set_slot,":p_008",211,8000),
(party_set_slot,":p_008",232,10),
(party_set_slot,":p_008",215,1),
(else_try),
(party_slot_eq,":p_008",121,"p_town_13"),
(party_set_slot,":p_008",220,2),
(party_set_slot,":p_008",205,100),
(party_set_slot,":p_008",217,1500),
(else_try),
(party_slot_eq,":p_008",121,"p_town_14"),
(party_set_slot,":p_008",209,40000),
(party_set_slot,":p_008",221,5),
(else_try),
(party_slot_eq,":p_008",121,"p_town_15"),
(party_set_slot,":p_008",211,8000),
(party_set_slot,":p_008",210,8000),
(party_set_slot,":p_008",232,10),
(else_try),
(party_slot_eq,":p_008",121,"p_town_16"),
(party_set_slot,":p_008",209,40000),
(party_set_slot,":p_008",219,3),
(party_set_slot,":p_008",221,5),
(else_try),
(party_slot_eq,":p_008",121,"p_town_17"),
(party_set_slot,":p_008",209,20000),
(party_set_slot,":p_008",220,1),
(else_try),
(party_slot_eq,":p_008",121,"p_town_18"),
(party_set_slot,":p_008",209,20000),
(party_set_slot,":p_008",219,3),
(party_set_slot,":p_008",216,8),
(party_set_slot,":p_008",212,4000),
(else_try),
(party_slot_eq,":p_008",121,"p_town_19"),
(party_set_slot,":p_008",209,6000),
(party_set_slot,":p_008",212,2000),
(party_set_slot,":p_008",210,3000),
(party_set_slot,":p_008",213,5000),
(else_try),
(party_slot_eq,":p_008",121,"p_town_20"),
(party_set_slot,":p_008",209,3000),
(party_set_slot,":p_008",213,10000),
(party_set_slot,":p_008",215,1),
(else_try),
(party_slot_eq,":p_008",121,"p_town_21"),
(party_set_slot,":p_008",209,3000),
(party_set_slot,":p_008",213,5000),
(party_set_slot,":p_008",218,1500),
(else_try),
(party_slot_eq,":p_008",121,"p_town_22"),
(party_set_slot,":p_008",209,2000),
(party_set_slot,":p_008",212,2000),
(party_set_slot,":p_008",213,10000),
(party_set_slot,":p_008",215,1),
(party_set_slot,":p_008",218,1500),
(try_end),
(try_end),
(try_for_range, ":p_008", ":p.village_1", ":p.salt_mine"),
(party_get_slot,":party_slot_018",":p_008",120),
(try_begin),
(is_between,":party_slot_018","p_castle_1","p_village_1"),
(try_for_range, ":slot_no_019", 209, 233),
(assign,":var020",0),
(try_for_range, ":p_021", ":p.village_1", ":p.salt_mine"),
(party_get_slot,":party_slot_018",":p_021",120),
(is_between,":party_slot_018","p_town_1","p_castle_1"),
(store_distance_to_party_from_party,":distance_parties_022",":p_008",":p_008"),
(le,":distance_parties_022",72),
(party_get_slot,":party_slot_023",":p_008",":slot_no_019"),
(store_add, ":var024", ":distance_parties_022", 24),
(store_mul, ":var025", ":party_slot_023", 12),
(store_div, ":var___x1", ":var025", ":var024"),
(assign,":var026",":var___x1"),
(val_div, ":var026", 2),
(val_add, ":var020", ":var026"),
(try_end),
(try_end),
(party_set_slot,":p_008",":slot_no_019",":var020"),
(try_end),
(try_end),
(party_set_slot,"p_village_1",214,15),
(party_set_slot,"p_village_3",214,15),
(party_set_slot,"p_village_5",214,15),
(party_set_slot,"p_village_8",214,15),
(party_set_slot,"p_village_9",214,15),
(party_set_slot,"p_village_20",214,15),
(party_set_slot,"p_village_21",214,15),
(party_set_slot,"p_village_23",214,15),
(party_set_slot,"p_village_27",214,15),
(party_set_slot,"p_village_30",214,20),
(party_set_slot,"p_village_31",214,15),
(party_set_slot,"p_village_35",214,15),
(party_set_slot,"p_village_47",214,15),
(party_set_slot,"p_village_49",214,15),
(party_set_slot,"p_village_51",214,15),
(party_set_slot,"p_village_56",214,15),
(party_set_slot,"p_village_66",214,15),
(party_set_slot,"p_village_68",214,15),
(party_set_slot,"p_village_69",214,15),
(party_set_slot,"p_village_77",214,25),
(party_set_slot,"p_village_79",214,15),
(party_set_slot,"p_village_81",214,15),
(party_set_slot,"p_village_85",214,15),
(party_set_slot,"p_village_87",214,15),
(party_set_slot,"p_village_90",214,15),
(try_for_range, ":p_027", ":p.town_1", ":p.salt_mine"),
(party_get_slot,":party_slot_028",":p_027",205),
(party_get_slot,":party_slot_029",":p_027",206),
(store_mul, ":var030", ":party_slot_028", 4),
(val_add, ":var030", ":party_slot_029"),
(val_add, ":var030", ":party_slot_029"),
(val_mul, ":var030", 6),
(val_div, ":var030", 5),
(store_random_in_range,":random_x_031",60,150),
(val_mul, ":var030", ":random_x_031"),
(val_div, ":var030", 100),
(party_set_slot,":p_027",208,":var030"),
(try_end),
(try_for_range, ":var032", 0, 3),
(call_script, "script_update_trade_good_prices"),
(try_end),
(try_for_range, ":p_033", ":p.town_1", ":p.salt_mine"),
(neg|is_between,":p_033","p_castle_1","p_village_1"),
(store_random_in_range,":random_x_034",-10,10),
(call_script, "script_get_center_ideal_prosperity", ":p_033"),
(assign,":var035",reg0),
(val_add, ":var035", ":random_x_034"),
(val_clamp,":var035",0, 100),
(party_set_slot,":p_033",50,":var035"),
(try_end),
(call_script, "script_calculate_castle_prosperities_by_using_its_villages"),
]),

("initialize_all_scene_prop_slots", [
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_6m"),
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_8m"),
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_10m"),
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_12m"),
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_14m"),
(call_script, "script_initialize_scene_prop_slots", "spr_castle_e_sally_door_a"),
(call_script, "script_initialize_scene_prop_slots", "spr_castle_f_sally_door_a"),
(call_script, "script_initialize_scene_prop_slots", "spr_earth_sally_gate_left"),
(call_script, "script_initialize_scene_prop_slots", "spr_earth_sally_gate_right"),
(call_script, "script_initialize_scene_prop_slots", "spr_viking_keep_destroy_sally_door_left"),
(call_script, "script_initialize_scene_prop_slots", "spr_viking_keep_destroy_sally_door_right"),
(call_script, "script_initialize_scene_prop_slots", "spr_castle_f_door_a"),
(call_script, "script_initialize_scene_prop_slots", "spr_belfry_a"),
(call_script, "script_initialize_scene_prop_slots", "spr_belfry_b"),
(call_script, "script_initialize_scene_prop_slots", "spr_winch_b"),
]),

("initialize_scene_prop_slots", [
(store_script_param, ":var001", 1),
(scene_prop_get_num_instances, ":scp_num_instances_002", ":var001"),
(try_for_range, ":var003", 0, ":scp_num_instances_002"),
(scene_prop_get_instance, ":scp_instance_004", ":var001", ":var003"),
(try_for_range, ":slot_no_005", 0, 6),
(scene_prop_set_slot,":scp_instance_004",":slot_no_005",0),
(try_end),
(try_end),
]),

("use_item", [
(store_script_param, ":scene_prop_instance_id_001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(game_in_multiplayer_mode),
(prop_instance_get_scene_prop_kind, ":scene_prop_kind_003", ":scene_prop_instance_id_001"),
(try_begin),
(eq,":scene_prop_kind_003","spr_winch_b"),
(multiplayer_get_my_player, ":my_player"),
(this_or_next|gt,":my_player",0),
(neg|multiplayer_is_dedicated_server),
(ge,":my_player",0),
(player_get_agent_id, ":agent_id_005", ":my_player"),
(ge,":agent_id_005",0),
(agent_is_active,":agent_id_005"),
(agent_get_team, ":agent_team_no_006", ":agent_id_005"),
(eq,":agent_team_no_006",0),
(scene_prop_get_slot,":scene_prop_slot_007",":scene_prop_instance_id_001",1),
(ge,":var002",0),
(agent_is_active,":var002"),
(agent_get_player_id,":agent_player_id_008",":var002"),
(str_store_string,s7,":str_store_player_username(agent_player_id_008)"),
(try_begin),
(eq,":scene_prop_slot_007",0),
(display_message, "@@{s7} opened the gate"),
(else_try),
(display_message, "@@{s7} closed the gate"),
(try_end),
(try_end),
(try_end),
(prop_instance_get_scene_prop_kind, ":scene_prop_kind_003", ":scene_prop_instance_id_001"),
(try_begin),
(this_or_next|eq,":scene_prop_kind_003","spr_winch"),
(eq,":scene_prop_kind_003","spr_winch_b"),
(assign,":var009","spr_portcullis"),
(else_try),
(this_or_next|eq,":scene_prop_kind_003","spr_siege_ladder_move_14m"),
(this_or_next|eq,":scene_prop_kind_003","spr_siege_ladder_move_12m"),
(this_or_next|eq,":scene_prop_kind_003","spr_siege_ladder_move_10m"),
(this_or_next|eq,":scene_prop_kind_003","spr_siege_ladder_move_8m"),
(this_or_next|eq,":scene_prop_kind_003","spr_siege_ladder_move_6m"),
(this_or_next|eq,":scene_prop_kind_003","spr_castle_f_door_a"),
(this_or_next|eq,":scene_prop_kind_003","spr_viking_keep_destroy_sally_door_right"),
(this_or_next|eq,":scene_prop_kind_003","spr_viking_keep_destroy_sally_door_left"),
(this_or_next|eq,":scene_prop_kind_003","spr_earth_sally_gate_right"),
(this_or_next|eq,":scene_prop_kind_003","spr_earth_sally_gate_left"),
(this_or_next|eq,":scene_prop_kind_003","spr_castle_f_sally_door_a"),
(this_or_next|eq,":scene_prop_kind_003","spr_castle_e_sally_door_a"),
(this_or_next|eq,":scene_prop_kind_003","spr_castle_f_door_b"),
(eq,":scene_prop_kind_003","spr_door_destructible"),
(assign,":var009",":scene_prop_kind_003"),
(try_end),
(assign,":var010",-1),
(prop_instance_get_position, pos0, ":scene_prop_instance_id_001"),
(scene_prop_get_num_instances, ":scp_num_instances_011", ":var009"),
(try_for_range, ":var012", 0, ":scp_num_instances_011"),
(scene_prop_get_instance, ":scp_instance_013", ":var009", ":var012"),
(prop_instance_get_position, pos1, ":scp_instance_013"),
(get_sq_distance_between_positions,":sq_distance_014",0,1),
(try_begin),
(this_or_next|eq,":var010",-1),
(lt,":sq_distance_014",":var010"),
(assign,":var010",":sq_distance_014"),
(assign,":scene_prop_instance_id_015",":scp_instance_013"),
(try_end),
(try_end),
(try_begin),
(ge,":scene_prop_instance_id_001",0),
(ge,":var010",0),
(try_begin),
(eq,":var009","spr_portcullis"),
(scene_prop_get_slot,":scene_prop_slot_007",":scene_prop_instance_id_001",1),
(try_begin),
(eq,":scene_prop_slot_007",0),
(scene_prop_enable_after_time, ":scene_prop_instance_id_001", 400),
(try_begin),
(this_or_next|multiplayer_is_server),
(neg|game_in_multiplayer_mode),
(prop_instance_get_position, pos0, ":scene_prop_instance_id_015"),
(position_move_z,0,375),
(prop_instance_animate_to_position, ":scene_prop_instance_id_015", 0, 400),
(try_end),
(scene_prop_set_slot,":scene_prop_instance_id_001",1,1),
(try_begin),
(eq,":scene_prop_kind_003","spr_winch_b"),
(this_or_next|multiplayer_is_server),
(neg|game_in_multiplayer_mode),
(prop_instance_get_position, pos1, ":scene_prop_instance_id_001"),
(prop_instance_rotate_to_position, ":scene_prop_instance_id_001", 1, 400, 72000),
(try_end),
(else_try),
(scene_prop_enable_after_time, ":scene_prop_instance_id_001", 400),
(try_begin),
(this_or_next|multiplayer_is_server),
(neg|game_in_multiplayer_mode),
(prop_instance_get_position, pos0, ":scene_prop_instance_id_015"),
(position_move_z,0,-375),
(prop_instance_animate_to_position, ":scene_prop_instance_id_015", 0, 400),
(try_end),
(scene_prop_set_slot,":scene_prop_instance_id_001",1,0),
(try_begin),
(eq,":scene_prop_kind_003","spr_winch_b"),
(this_or_next|multiplayer_is_server),
(neg|game_in_multiplayer_mode),
(prop_instance_get_position, pos1, ":scene_prop_instance_id_001"),
(prop_instance_rotate_to_position, ":scene_prop_instance_id_001", 1, 400, -72000),
(try_end),
(try_end),
(else_try),
(this_or_next|eq,":var009","spr_siege_ladder_move_14m"),
(this_or_next|eq,":var009","spr_siege_ladder_move_12m"),
(this_or_next|eq,":var009","spr_siege_ladder_move_10m"),
(this_or_next|eq,":var009","spr_siege_ladder_move_8m"),
(eq,":var009","spr_siege_ladder_move_6m"),
(try_begin),
(eq,":var009","spr_siege_ladder_move_6m"),
(assign,":var016",120),
(assign,":var017",240),
(else_try),
(eq,":var009","spr_siege_ladder_move_8m"),
(assign,":var016",140),
(assign,":var017",280),
(else_try),
(eq,":var009","spr_siege_ladder_move_10m"),
(assign,":var016",160),
(assign,":var017",320),
(else_try),
(eq,":var009","spr_siege_ladder_move_12m"),
(assign,":var016",190),
(assign,":var017",360),
(else_try),
(eq,":var009","spr_siege_ladder_move_14m"),
(assign,":var016",230),
(assign,":var017",400),
(try_end),
(scene_prop_get_slot,":scene_prop_slot_007",":scene_prop_instance_id_001",1),
(try_begin),
(eq,1,1),
(scene_prop_enable_after_time, ":scene_prop_instance_id_015", ":var017"),
(try_begin),
(eq,":scene_prop_slot_007",0),
(prop_instance_get_starting_position, pos0, ":scene_prop_instance_id_015"),
(prop_instance_enable_physics, ":scene_prop_instance_id_015", 0),
(prop_instance_animate_to_position, ":scene_prop_instance_id_015", 0, 300),
(scene_prop_set_slot,":scene_prop_instance_id_015",1,1),
(else_try),
(scene_prop_enable_after_time, ":scene_prop_instance_id_015", ":var016"),
(prop_instance_get_position, pos0, ":scene_prop_instance_id_001"),
(assign,":var010",-1),
(try_for_range, ":var018", 100, 110),
(entry_point_get_position, pos1, ":var018"),
(get_sq_distance_between_positions,":sq_distance_014",0,1),
(try_begin),
(this_or_next|eq,":var010",-1),
(lt,":sq_distance_014",":var010"),
(assign,":var010",":sq_distance_014"),
(assign,":var019",":var018"),
(try_end),
(try_end),
(try_end),
(try_begin),
(ge,":var010",0),
(lt,":var010",22500),
(entry_point_get_position, pos1, ":var019"),
(position_rotate_x,1,-90),
(scene_prop_set_slot,":scene_prop_instance_id_015",2,0),
(prop_instance_enable_physics, ":scene_prop_instance_id_015", 0),
(prop_instance_animate_to_position, ":scene_prop_instance_id_015", 1, 130),
(try_end),
(scene_prop_set_slot,":scene_prop_instance_id_015",1,0),
(try_end),
(else_try),
(this_or_next|eq,":var009","spr_door_destructible"),
(this_or_next|eq,":var009","spr_castle_f_door_b"),
(this_or_next|eq,":scene_prop_kind_003","spr_castle_e_sally_door_a"),
(this_or_next|eq,":scene_prop_kind_003","spr_castle_f_sally_door_a"),
(this_or_next|eq,":scene_prop_kind_003","spr_earth_sally_gate_left"),
(this_or_next|eq,":scene_prop_kind_003","spr_earth_sally_gate_right"),
(this_or_next|eq,":scene_prop_kind_003","spr_viking_keep_destroy_sally_door_left"),
(this_or_next|eq,":scene_prop_kind_003","spr_viking_keep_destroy_sally_door_right"),
(eq,":scene_prop_kind_003","spr_castle_f_door_a"),
(assign,":scene_prop_instance_id_015",":scene_prop_instance_id_001"),
(scene_prop_get_slot,":scene_prop_slot_007",":scene_prop_instance_id_015",1),
(try_begin),
(eq,":scene_prop_slot_007",0),
(prop_instance_get_starting_position, pos0, ":scene_prop_instance_id_015"),
(scene_prop_enable_after_time, ":scene_prop_instance_id_015", 100),
(try_begin),
(neq,":scene_prop_kind_003","spr_viking_keep_destroy_sally_door_left"),
(neq,":scene_prop_kind_003","spr_earth_sally_gate_left"),
(position_rotate_z,0,-85),
(else_try),
(position_rotate_z,0,85),
(try_end),
(prop_instance_animate_to_position, ":scene_prop_instance_id_015", 0, 100),
(scene_prop_set_slot,":scene_prop_instance_id_015",1,1),
(else_try),
(prop_instance_get_starting_position, pos0, ":scene_prop_instance_id_015"),
(scene_prop_enable_after_time, ":scene_prop_instance_id_015", 100),
(prop_instance_animate_to_position, ":scene_prop_instance_id_015", 0, 100),
(scene_prop_set_slot,":scene_prop_instance_id_015",1,0),
(try_end),
(try_end),
(try_end),
]),

("determine_team_flags", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,":::g_multiplayer_game_type",4),
(try_begin),
(eq,":var001",0),
(team_get_faction, ":team_faction_002", 0),
(try_begin),
(eq,":team_faction_002","fac_kingdom_1"),
(assign,"$team_1_flag_scene_prop","spr_ctf_flag_kingdom_1"),
(else_try),
(eq,":team_faction_002","fac_kingdom_2"),
(assign,"$team_1_flag_scene_prop","spr_ctf_flag_kingdom_2"),
(else_try),
(eq,":team_faction_002","fac_kingdom_3"),
(assign,"$team_1_flag_scene_prop","spr_ctf_flag_kingdom_3"),
(else_try),
(eq,":team_faction_002","fac_kingdom_4"),
(assign,"$team_1_flag_scene_prop","spr_ctf_flag_kingdom_4"),
(else_try),
(eq,":team_faction_002","fac_kingdom_5"),
(assign,"$team_1_flag_scene_prop","spr_ctf_flag_kingdom_5"),
(else_try),
(eq,":team_faction_002","fac_kingdom_6"),
(assign,"$team_1_flag_scene_prop","spr_ctf_flag_kingdom_6"),
(try_end),
(else_try),
(team_get_faction, ":team_faction_002", 1),
(try_begin),
(eq,":team_faction_002","fac_kingdom_1"),
(assign,"$team_2_flag_scene_prop","spr_ctf_flag_kingdom_1"),
(else_try),
(eq,":team_faction_002","fac_kingdom_2"),
(assign,"$team_2_flag_scene_prop","spr_ctf_flag_kingdom_2"),
(else_try),
(eq,":team_faction_002","fac_kingdom_3"),
(assign,"$team_2_flag_scene_prop","spr_ctf_flag_kingdom_3"),
(else_try),
(eq,":team_faction_002","fac_kingdom_4"),
(assign,"$team_2_flag_scene_prop","spr_ctf_flag_kingdom_4"),
(else_try),
(eq,":team_faction_002","fac_kingdom_5"),
(assign,"$team_2_flag_scene_prop","spr_ctf_flag_kingdom_5"),
(else_try),
(eq,":team_faction_002","fac_kingdom_6"),
(assign,"$team_2_flag_scene_prop","spr_ctf_flag_kingdom_6"),
(try_end),
(try_begin),
(eq,":::team_1_flag_scene_prop",":::team_2_flag_scene_prop"),
(assign,"$team_2_flag_scene_prop","spr_ctf_flag_kingdom_7"),
(try_end),
(try_end),
(else_try),
(try_begin),
(eq,":var001",0),
(team_get_faction, ":team_faction_002", 0),
(try_begin),
(eq,":team_faction_002","fac_kingdom_1"),
(assign,"$team_1_flag_scene_prop","spr_headquarters_flag_swadian"),
(else_try),
(eq,":team_faction_002","fac_kingdom_2"),
(assign,"$team_1_flag_scene_prop","spr_headquarters_flag_vaegir"),
(else_try),
(eq,":team_faction_002","fac_kingdom_3"),
(assign,"$team_1_flag_scene_prop","spr_headquarters_flag_khergit"),
(else_try),
(eq,":team_faction_002","fac_kingdom_4"),
(assign,"$team_1_flag_scene_prop","spr_headquarters_flag_nord"),
(else_try),
(eq,":team_faction_002","fac_kingdom_5"),
(assign,"$team_1_flag_scene_prop","spr_headquarters_flag_rhodok"),
(else_try),
(eq,":team_faction_002","fac_kingdom_6"),
(assign,"$team_1_flag_scene_prop","spr_headquarters_flag_sarranid"),
(try_end),
(else_try),
(team_get_faction, ":team_faction_002", 1),
(try_begin),
(eq,":team_faction_002","fac_kingdom_1"),
(assign,"$team_2_flag_scene_prop","spr_headquarters_flag_swadian"),
(else_try),
(eq,":team_faction_002","fac_kingdom_2"),
(assign,"$team_2_flag_scene_prop","spr_headquarters_flag_vaegir"),
(else_try),
(eq,":team_faction_002","fac_kingdom_3"),
(assign,"$team_2_flag_scene_prop","spr_headquarters_flag_khergit"),
(else_try),
(eq,":team_faction_002","fac_kingdom_4"),
(assign,"$team_2_flag_scene_prop","spr_headquarters_flag_nord"),
(else_try),
(eq,":team_faction_002","fac_kingdom_5"),
(assign,"$team_2_flag_scene_prop","spr_headquarters_flag_rhodok"),
(else_try),
(eq,":team_faction_002","fac_kingdom_6"),
(assign,"$team_2_flag_scene_prop","spr_headquarters_flag_sarranid"),
(try_end),
(try_begin),
(eq,":::team_1_flag_scene_prop",":::team_2_flag_scene_prop"),
(assign,"$team_2_flag_scene_prop","spr_headquarters_flag_rebel"),
(try_end),
(try_end),
(try_end),
]),

("calculate_flag_move_time", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(eq,":var001",0),
(store_mul, ":reg0", ":var002", 2500),
(else_try),
(eq,":var001",1),
(store_mul, ":reg0", ":var002", 500),
(else_try),
(eq,":var001",2),
(store_mul, ":reg0", ":var002", 300),
(else_try),
(eq,":var001",3),
(store_mul, ":reg0", ":var002", 195),
(else_try),
(eq,":var001",4),
(store_mul, ":reg0", ":var002", 137),
(else_try),
(eq,":var001",5),
(store_mul, ":reg0", ":var002", 102),
(else_try),
(eq,":var001",6),
(store_mul, ":reg0", ":var002", 82),
(else_try),
(eq,":var001",7),
(store_mul, ":reg0", ":var002", 66),
(else_try),
(eq,":var001",8),
(store_mul, ":reg0", ":var002", 59),
(else_try),
(store_mul, ":reg0", ":var002", 56),
(try_end),
(assign,":var003",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 0, ":max_players"),
(player_is_active, ":player_id_005"),
(val_add, ":var003", 1),
(try_end),
(try_begin),
(lt,":var003",10),
(val_mul, reg0, 50),
(else_try),
(lt,":var003",35),
(store_sub, ":var006", 35, ":var003"),
(val_mul, ":var006", 2),
(store_sub, ":var006", 100, ":var006"),
(val_mul, reg0, ":var006"),
(else_try),
(val_mul, reg0, 100),
(try_end),
(try_begin),
(eq,":::g_multiplayer_game_type",6),
(val_mul, reg0, 2),
(try_end),
(val_div, reg0, 10000),
]),

("move_death_mode_flags_down", [
(try_begin),
(eq,1,1),
(scene_prop_get_instance, ":scp_instance_001", "spr_headquarters_pole_code_only", 0),
(prop_instance_get_position, pos0, ":scp_instance_001"),
(position_move_z,0,-2000),
(prop_instance_set_position, ":scp_instance_001", 0),
(try_end),
(try_begin),
(eq,1,1),
(scene_prop_get_instance, ":scp_instance_002", "spr_headquarters_pole_code_only", 1),
(prop_instance_get_position, pos1, ":scp_instance_002"),
(position_move_z,1,-2000),
(prop_instance_set_position, ":scp_instance_002", 1),
(try_end),
(try_begin),
(eq,1,1),
(scene_prop_get_instance, ":scp_instance_001", "spr_headquarters_pole_code_only", 0),
(prop_instance_get_position, pos0, ":scp_instance_001"),
(scene_prop_get_instance, ":scp_instance_003", "$team_1_flag_scene_prop", 0),
(prop_instance_stop_animating, ":scp_instance_003"),
(position_move_z,0,100),
(prop_instance_set_position, ":scp_instance_003", 0),
(try_end),
(try_begin),
(eq,1,1),
(scene_prop_get_instance, ":scp_instance_002", "spr_headquarters_pole_code_only", 1),
(prop_instance_get_position, pos1, ":scp_instance_002"),
(scene_prop_get_instance, ":scp_instance_004", "$team_2_flag_scene_prop", 0),
(prop_instance_stop_animating, ":scp_instance_004"),
(position_move_z,1,100),
(prop_instance_set_position, ":scp_instance_004", 1),
(try_end),
]),

("move_flag", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(multiplayer_is_server),
(try_begin),
(eq,":var002",0),
(prop_instance_stop_animating, ":var001"),
(else_try),
(prop_instance_animate_to_position, ":var001", 0, ":var002"),
(try_end),
(try_end),
]),

("move_headquarters_flags", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(store_add, ":slot_no_004", 146, ":var001"),
(troop_get_slot,":troop_slot_005","trp_multiplayer_data",":slot_no_004"),
(scene_prop_get_num_instances, ":scp_num_instances_006", "spr_headquarters_flag_gray_code_only"),
(try_begin),
(eq,1,1),
(assign,":scp_visibility_007",0),
(try_begin),
(lt,":var001",":scp_num_instances_006"),
(scene_prop_get_instance, ":scp_instance_008", "spr_headquarters_flag_gray_code_only", ":var001"),
(scene_prop_get_visibility, ":scp_visibility_007", ":scp_instance_008"),
(try_end),
(try_end),
(try_begin),
(eq,":scp_visibility_007",1),
(assign,":var009",0),
(assign,":var010",":scp_instance_008"),
(else_try),
(scene_prop_get_num_instances, ":scp_num_instances_006", "$team_1_flag_scene_prop"),
(try_begin),
(eq,1,1),
(assign,":scp_visibility_007",0),
(try_begin),
(lt,":var001",":scp_num_instances_006"),
(scene_prop_get_instance, ":scp_instance_008", "$team_1_flag_scene_prop", ":var001"),
(scene_prop_get_visibility, ":scp_visibility_007", ":scp_instance_008"),
(try_end),
(try_end),
(try_begin),
(eq,":scp_visibility_007",1),
(assign,":var009",1),
(assign,":var010",":scp_instance_008"),
(else_try),
(scene_prop_get_num_instances, ":scp_num_instances_006", "$team_2_flag_scene_prop"),
(try_begin),
(eq,1,1),
(assign,":scp_visibility_007",0),
(try_begin),
(lt,":var001",":scp_num_instances_006"),
(scene_prop_get_instance, ":scp_instance_008", "$team_2_flag_scene_prop", ":var001"),
(scene_prop_get_visibility, ":scp_visibility_007", ":scp_instance_008"),
(try_end),
(try_end),
(try_begin),
(eq,":scp_visibility_007",1),
(assign,":var009",2),
(assign,":var010",":scp_instance_008"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(scene_prop_get_instance, ":scp_instance_011", "spr_headquarters_pole_code_only", ":var001"),
(try_end),
(try_begin),
(eq,":var009",":troop_slot_005"),
(try_begin),
(ge,":var002",1),
(ge,":var003",1),
(assign,":var012",0),
(else_try),
(eq,":var002",0),
(eq,":var003",0),
(assign,":var012",1),
(else_try),
(try_begin),
(ge,":var002",1),
(eq,":var003",0),
(eq,":troop_slot_005",1),
(assign,":var012",1),
(else_try),
(eq,":var002",0),
(ge,":var003",1),
(eq,":troop_slot_005",2),
(assign,":var012",1),
(else_try),
(assign,":var012",-1),
(try_end),
(try_end),
(else_try),
(try_begin),
(ge,":var002",1),
(ge,":var003",1),
(assign,":var012",0),
(else_try),
(eq,":var002",0),
(eq,":var003",0),
(assign,":var012",-1),
(else_try),
(try_begin),
(ge,":var002",1),
(eq,":var003",0),
(try_begin),
(eq,":var009",1),
(assign,":var012",1),
(else_try),
(neq,":troop_slot_005",1),
(assign,":var012",-1),
(try_end),
(else_try),
(eq,":var002",0),
(ge,":var003",1),
(try_begin),
(eq,":var009",2),
(assign,":var012",1),
(else_try),
(neq,":troop_slot_005",2),
(assign,":var012",-1),
(try_end),
(try_end),
(try_end),
(try_end),
(store_add, ":var013", ":var002", ":var003"),
(try_begin),
(eq,":var012",0),
(else_try),
(eq,":var012",1),
(prop_instance_get_position, pos1, ":var010"),
(prop_instance_get_position, pos0, ":scp_instance_011"),
(position_move_z,0,900),
(get_distance_between_positions,":distance_014",0,1),
(call_script, "script_calculate_flag_move_time", ":var013", ":distance_014"),
(else_try),
(eq,":var012",-1),
(prop_instance_get_position, pos1, ":var010"),
(prop_instance_get_position, pos0, ":scp_instance_011"),
(get_distance_between_positions,":distance_014",0,1),
(call_script, "script_calculate_flag_move_time", ":var013", ":distance_014"),
(try_end),
(call_script, "script_move_flag", ":var010", 0), # reg0
]),

("set_num_agents_around_flag", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_div, ":var___x1", ":var002", 100),
(assign,":var003",":var___x1"),
(store_mod,":var004",":var002",100),
(store_add, ":slot_no_005", 156, ":var001"),
(troop_set_slot,"trp_multiplayer_data",":slot_no_005",":var002"),
(call_script, "script_move_headquarters_flags", ":var001", ":var003", ":var004"),
]),

("change_flag_owner", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(lt,":var002",0),
(val_add, ":var002", 1),
(val_mul, ":var002", -1),
(try_end),
(store_div, ":var___x1", ":var002", 100),
(assign,":var003",":var___x1"),
(store_mod,":var004",":var002",100),
(store_add, ":slot_no_005", 146, ":var001"),
(troop_get_slot,":troop_slot_006","trp_multiplayer_data",":slot_no_005"),
(store_add, ":slot_no_005", 146, ":var001"),
(troop_set_slot,"trp_multiplayer_data",":slot_no_005",":var003"),
(try_begin),
(multiplayer_is_server),
(scene_prop_get_instance, ":scp_instance_007", "spr_headquarters_pole_code_only", ":var001"),
(try_begin),
(eq,":var003",0),
(neq,":troop_slot_006",-1),
(assign,":var008",1),
(try_begin),
(multiplayer_is_server),
(eq,":::g_placing_initial_flags",1),
(assign,":var008",0),
(try_end),
(try_begin),
(eq,":var008",1),
(prop_instance_get_position, pos0, ":scp_instance_007"),
(position_move_z,0,200),
(else_try),
(prop_instance_get_position, pos0, ":scp_instance_007"),
(position_move_z,0,900),
(try_end),
(try_end),
(scene_prop_get_instance, ":scp_instance_009", "$team_1_flag_scene_prop", ":var001"),
(prop_instance_stop_animating, ":scp_instance_009"),
(prop_instance_set_position, ":scp_instance_009", 0),
(scene_prop_get_instance, ":scp_instance_009", "$team_2_flag_scene_prop", ":var001"),
(prop_instance_stop_animating, ":scp_instance_009"),
(prop_instance_set_position, ":scp_instance_009", 0),
(scene_prop_get_instance, ":scp_instance_009", "spr_headquarters_flag_gray_code_only", ":var001"),
(prop_instance_stop_animating, ":scp_instance_009"),
(prop_instance_set_position, ":scp_instance_009", 0),
(try_end),
(try_begin),
(eq,":var004",0),
(scene_prop_get_instance, ":scp_instance_009", "$team_1_flag_scene_prop", ":var001"),
(scene_prop_set_visibility, ":scp_instance_009", 0),
(scene_prop_get_instance, ":scp_instance_009", "$team_2_flag_scene_prop", ":var001"),
(scene_prop_set_visibility, ":scp_instance_009", 0),
(scene_prop_get_instance, ":scp_instance_009", "spr_headquarters_flag_gray_code_only", ":var001"),
(scene_prop_set_visibility, ":scp_instance_009", 1),
(else_try),
(eq,":var004",1),
(scene_prop_get_instance, ":scp_instance_009", "$team_1_flag_scene_prop", ":var001"),
(scene_prop_set_visibility, ":scp_instance_009", 1),
(scene_prop_get_instance, ":scp_instance_009", "$team_2_flag_scene_prop", ":var001"),
(scene_prop_set_visibility, ":scp_instance_009", 0),
(scene_prop_get_instance, ":scp_instance_009", "spr_headquarters_flag_gray_code_only", ":var001"),
(scene_prop_set_visibility, ":scp_instance_009", 0),
(else_try),
(eq,":var004",2),
(scene_prop_get_instance, ":scp_instance_009", "$team_1_flag_scene_prop", ":var001"),
(scene_prop_set_visibility, ":scp_instance_009", 0),
(scene_prop_get_instance, ":scp_instance_009", "$team_2_flag_scene_prop", ":var001"),
(scene_prop_set_visibility, ":scp_instance_009", 1),
(scene_prop_get_instance, ":scp_instance_009", "spr_headquarters_flag_gray_code_only", ":var001"),
(scene_prop_set_visibility, ":scp_instance_009", 0),
(try_end),
(store_add, ":slot_no_010", 156, ":var001"),
(troop_get_slot,":troop_slot_011","trp_multiplayer_data",":slot_no_010"),
(store_div, ":var___x1", ":troop_slot_011", 100),
(assign,":var012",":var___x1"),
(store_mod,":var013",":troop_slot_011",100),
(call_script, "script_move_headquarters_flags", ":var001", ":var012", ":var013"),
]),

("move_object_to_nearest_entry_point", [
(store_script_param, ":var001", 1),
(scene_prop_get_num_instances, ":scp_num_instances_002", ":var001"),
(try_for_range, ":var003", 0, ":scp_num_instances_002"),
(scene_prop_get_instance, ":scp_instance_004", ":var001", ":var003"),
(prop_instance_get_position, pos0, ":scp_instance_004"),
(assign,":var005",-1),
(try_for_range, ":var006", 100, 110),
(entry_point_get_position, pos1, ":var006"),
(get_sq_distance_between_positions,":sq_distance_007",0,1),
(this_or_next|eq,":var005",-1),
(lt,":sq_distance_007",":var005"),
(assign,":var005",":sq_distance_007"),
(assign,":var008",":var006"),
(try_end),
(ge,":var005",0),
(lt,":var005",22500),
(entry_point_get_position, pos1, ":var008"),
(position_rotate_x,1,-90),
(prop_instance_animate_to_position, ":scp_instance_004", 1, 1),
(try_end),
]),

("multiplayer_server_on_agent_spawn_common", [
(store_script_param, ":agent_id_001", 1),
(agent_set_slot,":agent_id_001",21,-1),
(try_begin),
(agent_is_non_player, ":agent_id_001"),
(assign,"$g_multiplayer_ready_for_spawning_agent",1),
(else_try),
(call_script, "script_cf_multiplayer_can_buy_squad"),
(agent_get_player_id,":agent_player_id_002",":agent_id_001"),
(set_show_messages,0),
(team_give_order, ":agent_player_id_002", 9, 1),
(set_show_messages,1),
(try_end),
]),

("multiplayer_server_player_joined_common", [
(store_script_param, ":player_id_001", 1),
(try_begin),
(this_or_next|player_is_active, ":player_id_001"),
(eq,":player_id_001",0),
(call_script, "script_multiplayer_init_player_slots", ":player_id_001"),
(store_mission_timer_a,":m_timer_a_002"),
(player_set_slot,":player_id_001",21,":m_timer_a_002"),
(player_set_slot,":player_id_001",24,1),
(player_set_slot,":player_id_001",32,0),
(player_set_slot,":player_id_001",33,0),
(try_begin),
(multiplayer_is_server),
(assign,":gold_003",1000),
(val_mul, ":gold_003", ":::g_multiplayer_initial_gold_multiplier"),
(val_div, ":gold_003", 100),
(player_set_gold, ":player_id_001", ":gold_003"),
(call_script, "script_multiplayer_send_initial_information", ":player_id_001"),
(try_end),
(try_end),
]),

("multiplayer_server_before_mission_start_common", [
(try_begin),
(scene_allows_mounted_units),
(assign,"$g_horses_are_avaliable",1),
(try_begin),
(eq,":::g_multiplayer_game_type",8),
(store_current_scene,":cur_scene_001"),
(scene_get_slot,"$g_ccoop_disallow_horses",":cur_scene_001",1),
(eq,":::g_ccoop_disallow_horses",1),
(assign,"$g_horses_are_avaliable",0),
(try_end),
(else_try),
(assign,"$g_horses_are_avaliable",0),
(try_end),
(scene_set_day_time, 15),
(assign,"$g_multiplayer_mission_end_screen",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_003", 0, ":max_players"),
(player_is_active, ":player_id_003"),
(call_script, "script_multiplayer_init_player_slots", ":player_id_003"),
(assign,":gold_004",1000),
(val_mul, ":gold_004", ":::g_multiplayer_initial_gold_multiplier"),
(val_div, ":gold_004", 100),
(player_set_gold, ":player_id_003", ":gold_004"),
(player_set_slot,":player_id_003",24,1),
(try_end),
(call_script, "script_multiplayer_set_g_multiplayer_is_game_type_captain"),
]),

("multiplayer_server_on_agent_killed_or_wounded_common", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(call_script, "script_multiplayer_event_agent_killed_or_wounded", ":var001", ":var002"),
(try_begin),
(multiplayer_is_server),
(try_begin),
(lt,":var002",0),
(ge,":var001",0),
(neg|agent_is_non_player, ":var001"),
(agent_get_player_id,":agent_player_id_003",":var001"),
(try_begin),
(player_is_active, ":agent_player_id_003"),
(player_get_score, ":score_004", ":agent_player_id_003"),
(val_add, ":score_004", -1),
(call_script, "script_player_set_score", ":agent_player_id_003", ":score_004"),
(else_try),
(ge,":var002",0),
(ge,":var001",0),
(agent_get_team, ":agent_team_no_005", ":var002"),
(agent_get_team, ":agent_team_no_006", ":var001"),
(try_begin),
(eq,":agent_team_no_005",":agent_team_no_006"),
(neg|agent_is_non_player, ":var002"),
(agent_get_player_id,":agent_player_id_007",":var002"),
(try_begin),
(player_is_active, ":agent_player_id_007"),
(player_get_score, ":score_008", ":agent_player_id_007"),
(val_add, ":score_008", -1),
(call_script, "script_player_set_score", ":agent_player_id_007", ":score_008"),
(else_try),
(ge,":var002",0),
(ge,":var001",0),
(agent_is_human,":var001"),
(agent_is_human,":var002"),
(try_begin),
(eq,":::g_multiplayer_game_type",2),
(try_begin),
(eq,":::g_battle_death_mode_started",1),
(neq,":var001",":var002"),
(call_script, "script_calculate_new_death_waiting_time_at_death_mod"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(this_or_next|eq,":::g_multiplayer_game_type",3),
(eq,":::g_multiplayer_game_type",2),
(agent_get_player_id,":agent_player_id_009",":var001"),
(try_begin),
(ge,":agent_player_id_009",0),
(player_is_active, ":agent_player_id_009"),
(neg|agent_is_non_player, ":var001"),
(try_for_agents, ":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_get_group, ":agent_group_011", ":cur_agent"),
(eq,":agent_player_id_009",":agent_group_011"),
(agent_set_group, ":cur_agent", -1),
(try_end),
(try_end),
(try_end),
(try_end),
(neg|agent_is_non_player, ":var002"),
(agent_get_player_id,":agent_player_id_007",":var002"),
(try_begin),
(player_is_active, ":agent_player_id_007"),
(player_get_score, ":score_008", ":agent_player_id_007"),
(agent_get_team, ":agent_team_no_012", ":var002"),
(agent_get_team, ":agent_team_no_013", ":var001"),
(try_begin),
(neq,":agent_team_no_012",":agent_team_no_013"),
(val_add, ":score_008", 1),
(else_try),
(val_add, ":score_008", -1),
(try_end),
(try_end),
(try_end),
(call_script, "script_player_set_score", ":agent_player_id_007", ":score_008"),
(try_end),
(try_begin),
(eq,":::g_multiplayer_is_game_type_captain",1),
(ge,":var001",0),
(neg|agent_is_non_player, ":var001"),
(agent_get_team, ":agent_team_no_006", ":var001"),
(agent_get_player_id,":agent_player_id_009",":var001"),
(try_begin),
(player_is_active, ":agent_player_id_009"),
(set_show_messages,0),
(team_give_order, ":agent_player_id_009", 9, 2),
(team_give_order, ":agent_player_id_009", 9, 13),
(team_give_order, ":agent_player_id_009", 9, 10),
(set_show_messages,1),
(try_end),
(try_end),
(call_script, "script_add_kill_death_counts", ":var002", ":var001"),
(call_script, "script_money_management_after_agent_death", ":var002", ":var001"),
]),

("multiplayer_close_gate_if_it_is_open", [
(scene_prop_get_num_instances, ":scp_num_instances_001", "spr_winch_b"),
(try_for_range, ":var002", 0, ":scp_num_instances_001"),
(scene_prop_get_instance, ":scp_instance_003", "spr_winch_b", ":var002"),
(try_begin),
(scene_prop_slot_eq,":scp_instance_003",1,1),
(scene_prop_get_instance, ":scp_instance_004", "spr_portcullis", ":var002"),
(prop_instance_get_starting_position, pos0, ":scp_instance_004"),
(prop_instance_animate_to_position, ":scp_instance_004", 0, 1),
(try_end),
(try_end),
]),

("multiplayer_move_moveable_objects_initial_positions", [
(call_script, "script_move_object_to_nearest_entry_point", "spr_siege_ladder_move_6m"),
(call_script, "script_move_object_to_nearest_entry_point", "spr_siege_ladder_move_8m"),
(call_script, "script_move_object_to_nearest_entry_point", "spr_siege_ladder_move_10m"),
(call_script, "script_move_object_to_nearest_entry_point", "spr_siege_ladder_move_12m"),
(call_script, "script_move_object_to_nearest_entry_point", "spr_siege_ladder_move_14m"),
]),

("move_belfries_to_their_first_entry_point", [
(store_script_param, ":var001", 1),
(set_fixed_point_multiplier, 100),
(scene_prop_get_num_instances, ":scp_num_instances_002", ":var001"),
(try_for_range, ":var003", 0, ":scp_num_instances_002"),
(scene_prop_get_instance, ":scp_instance_004", ":var001", ":var003"),
(prop_instance_get_position, pos0, ":scp_instance_004"),
(try_begin),
(eq,":var001","spr_belfry_a"),
(scene_prop_get_instance, ":scp_instance_005", "spr_belfry_platform_a", ":var003"),
(scene_prop_get_instance, ":scp_instance_006", "spr_belfry_platform_b", ":var003"),
(else_try),
(scene_prop_get_instance, ":scp_instance_005", "spr_belfry_b_platform_a", ":var003"),
(try_end),
(store_mul, ":var007", ":var003", 3),
(try_begin),
(eq,":var001","spr_belfry_b"),
(scene_prop_get_num_instances, ":scp_num_instances_008", "spr_belfry_a"),
(store_mul, ":var009", ":scp_num_instances_008", 3),
(val_add, ":var007", ":var009"),
(try_end),
(scene_prop_get_instance, ":scp_instance_010", "spr_belfry_wheel", ":var007"),
(val_add, ":var007", 1),
(scene_prop_get_instance, ":scp_instance_011", "spr_belfry_wheel", ":var007"),
(val_add, ":var007", 1),
(scene_prop_get_instance, ":scp_instance_012", "spr_belfry_wheel", ":var007"),
(store_add, ":var013", 11, ":var003"),
(try_begin),
(eq,":var001","spr_belfry_b"),
(scene_prop_get_num_instances, ":scp_num_instances_008", "spr_belfry_a"),
(val_add, ":var013", ":scp_num_instances_008"),
(try_end),
(val_mul, ":var013", 10),
(entry_point_get_position, pos1, ":var013"),
(init_position,9),
(position_set_y,9,-500),
(position_set_x,9,-300),
(position_transform_position_to_parent,10,1,9),
(position_get_distance_to_terrain, ":distance_to_terrain_014", 10),
(init_position,9),
(position_set_y,9,-500),
(position_set_x,9,300),
(position_transform_position_to_parent,10,1,9),
(position_get_distance_to_terrain, ":distance_to_terrain_015", 10),
(store_add, ":var016", ":distance_to_terrain_014", ":distance_to_terrain_015"),
(val_mul, ":var016", 100),
(store_div, ":var___x1", ":var016", 24),
(assign,":var017",":var___x1"),
(init_position,20),
(position_rotate_x_floating,20,":var017"),
(position_transform_position_to_parent,23,1,20),
(init_position,9),
(position_set_x,9,-300),
(position_transform_position_to_parent,10,1,9),
(position_get_distance_to_terrain, ":distance_to_terrain_018", 10),
(init_position,9),
(position_set_x,9,300),
(position_transform_position_to_parent,10,1,9),
(position_get_distance_to_terrain, ":distance_to_terrain_019", 10),
(store_sub, ":distance_to_terrain_014", ":distance_to_terrain_018", ":distance_to_terrain_019"),
(init_position,9),
(position_set_x,9,-300),
(position_set_y,9,-500),
(position_transform_position_to_parent,10,1,9),
(position_get_distance_to_terrain, ":distance_to_terrain_018", 10),
(init_position,9),
(position_set_x,9,300),
(position_set_y,9,-500),
(position_transform_position_to_parent,10,1,9),
(position_get_distance_to_terrain, ":distance_to_terrain_019", 10),
(store_sub, ":distance_to_terrain_015", ":distance_to_terrain_018", ":distance_to_terrain_019"),
(store_add, ":var016", ":distance_to_terrain_014", ":distance_to_terrain_015"),
(val_mul, ":var016", 100),
(store_div, ":var___x1", ":var016", 24),
(assign,":var017",":var___x1"),
(val_mul, ":var017", -1),
(init_position,20),
(position_rotate_y_floating,20,":var017"),
(position_transform_position_to_parent,22,23,20),
(copy_position,1,22),
(prop_instance_stop_animating, ":scp_instance_004"),
(prop_instance_set_position, ":scp_instance_004", 1),
(try_begin),
(eq,":var001","spr_belfry_a"),
(prop_instance_get_position, pos6, ":scp_instance_005"),
(position_transform_position_to_local, 7,0,6),
(position_transform_position_to_parent,8,1,7),
(try_begin),
(neg|scene_prop_slot_eq,":scp_instance_004",5,0),
(init_position,20),
(position_rotate_x,20,90),
(position_transform_position_to_parent,8,8,20),
(try_end),
(prop_instance_stop_animating, ":scp_instance_005"),
(prop_instance_set_position, ":scp_instance_005", 8),
(prop_instance_get_position, pos6, ":scp_instance_006"),
(position_transform_position_to_local, 7,0,6),
(position_transform_position_to_parent,8,1,7),
(prop_instance_stop_animating, ":scp_instance_006"),
(prop_instance_set_position, ":scp_instance_006", 8),
(else_try),
(prop_instance_get_position, pos6, ":scp_instance_005"),
(position_transform_position_to_local, 7,0,6),
(position_transform_position_to_parent,8,1,7),
(try_begin),
(neg|scene_prop_slot_eq,":scp_instance_004",5,0),
(init_position,20),
(position_rotate_x,20,50),
(position_transform_position_to_parent,8,8,20),
(try_end),
(prop_instance_stop_animating, ":scp_instance_005"),
(prop_instance_set_position, ":scp_instance_005", 8),
(try_end),
(store_mul, ":var007", ":var003", 3),
(try_begin),
(eq,":var001","spr_belfry_b"),
(scene_prop_get_num_instances, ":scp_num_instances_008", "spr_belfry_a"),
(store_mul, ":var009", ":scp_num_instances_008", 3),
(val_add, ":var007", ":var009"),
(try_end),
(prop_instance_get_position, pos6, ":scp_instance_010"),
(position_transform_position_to_local, 7,0,6),
(position_transform_position_to_parent,8,1,7),
(prop_instance_stop_animating, ":scp_instance_010"),
(prop_instance_set_position, ":scp_instance_010", 8),
(prop_instance_get_position, pos6, ":scp_instance_011"),
(position_transform_position_to_local, 7,0,6),
(position_transform_position_to_parent,8,1,7),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 8),
(prop_instance_get_position, pos6, ":scp_instance_012"),
(position_transform_position_to_local, 7,0,6),
(position_transform_position_to_parent,8,1,7),
(prop_instance_stop_animating, ":scp_instance_012"),
(prop_instance_set_position, ":scp_instance_012", 8),
(try_end),
]),

("team_set_score", [
(store_script_param, ":team_id_001", 1),
(store_script_param, ":team_score_002", 2),
(call_script, "script_team_set_score", ":team_id_001", ":team_score_002"),
]),

("player_set_score", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":score_002", 2),
(call_script, "script_player_set_score", ":player_id_001", ":score_002"),
]),

("player_set_kill_count", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":kill_count_002", 2),
(call_script, "script_player_set_kill_count", ":player_id_001", ":kill_count_002"),
]),

("player_set_death_count", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":death_count_002", 2),
(call_script, "script_player_set_death_count", ":player_id_001", ":death_count_002"),
]),

("set_attached_scene_prop", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(eq,1,1),
(scene_prop_get_instance, ":scp_instance_003", "spr_tutorial_flag_red", 0),
(scene_prop_get_instance, ":scp_instance_004", "spr_tutorial_flag_blue", 0),
(assign,":team_id_005",-1),
(try_begin),
(ge,":scp_instance_003",0),
(eq,":var002",":scp_instance_003"),
(assign,":team_id_005",0),
(else_try),
(ge,":scp_instance_004",0),
(eq,":var002",":scp_instance_004"),
(assign,":team_id_005",1),
(try_end),
(try_begin),
(ge,":team_id_005",0),
(team_set_slot,":team_id_005",0,1),
(try_end),
(try_end),
(agent_set_attached_scene_prop, ":var001", ":var002"),
(agent_set_attached_scene_prop_x, ":var001", 20),
(agent_set_attached_scene_prop_z, ":var001", 50),
]),

("set_team_flag_situation", [
(store_script_param, ":team_id_001", 1),
(store_script_param, ":var002", 2),
(team_set_slot,":team_id_001",0,":var002"),
]),

("start_death_mode", [
(assign,"$g_multiplayer_message_type",18),
(start_presentation, ":"),
]),

("calculate_new_death_waiting_time_at_death_mod", [
(assign,":var001",0),
(try_begin),
(eq,1,1),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(val_add, ":var001", 1),
(try_end),
(try_end),
(val_add, ":var001", 15),
(set_fixed_point_multiplier, 100),
(store_mul, ":var001", ":var001", 100),
(store_sqrt, ":var003", ":var001"),
(store_div, ":var___x1", 18000, ":var003"),
(assign,"$g_battle_waiting_seconds",":var___x1"),
(store_mission_timer_a,"$g_death_mode_part_1_start_time"),
]),

("calculate_number_of_targets_destroyed", [
(assign,"$g_number_of_targets_destroyed",0),
(scene_prop_get_num_instances, ":scp_num_instances_001", "spr_catapult_destructible"),
(try_for_range, ":var002", 0, ":scp_num_instances_001"),
(scene_prop_get_instance, ":scp_instance_003", "spr_catapult_destructible", ":var002"),
(prop_instance_get_starting_position, pos0, ":scp_instance_003"),
(prop_instance_get_position, pos1, ":scp_instance_003"),
(get_sq_distance_between_positions_in_meters,":sq_distance_004",0,1),
(try_begin),
(gt,":sq_distance_004",2),
(val_add, ":::g_number_of_targets_destroyed", 1),
(try_end),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_001", "spr_trebuchet_destructible"),
(try_for_range, ":var002", 0, ":scp_num_instances_001"),
(scene_prop_get_instance, ":scp_instance_003", "spr_trebuchet_destructible", ":var002"),
(prop_instance_get_starting_position, pos0, ":scp_instance_003"),
(prop_instance_get_position, pos1, ":scp_instance_003"),
(get_sq_distance_between_positions_in_meters,":sq_distance_004",0,1),
(try_begin),
(gt,":sq_distance_004",2),
(val_add, ":::g_number_of_targets_destroyed", 1),
(try_end),
(try_end),
]),

("initialize_objects", [
(assign,":var001",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_003", 0, ":max_players"),
(player_is_active, ":player_id_003"),
(val_add, ":var001", 1),
(try_end),
(set_fixed_point_multiplier, 100),
(val_mul, ":var001", 100),
(store_sqrt, ":var001", ":var001"),
(val_sub, ":var001", 100),
(val_max,":var001",0),
(store_mul, ":var004", ":var001", 2),
(store_add, ":var005", 1200, ":var004"),
(store_mul, ":var006", ":var005", 15),
(val_div, ":var006", 10),
(store_mul, ":var007", ":var005", 18),
(val_div, ":var007", 10),
(store_mul, ":var008", ":var007", 2),
(assign,"$g_number_of_targets_destroyed",0),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_catapult_destructible"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_catapult_destructible", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var005"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_trebuchet_destructible"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_trebuchet_destructible", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var006"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_castle_e_sally_door_a"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_castle_e_sally_door_a", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var007"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_castle_f_sally_door_a"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_castle_f_sally_door_a", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var007"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_earth_sally_gate_left"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_earth_sally_gate_left", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var008"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_earth_sally_gate_right"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_earth_sally_gate_right", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var008"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_viking_keep_destroy_sally_door_left"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_viking_keep_destroy_sally_door_left", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var007"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_viking_keep_destroy_sally_door_right"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_viking_keep_destroy_sally_door_right", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var007"),
(try_end),
(store_div, ":var___x1", ":var007", 3),
(assign,":var012",":var___x1"),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_castle_f_door_a"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_castle_f_door_a", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var012"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_castle_f_door_b"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_castle_f_door_b", ":var010"),
(prop_instance_get_starting_position, pos0, ":scp_instance_011"),
(prop_instance_stop_animating, ":scp_instance_011"),
(prop_instance_set_position, ":scp_instance_011", 0),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var012"),
(try_end),
]),

("initialize_objects_clients", [
(assign,":var001",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_003", 0, ":max_players"),
(player_is_active, ":player_id_003"),
(val_add, ":var001", 1),
(try_end),
(set_fixed_point_multiplier, 100),
(val_mul, ":var001", 100),
(store_sqrt, ":var001", ":var001"),
(val_sub, ":var001", 100),
(val_max,":var001",0),
(store_mul, ":var004", ":var001", 2),
(store_add, ":var005", 1200, ":var004"),
(store_mul, ":var006", ":var005", 15),
(val_div, ":var006", 10),
(store_mul, ":var007", ":var005", 18),
(val_div, ":var007", 10),
(store_mul, ":var008", ":var007", 2),
(assign,"$g_number_of_targets_destroyed",0),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_catapult_destructible"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_catapult_destructible", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var005"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_trebuchet_destructible"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_trebuchet_destructible", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var006"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_castle_e_sally_door_a"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_castle_e_sally_door_a", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var007"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_castle_f_sally_door_a"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_castle_f_sally_door_a", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var007"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_earth_sally_gate_left"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_earth_sally_gate_left", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var008"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_earth_sally_gate_right"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_earth_sally_gate_right", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var008"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_viking_keep_destroy_sally_door_left"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_viking_keep_destroy_sally_door_left", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var007"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_viking_keep_destroy_sally_door_right"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_viking_keep_destroy_sally_door_right", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var007"),
(try_end),
(store_div, ":var___x1", ":var007", 3),
(assign,":var012",":var___x1"),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_castle_f_door_a"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_castle_f_door_a", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var012"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_009", "spr_castle_f_door_b"),
(try_for_range, ":var010", 0, ":scp_num_instances_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_castle_f_door_b", ":var010"),
(prop_instance_enable_physics, ":scp_instance_011", 1),
(scene_prop_set_hit_points, ":scp_instance_011", ":var012"),
(try_end),
]),

("show_multiplayer_message", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,"$g_multiplayer_message_type",":var001"),
(try_begin),
(eq,":var001",12),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(try_begin),
(neg|multiplayer_is_server),
(assign,"$g_battle_death_mode_started",0),
(try_end),
(else_try),
(eq,":var001",2),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(assign,"$g_team_balance_next_round",0),
(else_try),
(eq,":var001",3),
(assign,"$g_team_balance_next_round",1),
(call_script, "script_warn_player_about_auto_team_balance"),
(else_try),
(eq,":var001",11),
(assign,"$g_team_balance_next_round",0),
(else_try),
(eq,":var001",4),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(else_try),
(eq,":var001",5),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(else_try),
(eq,":var001",6),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(else_try),
(eq,":var001",7),
(assign,"$g_multiplayer_message_value_3",":var002"),
(start_presentation, ":"),
(else_try),
(eq,":var001",8),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(else_try),
(eq,":var001",9),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(else_try),
(eq,":var001",10),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(else_try),
(eq,":var001",14),
(start_presentation, ":"),
(else_try),
(eq,":var001",15),
(try_begin),
(eq,":::g_defender_team",0),
(assign,":team_id_003",1),
(else_try),
(assign,":team_id_003",0),
(try_end),
(team_get_score, ":team_score_004", ":team_id_003"),
(val_add, ":team_score_004", 1),
(call_script, "script_team_set_score", ":team_id_003", ":team_score_004"),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(else_try),
(eq,":var001",16),
(assign,"$g_multiplayer_message_value_1",":var002"),
(start_presentation, ":"),
(else_try),
(eq,":var001",17),
(try_begin),
(eq,":::g_defender_team",0),
(assign,"$g_multiplayer_message_value_1",1),
(else_try),
(assign,"$g_multiplayer_message_value_1",0),
(try_end),
(start_presentation, ":"),
(try_end),
]),

("get_headquarters_scores", [
(assign,":var001",0),
(assign,":var002",0),
(try_for_range, ":var003", 0, ":::g_number_of_flags"),
(store_add, ":slot_no_004", 146, ":var003"),
(troop_get_slot,":troop_slot_005","trp_multiplayer_data",":slot_no_004"),
(try_begin),
(neq,":troop_slot_005",0),
(try_begin),
(eq,":troop_slot_005",1),
(val_add, ":var001", 1),
(else_try),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var001"),
(assign,reg1,":var002"),
]),

("draw_this_round", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,":var001",-9),
(assign,"$g_round_ended",1),
(store_mission_timer_a,"$g_round_finish_time"),
(else_try),
(eq,":var001",-1),
(assign,"$g_round_ended",1),
(store_mission_timer_a,"$g_round_finish_time"),
(assign,"$g_multiplayer_message_value_1",-1),
(assign,"$g_multiplayer_message_type",14),
(start_presentation, ":"),
(else_try),
(eq,":var001",0),
(try_begin),
(eq,":::g_multiplayer_game_type",6),
(multiplayer_get_my_player, ":my_player"),
(try_begin),
(is_between,":my_player",0,1000),
(player_get_agent_id, ":agent_id_003", ":my_player"),
(try_begin),
(ge,":agent_id_003",0),
(agent_is_alive,":agent_id_003"),
(agent_get_team, ":agent_team_no_004", ":agent_id_003"),
(try_begin),
(eq,":agent_team_no_004",0),
(unlock_achievement, 56),
(try_end),
(try_end),
(try_end),
(try_end),
(assign,"$g_round_ended",1),
(store_mission_timer_a,"$g_round_finish_time"),
(team_get_faction, ":team_faction_005", 0),
(team_get_score, ":team_score_006", 0),
(val_add, ":team_score_006", 1),
(call_script, "script_team_set_score", 0, ":team_score_006"),
(assign,"$g_winner_team",0),
(str_store_string,s1,":str_store_faction_name(team_faction_005)"),
(assign,"$g_multiplayer_message_value_1",":var001"),
(try_begin),
(neq,":::g_multiplayer_game_type",2),
(neq,":::g_multiplayer_game_type",3),
(assign,"$g_multiplayer_message_type",13),
(else_try),
(assign,"$g_multiplayer_message_type",12),
(try_end),
(start_presentation, ":"),
(else_try),
(eq,":var001",1),
(assign,"$g_round_ended",1),
(store_mission_timer_a,"$g_round_finish_time"),
(team_get_faction, ":team_faction_005", 1),
(team_get_score, ":team_score_007", 1),
(val_add, ":team_score_007", 1),
(call_script, "script_team_set_score", 1, ":team_score_007"),
(assign,"$g_winner_team",1),
(str_store_string,s1,":str_store_faction_name(team_faction_005)"),
(assign,"$g_multiplayer_message_value_1",":var001"),
(try_begin),
(neq,":::g_multiplayer_game_type",2),
(neq,":::g_multiplayer_game_type",3),
(assign,"$g_multiplayer_message_type",13),
(else_try),
(assign,"$g_multiplayer_message_type",12),
(try_end),
(start_presentation, ":"),
(try_end),
(try_begin),
(is_between,":var001",0,2),
(try_begin),
(eq,":::g_multiplayer_game_type",2),
(multiplayer_get_my_player, ":my_player"),
(is_between,":my_player",0,1000),
(player_get_agent_id, ":agent_id_003", ":my_player"),
(ge,":agent_id_003",0),
(agent_is_alive,":agent_id_003"),
(agent_get_team, ":agent_team_no_004", ":agent_id_003"),
(eq,":agent_team_no_004",":var001"),
(unlock_achievement, 62),
(try_end),
(try_end),
]),

("check_achievement_last_man_standing", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,1,1),
(try_begin),
(is_between,":var001",0,2),
(eq,":::g_multiplayer_game_type",2),
(multiplayer_get_my_player, ":my_player"),
(is_between,":my_player",0,1000),
(player_get_agent_id, ":agent_id_003", ":my_player"),
(ge,":agent_id_003",0),
(agent_is_alive,":agent_id_003"),
(agent_get_team, ":agent_team_no_004", ":agent_id_003"),
(eq,":agent_team_no_004",":var001"),
(unlock_achievement, 62),
(try_end),
(try_end),
]),

("find_most_suitable_bot_to_control", [
(store_script_param, ":player_id_001", 1),
(set_fixed_point_multiplier, 100),
(player_get_team_no,  ":team_no_002", ":player_id_001"),
(player_get_slot,":player_slot_003",":player_id_001",29),
(player_get_slot,":player_slot_004",":player_id_001",30),
(player_get_slot,":player_slot_005",":player_id_001",31),
(init_position,0),
(position_set_x,0,":player_slot_003"),
(position_set_y,0,":player_slot_004"),
(position_set_z,0,":player_slot_005"),
(assign,":var006",-1),
(assign,":var007",-1),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_get_team, ":agent_team_no_009", ":cur_agent"),
(try_begin),
(eq,":agent_team_no_009",":team_no_002"),
(agent_get_position,pos1,":cur_agent"),
(get_distance_between_positions_in_meters,":distance_010",0,1),
(try_begin),
(lt,":distance_010",500),
(store_sub, ":var011", 500, ":distance_010"),
(else_try),
(assign,":var011",0),
(try_end),
(try_end),
(val_mul, ":var011", 6),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(eq,1,0),
(agent_get_team, ":agent_team_no_013", ":cur_agent"),
(try_begin),
(neq,":agent_team_no_013",":team_no_002"),
(agent_get_position,pos1,":cur_agent"),
(get_distance_between_positions,":distance_014",0,1),
(try_begin),
(lt,":distance_014",300),
(assign,":var015",":distance_014"),
(else_try),
(assign,":var015",300),
(try_end),
(try_end),
(val_add, ":var011", ":var015"),
(else_try),
(agent_get_position,pos1,":cur_agent"),
(get_distance_between_positions,":distance_014",0,1),
(try_begin),
(lt,":distance_014",300),
(assign,":var016",300),
(else_try),
(assign,":var016",0),
(try_end),
(val_add, ":var011", ":var016"),
(try_end),
set absolute to 1 to retrieve actual hps, ":cur_agent",
(val_mul, ":agent_hit_points_017", 2),
(val_add, ":var011", ":agent_hit_points_017"),
(try_begin),
(ge,":var011",":var007"),
(assign,":var007",":var011"),
(assign,":var006",":cur_agent"),
(try_end),
(try_end),
(assign,reg0,":var006"),
]),

("game_receive_url_response", [
]),

("game_get_cheat_mode", [
(assign,reg0,"$cheat_mode"),
]),

("game_receive_network_message", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":slot_no_003", 3),
(store_script_param, ":var089", 4),
(store_script_param, ":var090", 5),
(store_script_param, ":var091", 6),
(store_script_param, ":var092", 7),
(try_begin),
(eq,":var002",0),
(try_begin),
(is_between,":slot_no_003",2,11),
(assign,":var005",0),
(try_begin),
(eq,":item_id_004",-1),
(assign,":var005",1),
(else_try),
(ge,":item_id_004",0),
(player_get_troop_id, ":troop_id_006", ":player_id_001"),
(try_begin),
(is_between,":troop_id_006","trp_swadian_crossbowman_multiplayer","trp_multiplayer_end"),
(store_sub, ":slot_no_007", ":troop_id_006", ":trp.swadian_crossbowman_multiplayer"),
(val_add, ":slot_no_007", 61),
(item_get_slot,":item_slot_008",":item_id_004",":slot_no_007"),
(try_begin),
(gt,":item_slot_008",0),
(assign,":var005",1),
(try_begin),
(neq,":::g_horses_are_avaliable",1),
(item_get_slot,":item_slot_009",":item_id_004",60),
(try_begin),
(is_between,":item_slot_009",18,19),
(assign,":var005",0),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":::g_multiplayer_disallow_ranged_weapons",1),
(item_get_slot,":item_slot_009",":item_id_004",60),
(try_begin),
(is_between,":item_slot_009",12,18),
(assign,":var005",0),
(try_end),
(try_end),
(try_end),
(eq,":var005",1),
(player_set_slot,":player_id_001",":slot_no_003",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",1),
(try_begin),
(is_between,":slot_no_003",35,39),
(is_between,":item_id_004",0,2),
(player_set_slot,":player_id_001",":slot_no_003",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",19),
(try_begin),
(eq,1,1),
(player_get_team_no,  ":team_no_010", ":player_id_001"),
(try_begin),
(neq,":team_no_010",":item_id_004"),
(try_begin),
(call_script, "script_cf_multiplayer_team_is_available", ":player_id_001", ":item_id_004"),
(player_set_troop_id, ":player_id_001", -1),
(player_get_team_no,  ":player_id_001", ":item_id_004"),
(try_begin),
(neq,":item_id_004",2),
(neq,":item_id_004",3),
(store_mission_timer_a,":m_timer_a_011"),
(player_set_slot,":player_id_001",28,":m_timer_a_011"),
(multiplayer_send_message_to_player, ":player_id_001", 66),
(try_end),
(try_end),
(else_try),
(multiplayer_send_message_to_player, ":player_id_001", 67),
(try_end),
(try_end),
(else_try),
(eq,":var002",20),
(try_begin),
(eq,":item_id_004",-1),
(player_set_troop_id, ":player_id_001", -1),
(else_try),
(is_between,":item_id_004","trp_swadian_crossbowman_multiplayer","trp_multiplayer_end"),
(player_get_team_no,  ":team_no_010", ":player_id_001"),
(try_begin),
(is_between,":team_no_010",0,2),
(team_get_faction, ":team_faction_012", ":team_no_010"),
(store_troop_faction,":troop_faction_013",":item_id_004"),
(try_begin),
(eq,":troop_faction_013",":team_faction_012"),
(player_set_troop_id, ":player_id_001", ":item_id_004"),
(call_script, "script_multiplayer_clear_player_selected_items", ":player_id_001"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",2),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004","scn_multi_scene_1","scn_multiplayer_maps_end"),
(is_between,":player_id_014",0,9),
(server_get_changing_game_type_allowed, "$g_multiplayer_changing_game_type_allowed"),
(try_begin),
(this_or_next|eq,":::g_multiplayer_changing_game_type_allowed",1),
(eq,":::g_multiplayer_game_type",":player_id_014"),
(call_script, "script_multiplayer_fill_map_game_types", ":player_id_014"),
(assign,":var015",reg0),
(assign,":var016",0),
(store_add, ":var017", 0, ":var015"),
(try_for_range, ":var018", 0, ":var017"),
(troop_slot_eq,"trp_multiplayer_data",":var018",":item_id_004"),
(assign,":var016",1),
(assign,":var017",0),
(try_end),
(try_end),
(try_begin),
(eq,":var016",1),
(assign,"$g_multiplayer_game_type",":player_id_014"),
(call_script, "script_multiplayer_set_g_multiplayer_is_game_type_captain"),
(assign,"$g_multiplayer_selected_map",":item_id_004"),
(team_set_faction, 0, "$g_multiplayer_next_team_1_faction"),
(team_set_faction, 1, "$g_multiplayer_next_team_2_faction"),
(call_script, "script_game_multiplayer_get_game_type_mission_template", "$g_multiplayer_game_type"),
(try_begin),
(neq,":::g_multiplayer_game_type",8),
(neg|is_between,"$g_multiplayer_next_team_2_faction","fac_player_supporters_faction","fac_kingdoms_end"),
(team_set_faction, 1, "fac_kingdom_1"),
(try_end),
(try_end),
(start_multiplayer_mission, reg0, "$g_multiplayer_selected_map", 1),
(try_end),
(else_try),
(eq,":var002",3),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",2,201),
(try_begin),
(eq,":::g_multiplayer_game_type",8),
(val_min,":item_id_004",12),
(try_end),
(server_set_max_num_players, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",4),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",1,3),
(is_between,":player_id_014",0,"$g_multiplayer_max_num_bots"),
(try_begin),
(eq,":item_id_004",1),
(assign,"$g_multiplayer_num_bots_team_1",":player_id_014"),
(else_try),
(assign,"$g_multiplayer_num_bots_team_2",":player_id_014"),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_2_int_to_player, ":player_id_020", 51, ":item_id_004", ":player_id_014"),
(try_end),
(try_end),
(else_try),
(eq,":var002",44),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(server_set_anti_cheat, 0),
(try_end),
(else_try),
(eq,":var002",5),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(server_set_friendly_fire, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",39),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(server_set_melee_friendly_fire, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",40),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,101),
(server_set_friendly_fire_damage_self_ratio, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",41),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,101),
(server_set_friendly_fire_damage_friend_ratio, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",6),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,4),
(server_set_ghost_mode, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",7),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(server_set_control_block_dir, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",29),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,5),
(server_set_combat_speed, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",30),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,6),
(assign,"$g_multiplayer_number_of_respawn_count",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 88, ":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",8),
(try_begin),
(player_is_admin, ":player_id_001"),
(server_set_add_to_game_servers_list, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",9),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",3,31),
(assign,"$g_multiplayer_respawn_period",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 57, ":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",10),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",5,121),
(assign,"$g_multiplayer_game_max_minutes",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",11),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",60,901),
(assign,"$g_multiplayer_round_max_seconds",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 59, ":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",28),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(assign,"$g_multiplayer_player_respawn_as_bot",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 85, ":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",12),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",3,1001),
(assign,"$g_multiplayer_game_max_points",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",13),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",25,401),
(assign,"$g_multiplayer_point_gained_from_flags",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",14),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,11),
(assign,"$g_multiplayer_point_gained_from_capturing_flag",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",36),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,1001),
(assign,"$g_multiplayer_initial_gold_multiplier",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",37),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,1001),
(assign,"$g_multiplayer_battle_earnings_multiplier",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",38),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,1001),
(assign,"$g_multiplayer_round_earnings_multiplier",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",15),
(try_begin),
(player_is_admin, ":player_id_001"),
(server_get_renaming_server_allowed, "$g_multiplayer_renaming_server_allowed"),
(try_begin),
(eq,":::g_multiplayer_renaming_server_allowed",1),
(server_set_name, 0),
(try_end),
(try_end),
(else_try),
(eq,":var002",16),
(try_begin),
(player_is_admin, ":player_id_001"),
(server_set_password, 0),
(try_end),
(else_try),
(eq,":var002",35),
(try_begin),
(player_is_admin, ":player_id_001"),
(server_set_welcome_message, 0),
(try_end),
(else_try),
(eq,":var002",17),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",1,3),
(try_begin),
(eq,":item_id_004",1),
(is_between,":player_id_014","fac_kingdom_1","fac_kingdoms_end"),
(assign,"$g_multiplayer_next_team_1_faction",":player_id_014"),
(else_try),
(this_or_next|is_between,":player_id_014","fac_kingdom_1","fac_kingdoms_end"),
(this_or_next|eq,":player_id_014","fac_outlaws"),
(eq,":player_id_014","fac_ccoop_all_stars"),
(assign,"$g_multiplayer_next_team_2_faction",":player_id_014"),
(try_end),
(try_end),
(else_try),
(eq,":var002",45),
(try_begin),
(eq,1,1),
(server_get_max_num_players, ":server_max_players"),
(multiplayer_send_int_to_player, ":player_id_001", 50, ":server_max_players"),
(multiplayer_send_2_int_to_player, ":player_id_001", 84, 1, "$g_multiplayer_next_team_1_faction"),
(multiplayer_send_2_int_to_player, ":player_id_001", 84, 2, "$g_multiplayer_next_team_2_faction"),
(multiplayer_send_2_int_to_player, ":player_id_001", 51, 1, "$g_multiplayer_num_bots_team_1"),
(multiplayer_send_2_int_to_player, ":player_id_001", 51, 2, "$g_multiplayer_num_bots_team_2"),
(server_get_anti_cheat, ":server_anti_cheat"),
(multiplayer_send_int_to_player, ":player_id_001", 104, ":server_anti_cheat"),
(server_get_friendly_fire, ":server_friendly_fire"),
(multiplayer_send_int_to_player, ":player_id_001", 52, ":server_friendly_fire"),
(server_get_melee_friendly_fire, ":server_melee_friendly_fire"),
(multiplayer_send_int_to_player, ":player_id_001", 99, ":server_melee_friendly_fire"),
(server_get_friendly_fire_damage_self_ratio, ":server_friendly_fire_damage_self_ratio"),
(multiplayer_send_int_to_player, ":player_id_001", 100, ":server_friendly_fire_damage_self_ratio"),
(server_get_friendly_fire_damage_friend_ratio, ":server_friendly_fire_damage_friend_ratio"),
(multiplayer_send_int_to_player, ":player_id_001", 101, ":server_friendly_fire_damage_friend_ratio"),
(server_get_ghost_mode, ":server_ghost_mode"),
(multiplayer_send_int_to_player, ":player_id_001", 53, ":server_ghost_mode"),
(server_get_control_block_dir, ":server_control_block_direction"),
(multiplayer_send_int_to_player, ":player_id_001", 54, ":server_control_block_direction"),
(server_get_combat_speed, ":server_combat_speed"),
(multiplayer_send_int_to_player, ":player_id_001", 55, ":server_combat_speed"),
(server_get_add_to_game_servers_list, ":server_add_to_game_servers_list"),
(multiplayer_send_int_to_player, ":player_id_001", 56, ":server_add_to_game_servers_list"),
(multiplayer_send_int_to_player, ":player_id_001", 57, "$g_multiplayer_respawn_period"),
(multiplayer_send_int_to_player, ":player_id_001", 58, "$g_multiplayer_game_max_minutes"),
(multiplayer_send_int_to_player, ":player_id_001", 59, "$g_multiplayer_round_max_seconds"),
(multiplayer_send_int_to_player, ":player_id_001", 85, "$g_multiplayer_player_respawn_as_bot"),
(multiplayer_send_int_to_player, ":player_id_001", 60, "$g_multiplayer_game_max_points"),
(multiplayer_send_int_to_player, ":player_id_001", 61, "$g_multiplayer_point_gained_from_flags"),
(multiplayer_send_int_to_player, ":player_id_001", 62, "$g_multiplayer_point_gained_from_capturing_flag"),
(multiplayer_send_int_to_player, ":player_id_001", 94, "$g_multiplayer_initial_gold_multiplier"),
(multiplayer_send_int_to_player, ":player_id_001", 95, "$g_multiplayer_battle_earnings_multiplier"),
(multiplayer_send_int_to_player, ":player_id_001", 96, "$g_multiplayer_round_earnings_multiplier"),
(multiplayer_send_int_to_player, ":player_id_001", 92, "$g_multiplayer_valid_vote_ratio"),
(multiplayer_send_int_to_player, ":player_id_001", 122, "$g_multiplayer_ccoop_difficulty"),
(str_store_string,s0,":str_store_server_name()"),
(multiplayer_send_string_to_player, ":player_id_001", 63, 0),
(multiplayer_send_message_to_player, ":player_id_001", 105),
(try_end),
(else_try),
(eq,":var002",18),
(try_begin),
(player_is_admin, ":player_id_001"),
(server_get_renaming_server_allowed, "$g_multiplayer_renaming_server_allowed"),
(multiplayer_send_int_to_player, ":player_id_001", 97, "$g_multiplayer_renaming_server_allowed"),
(server_get_changing_game_type_allowed, "$g_multiplayer_changing_game_type_allowed"),
(multiplayer_send_int_to_player, ":player_id_001", 98, "$g_multiplayer_changing_game_type_allowed"),
(server_get_max_num_players, ":server_max_players"),
(multiplayer_send_int_to_player, ":player_id_001", 50, ":server_max_players"),
(multiplayer_send_2_int_to_player, ":player_id_001", 84, 1, "$g_multiplayer_next_team_1_faction"),
(multiplayer_send_2_int_to_player, ":player_id_001", 84, 2, "$g_multiplayer_next_team_2_faction"),
(multiplayer_send_2_int_to_player, ":player_id_001", 51, 1, "$g_multiplayer_num_bots_team_1"),
(multiplayer_send_2_int_to_player, ":player_id_001", 51, 2, "$g_multiplayer_num_bots_team_2"),
(server_get_anti_cheat, ":server_anti_cheat"),
(multiplayer_send_int_to_player, ":player_id_001", 104, ":server_anti_cheat"),
(server_get_friendly_fire, ":server_friendly_fire"),
(multiplayer_send_int_to_player, ":player_id_001", 52, ":server_friendly_fire"),
(server_get_melee_friendly_fire, ":server_melee_friendly_fire"),
(multiplayer_send_int_to_player, ":player_id_001", 99, ":server_melee_friendly_fire"),
(server_get_friendly_fire_damage_self_ratio, ":server_friendly_fire_damage_self_ratio"),
(multiplayer_send_int_to_player, ":player_id_001", 100, ":server_friendly_fire_damage_self_ratio"),
(server_get_friendly_fire_damage_friend_ratio, ":server_friendly_fire_damage_friend_ratio"),
(multiplayer_send_int_to_player, ":player_id_001", 101, ":server_friendly_fire_damage_friend_ratio"),
(server_get_ghost_mode, ":server_ghost_mode"),
(multiplayer_send_int_to_player, ":player_id_001", 53, ":server_ghost_mode"),
(server_get_control_block_dir, ":server_control_block_direction"),
(multiplayer_send_int_to_player, ":player_id_001", 54, ":server_control_block_direction"),
(server_get_combat_speed, ":server_combat_speed"),
(multiplayer_send_int_to_player, ":player_id_001", 55, ":server_combat_speed"),
(server_get_add_to_game_servers_list, ":server_add_to_game_servers_list"),
(multiplayer_send_int_to_player, ":player_id_001", 56, ":server_add_to_game_servers_list"),
(multiplayer_send_int_to_player, ":player_id_001", 57, "$g_multiplayer_respawn_period"),
(multiplayer_send_int_to_player, ":player_id_001", 58, "$g_multiplayer_game_max_minutes"),
(multiplayer_send_int_to_player, ":player_id_001", 59, "$g_multiplayer_round_max_seconds"),
(multiplayer_send_int_to_player, ":player_id_001", 85, "$g_multiplayer_player_respawn_as_bot"),
(multiplayer_send_int_to_player, ":player_id_001", 60, "$g_multiplayer_game_max_points"),
(multiplayer_send_int_to_player, ":player_id_001", 61, "$g_multiplayer_point_gained_from_flags"),
(multiplayer_send_int_to_player, ":player_id_001", 62, "$g_multiplayer_point_gained_from_capturing_flag"),
(multiplayer_send_int_to_player, ":player_id_001", 94, "$g_multiplayer_initial_gold_multiplier"),
(multiplayer_send_int_to_player, ":player_id_001", 95, "$g_multiplayer_battle_earnings_multiplier"),
(multiplayer_send_int_to_player, ":player_id_001", 96, "$g_multiplayer_round_earnings_multiplier"),
(multiplayer_send_int_to_player, ":player_id_001", 92, "$g_multiplayer_valid_vote_ratio"),
(multiplayer_send_int_to_player, ":player_id_001", 106, "$g_multiplayer_max_num_bots"),
(multiplayer_send_int_to_player, ":player_id_001", 122, "$g_multiplayer_ccoop_difficulty"),
(str_store_string,s0,":str_store_server_name()"),
(multiplayer_send_string_to_player, ":player_id_001", 63, 0),
(str_store_string,s0,":str_store_server_password()"),
(multiplayer_send_string_to_player, ":player_id_001", 64, 0),
(try_end),
(else_try),
(eq,":var002",21),
(try_begin),
(eq,1,1),
(try_begin),
(eq,":::g_multiplayer_poll_running",0),
(store_mission_timer_a,":m_timer_a_031"),
(player_get_slot,":player_slot_032",":player_id_001",26),
(try_begin),
(ge,":m_timer_a_031",":player_slot_032"),
(assign,":var033",0),
(try_begin),
(eq,":item_id_004",1),
(try_begin),
(eq,":::g_multiplayer_kick_voteable",1),
(player_is_active, ":player_id_014"),
(assign,":var033",1),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":item_id_004",2),
(try_begin),
(eq,":::g_multiplayer_ban_voteable",1),
(player_is_active, ":player_id_014"),
(save_ban_info_of_player, ":player_id_014"),
(assign,":var033",1),
(try_end),
(else_try),
(eq,":item_id_004",0),
(try_begin),
(eq,":::g_multiplayer_maps_voteable",1),
(call_script, "script_multiplayer_fill_map_game_types", "$g_multiplayer_game_type"),
(assign,":var015",reg0),
(try_for_range, ":var018", 0, ":var015"),
(store_add, ":var034", ":var018", 0),
(try_begin),
(troop_slot_eq,"trp_multiplayer_data",":var034",":player_id_014"),
(assign,":var033",1),
(assign,":var015",0),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":item_id_004",3),
(try_begin),
(eq,":::g_multiplayer_factions_voteable",1),
(call_script, "script_multiplayer_fill_map_game_types", "$g_multiplayer_game_type"),
(assign,":var015",reg0),
(try_for_range, ":var018", 0, ":var015"),
(store_add, ":var034", ":var018", 0),
(try_begin),
(troop_slot_eq,"trp_multiplayer_data",":var034",":player_id_014"),
(assign,":var033",1),
(assign,":var015",0),
(try_end),
(try_end),
(try_begin),
(eq,":var033",1),
(this_or_next|is_between,":var035","fac_kingdom_1","fac_kingdoms_end"),
(this_or_next|is_between,":var036","fac_kingdom_1","fac_kingdoms_end"),
(eq,":var035",":var036"),
(assign,":var033",0),
(try_end),
(try_end),
(else_try),
(eq,":item_id_004",4),
(store_add, ":var037", "$g_multiplayer_num_bots_voteable", 1),
(try_begin),
(is_between,":player_id_014",0,":var037"),
(is_between,":var035",0,":var037"),
(assign,":var033",1),
(try_end),
(try_end),
(try_begin),
(eq,":var033",1),
(str_store_string,s0,":str_store_player_username(player_id_001)"),
(try_begin),
(eq,":item_id_004",1),
(str_store_string,s1,":str_store_player_username(player_id_014)"),
(server_add_message_to_log, "str_poll_kick_player_s1_by_s0"),
(else_try),
(eq,":item_id_004",2),
(str_store_string,s1,":str_store_player_username(player_id_014)"),
(server_add_message_to_log, "str_poll_ban_player_s1_by_s0"),
(else_try),
(eq,":item_id_004",0),
(store_sub, ":var038", ":player_id_014", ":scn.multi_scene_1"),
(assign,":var038 +","str_multi_scene_1"),
(str_store_string,s1,":str_store_string(var038)"),
(server_add_message_to_log, "str_poll_change_map_to_s1_by_s0"),
(else_try),
(eq,":item_id_004",3),
(store_sub, ":var038", ":player_id_014", ":scn.multi_scene_1"),
(assign,":var038 +","str_multi_scene_1"),
(str_store_string,s1,":str_store_string(var038)"),
(str_store_string,s2,":str_store_faction_name(var035)"),
(str_store_string,s3,":str_store_faction_name(var036)"),
(server_add_message_to_log, "str_poll_change_map_to_s1_and_factions_to_s2_and_s3_by_s0"),
(else_try),
(eq,":item_id_004",4),
(assign,reg0,":player_id_014"),
(assign,reg1,":var035"),
(server_add_message_to_log, "str_poll_change_number_of_bots_to_reg0_and_reg1_by_s0"),
(try_end),
(try_end),
(assign,"$g_multiplayer_poll_running",1),
(assign,"$g_multiplayer_poll_ended",0),
(assign,"$g_multiplayer_poll_num_sent",0),
(assign,"$g_multiplayer_poll_yes_count",0),
(assign,"$g_multiplayer_poll_no_count",0),
(assign,"$g_multiplayer_poll_to_show",":item_id_004"),
(assign,"$g_multiplayer_poll_value_to_show",":player_id_014"),
(try_begin),
(eq,":item_id_004",3),
(assign,"$g_multiplayer_poll_value_2_to_show",":var035"),
(assign,"$g_multiplayer_poll_value_3_to_show",":var036"),
(else_try),
(eq,":item_id_004",4),
(assign,"$g_multiplayer_poll_value_2_to_show",":var035"),
(assign,"$g_multiplayer_poll_value_3_to_show",-1),
(else_try),
(assign,"$g_multiplayer_poll_value_2_to_show",-1),
(assign,"$g_multiplayer_poll_value_3_to_show",-1),
(try_end),
(store_add, ":var039", ":m_timer_a_031", 900),
(player_set_slot,":player_id_001",26,":var039"),
(store_add, "$g_multiplayer_poll_end_time", ":m_timer_a_031", 60),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 0, ":max_players"),
(player_is_active, ":player_id_020"),
(player_set_slot,":player_id_020",23,1),
(val_add, ":::g_multiplayer_poll_num_sent", 1),
(multiplayer_send_4_int_to_player, ":player_id_020", 74, "$g_multiplayer_poll_to_show", "$g_multiplayer_poll_value_to_show", "$g_multiplayer_poll_value_2_to_show", "$g_multiplayer_poll_value_3_to_show"),
(try_end),
(try_end),
(else_try),
(eq,":var002",22),
(try_begin),
(eq,1,1),
(try_begin),
(eq,":::g_multiplayer_poll_running",1),
(is_between,":item_id_004",0,2),
(player_slot_eq,":player_id_001",23,1),
(player_set_slot,":player_id_001",23,0),
(try_begin),
(eq,":item_id_004",0),
(val_add, ":::g_multiplayer_poll_no_count", 1),
(else_try),
(eq,":item_id_004",1),
(val_add, ":::g_multiplayer_poll_yes_count", 1),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",23),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(player_is_active, ":item_id_004"),
(kick_player, ":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",24),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(player_is_active, ":item_id_004"),
(ban_player, ":item_id_004", 0, ":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",33),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",50,101),
(assign,"$g_multiplayer_valid_vote_ratio",":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",34),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(this_or_next|is_between,":item_id_004",2,7),
(eq,":item_id_004",1000),
(assign,"$g_multiplayer_auto_team_balance_limit",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 93, ":item_id_004"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",25),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,51),
(is_between,":item_id_004",0,"$g_multiplayer_max_num_bots"),
(assign,"$g_multiplayer_num_bots_voteable",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 81, ":item_id_004"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",26),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(assign,"$g_multiplayer_factions_voteable",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 82, ":item_id_004"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",27),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(assign,"$g_multiplayer_maps_voteable",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 83, ":item_id_004"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",31),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(assign,"$g_multiplayer_kick_voteable",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 90, ":item_id_004"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",32),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(assign,"$g_multiplayer_ban_voteable",":item_id_004"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_020", 1, ":max_players"),
(player_is_active, ":player_id_020"),
(multiplayer_send_int_to_player, ":player_id_020", 91, ":item_id_004"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",42),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(assign,"$g_multiplayer_allow_player_banners",":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",43),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(assign,"$g_multiplayer_force_default_armor",":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",46),
(try_begin),
(eq,1,1),
(try_begin),
(eq,":::g_multiplayer_game_type",7),
(agent_is_active,":item_id_004"),
(agent_is_alive,":item_id_004"),
(agent_is_human,":item_id_004"),
(player_get_agent_id, ":agent_id_040", ":player_id_001"),
(try_begin),
(agent_is_active,":agent_id_040"),
(agent_is_alive,":agent_id_040"),
(agent_get_position,pos0,":agent_id_040"),
(agent_get_position,pos1,":item_id_004"),
(get_sq_distance_between_positions_in_meters,":sq_distance_041",0,1),
(try_begin),
(le,":sq_distance_041",49),
(this_or_next|agent_check_offer_from_agent, ":agent_id_040", ":agent_id_040"),
(agent_slot_eq,":agent_id_040",21,-1),
(neg|agent_slot_eq,":agent_id_040",21,":item_id_004"),
(try_begin),
(agent_check_offer_from_agent, ":agent_id_040", ":agent_id_040"),
(call_script, "script_multiplayer_accept_duel", ":agent_id_040", ":item_id_004"),
(else_try),
(assign,":var042",1),
(try_begin),
(agent_check_offer_from_agent, ":item_id_004", ":item_id_004"),
(assign,":var042",0),
(try_end),
(try_end),
(try_end),
(try_end),
(agent_add_offer_with_timeout, ":item_id_004", ":item_id_004", 10000),
(agent_get_player_id,":agent_player_id_043",":item_id_004"),
(try_begin),
(player_is_active, ":agent_player_id_043"),
(try_begin),
(eq,":var042",1),
(multiplayer_send_int_to_player, ":agent_player_id_043", 108, ":agent_id_040"),
(try_end),
(else_try),
(call_script, "script_multiplayer_accept_duel", ":item_id_004", ":agent_id_040"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",47),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":item_id_004",0,2),
(assign,"$g_multiplayer_disallow_ranged_weapons",":item_id_004"),
(try_end),
(try_end),
(else_try),
(eq,":var002",48),
(try_begin),
(eq,":item_id_004",0),
(try_begin),
(eq,":::g_multiplayer_is_game_type_captain",1),
(try_begin),
(is_between,":slot_no_044",43,45),
(is_between,":troop_id_045","trp_npc1_1","trp_npc1_2"),
(player_slot_eq,":player_id_001",42,0),
(player_set_slot,":player_id_001",":slot_no_044",":troop_id_045"),
(else_try),
(is_between,":slot_no_044",45,47),
(store_troop_faction,":troop_faction_046",":troop_id_045"),
(team_get_faction, ":team_faction_047", 0),
(store_sub, ":slot_no_048", ":slot_no_044", 2),
(player_get_slot,":player_slot_049",":player_id_001",":slot_no_048"),
(try_begin),
(eq,":player_slot_049",":troop_id_045"),
(player_set_slot,":player_id_001",":slot_no_044",":troop_id_045"),
(else_try),
(eq,":team_faction_047",":troop_faction_046"),
(store_character_level,":character_lvl_050",":troop_id_045"),
(try_begin),
(eq,":character_lvl_050",4),
(player_set_slot,":player_id_001",":slot_no_044",":troop_id_045"),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":item_id_004",14),
(try_begin),
(eq,1,1),
(try_begin),
(player_is_admin, ":player_id_001"),
(is_between,":var051",0,3),
(assign,"$g_multiplayer_ccoop_difficulty",":var051"),
(assign,reg0,":var051"),
(try_end),
(try_end),
(else_try),
(eq,":item_id_004",17),
(try_begin),
(ge,":item_id_004",0),
(call_script,"script_cf_coop_give_item_to_assigned_group_member"),
(else_try),
(player_set_slot,":player_id_001",49,-1),
(try_end),
(else_try),
(neg|multiplayer_is_dedicated_server),
(try_begin),
(this_or_next|eq,":item_id_004",4),
(eq,":item_id_004",3),
(assign,"$g_multiplayer_ccoop_enable_count_down",1),
(try_begin),
(eq,":item_id_004",3),
(assign,":var052",1),
(else_try),
(eq,":item_id_004",4),
(assign,":var052",0),
(try_end),
(try_begin),
(gt,":var052",0),
(store_mission_timer_a,"$g_multiplayer_ccoop_next_wave_start_time"),
(val_add, ":::g_multiplayer_ccoop_next_wave_start_time", ":::g_multiplayer_ccoop_enemy_respawn_secs"),
(start_presentation, ":"),
(try_end),
(else_try),
(eq,":item_id_004",15),
(try_begin),
(neg|multiplayer_is_server),
(try_begin),
(agent_is_active,":agent_no_053"),
(agent_is_human,":agent_no_053"),
(agent_is_alive,":agent_no_053"),
(ge,":var054",0),
(agent_unequip_item, ":agent_no_053", ":var054", ":var055"),
(try_end),
(try_end),
(else_try),
(eq,":item_id_004",16),
(try_begin),
(neg|multiplayer_is_server),
(try_begin),
(agent_is_active,":agent_no_053"),
(agent_is_human,":agent_no_053"),
(agent_is_alive,":agent_no_053"),
(ge,":var056",0),
(agent_equip_item, ":agent_no_053", ":var056"),
(try_end),
(try_end),
(else_try),
(eq,":item_id_004",5),
(call_script, "script_multiplayer_ccoop_set_prison_cart_visibility", 1),
(scene_prop_get_instance, ":scp_instance_058", "spr_prison_cart_door_right", 0),
(scene_prop_set_hit_points, ":scp_instance_058", ":var057"),
(scene_prop_get_instance, ":scp_instance_059", "spr_prison_cart_door_left", 0),
(scene_prop_set_hit_points, ":scp_instance_059", ":var057"),
(try_begin),
(eq,1,1),
(get_player_agent_no,":agent_no_053"),
(try_begin),
(ge,":agent_no_053",0),
(display_message, "str_prison_cart_hint"),
(try_end),
(try_end),
(start_presentation, ":"),
(else_try),
(eq,":item_id_004",6),
(call_script, "script_multiplayer_ccoop_set_prison_cart_visibility", 0),
(scene_prop_get_instance, ":scp_instance_059", "spr_prison_cart_door_left", 0),
(scene_prop_get_instance, ":scp_instance_058", "spr_prison_cart_door_right", 0),
(store_random_in_range,":random_x_060",35,80),
(store_random_in_range,":random_x_061",-80,-35),
(store_random_in_range,":random_x_062",100,350),
(store_random_in_range,":random_x_063",100,350),
(prop_instance_get_position, pos1, ":scp_instance_059"),
(position_rotate_z,1,":random_x_060",1),
(prop_instance_animate_to_position, ":scp_instance_059", 1, ":random_x_062"),
(prop_instance_get_position, pos1, ":scp_instance_058"),
(position_rotate_z,1,":random_x_061",1),
(prop_instance_animate_to_position, ":scp_instance_058", 1, ":random_x_063"),
(else_try),
(eq,":item_id_004",7),
(troop_set_slot,"trp_multiplayer_data",186,":var064"),
(troop_set_slot,"trp_multiplayer_data",187,":var065"),
(troop_set_slot,"trp_multiplayer_data",188,":var066"),
(else_try),
(eq,":item_id_004",8),
(troop_set_slot,"trp_multiplayer_data",189,":var064"),
(troop_set_slot,"trp_multiplayer_data",190,":var065"),
(troop_set_slot,"trp_multiplayer_data",191,":var066"),
(else_try),
(eq,":item_id_004",9),
(troop_set_slot,"trp_multiplayer_data",192,":var064"),
(troop_set_slot,"trp_multiplayer_data",193,":var065"),
(troop_set_slot,"trp_multiplayer_data",194,":var066"),
(else_try),
(eq,":item_id_004",10),
(troop_set_slot,"trp_multiplayer_data",195,":var064"),
(troop_set_slot,"trp_multiplayer_data",196,":var065"),
(troop_set_slot,"trp_multiplayer_data",197,":var066"),
(else_try),
(eq,":item_id_004",11),
(troop_set_slot,"trp_multiplayer_data",198,":var064"),
(troop_set_slot,"trp_multiplayer_data",199,":var065"),
(troop_set_slot,"trp_multiplayer_data",200,":var066"),
(else_try),
(eq,":item_id_004",12),
(troop_set_slot,"trp_multiplayer_data",201,":var064"),
(start_presentation, ":"),
(else_try),
(eq,":item_id_004",18),
(try_begin),
(agent_is_active,":var067"),
(agent_is_alive,":var067"),
(agent_is_non_player, ":var067"),
(is_between,":var068",0,2),
(agent_set_team, ":var067", ":var068"),
(try_begin),
(player_is_active, ":player_id_069"),
(agent_set_group, ":var067", ":player_id_069"),
(try_end),
(try_end),
(else_try),
(eq,":item_id_004",1),
(multiplayer_get_my_player, ":my_player"),
(player_set_slot,":my_player",42,":var070"),
(else_try),
(eq,":item_id_004",13),
(try_begin),
(is_between,":var073",0,4),
(is_between,":slot_no_072",47,49),
(multiplayer_get_my_player, ":my_player"),
(player_set_slot,":my_player",":slot_no_072",":var073"),
(try_end),
(try_end),
(try_end),
(else_try),
(neg|multiplayer_is_dedicated_server),
(try_begin),
(eq,":var002",97),
(assign,"$g_multiplayer_renaming_server_allowed",":item_id_004"),
(else_try),
(eq,":var002",98),
(assign,"$g_multiplayer_changing_game_type_allowed",":item_id_004"),
(else_try),
(eq,":var002",50),
(server_set_max_num_players, ":item_id_004"),
(else_try),
(eq,":var002",84),
(try_begin),
(eq,":item_id_004",1),
(assign,"$g_multiplayer_next_team_1_faction",":player_id_014"),
(else_try),
(assign,"$g_multiplayer_next_team_2_faction",":player_id_014"),
(try_end),
(else_try),
(eq,":var002",51),
(try_begin),
(eq,":item_id_004",1),
(assign,"$g_multiplayer_num_bots_team_1",":player_id_014"),
(else_try),
(assign,"$g_multiplayer_num_bots_team_2",":player_id_014"),
(try_end),
(else_try),
(eq,":var002",104),
(server_set_anti_cheat, 0),
(else_try),
(eq,":var002",52),
(server_set_friendly_fire, ":item_id_004"),
(else_try),
(eq,":var002",99),
(server_set_melee_friendly_fire, ":item_id_004"),
(else_try),
(eq,":var002",100),
(server_set_friendly_fire_damage_self_ratio, ":item_id_004"),
(else_try),
(eq,":var002",101),
(server_set_friendly_fire_damage_friend_ratio, ":item_id_004"),
(else_try),
(eq,":var002",53),
(server_set_ghost_mode, ":item_id_004"),
(else_try),
(eq,":var002",54),
(server_set_control_block_dir, ":item_id_004"),
(else_try),
(eq,":var002",56),
(server_set_add_to_game_servers_list, ":item_id_004"),
(else_try),
(eq,":var002",57),
(assign,"$g_multiplayer_respawn_period",":item_id_004"),
(else_try),
(eq,":var002",58),
(assign,"$g_multiplayer_game_max_minutes",":item_id_004"),
(else_try),
(eq,":var002",59),
(assign,"$g_multiplayer_round_max_seconds",":item_id_004"),
(else_try),
(eq,":var002",85),
(assign,"$g_multiplayer_player_respawn_as_bot",":item_id_004"),
(else_try),
(eq,":var002",60),
(assign,"$g_multiplayer_game_max_points",":item_id_004"),
(else_try),
(eq,":var002",61),
(assign,"$g_multiplayer_point_gained_from_flags",":item_id_004"),
(else_try),
(eq,":var002",62),
(assign,"$g_multiplayer_point_gained_from_capturing_flag",":item_id_004"),
(else_try),
(eq,":var002",94),
(assign,"$g_multiplayer_initial_gold_multiplier",":item_id_004"),
(else_try),
(eq,":var002",95),
(assign,"$g_multiplayer_battle_earnings_multiplier",":item_id_004"),
(else_try),
(eq,":var002",96),
(assign,"$g_multiplayer_round_earnings_multiplier",":item_id_004"),
(else_try),
(eq,":var002",88),
(assign,"$g_multiplayer_number_of_respawn_count",":item_id_004"),
(else_try),
(eq,":var002",63),
(server_set_name, 0),
(else_try),
(eq,":var002",64),
(server_set_password, 0),
(start_presentation, ":"),
(else_try),
(eq,":var002",105),
(assign,"$g_multiplayer_show_server_rules",1),
(start_presentation, ":"),
(else_try),
(eq,":var002",65),
(assign,"$g_multiplayer_game_type",":item_id_004"),
(call_script, "script_multiplayer_set_g_multiplayer_is_game_type_captain"),
(else_try),
(eq,":var002",92),
(assign,"$g_multiplayer_valid_vote_ratio",":item_id_004"),
(else_try),
(eq,":var002",106),
(assign,"$g_multiplayer_max_num_bots",":item_id_004"),
(else_try),
(eq,":var002",107),
(assign,"$server_mission_timer_while_player_joined",":item_id_004"),
(else_try),
(eq,":var002",93),
(assign,"$g_multiplayer_auto_team_balance_limit",":item_id_004"),
(else_try),
(eq,":var002",81),
(assign,"$g_multiplayer_num_bots_voteable",":item_id_004"),
(else_try),
(eq,":var002",82),
(assign,"$g_multiplayer_factions_voteable",":item_id_004"),
(else_try),
(eq,":var002",83),
(assign,"$g_multiplayer_maps_voteable",":item_id_004"),
(else_try),
(eq,":var002",90),
(assign,"$g_multiplayer_kick_voteable",":item_id_004"),
(else_try),
(eq,":var002",91),
(assign,"$g_multiplayer_ban_voteable",":item_id_004"),
(else_try),
(eq,":var002",102),
(assign,"$g_multiplayer_allow_player_banners",":item_id_004"),
(else_try),
(eq,":var002",103),
(assign,"$g_multiplayer_force_default_armor",":item_id_004"),
(else_try),
(eq,":var002",112),
(assign,"$g_multiplayer_disallow_ranged_weapons",":item_id_004"),
(else_try),
(eq,":var002",66),
(assign,"$g_confirmation_result",1),
(else_try),
(eq,":var002",67),
(assign,"$g_confirmation_result",-1),
(else_try),
(eq,":var002",68),
(call_script, "script_show_multiplayer_message", ":item_id_004", ":player_id_014"),
(else_try),
(eq,":var002",69),
(call_script, "script_draw_this_round", ":item_id_004"),
(else_try),
(eq,":var002",70),
(call_script, "script_set_attached_scene_prop", ":item_id_004", ":player_id_014"),
(try_begin),
(eq,":::g_multiplayer_game_type",4),
(try_begin),
(neq,":player_id_014",-1),
(agent_set_horse_speed_factor, ":item_id_004", 75),
(else_try),
(agent_set_horse_speed_factor, ":item_id_004", 100),
(try_end),
(try_end),
(else_try),
(eq,":var002",71),
(call_script, "script_set_team_flag_situation", ":item_id_004", ":player_id_014"),
(else_try),
(eq,":var002",72),
(call_script, "script_team_set_score", ":item_id_004", ":player_id_014"),
(else_try),
(eq,":var002",86),
(call_script, "script_player_set_score", ":item_id_004", ":player_id_014"),
(call_script, "script_player_set_kill_count", ":item_id_004", ":var035"),
(call_script, "script_player_set_death_count", ":item_id_004", ":var036"),
(else_try),
(eq,":var002",73),
(call_script, "script_set_num_agents_around_flag", ":var074", ":var075"),
(else_try),
(eq,":var002",74),
(assign,":var076",0),
(try_begin),
(this_or_next|eq,":item_id_004",1),
(eq,":item_id_004",2),
(player_is_active, ":player_id_014"),
(assign,":var076",1),
(else_try),
(assign,":var076",1),
(try_end),
(try_begin),
(eq,":var076",1),
(assign,"$g_multiplayer_poll_to_show",":item_id_004"),
(assign,"$g_multiplayer_poll_value_to_show",":player_id_014"),
(assign,"$g_multiplayer_poll_value_2_to_show",":var035"),
(assign,"$g_multiplayer_poll_value_3_to_show",":var036"),
(store_mission_timer_a,":m_timer_a_031"),
(store_add, "$g_multiplayer_poll_client_end_time", ":m_timer_a_031", 60),
(start_presentation, ":"),
(try_end),
(else_try),
(eq,":var002",75),
(call_script, "script_change_flag_owner", ":var074", ":var077"),
(else_try),
(eq,":var002",76),
(call_script, "script_use_item", ":item_id_004", ":player_id_014"),
(else_try),
(eq,":var002",121),
(try_begin),
(is_between,":item_id_004",50,60),
(multiplayer_get_my_player, ":player_id_001"),
(player_set_slot,":player_id_001",":item_id_004",":player_id_014"),
(try_end),
(else_try),
(eq,":var002",120),
(call_script, "script_coop_drop_item", ":item_id_004", ":player_id_014", ":var035"),
(else_try),
(eq,":var002",77),
(scene_prop_set_slot,":scene_prop_instance_id_078",1,1),
(prop_instance_get_scene_prop_kind, ":scene_prop_kind_079", ":scene_prop_instance_id_078"),
(try_begin),
(eq,":scene_prop_kind_079","spr_winch_b"),
(assign,":var080","spr_portcullis"),
(else_try),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_14m"),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_12m"),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_10m"),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_8m"),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_6m"),
(this_or_next|eq,":scene_prop_kind_079","spr_castle_f_door_b"),
(this_or_next|eq,":scene_prop_kind_079","spr_door_destructible"),
(this_or_next|eq,":scene_prop_kind_079","spr_castle_f_door_a"),
(this_or_next|eq,":scene_prop_kind_079","spr_viking_keep_destroy_sally_door_right"),
(this_or_next|eq,":scene_prop_kind_079","spr_viking_keep_destroy_sally_door_left"),
(this_or_next|eq,":scene_prop_kind_079","spr_earth_sally_gate_right"),
(this_or_next|eq,":scene_prop_kind_079","spr_earth_sally_gate_left"),
(this_or_next|eq,":scene_prop_kind_079","spr_castle_f_sally_door_a"),
(eq,":scene_prop_kind_079","spr_castle_e_sally_door_a"),
(assign,":var080",":scene_prop_kind_079"),
(try_end),
(try_begin),
(eq,":var080","spr_portcullis"),
(assign,":var081",-1),
(prop_instance_get_position, pos0, ":scene_prop_instance_id_078"),
(scene_prop_get_num_instances, ":scp_num_instances_082", ":var080"),
(try_for_range, ":var083", 0, ":scp_num_instances_082"),
(scene_prop_get_instance, ":scp_instance_084", ":var080", ":var083"),
(prop_instance_get_position, pos1, ":scp_instance_084"),
(get_sq_distance_between_positions,":sq_distance_085",0,1),
(try_begin),
(this_or_next|eq,":var081",-1),
(lt,":sq_distance_085",":var081"),
(assign,":var081",":sq_distance_085"),
(assign,":var086",":scp_instance_084"),
(try_end),
(try_end),
(try_begin),
(ge,":var081",0),
(prop_instance_is_animating, ":var087", ":var086"),
(try_begin),
(eq,":var087",0),
(prop_instance_get_starting_position, pos0, ":var086"),
(position_move_z,0,375),
(prop_instance_animate_to_position, ":var086", 0, 1),
(else_try),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_14m"),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_12m"),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_10m"),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_8m"),
(this_or_next|eq,":scene_prop_kind_079","spr_siege_ladder_move_6m"),
(this_or_next|eq,":scene_prop_kind_079","spr_castle_f_door_b"),
(this_or_next|eq,":scene_prop_kind_079","spr_door_destructible"),
(this_or_next|eq,":scene_prop_kind_079","spr_castle_f_door_a"),
(this_or_next|eq,":scene_prop_kind_079","spr_viking_keep_destroy_sally_door_right"),
(this_or_next|eq,":scene_prop_kind_079","spr_viking_keep_destroy_sally_door_left"),
(this_or_next|eq,":scene_prop_kind_079","spr_earth_sally_gate_right"),
(this_or_next|eq,":scene_prop_kind_079","spr_earth_sally_gate_left"),
(this_or_next|eq,":scene_prop_kind_079","spr_castle_f_sally_door_a"),
(eq,":scene_prop_kind_079","spr_castle_e_sally_door_a"),
(assign,":var086",":scene_prop_instance_id_078"),
(prop_instance_get_starting_position, pos0, ":var086"),
(position_rotate_z,0,-80),
(prop_instance_animate_to_position, ":var086", 0, 1),
(else_try),
(assign,":var086",":scene_prop_instance_id_078"),
(prop_instance_is_animating, ":var087", ":var086"),
(try_begin),
(eq,":var087",0),
(prop_instance_get_starting_position, pos0, ":var086"),
(prop_instance_animate_to_position, ":var086", 0, 1),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",78),
(try_begin),
(neq,":item_id_004",-9999),
(assign,"$g_round_start_time",":item_id_004"),
(else_try),
(store_mission_timer_a,"$g_round_start_time"),
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_6m"),
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_8m"),
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_10m"),
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_12m"),
(call_script, "script_initialize_scene_prop_slots", "spr_siege_ladder_move_14m"),
(call_script, "script_initialize_scene_prop_slots", "spr_winch_b"),
(try_end),
(else_try),
(eq,":var002",79),
(try_begin),
(is_presentation_active, ":"),
(assign,"$g_close_equipment_selection",1),
(try_end),
(start_presentation, ":"),
(else_try),
(eq,":var002",80),
(assign,"$g_battle_death_mode_started",2),
(start_presentation, ":"),
(call_script, "script_start_death_mode"),
(else_try),
(eq,":var002",89),
(try_begin),
(gt,":::g_my_spawn_count",0),
(store_add, "$g_my_spawn_count", "$g_my_spawn_count", ":item_id_004"),
(else_try),
(assign,"$g_my_spawn_count",":item_id_004"),
(try_end),
(else_try),
(eq,":var002",108),
(try_begin),
(agent_is_active,":item_id_004"),
(agent_get_player_id,":agent_player_id_088",":item_id_004"),
(try_begin),
(player_is_active, ":agent_player_id_088"),
(str_store_string,s0,":str_store_player_username(agent_player_id_088)"),
(else_try),
(str_store_string,s0,":str_store_agent_name(item_id_004)"),
(try_end),
(display_message, "str_s0_offers_a_duel_with_you"),
(try_begin),
(eq,1,1),
(get_player_agent_no,":agent_no_053"),
(try_begin),
(agent_is_active,":agent_no_053"),
(agent_add_offer_with_timeout, ":agent_no_053", ":agent_no_053", 10000),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var002",109),
(store_mission_timer_a,":m_timer_a_031"),
(try_begin),
(agent_is_active,":item_id_004"),
(get_player_agent_no,":agent_no_053"),
(try_begin),
(agent_is_active,":agent_no_053"),
(agent_get_player_id,":agent_player_id_088",":item_id_004"),
(try_begin),
(player_is_active, ":agent_player_id_088"),
(str_store_string,s0,":str_store_player_username(agent_player_id_088)"),
(else_try),
(str_store_string,s0,":str_store_agent_name(item_id_004)"),
(try_end),
(try_end),
(display_message, "str_a_duel_between_you_and_s0_will_start_in_3_seconds"),
(assign,"$g_multiplayer_duel_start_time",":m_timer_a_031"),
(start_presentation, ":"),
(agent_set_slot,":agent_no_053",21,":item_id_004"),
(agent_set_slot,":item_id_004",21,":agent_no_053"),
(agent_set_slot,":agent_no_053",22,":m_timer_a_031"),
(agent_set_slot,":item_id_004",22,":m_timer_a_031"),
(agent_clear_relations_with_agents, ":agent_no_053"),
(agent_clear_relations_with_agents, ":item_id_004"),
(try_end),
(else_try),
(eq,":var002",110),
(try_begin),
(agent_is_active,":item_id_004"),
(agent_get_player_id,":agent_player_id_088",":item_id_004"),
(try_begin),
(player_is_active, ":agent_player_id_088"),
(str_store_string,s0,":str_store_player_username(agent_player_id_088)"),
(else_try),
(str_store_string,s0,":str_store_agent_name(item_id_004)"),
(try_end),
(display_message, "str_your_duel_with_s0_is_cancelled"),
(try_end),
(try_begin),
(eq,1,1),
(get_player_agent_no,":agent_no_053"),
(try_begin),
(agent_is_active,":agent_no_053"),
(agent_set_slot,":agent_no_053",21,-1),
(agent_clear_relations_with_agents, ":agent_no_053"),
(try_end),
(try_end),
(else_try),
(eq,":var002",111),
(assign, reg1, 4294927974),
(display_message, "@str_server_s0 {reg1}"),
(else_try),
(eq,":var002",113),
(try_begin),
(is_between,":slot_no_003",35,39),
(is_between,":item_id_004",0,2),
(player_set_slot,":player_id_001",":slot_no_003",":item_id_004"),
(else_try),
(eq,":var002",122),
(assign,reg0,":item_id_004"),
(assign,"$g_multiplayer_ccoop_difficulty",":item_id_004"),
(else_try),
(eq,":var002",123),
(start_presentation, ":"),
(else_try),
(eq,":var002",124),
(else_try),
(eq,":var002",117),
(try_begin),
(is_between,":var092",0,"snd_sounds_end"),
(set_fixed_point_multiplier, 100),
(init_position,1),
(position_set_x,1,":var089"),
(position_set_y,1,":var090"),
(position_set_z,1,":var091"),
(play_sound_at_position, ":var092", 1),
(try_end),
(try_end),
(try_end),
(try_end),
]),

("cf_multiplayer_evaluate_poll", [
(assign,":var001",0),
(assign,"$g_multiplayer_poll_ended",1),
(store_add, ":var002", "$g_multiplayer_poll_yes_count", "$g_multiplayer_poll_no_count"),
(store_sub, ":var003", "$g_multiplayer_poll_num_sent", ":var002"),
(store_mul, ":var004", 3, ":var003"),
(val_div, ":var004", 10),
(val_add, ":var002", ":var004"),
(val_max,":var002",1),
(store_mul, ":var005", 100, "$g_multiplayer_poll_yes_count"),
(val_div, ":var005", ":var002"),
(try_begin),
(ge,":var005",":::g_multiplayer_valid_vote_ratio"),
(assign,":var001",1),
(try_begin),
(eq,":::g_multiplayer_poll_to_show",1),
(try_begin),
(player_is_active, "$g_multiplayer_poll_value_to_show"),
(kick_player, "$g_multiplayer_poll_value_to_show"),
(try_end),
(else_try),
(eq,":::g_multiplayer_poll_to_show",2),
(ban_player_using_saved_ban_info),
(else_try),
(eq,":::g_multiplayer_poll_to_show",3),
(team_set_faction, 0, "$g_multiplayer_poll_value_2_to_show"),
(team_set_faction, 1, "$g_multiplayer_poll_value_3_to_show"),
(else_try),
(eq,":::g_multiplayer_poll_to_show",4),
(assign,"$g_multiplayer_num_bots_team_1","$g_multiplayer_poll_value_to_show"),
(assign,"$g_multiplayer_num_bots_team_2","$g_multiplayer_poll_value_2_to_show"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_007", 1, ":max_players"),
(player_is_active, ":player_id_007"),
(multiplayer_send_2_int_to_player, ":player_id_007", 51, 1, "$g_multiplayer_num_bots_team_1"),
(multiplayer_send_2_int_to_player, ":player_id_007", 51, 2, "$g_multiplayer_num_bots_team_2"),
(try_end),
(try_end),
(else_try),
(assign,"$g_multiplayer_poll_running",0),
(try_end),
(get_max_players, ":max_players"),
(call_script, "script_show_multiplayer_message", 7, ":var001"),
(try_for_range, ":player_id_007", 1, ":max_players"),
(player_is_active, ":player_id_007"),
(multiplayer_send_2_int_to_player, ":player_id_007", 68, 7, ":var001"),
(try_end),
]),

("multiplayer_accept_duel", [
(store_script_param, ":agent_id_001", 1),
(store_script_param, ":agent_id_002", 2),
(try_begin),
(agent_slot_ge,":agent_id_001",21,0),
(agent_get_slot,":agent_slot_003",":agent_id_001",21),
(try_begin),
(agent_is_active,":agent_slot_003"),
(agent_clear_relations_with_agents, ":agent_slot_003"),
(agent_set_slot,":agent_slot_003",21,-1),
(agent_get_player_id,":agent_player_id_004",":agent_slot_003"),
(try_begin),
(player_is_active, ":agent_player_id_004"),
(multiplayer_send_int_to_player, ":agent_player_id_004", 110, ":agent_id_001"),
(else_try),
(agent_force_rethink, ":agent_slot_003"),
(try_end),
(try_end),
(try_end),
(try_begin),
(agent_slot_ge,":agent_id_002",21,0),
(agent_get_slot,":agent_slot_003",":agent_id_002",21),
(try_begin),
(agent_is_active,":agent_slot_003"),
(agent_clear_relations_with_agents, ":agent_slot_003"),
(agent_set_slot,":agent_slot_003",21,-1),
(try_begin),
(player_is_active, ":agent_player_id_004"),
(multiplayer_send_int_to_player, ":agent_player_id_004", 110, ":agent_id_002"),
(else_try),
(agent_force_rethink, ":agent_slot_003"),
(try_end),
(try_end),
(try_end),
(agent_set_slot,":agent_id_001",21,":agent_id_002"),
(agent_set_slot,":agent_id_002",21,":agent_id_001"),
(agent_clear_relations_with_agents, ":agent_id_001"),
(agent_clear_relations_with_agents, ":agent_id_002"),
(agent_get_player_id,":agent_player_id_004",":agent_id_001"),
(store_mission_timer_a,":m_timer_a_005"),
(try_begin),
(player_is_active, ":agent_player_id_004"),
(multiplayer_send_int_to_player, ":agent_player_id_004", 109, ":agent_id_002"),
(else_try),
(agent_force_rethink, ":agent_id_001"),
(try_end),
(agent_set_slot,":agent_id_001",22,":m_timer_a_005"),
(agent_get_player_id,":agent_player_id_006",":agent_id_002"),
(try_begin),
(player_is_active, ":agent_player_id_006"),
(multiplayer_send_int_to_player, ":agent_player_id_006", 109, ":agent_id_001"),
(else_try),
(agent_force_rethink, ":agent_id_002"),
(try_end),
(agent_set_slot,":agent_id_002",22,":m_timer_a_005"),
]),

("game_get_multiplayer_server_option_for_mission_template", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(eq,":var002",0),
(assign,reg0,"$g_multiplayer_team_1_faction"),
(set_trigger_result, 1),
(else_try),
(eq,":var002",1),
(assign,reg0,"$g_multiplayer_team_2_faction"),
(set_trigger_result, 1),
(else_try),
(eq,":var002",2),
(assign,reg0,"$g_multiplayer_num_bots_team_1"),
(set_trigger_result, 1),
(else_try),
(eq,":var002",3),
(assign,reg0,"$g_multiplayer_num_bots_team_2"),
(set_trigger_result, 1),
(else_try),
(eq,":var002",4),
(server_get_friendly_fire, reg0),
(set_trigger_result, 1),
(else_try),
(eq,":var002",5),
(server_get_melee_friendly_fire, reg0),
(set_trigger_result, 1),
(else_try),
(eq,":var002",6),
(server_get_friendly_fire_damage_self_ratio, reg0),
(set_trigger_result, 1),
(else_try),
(eq,":var002",7),
(server_get_friendly_fire_damage_friend_ratio, reg0),
(set_trigger_result, 1),
(else_try),
(eq,":var002",8),
(server_get_ghost_mode, reg0),
(set_trigger_result, 1),
(else_try),
(eq,":var002",9),
(server_get_control_block_dir, reg0),
(set_trigger_result, 1),
(else_try),
(eq,":var002",10),
(server_get_combat_speed, reg0),
(set_trigger_result, 1),
(else_try),
(try_begin),
(eq,":var001","mt_multiplayer_hq"),
(val_add, ":var002", 1),
(try_end),
(try_begin),
(eq,":var002",11),
(assign,reg0,"$g_multiplayer_game_max_minutes"),
(set_trigger_result, 1),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_bt"),
(neq,":var001","mt_multiplayer_fd"),
(neq,":var001","mt_multiplayer_sg"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",12),
(assign,reg0,"$g_multiplayer_round_max_seconds"),
(set_trigger_result, 1),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_bt"),
(neq,":var001","mt_multiplayer_fd"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",13),
(assign,reg0,"$g_multiplayer_player_respawn_as_bot"),
(set_trigger_result, 1),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_sg"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",14),
(assign,reg0,"$g_multiplayer_number_of_respawn_count"),
(set_trigger_result, 1),
(else_try),
(eq,":var002",15),
(assign,reg0,"$g_multiplayer_game_max_points"),
(set_trigger_result, 1),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_hq"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",16),
(assign,reg0,"$g_multiplayer_point_gained_from_flags"),
(set_trigger_result, 1),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_cf"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",17),
(assign,reg0,"$g_multiplayer_point_gained_from_capturing_flag"),
(set_trigger_result, 1),
(else_try),
(eq,":var002",18),
(assign,reg0,"$g_multiplayer_respawn_period"),
(set_trigger_result, 1),
(else_try),
(eq,":var002",19),
(assign,reg0,"$g_multiplayer_initial_gold_multiplier"),
(set_trigger_result, 1),
(else_try),
(eq,":var002",20),
(assign,reg0,"$g_multiplayer_battle_earnings_multiplier"),
(set_trigger_result, 1),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_bt"),
(neq,":var001","mt_multiplayer_fd"),
(neq,":var001","mt_multiplayer_sg"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",21),
(assign,reg0,"$g_multiplayer_round_earnings_multiplier"),
(set_trigger_result, 1),
(try_end),
(try_end),
]),

("game_multiplayer_server_option_for_mission_template_to_string", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(str_clear, 0),
(try_begin),
(eq,":var002",0),
(assign,reg1,1),
(str_store_string,s0,":str_store_string("str_team_reg1_faction")"),
(str_store_string,s1,":str_store_faction_name(var003)"),
(str_store_string,s0,":str_store_string("str_s0_s1")"),
(else_try),
(eq,":var002",1),
(assign,reg1,2),
(str_store_string,s0,":str_store_string("str_team_reg1_faction")"),
(str_store_string,s1,":str_store_faction_name(var003)"),
(str_store_string,s0,":str_store_string("str_s0_s1")"),
(else_try),
(eq,":var002",2),
(assign,reg1,1),
(str_store_string,s0,":str_store_string("str_number_of_bots_in_team_reg1")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(eq,":var002",3),
(assign,reg1,2),
(str_store_string,s0,":str_store_string("str_number_of_bots_in_team_reg1")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(eq,":var002",4),
(str_store_string,s0,":str_store_string("str_allow_friendly_fire")"),
(try_begin),
(eq,":var003",0),
(str_store_string,s1,":str_store_string("str_no_wo_dot")"),
(else_try),
(str_store_string,s1,":str_store_string("str_yes_wo_dot")"),
(try_end),
(str_store_string,s0,":str_store_string("str_s0_s1")"),
(else_try),
(eq,":var002",5),
(str_store_string,s0,":str_store_string("str_allow_melee_friendly_fire")"),
(try_begin),
(eq,":var003",0),
(str_store_string,s1,":str_store_string("str_no_wo_dot")"),
(else_try),
(str_store_string,s1,":str_store_string("str_yes_wo_dot")"),
(try_end),
(str_store_string,s0,":str_store_string("str_s0_s1")"),
(else_try),
(eq,":var002",6),
(str_store_string,s0,":str_store_string("str_friendly_fire_damage_self_ratio")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(eq,":var002",7),
(str_store_string,s0,":str_store_string("str_friendly_fire_damage_friend_ratio")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(eq,":var002",8),
(str_store_string,s0,":str_store_string("str_spectator_camera")"),
(try_begin),
(eq,":var003",0),
(str_store_string,s1,":str_store_string("str_free")"),
(else_try),
(eq,":var003",1),
(str_store_string,s1,":str_store_string("str_stick_to_any_player")"),
(else_try),
(eq,":var003",2),
(str_store_string,s1,":str_store_string("str_stick_to_team_members")"),
(else_try),
(str_store_string,s1,":str_store_string("str_stick_to_team_members_view")"),
(try_end),
(str_store_string,s0,":str_store_string("str_s0_s1")"),
(else_try),
(eq,":var002",9),
(str_store_string,s0,":str_store_string("str_control_block_direction")"),
(try_begin),
(eq,":var003",0),
(str_store_string,s1,":str_store_string("str_automatic")"),
(else_try),
(str_store_string,s1,":str_store_string("str_by_mouse_movement")"),
(try_end),
(str_store_string,s0,":str_store_string("str_s0_s1")"),
(else_try),
(eq,":var002",10),
(str_store_string,s0,":str_store_string("str_combat_speed")"),
(try_begin),
(eq,":var003",0),
(str_store_string,s1,":str_store_string("str_combat_speed_0")"),
(else_try),
(eq,":var003",1),
(str_store_string,s1,":str_store_string("str_combat_speed_1")"),
(else_try),
(eq,":var003",2),
(str_store_string,s1,":str_store_string("str_combat_speed_2")"),
(else_try),
(eq,":var003",3),
(str_store_string,s1,":str_store_string("str_combat_speed_3")"),
(else_try),
(str_store_string,s1,":str_store_string("str_combat_speed_4")"),
(try_end),
(str_store_string,s0,":str_store_string("str_s0_s1")"),
(else_try),
(eq,":var001","mt_multiplayer_hq"),
(val_add, ":var002", 1),
(try_begin),
(eq,":var002",11),
(str_store_string,s0,":str_store_string("str_map_time_limit")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_bt"),
(neq,":var001","mt_multiplayer_fd"),
(neq,":var001","mt_multiplayer_sg"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",12),
(str_store_string,s0,":str_store_string("str_round_time_limit")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_bt"),
(neq,":var001","mt_multiplayer_fd"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",13),
(str_store_string,s0,":str_store_string("str_players_take_control_of_a_bot_after_death")"),
(try_begin),
(eq,":var003",0),
(str_store_string,s1,":str_store_string("str_no_wo_dot")"),
(else_try),
(str_store_string,s1,":str_store_string("str_yes_wo_dot")"),
(try_end),
(try_end),
(str_store_string,s0,":str_store_string("str_s0_s1")"),
(else_try),
(neq,":var001","mt_multiplayer_sg"),
(val_add, ":var002", 1),
(try_begin),
(eq,":var002",14),
(str_store_string,s0,":str_store_string("str_defender_spawn_count_limit")"),
(try_begin),
(eq,":var003",0),
(str_store_string,s1,":str_store_string("str_unlimited")"),
(else_try),
(assign,reg1,":var003"),
(str_store_string,s1,":str_store_string("str_reg1")"),
(try_end),
(try_end),
(str_store_string,s0,":str_store_string("str_s0_s1")"),
(else_try),
(eq,":var002",15),
(str_store_string,s0,":str_store_string("str_team_points_limit")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_hq"),
(val_add, ":var002", 1),
(try_end),
(try_begin),
(eq,":var002",16),
(str_store_string,s0,":str_store_string("str_point_gained_from_flags")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_cf"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",17),
(str_store_string,s0,":str_store_string("str_point_gained_from_capturing_flag")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(eq,":var002",18),
(str_store_string,s0,":str_store_string("str_respawn_period")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(eq,":var002",19),
(str_store_string,s0,":str_store_string("str_initial_gold_multiplier")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(eq,":var002",20),
(str_store_string,s0,":str_store_string("str_battle_earnings_multiplier")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(else_try),
(try_begin),
(neq,":var001","mt_multiplayer_bt"),
(neq,":var001","mt_multiplayer_fd"),
(neq,":var001","mt_multiplayer_sg"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",21),
(str_store_string,s0,":str_store_string("str_round_earnings_multiplier")"),
(assign,reg0,":var003"),
(str_store_string,s0,":str_store_string("str_s0_reg0")"),
(try_end),
(try_end),
]),

("cf_multiplayer_team_is_available", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",1),
(try_begin),
(eq,":::g_multiplayer_game_type",8),
(eq,":var002",1),
(assign,":var003",0),
(else_try),
(eq,":::g_multiplayer_game_type",8),
(eq,":var002",0),
(assign,":var003",1),
(else_try),
(neq,":::g_multiplayer_game_type",0),
(neq,":::g_multiplayer_game_type",7),
(is_between,":var002",0,2),
(neg|teams_are_enemies, ":var002", ":var002"),
(assign,":var003",0),
(assign,":var004",0),
(assign,":var005",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_007", 0, ":max_players"),
(player_is_active, ":player_id_007"),
(neq,":player_id_007",":var001"),
(player_get_team_no,  ":team_no_008", ":player_id_007"),
(try_begin),
(eq,":team_no_008",0),
(val_add, ":var004", 1),
(else_try),
(eq,":team_no_008",1),
(val_add, ":var005", 1),
(try_end),
(try_end),
(store_sub, ":var009", ":var004", ":var005"),
(try_begin),
(ge,":var009",0),
(val_add, ":var009", 1),
(else_try),
(val_add, ":var009", -1),
(try_end),
(try_begin),
(eq,":var002",0),
(lt,":var009",":::g_multiplayer_auto_team_balance_limit"),
(assign,":var003",1),
(else_try),
(eq,":var002",1),
(store_mul, ":var010", "$g_multiplayer_auto_team_balance_limit", -1),
(try_begin),
(gt,":var009",":var010"),
(assign,":var003",1),
(try_end),
(try_end),
(try_end),
]),

("find_number_of_agents_constant", [
(assign,":var001",0),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(val_add, ":var001", 1),
(try_end),
(try_begin),
(le,":var001",2),
(assign,reg0,100),
(else_try),
(le,":var001",4),
(assign,reg0,140),
(else_try),
(le,":var001",7),
(assign,reg0,180),
(else_try),
(le,":var001",11),
(assign,reg0,220),
(else_try),
(le,":var001",17),
(assign,reg0,260),
(else_try),
(le,":var001",25),
(assign,reg0,300),
(else_try),
(le,":var001",36),
(assign,reg0,340),
(else_try),
(le,":var001",50),
(assign,reg0,380),
(else_try),
(le,":var001",68),
(assign,reg0,420),
(else_try),
(le,":var001",91),
(assign,reg0,460),
(else_try),
(assign,reg0,500),
(try_end),
]),

("game_multiplayer_event_duel_offered", [
(store_script_param, ":var001", 1),
(get_player_agent_no,":agent_no_002"),
(try_begin),
(agent_is_active,":agent_no_002"),
(this_or_next|agent_slot_eq,":agent_no_002",21,-1),
(agent_check_offer_from_agent, ":agent_no_002", ":agent_no_002"),
(neg|agent_slot_eq,":agent_no_002",21,":var001"),
(multiplayer_send_int_to_server, 46, ":var001"),
(agent_get_player_id,":agent_player_id_003",":var001"),
(try_begin),
(player_is_active, ":agent_player_id_003"),
(str_store_string,s0,":str_store_player_username(agent_player_id_003)"),
(else_try),
(str_store_string,s0,":str_store_agent_name(var001)"),
(try_end),
(display_message, "str_a_duel_request_is_sent_to_s0"),
(try_end),
]),

("game_get_multiplayer_game_type_enum", [
(assign,reg0,0),
(assign,reg1,9),
]),

("game_multiplayer_get_game_type_mission_template", [
(store_script_param, ":var002", 1),
(assign,":var001",-1),
(try_begin),
(eq,":var002",0),
(assign,":var001","mt_multiplayer_dm"),
(else_try),
(eq,":var002",1),
(assign,":var001","mt_multiplayer_tdm"),
(else_try),
(eq,":var002",2),
(assign,":var001","mt_multiplayer_bt"),
(else_try),
(eq,":var002",3),
(assign,":var001","mt_multiplayer_fd"),
(else_try),
(eq,":var002",4),
(assign,":var001","mt_multiplayer_cf"),
(else_try),
(eq,":var002",5),
(assign,":var001","mt_multiplayer_hq"),
(else_try),
(eq,":var002",6),
(assign,":var001","mt_multiplayer_sg"),
(else_try),
(eq,":var002",7),
(assign,":var001","mt_multiplayer_duel"),
(else_try),
(eq,":var002",8),
(assign,":var001","mt_multiplayer_ccoop"),
(try_end),
(assign,reg0,":var001"),
]),

("multiplayer_get_mission_template_game_type", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(try_begin),
(eq,":var001","mt_multiplayer_dm"),
(assign,":var002",0),
(else_try),
(eq,":var001","mt_multiplayer_tdm"),
(assign,":var002",1),
(else_try),
(eq,":var001","mt_multiplayer_bt"),
(assign,":var002",2),
(else_try),
(eq,":var001","mt_multiplayer_fd"),
(assign,":var002",3),
(else_try),
(eq,":var001","mt_multiplayer_cf"),
(assign,":var002",4),
(else_try),
(eq,":var001","mt_multiplayer_hq"),
(assign,":var002",5),
(else_try),
(eq,":var001","mt_multiplayer_sg"),
(assign,":var002",6),
(else_try),
(eq,":var001","mt_multiplayer_duel"),
(assign,":var002",7),
(else_try),
(eq,":var001","mt_multiplayer_ccoop"),
(assign,":var002",8),
(try_end),
(assign,reg0,":var002"),
]),

("multiplayer_fill_available_factions_combo_button", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_for_range, ":fac_003", ":fac.kingdom_1", ":fac.kingdoms_end"),
(str_store_string,s0,":str_store_faction_name(fac_003)"),
(overlay_add_item, ":var001", 0),
(try_end),
(try_begin),
(eq,":::g_multiplayer_game_type",8),
(eq,":var001",":::g_presentation_obj_admin_panel_12"),
(str_store_string,s0,":str_store_faction_name("fac_outlaws")"),
(overlay_add_item, ":var001", 0),
(str_store_string,s0,":str_store_faction_name("fac_ccoop_all_stars")"),
(overlay_add_item, ":var001", 0),
(try_begin),
(eq,":var002","fac_outlaws"),
(overlay_set_val, ":var001", 6),
(else_try),
(eq,":var002","fac_ccoop_all_stars"),
(overlay_set_val, ":var001", 7),
(else_try),
(assign,":var002 -","fac_kingdom_1"),
(overlay_set_val, ":var001", ":var002"),
(try_end),
(else_try),
(try_begin),
(gt,":var002","fac_kingdoms_end"),
(overlay_set_val, ":var001", 1),
(else_try),
(assign,":var002 -","fac_kingdom_1"),
(overlay_set_val, ":var001", ":var002"),
(try_end),
(try_end),
]),

("multiplayer_get_troop_class", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_begin),
(this_or_next|eq,":var001","trp_sarranid_archer_multiplayer"),
(this_or_next|eq,":var001","trp_nord_archer_multiplayer"),
(eq,":var001","trp_vaegir_archer_multiplayer"),
(assign,":var002",4),
(else_try),
(this_or_next|eq,":var001","trp_vaegir_horseman_multiplayer"),
(this_or_next|eq,":var001","trp_sarranid_mamluke_multiplayer"),
(this_or_next|eq,":var001","trp_rhodok_horseman_multiplayer"),
(this_or_next|eq,":var001","trp_nord_scout_multiplayer"),
(eq,":var001","trp_swadian_man_at_arms_multiplayer"),
(assign,":var002",3),
(else_try),
(eq,":var001","trp_khergit_veteran_horse_archer_multiplayer"),
(assign,":var002",6),
(else_try),
(this_or_next|eq,":var001","trp_vaegir_horseman_multiplayer"),
(this_or_next|eq,":var001","trp_sarranid_mamluke_multiplayer"),
(this_or_next|eq,":var001","trp_rhodok_horseman_multiplayer"),
(this_or_next|eq,":var001","trp_nord_scout_multiplayer"),
(eq,":var001","trp_swadian_man_at_arms_multiplayer"),
(assign,":var002",5),
(else_try),
(this_or_next|eq,":var001","trp_vaegir_horseman_multiplayer"),
(this_or_next|eq,":var001","trp_sarranid_mamluke_multiplayer"),
(this_or_next|eq,":var001","trp_rhodok_horseman_multiplayer"),
(this_or_next|eq,":var001","trp_nord_scout_multiplayer"),
(eq,":var001","trp_swadian_man_at_arms_multiplayer"),
(assign,":var002",1),
(else_try),
(eq,":var001","trp_vaegir_spearman_multiplayer"),
(assign,":var002",2),
(try_end),
(assign,reg0,":var002"),
]),

("multiplayer_clear_player_selected_items", [
(store_script_param, ":player_id_001", 1),
(try_for_range, ":slot_no_002", 2, 11),
(player_set_slot,":player_id_001",":slot_no_002",-1),
(try_end),
]),

("multiplayer_init_player_slots", [
(store_script_param, ":player_id_001", 1),
(call_script, "script_multiplayer_clear_player_selected_items", ":player_id_001"),
(player_set_slot,":player_id_001",0,0),
(player_set_slot,":player_id_001",1,0),
(player_set_slot,":player_id_001",26,0),
(player_set_slot,":player_id_001",35,0),
(player_set_slot,":player_id_001",36,0),
(player_set_slot,":player_id_001",37,0),
(player_set_slot,":player_id_001",38,0),
]),

("multiplayer_initialize_belfry_wheel_rotations", [
(scene_prop_get_num_instances, ":scp_num_instances_001", "spr_belfry_wheel"),
(try_for_range, ":var002", 0, ":scp_num_instances_001"),
(scene_prop_get_instance, ":scp_instance_003", "spr_belfry_wheel", ":var002"),
(prop_instance_initialize_rotation_angles, ":scp_instance_003"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_004", "spr_winch"),
(try_for_range, ":var005", 0, ":scp_num_instances_004"),
(scene_prop_get_instance, ":scp_instance_006", "spr_winch", ":var005"),
(prop_instance_initialize_rotation_angles, ":scp_instance_006"),
(try_end),
(scene_prop_get_num_instances, ":scp_num_instances_007", "spr_winch_b"),
(try_for_range, ":var008", 0, ":scp_num_instances_007"),
(scene_prop_get_instance, ":scp_instance_009", "spr_winch_b", ":var008"),
(prop_instance_initialize_rotation_angles, ":scp_instance_009"),
(try_end),
]),

("send_open_close_information_of_object", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":var002", 2),
(scene_prop_get_num_instances, ":scp_num_instances_003", ":var002"),
(try_for_range, ":var004", 0, ":scp_num_instances_003"),
(scene_prop_get_instance, ":scp_instance_005", ":var002", ":var004"),
(scene_prop_get_slot,":scene_prop_slot_006",":scp_instance_005",1),
(try_begin),
(eq,":scene_prop_slot_006",1),
(multiplayer_send_int_to_player, ":player_id_001", 77, ":scp_instance_005"),
(try_end),
(try_end),
]),

("multiplayer_send_initial_information", [
(store_script_param, ":player_id_001", 1),
(multiplayer_send_2_int_to_player, ":player_id_001", 51, 1, "$g_multiplayer_num_bots_team_1"),
(multiplayer_send_2_int_to_player, ":player_id_001", 51, 2, "$g_multiplayer_num_bots_team_2"),
(multiplayer_send_int_to_player, ":player_id_001", 93, "$g_multiplayer_auto_team_balance_limit"),
(multiplayer_send_int_to_player, ":player_id_001", 81, "$g_multiplayer_num_bots_voteable"),
(multiplayer_send_int_to_player, ":player_id_001", 82, "$g_multiplayer_factions_voteable"),
(multiplayer_send_int_to_player, ":player_id_001", 83, "$g_multiplayer_maps_voteable"),
(multiplayer_send_int_to_player, ":player_id_001", 90, "$g_multiplayer_kick_voteable"),
(multiplayer_send_int_to_player, ":player_id_001", 91, "$g_multiplayer_ban_voteable"),
(multiplayer_send_int_to_player, ":player_id_001", 102, "$g_multiplayer_allow_player_banners"),
(multiplayer_send_int_to_player, ":player_id_001", 103, "$g_multiplayer_force_default_armor"),
(multiplayer_send_int_to_player, ":player_id_001", 112, "$g_multiplayer_disallow_ranged_weapons"),
(multiplayer_send_int_to_player, ":player_id_001", 57, "$g_multiplayer_respawn_period"),
(multiplayer_send_int_to_player, ":player_id_001", 59, "$g_multiplayer_round_max_seconds"),
(multiplayer_send_int_to_player, ":player_id_001", 65, "$g_multiplayer_game_type"),
(multiplayer_send_int_to_player, ":player_id_001", 85, "$g_multiplayer_player_respawn_as_bot"),
(multiplayer_send_int_to_player, ":player_id_001", 122, "$g_multiplayer_ccoop_difficulty"),
(store_mission_timer_a,":m_timer_a_002"),
(multiplayer_send_int_to_player, ":player_id_001", 107, ":m_timer_a_002"),
(try_begin),
(eq,":::g_multiplayer_game_type",6),
(multiplayer_send_int_to_player, ":player_id_001", 88, "$g_multiplayer_number_of_respawn_count"),
(try_end),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_attached_scene_prop, ":agent_attached_scene_prop_004", ":cur_agent"),
(ge,":agent_attached_scene_prop_004",0),
(multiplayer_send_2_int_to_player, ":player_id_001", 70, ":cur_agent", ":agent_attached_scene_prop_004"),
(try_end),
(try_end),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_siege_ladder_move_6m"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_siege_ladder_move_8m"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_siege_ladder_move_10m"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_siege_ladder_move_12m"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_siege_ladder_move_14m"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_winch_b"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_castle_e_sally_door_a"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_castle_f_sally_door_a"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_earth_sally_gate_left"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_earth_sally_gate_right"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_viking_keep_destroy_sally_door_left"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_viking_keep_destroy_sally_door_right"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_castle_f_door_a"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_door_destructible"),
(call_script, "script_send_open_close_information_of_object", ":player_id_001", "spr_castle_f_door_b"),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(this_or_next|eq,":::g_multiplayer_game_type",3),
(eq,":::g_multiplayer_game_type",2),
(store_mission_timer_a,":m_timer_a_005"),
(val_sub, ":m_timer_a_005", ":::g_round_start_time"),
(val_mul, ":m_timer_a_005", -1),
(multiplayer_send_int_to_player, ":player_id_001", 78, ":m_timer_a_005"),
(else_try),
(eq,":::g_multiplayer_game_type",4),
(team_get_slot,":team_slot_006",0,0),
(multiplayer_send_2_int_to_player, ":player_id_001", 71, 0, ":team_slot_006"),
(team_get_slot,":team_slot_007",1,0),
(multiplayer_send_2_int_to_player, ":player_id_001", 71, 1, ":team_slot_007"),
(else_try),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(eq,":::g_multiplayer_game_type",5),
(try_for_range, ":var008", 0, ":::g_number_of_flags"),
(assign,":var009",0),
(assign,":var010",0),
(scene_prop_get_instance, ":scp_instance_011", "spr_headquarters_pole_code_only", ":var008"),
(prop_instance_get_position, pos0, ":scp_instance_011"),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(neg|agent_is_non_player, ":cur_agent"),
(agent_get_team, ":agent_team_no_012", ":cur_agent"),
(agent_get_position,pos1,":cur_agent"),
(get_sq_distance_between_positions,":sq_distance_013",0,1),
(get_sq_distance_between_position_heights,":sq_distance_014",0,1),
(val_add, ":sq_distance_013", ":sq_distance_014"),
(try_begin),
(lt,":sq_distance_013",1600),
(try_begin),
(eq,":agent_team_no_012",0),
(val_add, ":var009", 1),
(else_try),
(eq,":agent_team_no_012",1),
(val_add, ":var010", 1),
(try_end),
(try_end),
(try_end),
(store_mul, ":var015", ":var009", 100),
(val_add, ":var015", ":var010"),
(multiplayer_send_2_int_to_player, ":player_id_001", 73, ":var008", ":var015"),
(try_end),
(assign,"$g_placing_initial_flags",1),
(try_for_range, ":var016", 0, ":::g_number_of_flags"),
(store_add, ":slot_no_017", 146, ":var016"),
(troop_get_slot,":troop_slot_018","trp_multiplayer_data",":slot_no_017"),
(store_mul, ":var019", ":troop_slot_018", 100),
(val_add, ":var019", ":troop_slot_018"),
(val_add, ":var019", 1),
(val_mul, ":var019", -1),
(multiplayer_send_2_int_to_player, ":player_id_001", 75, ":var016", ":var019"),
(try_end),
(assign,"$g_placing_initial_flags",0),
(try_end),
]),

("multiplayer_remove_headquarters_flags", [
(assign,":var001","spr_headquarters_flag_gray"),
(val_add, ":var001", 1),
(try_for_range, ":var002", ":spr.headquarters_flag_red", ":var001"),
(replace_scene_props, ":var002","spr_empty"),
(try_end),
]),

("multiplayer_remove_destroy_mod_targets", [
(replace_scene_props, "spr_catapult_destructible","spr_empty"),
(replace_scene_props, "spr_trebuchet_destructible","spr_empty"),
]),

("multiplayer_init_mission_variables", [
(assign,"$g_multiplayer_team_1_first_spawn",1),
(assign,"$g_multiplayer_team_2_first_spawn",1),
(assign,"$g_multiplayer_poll_running",0),
(assign,"$g_waiting_for_confirmation_to_terminate",0),
(assign,"$g_confirmation_result",0),
(assign,"$g_team_balance_next_round",0),
(team_get_faction, "$g_multiplayer_team_1_faction", 0),
(team_get_faction, "$g_multiplayer_team_2_faction", 1),
(assign,"$g_multiplayer_next_team_1_faction","$g_multiplayer_team_1_faction"),
(assign,"$g_multiplayer_next_team_2_faction","$g_multiplayer_team_2_faction"),
(assign,"$g_multiplayer_bot_type_1_wanted",0),
(assign,"$g_multiplayer_bot_type_2_wanted",0),
(assign,"$g_multiplayer_bot_type_3_wanted",0),
(assign,"$g_multiplayer_bot_type_4_wanted",0),
(call_script, "script_music_set_situation_with_culture", 2048),
]),

("multiplayer_event_mission_end", [
(try_begin),
(eq,1,1),
(multiplayer_get_my_player, ":my_player"),
(try_begin),
(is_between,":my_player",0,1000),
(player_get_kill_count, ":kill_count_002", ":my_player"),
(player_get_death_count, ":death_count_003", ":my_player"),
(gt,":kill_count_002",":death_count_003"),
(unlock_achievement, 63),
(try_end),
(try_end),
]),

("multiplayer_event_agent_killed_or_wounded", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(multiplayer_get_my_player, ":my_player"),
(try_begin),
(neq,":::g_multiplayer_game_type",8),
(player_get_agent_id, ":agent_id_004", ":my_player"),
(try_begin),
(neq,":agent_id_004",-1),
(eq,":agent_id_004",":var001"),
(store_mission_timer_a,"$g_multiplayer_respawn_start_time"),
(try_end),
(try_end),
(try_begin),
(neq,":::g_multiplayer_game_type",8),
(is_between,":my_player",0,1000),
(player_get_agent_id, ":agent_id_005", ":my_player"),
(try_begin),
(eq,":var001",":agent_id_005"),
(assign,":var006",0),
(try_begin),
(neq,":::g_multiplayer_game_type",2),
(assign,":var006",1),
(else_try),
(eq,":::g_multiplayer_player_respawn_as_bot",1),
(player_get_team_no,  ":team_no_007", ":my_player"),
(assign,":var008",0),
(try_for_agents, ":cur_agent"),
(eq,":var008",0),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_get_team, ":agent_team_no_010", ":cur_agent"),
(try_begin),
(eq,":agent_team_no_010",":team_no_007"),
(assign,":var008",1),
(try_end),
(try_end),
(try_end),
(eq,":var008",1),
(assign,":var006",1),
(try_end),
(eq,":::g_multiplayer_game_type",6),
(gt,":::g_multiplayer_number_of_respawn_count",0),
(ge,":::g_my_spawn_count",":::g_multiplayer_number_of_respawn_count"),
(multiplayer_get_my_player, ":my_player"),
(player_get_team_no,  ":team_no_007", ":my_player"),
(try_begin),
(this_or_next|eq,":team_no_007",0),
(ge,":::g_my_spawn_count",999),
(assign,"$g_show_no_more_respawns_remained",1),
(else_try),
(assign,"$g_show_no_more_respawns_remained",0),
(try_end),
(try_end),
(eq,":var006",1),
(start_presentation, ":"),
(try_end),
(try_begin),
(is_between,":my_player",0,1000),
(player_get_agent_id, ":agent_id_004", ":my_player"),
(try_begin),
(ge,":agent_id_004",0),
(eq,":agent_id_004",":var001"),
(store_mission_timer_a,"$g_multiplayer_respawn_start_time"),
(try_end),
(eq,":agent_id_004",":var002"),
(neq,":agent_id_004",":var001"),
(agent_is_human,":var001"),
(agent_is_alive,":agent_id_004"),
(neg|agent_is_ally,":var001"),
(agent_get_horse,":agent_horse_011",":agent_id_004"),
(agent_get_wielded_item,":agent_wieled_item_012",":agent_id_004",0),
(assign,":item_slot_013",-1),
(ge,":agent_wieled_item_012",0),
(item_get_slot,":item_slot_013",":agent_wieled_item_012",60),
(try_end),
(lt,":agent_horse_011",0),
(agent_get_horse,":agent_horse_014",":var001"),
(ge,":agent_horse_014",0),
(get_achievement_stat, ":var015", 57, 0),
(lt,":var015",50),
(val_add, ":var015", 1),
(set_achievement_stat, 57, 0, ":var015"),
(ge,":var015",50),
(unlock_achievement, 57),
(try_end),
(ge,":agent_horse_011",0),
(this_or_next|eq,":item_slot_013",12),
(this_or_next|eq,":item_slot_013",13),
(this_or_next|eq,":item_slot_013",16),
(eq,":item_slot_013",17),
(get_achievement_stat, ":var015", 58, 0),
(lt,":var015",100),
(val_add, ":var015", 1),
(set_achievement_stat, 58, 0, ":var015"),
(ge,":var015",100),
(unlock_achievement, 58),
(try_end),
(this_or_next|eq,":item_slot_013",17),
(eq,":item_slot_013",16),
(get_achievement_stat, ":var015", 59, 0),
(lt,":var015",25),
(val_add, ":var015", 1),
(set_achievement_stat, 59, 0, ":var015"),
(ge,":var015",25),
(unlock_achievement, 59),
(try_end),
(ge,":agent_horse_011",0),
(eq,":item_slot_013",9),
(get_achievement_stat, ":var015", 60, 0),
(lt,":var015",25),
(val_add, ":var015", 1),
(set_achievement_stat, 60, 0, ":var015"),
(ge,":var015",25),
(unlock_achievement, 60),
(try_end),
(this_or_next|eq,":item_slot_013",1),
(this_or_next|eq,":item_slot_013",2),
(this_or_next|eq,":item_slot_013",5),
(this_or_next|eq,":item_slot_013",6),
(this_or_next|eq,":item_slot_013",7),
(this_or_next|eq,":agent_wieled_item_012","itm_sarranid_axe_a"),
(eq,":agent_wieled_item_012","itm_sarranid_axe_b"),
(neq,":agent_wieled_item_012","itm_sarranid_two_handed_mace_1"),
(get_achievement_stat, ":var015", 64, 0),
(lt,":var015",50),
(val_add, ":var015", 1),
(set_achievement_stat, 64, 0, ":var015"),
(ge,":var015",50),
(unlock_achievement, 64),
(try_end),
(this_or_next|eq,":item_slot_013",3),
(eq,":agent_wieled_item_012","itm_sarranid_two_handed_mace_1"),
(neq,":agent_wieled_item_012","itm_sarranid_axe_b"),
(neq,":agent_wieled_item_012","itm_sarranid_axe_a"),
(get_achievement_stat, ":var015", 65, 0),
(lt,":var015",25),
(val_add, ":var015", 1),
(set_achievement_stat, 65, 0, ":var015"),
(ge,":var015",25),
(unlock_achievement, 65),
(try_end),
(eq,":item_slot_013",17),
(get_achievement_stat, ":var015", 66, 0),
(lt,":var015",50),
(val_add, ":var015", 1),
(set_achievement_stat, 66, 0, ":var015"),
(ge,":var015",50),
(unlock_achievement, 66),
(try_end),
(try_begin),
(is_between,":my_player",0,1000),
(player_get_agent_id, ":agent_id_005", ":my_player"),
(try_begin),
(eq,":var001",":agent_id_005"),
(assign,":var006",0),
(try_begin),
(neq,":::g_multiplayer_game_type",2),
(neq,":::g_multiplayer_game_type",3),
(neq,":::g_multiplayer_game_type",8),
(assign,":var006",1),
(else_try),
(neq,":::g_multiplayer_game_type",8),
(eq,":::g_multiplayer_player_respawn_as_bot",1),
(player_get_team_no,  ":team_no_007", ":my_player"),
(assign,":var008",0),
(try_for_agents, ":cur_agent"),
(eq,":var008",0),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_get_team, ":agent_team_no_010", ":cur_agent"),
(try_begin),
(eq,":agent_team_no_010",":team_no_007"),
(assign,":var008",1),
(try_end),
(try_end),
(try_end),
(eq,":var008",1),
(assign,":var006",1),
(try_end),
(eq,":::g_multiplayer_game_type",6),
(gt,":::g_multiplayer_number_of_respawn_count",0),
(ge,":::g_my_spawn_count",":::g_multiplayer_number_of_respawn_count"),
(multiplayer_get_my_player, ":my_player"),
(player_get_team_no,  ":team_no_007", ":my_player"),
(try_begin),
(this_or_next|eq,":team_no_007",0),
(ge,":::g_my_spawn_count",999),
(assign,"$g_show_no_more_respawns_remained",1),
(else_try),
(assign,"$g_show_no_more_respawns_remained",0),
(try_end),
(try_end),
(eq,":var006",1),
(start_presentation, ":"),
(try_end),
]),

("multiplayer_get_item_value_for_troop", [
(store_script_param, ":item_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(try_begin),
(call_script, "script_cf_multiplayer_is_item_default_for_troop", ":item_id_001", ":troop_id_002"),
(assign,":item_value_003",0),
(else_try),
(store_item_value,":item_value_003",":item_id_001"),
(store_troop_faction,":troop_faction_004",":troop_id_002"),
(store_sub, ":slot_no_005", ":troop_faction_004", ":fac.kingdom_1"),
(val_add, ":slot_no_005", 30),
(item_get_slot,":item_slot_006",":item_id_001",":slot_no_005"),
(val_mul, ":item_value_003", ":item_slot_006"),
(val_div, ":item_value_003", 100),
(try_end),
(assign,reg0,":item_value_003"),
]),

("multiplayer_get_previous_item_for_item_and_troop", [
(store_script_param, ":item_id_001", 1),
(store_script_param, ":var002", 2),
(item_get_slot,":item_slot_003",":item_id_001",60),
(call_script, "script_multiplayer_get_item_value_for_troop", ":item_id_001", ":var002"),
(assign,":var004",reg0),
(store_sub, ":var005", ":var002", ":trp.swadian_crossbowman_multiplayer"),
(val_add, ":var005", 61),
(assign,":var006",-1),
(assign,":var007",-1),
(try_for_range, ":item_id_008", 0, ":itm.items_end"),
(item_slot_eq,":item_id_008",60,":item_slot_003"),
(item_slot_ge,":item_id_008",":var005",1),
(call_script, "script_multiplayer_get_item_value_for_troop", ":item_id_008", ":var002"),
(assign,":var009",reg0),
(try_begin),
(eq,":var009",0),
(eq,":var007",0),
(store_item_value,":item_value_010",":item_id_008"),
(store_item_value,":item_value_011",":var006"),
(gt,":item_value_010",":item_value_011"),
(assign,":var007",":var009"),
(assign,":var006",":item_id_008"),
(try_end),
(else_try),
(gt,":var009",":var007"),
(lt,":var009",":var004"),
(assign,":var007",":var009"),
(assign,":var006",":item_id_008"),
(try_end),
(try_begin),
(eq,":var006",-1),
(assign,":var012",-1),
(try_begin),
(is_between,":item_slot_003",1,10),
(assign,":var012",0),
(else_try),
(is_between,":item_slot_003",10,12),
(assign,":var012",1),
(else_try),
(eq,":item_slot_003",12),
(assign,":var012",2),
(else_try),
(eq,":item_slot_003",13),
(assign,":var012",3),
(else_try),
(eq,":item_slot_003",14),
(assign,":var012",4),
(else_try),
(eq,":item_slot_003",15),
(assign,":var012",5),
(else_try),
(eq,":item_slot_003",16),
(assign,":var012",6),
(else_try),
(is_between,":item_slot_003",22,24),
(assign,":var012",7),
(else_try),
(is_between,":item_slot_003",19,22),
(assign,":var012",8),
(else_try),
(is_between,":item_slot_003",24,26),
(assign,":var012",9),
(else_try),
(is_between,":item_slot_003",26,27),
(assign,":var012",10),
(else_try),
(is_between,":item_slot_003",18,19),
(assign,":var012",11),
(try_end),
(try_begin),
(neq,":var012",0),
(assign,":var013","itm_items_end"),
(try_for_range, ":item_id_008", 0, ":var013"),
(item_slot_ge,":item_id_008",":var005",1),
(item_get_slot,":item_slot_014",":item_id_008",60),
(try_begin),
(is_between,":item_slot_014",1,10),
(assign,":var015",0),
(else_try),
(is_between,":item_slot_014",10,12),
(assign,":var015",1),
(else_try),
(eq,":item_slot_014",12),
(assign,":var015",2),
(else_try),
(eq,":item_slot_014",13),
(assign,":var015",3),
(else_try),
(eq,":item_slot_014",14),
(assign,":var015",4),
(else_try),
(eq,":item_slot_014",15),
(assign,":var015",5),
(else_try),
(eq,":item_slot_014",16),
(assign,":var015",6),
(else_try),
(is_between,":item_slot_014",22,24),
(assign,":var015",7),
(else_try),
(is_between,":item_slot_014",19,22),
(assign,":var015",8),
(else_try),
(is_between,":item_slot_014",24,26),
(assign,":var015",9),
(else_try),
(is_between,":item_slot_014",26,27),
(assign,":var015",10),
(else_try),
(is_between,":item_slot_014",18,19),
(assign,":var015",11),
(try_end),
(try_end),
(eq,":var015",":var012"),
(call_script, "script_cf_multiplayer_is_item_default_for_troop", ":item_id_008", ":var002"),
(assign,":var006",":item_id_008"),
(assign,":var013",0),
(try_end),
(try_end),
(assign,reg0,":var006"),
]),

("cf_multiplayer_is_item_default_for_troop", [
(store_script_param, ":var001", 1),
(store_script_param, ":troop_id_002", 2),
(try_begin),
(neg|is_between,":var001","itm_sumpter_horse","itm_arrows"),
(neq,":var001","itm_warhorse_sarranid"),
(neq,":var001","itm_warhorse_steppe"),
(troop_get_inventory_capacity,":troop_inv_capacity_004",":troop_id_002"),
(try_for_range, ":inventory_slot_no_005", 0, ":troop_inv_capacity_004"),
(troop_get_inventory_slot,":troop_inv_slot_006",":troop_id_002",":inventory_slot_no_005"),
(eq,":var001",":troop_inv_slot_006"),
(assign,0,1), # var003
(assign,":troop_inv_capacity_004",0),
(try_end),
(try_end),
]),

("multiplayer_calculate_cur_selected_items_cost", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(player_get_troop_id, ":troop_id_004", ":player_id_001"),
(try_begin),
(eq,":var002",0),
(assign,":var005",11),
(assign,":var006",20),
(else_try),
(assign,":var005",2),
(assign,":var006",11),
(try_end),
(try_for_range, ":slot_no_007", ":var005", ":var006"),
(player_get_slot,":player_slot_008",":player_id_001",":slot_no_007"),
(try_begin),
(ge,":player_slot_008",0),
(call_script, "script_multiplayer_get_item_value_for_troop", ":player_slot_008", ":troop_id_004"),
(val_add, ":var003", reg0),
(try_end),
(try_end),
(assign,reg0,":var003"),
]),

("multiplayer_set_item_available_for_troop", [
(store_script_param, ":item_id_001", 1),
(store_script_param, ":var002", 2),
(store_sub, ":slot_no_003", ":var002", ":trp.swadian_crossbowman_multiplayer"),
(val_add, ":slot_no_003", 61),
(item_set_slot,":item_id_001",":slot_no_003",1),
]),

("multiplayer_send_item_selections", [
(multiplayer_get_my_player, ":my_player"),
(try_for_range, ":slot_no_002", 2, 11),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(multiplayer_send_2_int_to_server, 0, ":slot_no_002", ":player_slot_003"),
(try_end),
(try_begin),
(call_script, "script_cf_multiplayer_can_buy_squad"),
(try_for_range, ":slot_no_004", 43, 47),
(player_get_slot,":player_slot_005",":my_player",":slot_no_004"),
(multiplayer_send_3_int_to_server, 48, 0, ":slot_no_004", ":player_slot_005"),
(try_end),
(try_end),
]),

("multiplayer_set_default_item_selections_for_troop", [
(store_script_param, ":troop_id_001", 1),
(multiplayer_get_my_player, ":my_player"),
(call_script, "script_multiplayer_clear_player_selected_items", ":my_player"),
(assign,":var003",0),
(troop_get_inventory_capacity,":troop_inv_capacity_004",":troop_id_001"),
(try_for_range, ":inventory_slot_no_005", 0, ":troop_inv_capacity_004"),
(troop_get_inventory_slot,":troop_inv_slot_006",":troop_id_001",":inventory_slot_no_005"),
(try_begin),
(ge,":troop_inv_slot_006",0),
(item_get_slot,":item_slot_007",":troop_inv_slot_006",60),
(try_begin),
(is_between,":item_slot_007",1,18),
(this_or_next|eq,":::g_multiplayer_disallow_ranged_weapons",0),
(neg|is_between,":item_slot_007",12,18),
(store_add, ":slot_no_008", 2, ":var003"),
(player_set_slot,":my_player",":slot_no_008",":troop_inv_slot_006"),
(val_add, ":var003", 1),
(else_try),
(is_between,":item_slot_007",22,24),
(store_add, ":slot_no_008", 2, 4),
(player_set_slot,":my_player",":slot_no_008",":troop_inv_slot_006"),
(else_try),
(is_between,":item_slot_007",19,22),
(store_add, ":slot_no_008", 2, 5),
(player_set_slot,":my_player",":slot_no_008",":troop_inv_slot_006"),
(else_try),
(is_between,":item_slot_007",24,26),
(store_add, ":slot_no_008", 2, 6),
(player_set_slot,":my_player",":slot_no_008",":troop_inv_slot_006"),
(else_try),
(is_between,":item_slot_007",26,27),
(store_add, ":slot_no_008", 2, 7),
(player_set_slot,":my_player",":slot_no_008",":troop_inv_slot_006"),
(else_try),
(is_between,":item_slot_007",18,19),
(eq,":::g_horses_are_avaliable",1),
(store_add, ":slot_no_008", 2, 8),
(player_set_slot,":my_player",":slot_no_008",":troop_inv_slot_006"),
(try_end),
(try_end),
(try_end),
]),

("multiplayer_display_available_items_for_troop_and_item_classes", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(store_script_param, ":var004", 4),
(store_script_param, ":var005", 5),
(assign,":var006",100),
(try_begin),
(gt,":var004",500),
(assign,":var006",-100),
(try_end),
(store_sub, ":var007", ":var001", ":trp.swadian_crossbowman_multiplayer"),
(val_add, ":var007", 61),
(try_for_range, ":slot_no_008", 46, 146),
(troop_set_slot,"trp_multiplayer_data",":slot_no_008",-1),
(try_end),
(assign,":var009",0),
(try_for_range, ":item_id_010", 0, ":itm.items_end"),
(item_get_slot,":item_slot_011",":item_id_010",60),
(try_begin),
(is_between,":item_slot_011",":var002",":var003"),
(this_or_next|eq,":::g_multiplayer_disallow_ranged_weapons",0),
(neg|is_between,":item_slot_011",12,18),
(item_slot_ge,":item_id_010",":var007",1),
(store_add, ":slot_no_012", ":var009", 46),
(troop_set_slot,"trp_multiplayer_data",":slot_no_012",":item_id_010"),
(val_add, ":var009", 1),
(try_end),
(try_end),
(store_add, ":var013", ":var009", 46),
(store_sub, ":var014", ":var013", 1),
(try_for_range, ":slot_no_008", 46, ":var014"),
(store_add, ":var015", ":slot_no_008", 1),
(try_for_range, ":slot_no_016", ":var015", ":var013"),
(troop_get_slot,":troop_slot_017","trp_multiplayer_data",":slot_no_008"),
(troop_get_slot,":troop_slot_018","trp_multiplayer_data",":slot_no_016"),
(call_script, "script_multiplayer_get_item_value_for_troop", ":troop_slot_017", ":var001"),
(assign,":var019",reg0),
(call_script, "script_multiplayer_get_item_value_for_troop", ":troop_slot_018", ":var001"),
(assign,":var020",reg0),
(item_get_slot,":item_slot_021",":troop_slot_017",60),
(item_get_slot,":item_slot_022",":troop_slot_018",60),
(val_mul, ":item_slot_021", 1000000),
(val_mul, ":item_slot_022", 1000000),
(val_add, ":var019", ":item_slot_021"),
(val_add, ":var020", ":item_slot_022"),
(lt,":var020",":var019"),
(troop_set_slot,"trp_multiplayer_data",":slot_no_008",":troop_slot_018"),
(troop_set_slot,"trp_multiplayer_data",":slot_no_016",":troop_slot_017"),
(try_end),
(try_end),
(troop_get_slot,":troop_slot_023","trp_multiplayer_data",46),
(assign,":var024",0),
(try_begin),
(ge,":troop_slot_023",0),
(item_get_slot,":item_slot_025",":troop_slot_023",60),
(try_for_range, ":slot_no_008", 46, ":var013"),
(troop_get_slot,":item_id_010","trp_multiplayer_data",":slot_no_008"),
(item_get_slot,":item_slot_011",":item_id_010",60),
(try_begin),
(neq,":item_slot_011",":item_slot_025"),
(val_add, ":var024", 1),
(assign,":item_slot_025",":item_slot_011"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_mul, ":var026", ":var024", 100),
(try_begin),
(gt,":var026",":var005"),
(store_sub, ":var027", ":var026", ":var005"),
(val_div, ":var027", 100),
(val_add, ":var027", 1),
(val_mul, ":var027", 100),
(val_add, ":var005", ":var027"),
(try_end),
(try_end),
(item_get_slot,":item_slot_025",":troop_slot_023",60),
(try_end),
(assign,":var028",":var004"),
(assign,":var029",":var005"),
(try_for_range, ":slot_no_008", 46, ":var013"),
(troop_get_slot,":item_id_010","trp_multiplayer_data",":slot_no_008"),
(item_get_slot,":item_slot_011",":item_id_010",60),
(try_begin),
(neq,":item_slot_011",":item_slot_025"),
(val_sub, ":var029", 100),
(assign,":var028",":var004"),
(assign,":item_slot_025",":item_slot_011"),
(try_end),
(create_image_button_overlay, ":image_button_overlay_030", "mesh_mp_inventory_choose", "mesh_mp_inventory_choose"),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, ":image_button_overlay_030", 1),
(position_set_x,1,":var028"),
(position_set_y,1,":var029"),
(overlay_set_position, ":image_button_overlay_030", 1),
(create_mesh_overlay_with_item_id, reg0, ":item_id_010"),
(store_add, ":var031", ":var028", 50),
(store_add, ":var032", ":var029", 50),
(position_set_x,1,":var031"),
(position_set_y,1,":var032"),
(overlay_set_position, reg0, 1),
(val_add, ":var028", ":var006"),
(try_end),
]),

("multiplayer_fill_map_game_types", [
(store_script_param, ":var001", 1),
(try_for_range, ":slot_no_002", 0, 30),
(troop_set_slot,"trp_multiplayer_data",":slot_no_002",-1),
(try_end),
(assign,":var003",0),
(try_begin),
(this_or_next|eq,":var001",1),
(this_or_next|eq,":var001",7),
(eq,":var001",0),
(troop_set_slot,"trp_multiplayer_data",0,"scn_multi_scene_1"),
(troop_set_slot,"trp_multiplayer_data",1,"scn_multi_scene_2"),
(troop_set_slot,"trp_multiplayer_data",2,"scn_multi_scene_4"),
(troop_set_slot,"trp_multiplayer_data",3,"scn_multi_scene_7"),
(troop_set_slot,"trp_multiplayer_data",4,"scn_multi_scene_9"),
(troop_set_slot,"trp_multiplayer_data",5,"scn_multi_scene_11"),
(troop_set_slot,"trp_multiplayer_data",6,"scn_multi_scene_12"),
(troop_set_slot,"trp_multiplayer_data",7,"scn_multi_scene_14"),
(troop_set_slot,"trp_multiplayer_data",8,"scn_multi_scene_17"),
(troop_set_slot,"trp_multiplayer_data",9,"scn_multi_scene_18"),
(troop_set_slot,"trp_multiplayer_data",10,"scn_multi_scene_19"),
(troop_set_slot,"trp_multiplayer_data",11,"scn_multi_scene_20"),
(troop_set_slot,"trp_multiplayer_data",12,"scn_random_multi_plain_medium"),
(troop_set_slot,"trp_multiplayer_data",13,"scn_random_multi_plain_large"),
(troop_set_slot,"trp_multiplayer_data",14,"scn_random_multi_steppe_medium"),
(troop_set_slot,"trp_multiplayer_data",15,"scn_random_multi_steppe_large"),
(assign,":var003",16),
(else_try),
(eq,":var001",2),
(troop_set_slot,"trp_multiplayer_data",0,"scn_multi_scene_1"),
(troop_set_slot,"trp_multiplayer_data",1,"scn_multi_scene_2"),
(troop_set_slot,"trp_multiplayer_data",2,"scn_multi_scene_4"),
(troop_set_slot,"trp_multiplayer_data",3,"scn_multi_scene_7"),
(troop_set_slot,"trp_multiplayer_data",4,"scn_multi_scene_9"),
(troop_set_slot,"trp_multiplayer_data",5,"scn_multi_scene_11"),
(troop_set_slot,"trp_multiplayer_data",6,"scn_multi_scene_12"),
(troop_set_slot,"trp_multiplayer_data",7,"scn_multi_scene_14"),
(troop_set_slot,"trp_multiplayer_data",8,"scn_multi_scene_17"),
(troop_set_slot,"trp_multiplayer_data",9,"scn_multi_scene_18"),
(troop_set_slot,"trp_multiplayer_data",10,"scn_multi_scene_19"),
(troop_set_slot,"trp_multiplayer_data",11,"scn_multi_scene_20"),
(troop_set_slot,"trp_multiplayer_data",12,"scn_random_multi_plain_medium"),
(troop_set_slot,"trp_multiplayer_data",13,"scn_random_multi_plain_large"),
(troop_set_slot,"trp_multiplayer_data",14,"scn_random_multi_steppe_medium"),
(troop_set_slot,"trp_multiplayer_data",15,"scn_random_multi_steppe_large"),
(assign,":var003",16),
(else_try),
(eq,":var001",3),
(troop_set_slot,"trp_multiplayer_data",0,"scn_multi_scene_1"),
(troop_set_slot,"trp_multiplayer_data",1,"scn_multi_scene_2"),
(troop_set_slot,"trp_multiplayer_data",2,"scn_multi_scene_4"),
(troop_set_slot,"trp_multiplayer_data",3,"scn_multi_scene_7"),
(troop_set_slot,"trp_multiplayer_data",4,"scn_multi_scene_9"),
(troop_set_slot,"trp_multiplayer_data",5,"scn_multi_scene_12"),
(troop_set_slot,"trp_multiplayer_data",6,"scn_multi_scene_14"),
(troop_set_slot,"trp_multiplayer_data",7,"scn_multi_scene_19"),
(troop_set_slot,"trp_multiplayer_data",8,"scn_multi_scene_20"),
(assign,":var003",9),
(else_try),
(eq,":var001",4),
(troop_set_slot,"trp_multiplayer_data",0,"scn_multi_scene_1"),
(troop_set_slot,"trp_multiplayer_data",1,"scn_multi_scene_2"),
(troop_set_slot,"trp_multiplayer_data",2,"scn_multi_scene_4"),
(troop_set_slot,"trp_multiplayer_data",3,"scn_multi_scene_7"),
(troop_set_slot,"trp_multiplayer_data",4,"scn_multi_scene_9"),
(troop_set_slot,"trp_multiplayer_data",5,"scn_multi_scene_11"),
(troop_set_slot,"trp_multiplayer_data",6,"scn_multi_scene_12"),
(troop_set_slot,"trp_multiplayer_data",7,"scn_multi_scene_14"),
(troop_set_slot,"trp_multiplayer_data",8,"scn_multi_scene_17"),
(troop_set_slot,"trp_multiplayer_data",9,"scn_multi_scene_18"),
(troop_set_slot,"trp_multiplayer_data",10,"scn_multi_scene_19"),
(troop_set_slot,"trp_multiplayer_data",11,"scn_multi_scene_20"),
(troop_set_slot,"trp_multiplayer_data",12,"scn_random_multi_plain_medium"),
(troop_set_slot,"trp_multiplayer_data",13,"scn_random_multi_plain_large"),
(troop_set_slot,"trp_multiplayer_data",14,"scn_random_multi_steppe_medium"),
(troop_set_slot,"trp_multiplayer_data",15,"scn_random_multi_steppe_large"),
(assign,":var003",16),
(else_try),
(eq,":var001",5),
(troop_set_slot,"trp_multiplayer_data",0,"scn_multi_scene_1"),
(troop_set_slot,"trp_multiplayer_data",1,"scn_multi_scene_2"),
(troop_set_slot,"trp_multiplayer_data",2,"scn_multi_scene_4"),
(troop_set_slot,"trp_multiplayer_data",3,"scn_multi_scene_7"),
(troop_set_slot,"trp_multiplayer_data",4,"scn_multi_scene_9"),
(troop_set_slot,"trp_multiplayer_data",5,"scn_multi_scene_11"),
(troop_set_slot,"trp_multiplayer_data",6,"scn_multi_scene_12"),
(troop_set_slot,"trp_multiplayer_data",7,"scn_multi_scene_14"),
(troop_set_slot,"trp_multiplayer_data",8,"scn_multi_scene_17"),
(troop_set_slot,"trp_multiplayer_data",9,"scn_multi_scene_18"),
(troop_set_slot,"trp_multiplayer_data",10,"scn_multi_scene_19"),
(troop_set_slot,"trp_multiplayer_data",11,"scn_multi_scene_20"),
(assign,":var003",12),
(else_try),
(eq,":var001",6),
(troop_set_slot,"trp_multiplayer_data",0,"scn_multi_scene_3"),
(troop_set_slot,"trp_multiplayer_data",1,"scn_multi_scene_8"),
(troop_set_slot,"trp_multiplayer_data",2,"scn_multi_scene_10"),
(troop_set_slot,"trp_multiplayer_data",3,"scn_multi_scene_13"),
(troop_set_slot,"trp_multiplayer_data",4,"scn_multi_scene_15"),
(troop_set_slot,"trp_multiplayer_data",5,"scn_multi_scene_16"),
(assign,":var003",6),
(else_try),
(eq,":var001",8),
(troop_set_slot,"trp_multiplayer_data",0,"scn_multi_scene_1"),
(troop_set_slot,"trp_multiplayer_data",1,"scn_multi_scene_4"),
(troop_set_slot,"trp_multiplayer_data",2,"scn_multi_scene_7"),
(troop_set_slot,"trp_multiplayer_data",3,"scn_multi_scene_9"),
(troop_set_slot,"trp_multiplayer_data",4,"scn_multi_scene_11"),
(troop_set_slot,"trp_multiplayer_data",5,"scn_multi_scene_12"),
(troop_set_slot,"trp_multiplayer_data",6,"scn_multi_scene_14"),
(troop_set_slot,"trp_multiplayer_data",7,"scn_multi_scene_17"),
(troop_set_slot,"trp_multiplayer_data",8,"scn_multi_scene_18"),
(troop_set_slot,"trp_multiplayer_data",9,"scn_multi_scene_19"),
(troop_set_slot,"trp_multiplayer_data",10,"scn_multi_scene_20"),
(assign,":var003",11),
(try_end),
(assign,reg0,":var003"),
]),

("multiplayer_count_players_bots", [
(get_max_players, ":max_players"),
(try_for_range, ":player_id_002", 0, ":max_players"),
(player_is_active, ":player_id_002"),
(player_set_slot,":player_id_002",34,0),
(try_end),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_get_player_id,":agent_player_id_004",":cur_agent"),
(lt,":agent_player_id_004",0),
(agent_get_group, ":agent_group_005", ":cur_agent"),
(player_is_active, ":agent_group_005"),
(player_get_slot,":player_slot_006",":agent_group_005",34),
(val_add, ":player_slot_006", 1),
(player_set_slot,":agent_group_005",34,":player_slot_006"),
(try_end),
(try_end),
]),

("multiplayer_find_player_leader_for_bot", [
(store_script_param, ":team_id_001", 1),
(store_script_param, ":var002", 2),
(team_get_faction, ":team_faction_003", ":team_id_001"),
(assign,":var004",0),
(try_for_range, ":trp_005", ":trp.swadian_crossbowman_multiplayer_ai", ":trp.swadian_crossbowman_multiplayer"),
(store_troop_faction,":troop_faction_006",":trp_005"),
(try_begin),
(eq,":troop_faction_006",":team_faction_003"),
(val_add, ":var004", 1),
(try_end),
(try_end),
(call_script, "script_multiplayer_count_players_bots"),
(assign,":var007",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_009", 0, ":max_players"),
(assign,":var010",0),
(try_begin),
(player_is_active, ":player_id_009"),
(try_begin),
(eq,":var002",0),
(assign,":var010",1),
(else_try),
(neq,":var002",0),
(player_get_agent_id, ":agent_id_011", ":player_id_009"),
(try_begin),
(ge,":agent_id_011",0),
(agent_is_alive,":agent_id_011"),
(assign,":var010",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var010",1),
(player_get_team_no,  ":team_no_012", ":player_id_009"),
(eq,":team_id_001",":team_no_012"),
(val_add, ":var007", 1),
(try_end),
(try_end),
(assign,":var013",-1),
(try_begin),
(gt,":var007",0),
(assign,":var014","$g_multiplayer_num_bots_team_1"),
(try_begin),
(eq,":team_id_001",1),
(assign,":var014","$g_multiplayer_num_bots_team_2"),
(try_end),
(store_div, ":var___x1", ":var014", ":var007"),
(assign,":var015",":var___x1"),
(store_mul, ":var016", ":var015", ":var007"),
(try_begin),
(lt,":var016",":var014"),
(val_add, ":var015", 1),
(try_end),
(assign,":var017",0),
(try_for_range, ":player_id_009", 0, ":max_players"),
(player_is_active, ":player_id_009"),
(player_get_agent_id, ":agent_id_011", ":player_id_009"),
(ge,":agent_id_011",0),
(agent_is_alive,":agent_id_011"),
(player_get_team_no,  ":team_no_012", ":player_id_009"),
(eq,":team_id_001",":team_no_012"),
(assign,":var018",0),
(store_add, ":var019", 35, ":var004"),
(try_for_range, ":var020", 35, ":var019"),
(player_slot_ge,":player_id_009",":var020",1),
(assign,":var018",1),
(assign,":var019",0),
(try_end),
(try_end),
(eq,":var018",1),
(player_get_slot,":player_slot_021",":player_id_009",34),
(lt,":player_slot_021",":var015"),
(val_add, ":var017", ":var015"),
(val_sub, ":var017", ":player_slot_021"),
(try_end),
(gt,":var017",0),
(store_random_in_range,":random_x_022",0,":var017"),
(try_for_range, ":player_id_009", 0, ":max_players"),
(player_is_active, ":player_id_009"),
(player_get_agent_id, ":agent_id_011", ":player_id_009"),
(ge,":agent_id_011",0),
(agent_is_alive,":agent_id_011"),
(player_get_team_no,  ":team_no_012", ":player_id_009"),
(eq,":team_id_001",":team_no_012"),
(assign,":var018",0),
(store_add, ":var019", 35, ":var004"),
(try_for_range, ":var020", 35, ":var019"),
(player_slot_ge,":player_id_009",":var020",1),
(assign,":var018",1),
(assign,":var019",0),
(try_end),
(try_end),
(try_end),
(eq,":var018",1),
(player_get_slot,":player_slot_021",":player_id_009",34),
(lt,":player_slot_021",":var015"),
(val_sub, ":random_x_022", ":var015"),
(val_add, ":random_x_022", ":player_slot_021"),
(lt,":random_x_022",0),
(assign,":var013",":player_id_009"),
(assign,":max_players",0),
(try_end),
(assign,reg0,":var013"),
]),

("multiplayer_find_bot_troop_and_group_for_spawn", [
(store_script_param, ":team_id_001", 1),
(store_script_param, ":var002", 2),
(call_script, "script_multiplayer_find_player_leader_for_bot", ":team_id_001", ":var002"),
(assign,":var003",reg0),
(assign,":var004",0),
(assign,":var005",0),
(team_get_faction, ":team_faction_006", ":team_id_001"),
(try_for_range, ":trp_007", ":trp.swadian_crossbowman_multiplayer_ai", ":trp.swadian_crossbowman_multiplayer"),
(store_troop_faction,":troop_faction_008",":trp_007"),
(try_begin),
(eq,":troop_faction_008",":team_faction_006"),
(store_add, ":var009", 35, ":var004"),
(val_add, ":var004", 1),
(this_or_next|ge,":var003",0),
(player_slot_ge,":var003",":var009",1),
(val_add, ":var005", 1),
(try_end),
(try_end),
(assign,":var004",0),
(store_random_in_range,":random_x_010",0,":var005"),
(assign,":var011","trp_swadian_crossbowman_multiplayer"),
(try_for_range, ":trp_007", ":trp.swadian_crossbowman_multiplayer_ai", ":var011"),
(store_troop_faction,":troop_faction_008",":trp_007"),
(try_begin),
(eq,":troop_faction_008",":team_faction_006"),
(store_add, ":var009", 35, ":var004"),
(val_add, ":var004", 1),
(this_or_next|ge,":var003",0),
(player_slot_ge,":var003",":var009",1),
(val_sub, ":random_x_010", 1),
(lt,":random_x_010",0),
(assign,":var011",0),
(assign,":var012",":trp_007"),
(try_end),
(try_end),
(assign,reg0,":var012"),
(assign,reg1,":var003"),
]),

("multiplayer_change_leader_of_bot", [
(store_script_param, ":var001", 1),
(agent_get_team, ":agent_team_no_002", ":var001"),
(call_script, "script_multiplayer_find_player_leader_for_bot", ":agent_team_no_002", 1),
(assign,":var003",reg0),
(agent_set_group, ":var001", ":var003"),
]),

("multiplayer_find_spawn_point", [
(store_script_param, ":team_no_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(set_fixed_point_multiplier, 100),
(assign,":examine_all_spawn_points_004",0),
(try_begin),
(eq,":var002",1),
(val_or,":examine_all_spawn_points_004",4),
(try_end),
(try_begin),
(eq,":var003",1),
(val_or,":examine_all_spawn_points_004",2),
(try_end),
(try_begin),
(eq,":::g_multiplayer_game_type",0),
(eq,":::g_multiplayer_game_type",7),
(val_or,":examine_all_spawn_points_004",1),
(val_or,":examine_all_spawn_points_004",2048),
(else_try),
(eq,":::g_multiplayer_game_type",1),
(val_or,":examine_all_spawn_points_004",2048),
(else_try),
(eq,":::g_multiplayer_game_type",6),
(val_or,":examine_all_spawn_points_004",32),
(val_or,":examine_all_spawn_points_004",512),
(val_or,":examine_all_spawn_points_004",128),
(val_or,":examine_all_spawn_points_004",4096),
(else_try),
(eq,":::g_multiplayer_game_type",4),
(val_or,":examine_all_spawn_points_004",16),
(val_or,":examine_all_spawn_points_004",8),
(val_or,":examine_all_spawn_points_004",2048),
(else_try),
(eq,":::g_multiplayer_game_type",5),
(assign,":scene_prop_id_005",0),
(store_sub, ":var006", 900, 50),
(store_mul, ":var007", ":var006", ":var006"),
(val_div, ":var007", 100),
(try_for_range, ":var008", 0, ":::g_number_of_flags"),
(store_add, ":slot_no_009", 146, ":var008"),
(troop_get_slot,":troop_slot_010","trp_multiplayer_data",":slot_no_009"),
(scene_prop_get_instance, ":scp_instance_011", "spr_headquarters_pole_code_only", ":var008"),
(prop_instance_get_position, pos0, ":scp_instance_011"),
(try_begin),
(eq,":troop_slot_010",1),
(scene_prop_get_instance, ":scp_instance_012", "$team_1_flag_scene_prop", ":var008"),
(prop_instance_get_position, pos1, ":scp_instance_012"),
(get_sq_distance_between_positions,":sq_distance_013",0,1),
(try_begin),
(ge,":sq_distance_013",":var007"),
(set_spawn_effector_scene_prop_id <scene_prop_id>),
(val_add, ":scene_prop_id_005", 1),
(else_try),
(eq,":troop_slot_010",2),
(scene_prop_get_instance, ":scp_instance_014", "$team_2_flag_scene_prop", ":var008"),
(prop_instance_get_position, pos1, ":scp_instance_014"),
(get_sq_distance_between_positions,":sq_distance_013",0,1),
(try_begin),
(ge,":sq_distance_013",":var007"),
(set_spawn_effector_scene_prop_id <scene_prop_id>),
(val_add, ":scene_prop_id_005", 1),
(try_end),
(try_end),
(try_end),
(try_end),
(set_spawn_effector_scene_prop_id <scene_prop_id>),
(try_end),
(call_script, "script_multiplayer_find_spawn_point", reg0, ":team_no_001", ":examine_all_spawn_points_004"),
]),

("multiplayer_find_spawn_point_2", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(assign,":var004",-10000000),
(assign,":var005",0),
(assign,":var007",0),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(this_or_next|eq,":::g_multiplayer_game_type",5),
(eq,":::g_multiplayer_game_type",4),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(val_add, ":var007", 1),
(try_end),
(try_end),
(assign,":var009",":var007"),
(try_begin),
(le,":var009",4),
(assign,":var010",2),
(else_try),
(le,":var009",8),
(assign,":var010",2),
(else_try),
(le,":var009",16),
(assign,":var010",3),
(else_try),
(le,":var009",24),
(assign,":var010",4),
(else_try),
(le,":var009",32),
(assign,":var010",5),
(else_try),
(le,":var009",40),
(assign,":var010",6),
(else_try),
(assign,":var010",7),
(try_end),
(val_div, ":var007", 3),
(val_add, ":var007", 1),
(store_mul, ":var011", ":var007", -1),
(try_begin),
(eq,":var002",1),
(assign,":var010",1),
(try_end),
(try_begin),
(eq,":::g_multiplayer_game_type",5),
(assign,":var012",0),
(assign,":var013",0),
(try_for_range, ":var014", 0, ":::g_number_of_flags"),
(store_add, ":slot_no_015", 146, ":var014"),
(troop_get_slot,":troop_slot_016","trp_multiplayer_data",":slot_no_015"),
(neq,":troop_slot_016",0),
(val_sub, ":troop_slot_016", 1),
(try_begin),
(eq,":troop_slot_016",":var001"),
(val_add, ":var012", 1),
(else_try),
(val_add, ":var013", 1),
(try_end),
(try_end),
(try_end),
(assign,":var017",0),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(this_or_next|eq,":::g_multiplayer_game_type",5),
(eq,":::g_multiplayer_game_type",4),
(try_begin),
(eq,":var001",0),
(eq,":::g_multiplayer_team_1_first_spawn",1),
(assign,":var017",1),
(assign,"$g_multiplayer_team_1_first_spawn",0),
(else_try),
(eq,":var001",1),
(eq,":::g_multiplayer_team_2_first_spawn",1),
(assign,":var017",1),
(assign,"$g_multiplayer_team_2_first_spawn",0),
(try_end),
(try_end),
(try_begin),
(eq,":var017",1),
(store_mul, ":var005", ":var001", 32),
(else_try),
(try_for_range, ":var018", 0, 64),
(assign,":var019",3000),
(assign,":var020",3000),
(assign,":var021",0),
(store_random_in_range,":random_x_022",0,":var010"),
(try_begin),
(eq,":random_x_022",0),
(entry_point_get_position, pos0, ":var018"),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_team, ":agent_team_no_023", ":cur_agent"),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(this_or_next|eq,":::g_multiplayer_game_type",5),
(eq,":::g_multiplayer_game_type",4),
(try_begin),
(teams_are_enemies, ":var001", ":agent_team_no_023"),
(assign,":var024",-2),
(else_try),
(assign,":var024",1),
(try_end),
(try_end),
(else_try),
(this_or_next|eq,":::g_multiplayer_game_type",7),
(eq,":::g_multiplayer_game_type",0),
(assign,":var024",-1),
(try_end),
(agent_get_position,pos1,":cur_agent"),
(get_distance_between_positions_in_meters,":distance_025",0,1),
(val_add, 0, 1), # var006
(try_begin),
(eq,1,1),
(try_begin),
(lt,":var024",0),
(try_begin),
(lt,":distance_025",":var019"),
(assign,":var020",":var019"),
(assign,":var019",":distance_025"),
(else_try),
(lt,":distance_025",":var020"),
(assign,":var020",":distance_025"),
(try_end),
(try_end),
(try_begin),
(lt,":distance_025",100),
(try_begin),
(lt,":distance_025",3),
(try_begin),
(this_or_next|eq,":var002",0),
(this_or_next|ge,":var024",0),
(neq,":::g_multiplayer_game_type",6),
(try_begin),
(lt,":distance_025",1),
(assign,":var026",-1000000),
(else_try),
(lt,":distance_025",2),
(try_begin),
(lt,":var024",0),
(assign,":var026",-20000),
(else_try),
(assign,":var026",-2000),
(try_end),
(try_end),
(else_try),
(try_begin),
(lt,":var024",0),
(assign,":var026",-10000),
(else_try),
(assign,":var026",-1000),
(try_end),
(try_end),
(else_try),
(try_begin),
(lt,":distance_025",1),
(assign,":var026",-20000),
(else_try),
(lt,":distance_025",2),
(assign,":var026",-2000),
(else_try),
(assign,":var026",-1000),
(try_end),
(try_end),
(val_mul, ":var026", ":var007"),
(else_try),
(assign,":var026",0),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(this_or_next|ge,":var024",0),
(eq,":var001",1),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(this_or_next|eq,":::g_multiplayer_game_type",5),
(eq,":::g_multiplayer_game_type",4),
(store_sub, ":var026", 45, ":distance_025"),
(val_max,":var026",0),
(val_mul, ":var026", ":var026"),
(else_try),
(store_mul, ":var027", 45, 3),
(val_div, ":var027", 2),
(store_sub, ":var026", ":var027", ":distance_025"),
(val_mul, ":var026", ":var026"),
(try_end),
(try_end),
(val_mul, ":var026", ":var024"),
(try_end),
(val_add, ":var021", ":var026"),
(try_end),
(try_end),
(try_begin),
(eq,":::g_multiplayer_game_type",6),
(store_mul, ":var028", 1000, ":var007"),
(try_begin),
(ge,":var021",":var028"),
(assign,":var021",":var028"),
(try_end),
(try_end),
(try_begin),
(neq,":::g_multiplayer_game_type",6),
(try_begin),
(lt,":var019",3000),
(try_begin),
(gt,":var019",32),
(val_sub, ":var019", 32),
(store_mul, ":var029", ":var019", -50),
(val_mul, ":var029", ":var007"),
(val_add, ":var021", ":var029"),
(try_end),
(try_end),
(try_begin),
(lt,":var020",3000),
(try_begin),
(gt,":var020",32),
(val_sub, ":var020", 32),
(store_mul, ":var030", ":var020", -50),
(val_mul, ":var030", ":var007"),
(val_add, ":var021", ":var030"),
(try_end),
(try_end),
(try_end),
(try_begin),
(neq,":var003",-1),
(position_get_distance_to_terrain, ":distance_to_terrain_031", 0),
(val_max,":distance_to_terrain_031",0),
(val_min,":distance_to_terrain_031",300),
(try_begin),
(ge,":distance_to_terrain_031",40),
(store_mul, ":var032", ":distance_to_terrain_031", ":var007"),
(try_begin),
(eq,":::g_multiplayer_game_type",1),
(val_mul, ":var032", 16),
(else_try),
(val_mul, ":var032", 4),
(try_end),
(try_end),
(try_begin),
(eq,":var003",0),
(try_begin),
(eq,":::g_multiplayer_game_type",6),
(eq,":var001",0),
(val_add, ":var021", ":var032"),
(try_end),
(else_try),
(val_mul, ":var032", 5),
(val_sub, ":var021", ":var032"),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(this_or_next|eq,":::g_multiplayer_game_type",5),
(eq,":::g_multiplayer_game_type",4),
(try_begin),
(neq,":::g_multiplayer_game_type",6),
(store_random_in_range,":random_x_022",0,400),
(try_begin),
(eq,":::g_multiplayer_game_type",4),
(val_mul, ":random_x_022", 5),
(try_end),
(else_try),
(eq,":var001",1),
(store_random_in_range,":random_x_022",0,600),
(else_try),
(store_random_in_range,":random_x_022",0,200),
(try_end),
(val_mul, ":random_x_022", ":var007"),
(val_add, ":var021", ":random_x_022"),
(try_end),
(try_begin),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(this_or_next|eq,":::g_multiplayer_game_type",5),
(eq,":::g_multiplayer_game_type",4),
(try_begin),
(eq,":::g_multiplayer_game_type",4),
(try_begin),
(eq,":var001",0),
(entry_point_get_position, pos1, 64),
(entry_point_get_position, pos2, 65),
(else_try),
(entry_point_get_position, pos1, 65),
(entry_point_get_position, pos2, 64),
(try_end),
(else_try),
(try_begin),
(eq,":var001",0),
(entry_point_get_position, pos1, 66),
(entry_point_get_position, pos2, 32),
(else_try),
(entry_point_get_position, pos1, 32),
(entry_point_get_position, pos2, 66),
(try_end),
(try_end),
(try_begin),
(eq,":::g_multiplayer_game_type",6),
(position_get_z,":pos_z_033",0),
(position_set_z,1,":pos_z_033"),
(position_set_z,2,":pos_z_033"),
(try_end),
(get_sq_distance_between_positions_in_meters,":sq_distance_034",0,1),
(get_sq_distance_between_positions_in_meters,":sq_distance_035",0,2),
(get_distance_between_positions_in_meters,":distance_036",0,2),
(assign,":var037",0),
(try_begin),
(eq,":::g_multiplayer_game_type",4),
(get_distance_between_positions_in_meters,":distance_038",0,1),
(try_begin),
(lt,":distance_038",100),
(store_sub, ":var037", 100, ":distance_038"),
(try_begin),
(gt,":var037",75),
(assign,":var037",75),
(try_end),
(try_end),
(val_mul, ":var037", 50),
(val_mul, ":var037", ":var007"),
(else_try),
(lt,":sq_distance_034",10000),
(try_begin),
(eq,":var001",0),
(try_begin),
(lt,":sq_distance_034",2500),
(assign,":sq_distance_034",0),
(else_try),
(val_sub, ":sq_distance_034", 2500),
(val_mul, ":sq_distance_034", 2),
(try_end),
(try_end),
(store_sub, ":var037", 10000, ":sq_distance_034"),
(val_add, ":var037", 5000),
(try_begin),
(eq,":var001",0),
(else_try),
(val_div, ":var037", 45),
(try_end),
(val_mul, ":var037", ":var007"),
(try_end),
(val_add, ":var021", ":var037"),
(assign,":var039",0),
(try_begin),
(eq,":::g_multiplayer_game_type",4),
(lt,":distance_036",150),
(store_sub, ":var039", 150, ":distance_036"),
(try_begin),
(gt,":var039",50),
(store_sub, ":var040", ":var039", 50),
(val_mul, ":var040", 2),
(val_add, ":var039", ":var040"),
(try_end),
(val_mul, ":var039", -50),
(val_mul, ":var039", ":var007"),
(else_try),
(this_or_next|eq,":::g_multiplayer_game_type",6),
(eq,":var001",1),
(assign,":var039",0),
(try_begin),
(neq,":::g_multiplayer_game_type",6),
(try_begin),
(lt,":sq_distance_035",10000),
(store_sub, ":var039", 10000, ":sq_distance_035"),
(val_div, ":var039", 4),
(val_mul, ":var039", ":var011"),
(try_end),
(else_try),
(val_max,":distance_036",60),
(try_begin),
(eq,":var003",1),
(assign,":var041",120),
(else_try),
(assign,":var041",80),
(try_end),
(try_begin),
(le,":distance_036",":var041"),
(store_sub, ":var039", ":var041", ":distance_036"),
(val_mul, ":var039", 180),
(else_try),
(store_sub, ":var039", ":distance_036", ":var041"),
(val_mul, ":var039", 30),
(try_end),
(val_sub, ":var039", 600),
(val_max,":var039",0),
(val_mul, ":var039", ":var011"),
(try_end),
(try_end),
(val_add, ":var021", ":var039"),
(else_try),
(eq,":::g_multiplayer_game_type",5),
(try_for_range, ":var014", 0, ":::g_number_of_flags"),
(store_add, ":slot_no_015", 146, ":var014"),
(troop_get_slot,":troop_slot_016","trp_multiplayer_data",":slot_no_015"),
(try_begin),
(neq,":troop_slot_016",0),
(val_sub, ":troop_slot_016", 1),
(scene_prop_get_instance, ":scp_instance_042", "spr_headquarters_pole_code_only", ":var014"),
(prop_instance_get_position, pos1, ":scp_instance_042"),
(get_sq_distance_between_positions_in_meters,":sq_distance_043",0,1),
(try_begin),
(lt,":sq_distance_043",6400),
(try_begin),
(eq,":troop_slot_016",":var001"),
(store_sub, ":var044", 6400, ":sq_distance_043"),
(val_mul, ":var044", 2),
(val_div, ":var044", ":var012"),
(val_mul, ":var044", ":var007"),
(else_try),
(store_sub, ":var044", 6400, ":sq_distance_043"),
(val_mul, ":var044", 2),
(val_div, ":var044", ":var013"),
(val_mul, ":var044", ":var011"),
(try_end),
(try_end),
(try_end),
(val_add, ":var021", ":var044"),
(try_end),
(try_end),
(try_begin),
(gt,":var021",":var004"),
(assign,":var004",":var021"),
(assign,":var005",":var018"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var005"),
]),

("multiplayer_buy_agent_equipment", [
(store_script_param, ":player_id_001", 1),
(player_get_troop_id, ":troop_id_002", ":player_id_001"),
(player_get_gold, ":gold_003", ":player_id_001"),
(player_get_slot,":player_slot_004",":player_id_001",1),
(player_set_slot,":player_id_001",1,0),
(val_add, ":gold_003", ":player_slot_004"),
(assign,":var005",0),
(try_for_range, ":slot_no_006", 2, 11),
(player_get_slot,":player_slot_007",":player_id_001",":slot_no_006"),
(store_sub, ":slot_no_008", ":slot_no_006", 2),
(try_begin),
(player_item_slot_is_picked_up, ":player_id_001", ":slot_no_008"),
(assign,":player_slot_007",-1),
(try_end),
(val_add, ":slot_no_008", 11),
(player_set_slot,":player_id_001",":slot_no_008",":player_slot_007"),
(try_end),
(assign,":var009",1000),
(try_for_range, ":var010", 0, ":var009"),
(call_script, "script_multiplayer_calculate_cur_selected_items_cost", ":player_id_001", 0),
(assign,":var011",reg0),
(try_begin),
(gt,":var011",":gold_003"),
(call_script, "script_multiplayer_get_troop_class", ":troop_id_002"),
(assign,":var012",reg0),
(assign,":var013",0),
(assign,":slot_no_014",-1),
(try_for_range, ":slot_no_006", 11, 20),
(player_get_slot,":player_slot_015",":player_id_001",":slot_no_006"),
(try_begin),
(ge,":player_slot_015",0),
(call_script, "script_multiplayer_get_item_value_for_troop", ":player_slot_015", ":troop_id_002"),
(assign,":var016",reg0),
(store_sub, ":var017", ":slot_no_006", 11),
(try_begin),
(this_or_next|eq,":var017",3),
(this_or_next|eq,":var017",2),
(this_or_next|eq,":var017",1),
(eq,":var017",0),
(val_mul, ":var016", 5),
(else_try),
(eq,":var017",4),
(val_mul, ":var016", 4),
(else_try),
(eq,":var017",5),
(val_mul, ":var016", 2),
(else_try),
(eq,":var017",6),
(val_mul, ":var016", 8),
(else_try),
(eq,":var017",7),
(val_mul, ":var016", 8),
(else_try),
(try_end),
(try_end),
(item_get_slot,":item_slot_018",":player_slot_015",60),
(try_begin),
(eq,":var012",1),
(this_or_next|eq,":item_slot_018",1),
(this_or_next|eq,":item_slot_018",2),
(this_or_next|eq,":item_slot_018",3),
(this_or_next|eq,":item_slot_018",4),
(this_or_next|eq,":item_slot_018",6),
(this_or_next|eq,":item_slot_018",10),
(eq,":item_slot_018",7),
(val_div, ":var016", 2),
(else_try),
(eq,":var012",2),
(this_or_next|eq,":item_slot_018",8),
(eq,":item_slot_018",11),
(val_div, ":var016", 2),
(else_try),
(eq,":var012",3),
(this_or_next|eq,":item_slot_018",9),
(this_or_next|eq,":item_slot_018",1),
(eq,":item_slot_018",18),
(val_div, ":var016", 2),
(else_try),
(eq,":var012",4),
(this_or_next|eq,":item_slot_018",12),
(eq,":item_slot_018",14),
(val_div, ":var016", 2),
(else_try),
(eq,":var012",5),
(this_or_next|eq,":item_slot_018",13),
(eq,":item_slot_018",15),
(val_div, ":var016", 2),
(else_try),
(eq,":var012",6),
(this_or_next|eq,":item_slot_018",12),
(this_or_next|eq,":item_slot_018",14),
(eq,":item_slot_018",18),
(val_div, ":var016", 2),
(else_try),
(eq,":var012",7),
(this_or_next|eq,":item_slot_018",13),
(this_or_next|eq,":item_slot_018",15),
(eq,":item_slot_018",18),
(val_div, ":var016", 2),
(try_end),
(try_begin),
(gt,":var016",":var013"),
(assign,":var013",":var016"),
(assign,":slot_no_014",":slot_no_006"),
(try_end),
(try_end),
(player_get_slot,":player_slot_015",":player_id_001",":slot_no_014"),
(call_script, "script_multiplayer_get_previous_item_for_item_and_troop", ":player_slot_015", ":troop_id_002"),
(assign,":player_slot_015",reg0),
(player_set_slot,":player_id_001",":slot_no_014",":player_slot_015"),
(else_try),
(assign,":var009",0),
(val_sub, ":gold_003", ":var011"),
(player_set_gold, ":player_id_001", ":gold_003", 15000),
(try_for_range, ":slot_no_006", 11, 20),
(player_get_slot,":player_slot_015",":player_id_001",":slot_no_006"),
(try_begin),
(ge,":player_slot_015",0),
(else_try),
(store_sub, ":var019", ":slot_no_006", 11),
(store_add, ":slot_no_020", ":var019", 2),
(player_get_slot,":player_slot_007",":player_id_001",":slot_no_020"),
(try_begin),
(this_or_next|eq,":player_slot_007",-1),
(player_item_slot_is_picked_up, ":player_id_001", ":var019"),
(else_try),
(item_get_slot,":item_slot_018",":player_slot_007",60),
(try_begin),
(is_between,":item_slot_018",1,18),
(assign,":var021",-1),
(try_for_range, ":var022", 1, 10),
(lt,":var021",0),
(assign,":var023",0),
(try_for_range, ":slot_no_024", 11, 20),
(player_get_slot,":player_slot_025",":player_id_001",":slot_no_024"),
(try_begin),
(ge,":player_slot_025",0),
(item_get_slot,":item_slot_026",":player_slot_025",60),
(try_begin),
(eq,":item_slot_026",":var022"),
(assign,":var023",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var023",0),
(assign,":var027","itm_items_end"),
(try_for_range, ":var028", 0, ":var027"),
(item_slot_eq,":var028",60,":var022"),
(call_script, "script_cf_multiplayer_is_item_default_for_troop", ":var028", ":troop_id_002"),
(assign,":var027",0),
(assign,":var021",":var028"),
(try_end),
(try_end),
(try_end),
(try_begin),
(ge,":var021",0),
(player_set_slot,":player_id_001",":slot_no_006",":var021"),
(assign,":player_slot_015",":var021"),
(try_end),
(try_end),
(try_begin),
(ge,":player_slot_015",0),
(store_sub, ":item_slot_no_029", ":slot_no_006", 11),
(player_add_spawn_item, ":player_id_001", ":item_slot_no_029", ":player_slot_015"),
(try_begin),
(eq,":item_slot_no_029",5),
(assign,":var005",1),
(try_end),
(try_end),
(try_end),
(player_set_slot,":player_id_001",27,":var011"),
(try_end),
(try_end),
(try_begin),
(eq,":var005",0),
(eq,":::g_multiplayer_force_default_armor",1),
(assign,":var009","itm_items_end"),
(try_for_range, ":item_id_030", 0, ":var009"),
(this_or_next|item_slot_eq,":item_id_030",60,19),
(this_or_next|item_slot_eq,":item_id_030",60,20),
(item_slot_eq,":item_id_030",60,21),
(call_script, "script_cf_multiplayer_is_item_default_for_troop", ":item_id_030", ":troop_id_002"),
(assign,":var009",0),
(player_add_spawn_item, ":player_id_001", 5, ":item_id_030"),
(try_end),
(try_end),
]),

("party_get_ideal_size", [
(store_script_param, ":party_id_001", 1),
(assign,":var002",30),
(try_begin),
(party_slot_eq,":party_id_001",0,13),
(party_stack_get_troop_id,      ":troop_id_003",":party_id_001",0),
(store_faction_of_party, ":party_faction_004", ":party_id_001"),
(assign,":var002",10),
(store_skill_level,":skill_lvl_005","skl_leadership",":troop_id_003"),
(store_attribute_level,":attribute_lvl_006",":troop_id_003",3),
(val_mul, ":skill_lvl_005", 5),
(val_add, ":var002", ":skill_lvl_005"),
(val_add, ":var002", ":attribute_lvl_006"),
(troop_get_slot,":troop_slot_007",":troop_id_003",7),
(store_div, ":var___x1", ":troop_slot_007", 25),
(assign,":var008",":var___x1"),
(val_add, ":var002", ":var008"),
(try_begin),
(faction_slot_eq,":party_faction_004",11,":troop_id_003"),
(val_add, ":var002", 100),
(try_end),
(try_begin),
(faction_slot_eq,":party_faction_004",8,":troop_id_003"),
(val_add, ":var002", 20),
(try_end),
(try_for_range, ":p_009", ":p.castle_1", ":p.village_1"),
(party_slot_eq,":p_009",7,":troop_id_003"),
(val_add, ":var002", 20),
(try_end),
(try_end),
(store_character_level,":character_lvl_010","trp_player"),
(val_min,":character_lvl_010",80),
(store_add, ":var011", 80, ":character_lvl_010"),
(val_mul, ":var002", ":var011"),
(val_div, ":var002", 80),
(assign,reg0,":var002"),
]),

("game_get_party_prisoner_limit", [
(assign,":[troop_id_001]","trp_player"),
(assign,":var002",0),
(store_skill_level,":skill_lvl_003","skl_prisoner_management",":[troop_id_001]"),
(store_mul, ":var002", ":skill_lvl_003", 5),
(assign,reg0,":var002"),
(set_trigger_result, reg0),
]),

("game_get_item_extra_text", [
(store_script_param, ":item_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(try_begin),
(is_between,":item_id_001","itm_smoked_fish","itm_siege_supply"),
(try_begin),
(eq,":var002",0),
(assign,":var004",1),
(try_begin),
(this_or_next|eq,":item_id_001","itm_cattle_meat"),
(this_or_next|eq,":item_id_001","itm_pork"),
(eq,":item_id_001","itm_chicken"),
(eq,":var003",41),
(assign,":var004",0),
(try_end),
(try_begin),
(eq,":var004",1),
(item_get_slot,":item_slot_005",":item_id_001",1),
(assign,reg1,":item_slot_005"),
sets the result string for game scripts that need one (set_result_string, "@+{reg1} to party morale"),
(set_trigger_result, 4474111),
(try_end),
(try_end),
(else_try),
(is_between,":item_id_001","itm_book_tactics","itm_book_wound_treatment_reference"),
(try_begin),
(eq,":var002",0),
(item_get_slot,reg1,":item_id_001",4),
sets the result string for game scripts that need one (set_result_string, "@Requires {reg1} intelligence to read"),
(set_trigger_result, 16772829),
(else_try),
(eq,":var002",1),
(item_get_slot,":item_slot_006",":item_id_001",2),
(val_div, ":item_slot_006", 10),
(assign,reg1,":item_slot_006"),
sets the result string for game scripts that need one (set_result_string, "@Reading Progress: {reg1}%"),
(set_trigger_result, 16772829),
(try_end),
(else_try),
(is_between,":item_id_001","itm_book_wound_treatment_reference","itm_spice"),
(try_begin),
(eq,":var002",0),
(try_begin),
(eq,":item_id_001","itm_book_wound_treatment_reference"),
(str_store_string,s1,":str_store_string("@wound treament")"),
(else_try),
(eq,":item_id_001","itm_book_training_reference"),
(str_store_string,s1,":str_store_string("@trainer")"),
(else_try),
(eq,":item_id_001","itm_book_surgery_reference"),
(str_store_string,s1,":str_store_string("@surgery")"),
(try_end),
sets the result string for game scripts that need one (set_result_string, "@+1 to {s1} while in inventory"),
(set_trigger_result, 16772829),
(try_end),
(try_end),
]),

("game_on_disembark", [
(jump_to_menu,"mnu_disembark"),
]),

("game_context_menu_get_buttons", [
(store_script_param, ":party_id_001", 1),
(try_begin),
(neq,":party_id_001","p_main_party"),
(right_mouse_menu_add_item, "@Move here", -7),
(try_end),
(try_begin),
(is_between,":party_id_001","p_town_1","p_salt_mine"),
(right_mouse_menu_add_item, "@View notes", 1),
(else_try),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(try_begin),
(gt,":party_num_companions_stacks_002",0),
(party_stack_get_troop_id,      ":troop_id_003",":party_id_001",0),
(try_begin),
(is_between,":troop_id_003","trp_npc1","trp_knight_1_1_wife"),
(right_mouse_menu_add_item, "@View notes", 2),
(try_end),
(try_end),
(try_end),
(try_begin),
(neq,":party_id_001","p_main_party"),
(store_faction_of_party, ":party_faction_004", ":party_id_001"),
(try_begin),
(this_or_next|eq,":party_faction_004",":::players_kingdom"),
(this_or_next|eq,":party_faction_004","fac_player_supporters_faction"),
(party_slot_eq,":party_id_001",0,11),
(neg|is_between,":party_id_001","p_town_1","p_salt_mine"),
(right_mouse_menu_add_item, "@Accompany", -6),
(try_end),
(try_end),
]),

("game_event_context_menu_button_clicked", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(eq,":var002",1),
(change_screen_notes, 3, ":party_id_001"),
(else_try),
(eq,":var002",2),
(party_stack_get_troop_id,      ":troop_id_003",":party_id_001",0),
(change_screen_notes, 1, ":troop_id_003"),
(try_end),
]),

("game_get_skill_modifier_for_troop", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":trigger_result_003",0),
(try_begin),
(eq,":var002","skl_wound_treatment"),
(call_script, "script_get_troop_item_amount", ":var001", "itm_book_wound_treatment_reference"),
(try_begin),
(gt,reg0,0),
(val_add, ":trigger_result_003", 1),
(else_try),
(eq,":var002","skl_trainer"),
(call_script, "script_get_troop_item_amount", ":var001", "itm_book_training_reference"),
(try_begin),
(gt,reg0,0),
(val_add, ":trigger_result_003", 1),
(else_try),
(eq,":var002","skl_surgery"),
(call_script, "script_get_troop_item_amount", ":var001", "itm_book_surgery_reference"),
(try_begin),
(gt,reg0,0),
(val_add, ":trigger_result_003", 1),
(try_end),
(try_end),
(try_end),
(try_end),
(set_trigger_result, ":trigger_result_003"),
]),

("npc_get_troop_wage", [
(store_script_param, ":troop_id_001", 1),
(assign,":character_lvl_002",0),
(try_begin),
(troop_is_hero,":troop_id_001"),
(else_try),
(store_character_level,":character_lvl_002",":troop_id_001"),
(val_mul, ":character_lvl_002", ":character_lvl_002"),
(val_add, ":character_lvl_002", 50),
(val_div, ":character_lvl_002", 30),
(try_begin),
(troop_is_mounted,":troop_id_001"),
(val_mul, ":character_lvl_002", 5),
(val_div, ":character_lvl_002", 4),
(try_end),
(try_end),
(assign,reg0,":character_lvl_002"),
]),

("setup_talk_info", [
(talk_info_set_relation_bar, "$g_talk_troop_relation"),
(str_store_string,s61,":str_store_troop_name(_g_talk_troop)"),
(str_store_string,s61,":str_store_string("@{!} {s61}")"),
(assign,reg1,"$g_talk_troop_relation"),
(str_store_string,s62,":str_store_string("str_relation_reg1")"),
(talk_info_set_line, 0, 61),
(talk_info_set_line, 1, 62),
(call_script, "script_describe_relation_to_s63", "$g_talk_troop_relation"),
(talk_info_set_line, 3, 63),
]),

("setup_talk_info_companions", [
(call_script, "script_npc_morale", "$g_talk_troop"),
(assign,":var001",reg0),
(talk_info_set_relation_bar, ":var001"),
(str_store_string,s61,":str_store_troop_name(_g_talk_troop)"),
(str_store_string,s61,":str_store_string("@{!} {s61}")"),
(assign,reg1,":var001"),
(str_store_string,s62,":str_store_string("str_morale_reg1")"),
(talk_info_set_line, 0, 61),
(talk_info_set_line, 1, 62),
(talk_info_set_line, 3, 63),
]),

("update_party_creation_random_limits", [
(store_character_level,":character_lvl_001","trp_player"),
(store_mul, ":var002", ":character_lvl_001", 3),
(val_add, ":var002", 25),
(val_min,":var002",100),
(set_party_creation_random_limits, 0, ":var002"),
(assign,reg0,":var002"),
]),

("set_trade_route_between_centers", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":party_id_002", 2),
(assign,":var003",0),
(assign,":var004",0),
(try_for_range, ":slot_no_005", 190, 205),
(eq,":var003",0),
(party_slot_eq,":party_id_001",":slot_no_005",0),
(party_set_slot,":party_id_001",":slot_no_005",":party_id_002"),
(assign,":var003",1),
(try_begin),
(eq,":var004",0),
(party_slot_eq,":party_id_002",":slot_no_005",0),
(party_set_slot,":party_id_002",":slot_no_005",":party_id_001"),
(assign,":var004",1),
(try_end),
(try_end),
(try_begin),
(eq,":var003",0),
(str_store_string,s1,":str_store_party_name(party_id_001)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_begin),
(eq,":var004",0),
(str_store_string,s1,":str_store_party_name(party_id_002)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
]),

("average_trade_good_prices", [
(store_sub, ":var001", 250, ":itm.spice"),
(try_for_range, ":p_002", ":p.town_1", ":p.castle_1"),
(this_or_next|is_between,":p_002","p_town_1","p_castle_1"),
(is_between,":p_002","p_village_1","p_salt_mine"),
(try_for_range, ":p_003", ":p.town_1", ":p.salt_mine"),
(this_or_next|is_between,":p_002","p_town_1","p_castle_1"),
(is_between,":p_002","p_village_1","p_salt_mine"),
(neq,":p_003",":p_002"),
(store_distance_to_party_from_party,":distance_parties_004",":p_002",":p_002"),
(lt,":distance_parties_004",50),
(store_sub, ":var005", 50, ":distance_parties_004"),
(try_for_range, ":itm_006", ":itm.spice", ":itm.siege_supply"),
(store_add, ":slot_no_007", ":itm_006", ":var001"),
(party_get_slot,":party_slot_008",":p_002",":slot_no_007"),
(party_get_slot,":party_slot_009",":p_003",":slot_no_007"),
(store_sub, ":var010", ":party_slot_008", ":party_slot_009"),
(assign,":var011",":var010"),
(val_mul, ":var011", ":var005"),
(val_div, ":var011", 1000),
(val_add, ":party_slot_009", ":var011"),
(party_set_slot,":p_003",":slot_no_007",":party_slot_009"),
(val_sub, ":party_slot_008", ":var011"),
(party_set_slot,":p_002",":slot_no_007",":party_slot_008"),
(try_end),
(try_end),
(try_end),
(try_end),
]),

("average_trade_good_prices_2", [
(store_sub, ":var001", 250, ":itm.spice"),
(try_for_range, ":p_002", ":p.town_1", ":p.castle_1"),
(try_for_range, ":p_003", ":p.town_1", ":p.salt_mine"),
(this_or_next|is_between,":p_003","p_town_1","p_castle_1"),
(is_between,":p_003","p_village_1","p_salt_mine"),
(this_or_next|party_slot_eq,":p_003",121,":p_002"),
(this_or_next|party_slot_eq,":p_002",190,":p_003"),
(this_or_next|party_slot_eq,":p_002",191,":p_003"),
(this_or_next|party_slot_eq,":p_002",192,":p_003"),
(this_or_next|party_slot_eq,":p_002",193,":p_003"),
(this_or_next|party_slot_eq,":p_002",194,":p_003"),
(this_or_next|party_slot_eq,":p_002",195,":p_003"),
(this_or_next|party_slot_eq,":p_002",196,":p_003"),
(this_or_next|party_slot_eq,":p_002",197,":p_003"),
(this_or_next|party_slot_eq,":p_002",198,":p_003"),
(this_or_next|party_slot_eq,":p_002",199,":p_003"),
(this_or_next|party_slot_eq,":p_002",200,":p_003"),
(this_or_next|party_slot_eq,":p_002",201,":p_003"),
(this_or_next|party_slot_eq,":p_002",202,":p_003"),
(this_or_next|party_slot_eq,":p_002",203,":p_003"),
(party_slot_eq,":p_002",204,":p_003"),
(try_for_range, ":itm_004", ":itm.spice", ":itm.siege_supply"),
(store_add, ":slot_no_005", ":itm_004", ":var001"),
(party_get_slot,":party_slot_006",":p_002",":slot_no_005"),
(party_get_slot,":party_slot_007",":p_003",":slot_no_005"),
(store_sub, ":var008", ":party_slot_006", ":party_slot_007"),
(store_div, ":var___x1", ":var008", 5),
(assign,":var009",":var___x1"),
(val_add, ":party_slot_007", ":var009"),
(party_set_slot,":p_003",":slot_no_005",":party_slot_007"),
(val_sub, ":party_slot_006", ":var009"),
(party_set_slot,":p_002",":slot_no_005",":party_slot_006"),
(try_end),
(try_end),
(try_end),
]),

("average_trade_good_productions", [
(store_sub, ":var001", 500, ":itm.spice"),
(try_for_range, ":p_002", ":p.town_1", ":p.castle_1"),
(this_or_next|is_between,":p_002","p_town_1","p_castle_1"),
(is_between,":p_002","p_village_1","p_salt_mine"),
(try_for_range, ":p_003", ":p.town_1", ":p.salt_mine"),
(this_or_next|is_between,":p_002","p_town_1","p_castle_1"),
(is_between,":p_002","p_village_1","p_salt_mine"),
(neq,":p_003",":p_002"),
(store_distance_to_party_from_party,":distance_parties_004",":p_002",":p_002"),
(lt,":distance_parties_004",110),
(store_sub, ":var005", 110, ":distance_parties_004"),
(try_for_range, ":itm_006", ":itm.spice", ":itm.siege_supply"),
(store_add, ":slot_no_007", ":itm_006", ":var001"),
(party_get_slot,":party_slot_008",":p_002",":slot_no_007"),
(party_get_slot,":party_slot_009",":p_003",":slot_no_007"),
(store_sub, ":var010", ":party_slot_008", ":party_slot_009"),
(gt,":var010",0),
(store_mul, ":var011", ":var010", 1),
(val_mul, ":var011", ":var005"),
(val_div, ":var011", 110),
(val_add, ":party_slot_009", ":var011"),
(party_set_slot,":p_003",":slot_no_007",":party_slot_009"),
(try_end),
(try_end),
(try_end),
(try_end),
]),

("normalize_trade_good_productions", [
(store_sub, ":var001", 500, ":itm.spice"),
(try_for_range, ":itm_002", ":itm.spice", ":itm.siege_supply"),
(assign,":var003",0),
(assign,":var004",0),
(store_add, ":slot_no_005", ":itm_002", ":var001"),
(try_for_range, ":p_006", ":p.town_1", ":p.salt_mine"),
(val_add, ":var004", 1),
(try_begin),
(is_between,":p_006","p_town_1","p_castle_1"),
(val_add, ":var004", 4),
(try_end),
(party_get_slot,":party_slot_007",":p_006",":slot_no_005"),
(val_add, ":var003", ":party_slot_007"),
(try_end),
(store_div, ":var___x1", ":var003", ":var004"),
(assign,":var008",":var___x1"),
(try_begin),
(neq,":var008",0),
(try_for_range, ":p_006", ":p.town_1", ":p.salt_mine"),
(this_or_next|is_between,":p_006","p_town_1","p_castle_1"),
(is_between,":p_006","p_village_1","p_salt_mine"),
(party_get_slot,":party_slot_007",":p_006",":slot_no_005"),
(val_sub, ":party_slot_007", ":var008"),
(party_set_slot,":p_006",":slot_no_005",":party_slot_007"),
(try_end),
(try_end),
(try_end),
]),

("update_trade_good_prices", [
(try_for_range, ":p_001", ":p.town_1", ":p.salt_mine"),
(this_or_next|is_between,":p_001","p_town_1","p_castle_1"),
(is_between,":p_001","p_village_1","p_salt_mine"),
(call_script, "script_update_trade_good_price_for_party", ":p_001"),
(try_end),
(try_for_range, ":itm_002", ":itm.spice", ":itm.siege_supply"),
(assign,":var003",0),
(assign,":var004",0),
(try_for_range, ":p_001", ":p.town_1", ":p.salt_mine"),
(this_or_next|is_between,":p_001","p_town_1","p_castle_1"),
(is_between,":p_001","p_village_1","p_salt_mine"),
(store_sub, ":slot_no_005", ":itm_002", ":itm.spice"),
(val_add, ":slot_no_005", 250),
(party_get_slot,":party_slot_006",":p_001",":slot_no_005"),
(try_begin),
(is_between,":p_001","p_town_1","p_castle_1"),
(assign,":var007",5),
(else_try),
(assign,":var007",1),
(try_end),
(val_mul, ":party_slot_006", ":var007"),
(val_add, ":var003", ":party_slot_006"),
(val_add, ":var004", ":var007"),
(try_end),
(try_for_range, ":p_001", ":p.town_1", ":p.salt_mine"),
(this_or_next|is_between,":p_001","p_town_1","p_castle_1"),
(is_between,":p_001","p_village_1","p_salt_mine"),
(store_sub, ":slot_no_005", ":itm_002", ":itm.spice"),
(val_add, ":slot_no_005", 250),
(party_get_slot,":party_slot_006",":p_001",":slot_no_005"),
(val_mul, ":party_slot_006", 1000),
(val_mul, ":party_slot_006", ":var004"),
(val_div, ":party_slot_006", ":var003"),
(val_clamp,":party_slot_006",100, 10000),
(party_set_slot,":p_001",":slot_no_005",":party_slot_006"),
(try_end),
(try_end),
]),

("update_trade_good_price_for_party", [
(store_script_param, ":party_id_001", 1),
(try_for_range, ":itm_002", ":itm.spice", ":itm.siege_supply"),
(store_sub, ":slot_no_003", ":itm_002", ":itm.spice"),
(val_add, ":slot_no_003", 250),
(party_get_slot,":party_slot_004",":party_id_001",":slot_no_003"),
(call_script, "script_center_get_production", ":party_id_001", ":itm_002"),
(assign,":var005",reg0),
(call_script, "script_center_get_consumption", ":party_id_001", ":itm_002"),
(assign,":var006",reg0),
(val_sub, ":var005", ":var006"),
(try_begin),
(gt,":var005",0),
(store_mul, ":var007", ":var005", 1),
(store_random_in_range,":random_x_008",0,":var007"),
(val_add, ":random_x_008", ":var007"),
(val_add, ":random_x_008", ":var007"),
(store_sub, ":var009", ":party_slot_004", ":random_x_008"),
(val_clamp,":var009",100, 10000),
(try_begin),
(lt,":var009",1000),
(store_add, ":var010", ":var009", 300),
(val_mul, ":random_x_008", ":var010"),
(val_div, ":random_x_008", 1300),
(try_end),
(val_sub, ":party_slot_004", ":random_x_008"),
(else_try),
(lt,":var005",0),
(store_sub, ":var007", 0, ":var005"),
(val_mul, ":var007", 1),
(store_random_in_range,":random_x_008",0,":var007"),
(val_add, ":random_x_008", ":var007"),
(val_add, ":random_x_008", ":var007"),
(val_add, ":party_slot_004", ":random_x_008"),
(try_end),
(try_begin),
(is_between,":party_id_001","p_village_1","p_salt_mine"),
(store_sub, ":var011", ":party_slot_004", 1000),
(val_mul, ":var011", 96),
(val_div, ":var011", 100),
(store_add, ":var012", 1000, ":var011"),
(else_try),
(store_sub, ":var011", ":party_slot_004", 1000),
(val_mul, ":var011", 96),
(val_div, ":var011", 100),
(store_add, ":var012", 1000, ":var011"),
(try_end),
(try_begin),
(eq,1,1),
(item_get_slot,":item_slot_013",":itm_002",50),
(try_begin),
(neq,":item_slot_013",0),
(store_sub, ":slot_no_014", ":item_slot_013", ":itm.spice"),
(val_add, ":slot_no_014", 250),
(party_get_slot,":party_slot_015",":party_id_001",":slot_no_014"),
(val_mul, ":party_slot_015", 3),
(assign,":var016",3),
(try_for_range, ":p_017", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_017",120,":party_id_001"),
(party_get_slot,":party_slot_018",":p_017",":slot_no_014"),
(val_add, ":party_slot_015", ":party_slot_018"),
(val_add, ":var016", 1),
(try_end),
(try_end),
(store_div, ":var___x1", ":party_slot_015", ":var016"),
(assign,":var019",":var___x1"),
(gt,":var019",":var012"),
(store_sub, ":var020", ":var019", ":var012"),
(val_div, ":var020", 10),
(val_add, ":var012", ":var020"),
(try_end),
(val_clamp,":var012",100, 10000),
(party_set_slot,":party_id_001",":slot_no_003",":var012"),
(try_end),
]),

("center_get_production", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":party_slot_003",0),
(try_begin),
(eq,":var002","itm_bread"),
(party_get_slot,":party_slot_003",":party_id_001",221),
(val_mul, ":party_slot_003", 20),
(else_try),
(eq,":var002","itm_grain"),
(party_get_slot,":party_slot_003",":party_id_001",209),
(val_div, ":party_slot_003", 125),
(else_try),
(eq,":var002","itm_ale"),
(party_get_slot,":party_slot_003",":party_id_001",222),
(val_mul, ":party_slot_003", 25),
(else_try),
(eq,":var002","itm_smoked_fish"),
(party_get_slot,":party_slot_003",":party_id_001",214),
(val_mul, ":party_slot_003", 4),
(else_try),
(eq,":var002","itm_salt"),
(party_get_slot,":party_slot_003",":party_id_001",215),
(val_mul, ":party_slot_003", 35),
(else_try),
(eq,":var002","itm_cattle_meat"),
(party_get_slot,":party_slot_003",":party_id_001",205),
(val_div, ":party_slot_003", 4),
(else_try),
(eq,":var002","itm_dried_meat"),
(party_get_slot,":party_slot_003",":party_id_001",205),
(val_div, ":party_slot_003", 2),
(else_try),
(eq,":var002","itm_cheese"),
(party_get_slot,":party_slot_003",":party_id_001",205),
(party_get_slot,":party_slot_004",":party_id_001",206),
(val_div, ":party_slot_004", 2),
(val_add, ":party_slot_003", ":party_slot_004"),
(party_get_slot,":party_slot_005",":party_id_001",232),
(val_mul, ":party_slot_003", ":party_slot_005"),
(val_div, ":party_slot_003", 10),
(else_try),
(eq,":var002","itm_butter"),
(party_get_slot,":party_slot_003",":party_id_001",205),
(party_get_slot,":party_slot_005",":party_id_001",232),
(val_mul, ":party_slot_003", ":party_slot_005"),
(val_div, ":party_slot_003", 15),
(else_try),
(eq,":var002","itm_raw_leather"),
(party_get_slot,":party_slot_003",":party_id_001",205),
(val_div, ":party_slot_003", 6),
(party_get_slot,":party_slot_004",":party_id_001",206),
(val_div, ":party_slot_004", 12),
(val_add, ":party_slot_003", ":party_slot_004"),
(else_try),
(eq,":var002","itm_leatherwork"),
(party_get_slot,":party_slot_003",":party_id_001",230),
(val_mul, ":party_slot_003", 20),
(else_try),
(eq,":var002","itm_honey"),
(party_get_slot,":party_slot_003",":party_id_001",216),
(val_mul, ":party_slot_003", 6),
(else_try),
(eq,":var002","itm_cabbages"),
(party_get_slot,":party_slot_003",":party_id_001",232),
(val_mul, ":party_slot_003", 10),
(else_try),
(eq,":var002","itm_apples"),
(party_get_slot,":party_slot_003",":party_id_001",232),
(val_mul, ":party_slot_003", 10),
(else_try),
(eq,":var002","itm_sausages"),
(party_get_slot,":party_slot_003",":party_id_001",206),
(val_div, ":party_slot_003", 15),
(else_try),
(eq,":var002","itm_wool"),
(party_get_slot,":party_slot_003",":party_id_001",206),
(val_div, ":party_slot_003", 5),
(else_try),
(eq,":var002","itm_wool_cloth"),
(party_get_slot,":party_slot_003",":party_id_001",227),
(val_mul, ":party_slot_003", 5),
(else_try),
(this_or_next|eq,":var002","itm_chicken"),
(eq,":var002","itm_pork"),
(try_begin),
(is_between,":party_id_001","p_village_1","p_salt_mine"),
(assign,":party_slot_003",30),
(else_try),
(assign,":party_slot_003",0),
(try_end),
(else_try),
(eq,":var002","itm_iron"),
(party_get_slot,":party_slot_003",":party_id_001",219),
(val_mul, ":party_slot_003", 10),
(else_try),
(eq,":var002","itm_tools"),
(party_get_slot,":party_slot_003",":party_id_001",229),
(val_mul, ":party_slot_003", 3),
(else_try),
(eq,":var002","itm_pottery"),
(party_get_slot,":party_slot_003",":party_id_001",228),
(val_mul, ":party_slot_003", 5),
(else_try),
(eq,":var002","itm_raw_grapes"),
(party_get_slot,":party_slot_003",":party_id_001",211),
(val_div, ":party_slot_003", 100),
(else_try),
(eq,":var002","itm_wine"),
(party_get_slot,":party_slot_003",":party_id_001",223),
(val_mul, ":party_slot_003", 25),
(else_try),
(eq,":var002","itm_raw_olives"),
(party_get_slot,":party_slot_003",":party_id_001",210),
(val_div, ":party_slot_003", 150),
(else_try),
(eq,":var002","itm_oil"),
(party_get_slot,":party_slot_003",":party_id_001",224),
(val_mul, ":party_slot_003", 12),
(else_try),
(eq,":var002","itm_linen"),
(party_get_slot,":party_slot_003",":party_id_001",225),
(val_mul, ":party_slot_003", 5),
(else_try),
(eq,":var002","itm_raw_flax"),
(party_get_slot,":party_slot_003",":party_id_001",212),
(val_div, ":party_slot_003", 80),
(else_try),
(eq,":var002","itm_velvet"),
(party_get_slot,":party_slot_003",":party_id_001",226),
(val_mul, ":party_slot_003", 5),
(else_try),
(eq,":var002","itm_raw_silk"),
(party_get_slot,":party_slot_003",":party_id_001",217),
(val_div, ":party_slot_003", 20),
(else_try),
(eq,":var002","itm_raw_dyes"),
(party_get_slot,":party_slot_003",":party_id_001",218),
(val_div, ":party_slot_003", 20),
(else_try),
(eq,":var002","itm_raw_date_fruit"),
(party_get_slot,":party_slot_003",":party_id_001",213),
(val_div, ":party_slot_003", 120),
(else_try),
(eq,":var002","itm_furs"),
(party_get_slot,":party_slot_003",":party_id_001",220),
(val_mul, ":party_slot_003", 25),
(else_try),
(eq,":var002","itm_spice"),
(try_begin),
(eq,":party_id_001","p_town_10"),
(assign,":party_slot_003",100),
(else_try),
(eq,":party_id_001","p_town_17"),
(assign,":party_slot_003",50),
(else_try),
(eq,":party_id_001","p_town_19"),
(assign,":party_slot_003",50),
(else_try),
(eq,":party_id_001","p_town_22"),
(assign,":party_slot_003",50),
(else_try),
(this_or_next|eq,":party_id_001","p_village_25"),
(eq,":party_id_001","p_village_11"),
(assign,":party_slot_003",50),
(else_try),
(this_or_next|eq,":party_id_001","p_village_25"),
(eq,":party_id_001","p_village_11"),
(assign,":party_slot_003",25),
(try_end),
(try_end),
(assign,":var006",":party_slot_003"),
(try_begin),
(eq,":var002","itm_bread"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_grain", ":party_slot_003", 1),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_ale"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_grain", ":party_slot_003", 2),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_dried_meat"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_salt", ":party_slot_003", 2),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_smoked_fish"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_salt", ":party_slot_003", 2),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_tools"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_iron", ":party_slot_003", 1),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_wool_cloth"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_wool", ":party_slot_003", 1),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_wine"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_raw_grapes", ":party_slot_003", 1),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_oil"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_raw_olives", ":party_slot_003", 1),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_velvet"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_raw_silk", ":party_slot_003", 1),
(assign,":var007",reg0),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_raw_dyes", ":var007", 2),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_leatherwork"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_raw_leather", ":party_slot_003", 1),
(assign,":var006",reg0),
(else_try),
(eq,":var002","itm_linen"),
(call_script, "script_good_price_affects_good_production", ":party_id_001", "itm_raw_flax", ":party_slot_003", 1),
(assign,":var006",reg0),
(try_end),
(assign,":var008",":var006"),
(try_begin),
(eq,1,1),
(party_get_slot,":party_slot_009",":party_id_001",50),
(val_add, ":party_slot_009", 75),
(val_mul, ":var006", ":party_slot_009"),
(val_div, ":var006", 125),
(try_end),
(try_begin),
(this_or_next|party_slot_eq,":party_id_001",35,1),
(party_slot_eq,":party_id_001",35,2),
(assign,":var006",0),
(try_end),
(assign,reg0,":var006"),
(assign,reg1,":var008"),
(assign,reg2,":party_slot_003"),
]),

("center_get_consumption", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":item_id_002", 2),
(assign,":item_slot_003",0),
(try_begin),
(this_or_next|is_between,":party_id_001","p_town_19","p_castle_1"),
(ge,":party_id_001","p_village_91"),
(item_slot_ge,":item_id_002",13,0),
(item_get_slot,":item_slot_003",":item_id_002",13),
(else_try),
(is_between,":party_id_001","p_village_1","p_salt_mine"),
(item_get_slot,":item_slot_003",":item_id_002",12),
(else_try),
(is_between,":party_id_001","p_town_1","p_castle_1"),
(item_get_slot,":item_slot_003",":item_id_002",11),
(try_end),
(assign,":party_slot_004",0),
(try_begin),
(eq,":item_id_002","itm_grain"),
(party_get_slot,":party_slot_005",":party_id_001",221),
(val_mul, ":party_slot_005", 20),
(party_get_slot,":party_slot_006",":party_id_001",222),
(val_mul, ":party_slot_006", 5),
(store_add, ":party_slot_004", ":party_slot_005", ":party_slot_006"),
(else_try),
(eq,":item_id_002","itm_iron"),
(party_get_slot,":party_slot_004",":party_id_001",229),
(val_mul, ":party_slot_004", 3),
(else_try),
(eq,":item_id_002","itm_wool"),
(party_get_slot,":party_slot_004",":party_id_001",227),
(val_mul, ":party_slot_004", 5),
(else_try),
(eq,":item_id_002","itm_raw_flax"),
(party_get_slot,":party_slot_004",":party_id_001",225),
(val_mul, ":party_slot_004", 5),
(else_try),
(eq,":item_id_002","itm_raw_leather"),
(party_get_slot,":party_slot_004",":party_id_001",230),
(val_mul, ":party_slot_004", 20),
(else_try),
(eq,":item_id_002","itm_raw_grapes"),
(party_get_slot,":party_slot_004",":party_id_001",223),
(val_mul, ":party_slot_004", 30),
(else_try),
(eq,":item_id_002","itm_raw_olives"),
(party_get_slot,":party_slot_004",":party_id_001",224),
(val_mul, ":party_slot_004", 12),
(else_try),
(eq,":item_id_002","itm_raw_dyes"),
(party_get_slot,":party_slot_004",":party_id_001",226),
(val_mul, ":party_slot_004", 1),
(else_try),
(eq,":item_id_002","itm_raw_silk"),
(party_get_slot,":party_slot_004",":party_id_001",226),
(val_mul, ":party_slot_004", 5),
(else_try),
(eq,":item_id_002","itm_salt"),
(party_get_slot,":party_slot_007",":party_id_001",205),
(val_div, ":party_slot_007", 10),
(party_get_slot,":party_slot_008",":party_id_001",214),
(val_div, ":party_slot_008", 5),
(store_add, ":party_slot_004", ":party_slot_007", ":party_slot_008"),
(try_end),
(try_begin),
(gt,":party_slot_004",0),
(store_sub, ":var009", 250, ":itm.spice"),
(store_add, ":slot_no_010", ":item_id_002", ":var009"),
(party_get_slot,":party_slot_011",":party_id_001",":slot_no_010"),
(try_begin),
(gt,":party_slot_011",1000),
(val_mul, ":party_slot_004", 1000),
(val_div, ":party_slot_004", ":party_slot_011"),
(try_end),
(try_end),
(store_add, ":var012", ":item_slot_003", ":party_slot_004"),
(try_begin),
(eq,1,1),
(party_get_slot,":party_slot_013",":party_id_001",50),
(val_add, ":party_slot_013", 75),
(val_mul, ":var012", ":party_slot_013"),
(val_div, ":var012", 125),
(try_end),
(assign,reg0,":var012"),
(assign,reg1,":party_slot_004"),
(assign,reg2,":item_slot_003"),
]),

("get_enterprise_name", [
(store_script_param, ":var001", 1),
(assign,":var002","str_bread_site"),
(try_begin),
(eq,":var001","itm_bread"),
(assign,":var002","str_bread_site"),
(else_try),
(eq,":var001","itm_ale"),
(assign,":var002","str_ale_site"),
(else_try),
(eq,":var001","itm_oil"),
(assign,":var002","str_oil_site"),
(else_try),
(eq,":var001","itm_wine"),
(assign,":var002","str_wine_site"),
(else_try),
(eq,":var001","itm_leatherwork"),
(assign,":var002","str_leather_site"),
(else_try),
(eq,":var001","itm_wool_cloth"),
(assign,":var002","str_wool_cloth_site"),
(else_try),
(eq,":var001","itm_linen"),
(assign,":var002","str_linen_site"),
(else_try),
(eq,":var001","itm_velvet"),
(assign,":var002","str_velvet_site"),
(else_try),
(eq,":var001","itm_tools"),
(assign,":var002","str_tool_site"),
(try_end),
(assign,reg0,":var002"),
]),

("do_merchant_town_trade", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":party_id_002", 2),
(party_get_slot,":party_slot_003",":party_id_001",126),
(try_begin),
(eq,":::cheat_mode",2),
(str_store_string,s4,":str_store_party_name(party_id_002)"),
(str_store_string,s5,":str_store_party_name(party_slot_003)"),
(display_message, "@@{!}DEBUG -- Caravan trades in {s4}; originally from {s5}"),
(try_end),
(call_script, "script_add_log_entry", 5, ":party_id_001", ":party_slot_003", ":party_id_002", -1),
(call_script, "script_do_party_center_trade", ":party_id_001", ":party_id_002", 4),
(assign,":var004",reg0),
(val_div, ":var004", 2),
(str_store_string,s1,":str_store_party_name(party_id_001)"),
(str_store_string,s2,":str_store_party_name(party_id_002)"),
(assign,reg1,":var004"),
(party_get_slot,":party_slot_005",":party_id_002",48),
(party_get_slot,":party_slot_006",":party_id_002",50),
(assign,":var007",":var004"),
(val_mul, ":var007", ":party_slot_006"),
(val_div, ":var007", 100),
(val_div, ":var007", 10),
(val_add, ":party_slot_005", ":var007"),
(try_begin),
(ge,":::cheat_mode",3),
(assign,reg4,":var007"),
(str_store_string,s4,":str_store_party_name(party_id_002)"),
(assign,reg5,":party_slot_005"),
(display_message, "@@{!}New tariffs at {s4} = {reg4}; total = {reg5}"),
(try_end),
(party_set_slot,":party_id_002",48,":party_slot_005"),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_008",0,80),
(call_script, "script_center_get_goods_availability", ":party_id_002"),
(assign,":var009",reg0),
(try_begin),
(gt,":random_x_008",":var009"),
(eq,1,1),
(store_random_in_range,":random_x_008",0,100),
(gt,":random_x_008",82),
(call_script, "script_change_center_prosperity", ":party_id_002", 1),
(val_add, ":::newglob_total_prosperity_from_caravan_trade", 1),
(try_end),
(try_end),
]),

("party_calculate_regular_strength", [
(store_script_param, ":party_id_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(try_for_range, ":stack_no_003", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004",":party_id_001",":stack_no_003"),
(try_begin),
(neg|troop_is_hero,":troop_id_004"),
(store_character_level,":character_lvl_005",":troop_id_004"),
(val_add, ":character_lvl_005", 12),
(val_mul, ":character_lvl_005", ":character_lvl_005"),
(val_div, ":character_lvl_005", 100),
(party_stack_get_size,          ":party_stack_size_006",":party_id_001",":stack_no_003"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_007",":party_id_001",":stack_no_003"),
(val_sub, ":party_stack_size_006", ":party_stack_num_wounded_007"),
(val_mul, ":character_lvl_005", ":party_stack_size_006"),
(val_add, 0, ":character_lvl_005"), # reg0
(try_end),
(try_end),
]),

("party_calculate_strength", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(assign,reg0,0),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_001"),
(assign,":var004",0),
(try_begin),
(neq,":var002",0),
(assign,":var004",1),
(try_end),
(try_for_range, ":stack_no_005", ":var004", ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_006",":party_id_001",":stack_no_005"),
(store_character_level,":character_lvl_007",":troop_id_006"),
(val_add, ":character_lvl_007", 4),
(val_mul, ":character_lvl_007", ":character_lvl_007"),
(val_mul, ":character_lvl_007", 2),
(val_div, ":character_lvl_007", 100),
(val_max,":character_lvl_007",1),
(try_begin),
(neg|troop_is_hero,":troop_id_006"),
(party_stack_get_size,          ":party_stack_size_008",":party_id_001",":stack_no_005"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_009",":party_id_001",":stack_no_005"),
(val_sub, ":party_stack_size_008", ":party_stack_num_wounded_009"),
(val_mul, ":character_lvl_007", ":party_stack_size_008"),
(else_try),
(troop_is_wounded,":troop_id_006"),
(assign,":character_lvl_007",0),
(try_end),
(val_add, reg0, ":character_lvl_007"),
(try_end),
(party_set_slot,":party_id_001",56,reg0),
]),

("loot_player_items", [
(store_script_param, ":party_id_001", 1),
(troop_get_inventory_capacity,":troop_inv_capacity_002","trp_player"),
(try_for_range, ":inventory_slot_no_003", 0, ":troop_inv_capacity_002"),
(troop_get_inventory_slot,":troop_inv_slot_004","trp_player",":inventory_slot_no_003"),
(try_begin),
(ge,":troop_inv_slot_004",0),
(troop_get_inventory_slot_modifier,":troop_inv_slot_modifier_005","trp_player",":inventory_slot_no_003"),
(try_begin),
(is_between,":troop_inv_slot_004","itm_spice","itm_siege_supply"),
(assign,":var006",20),
(else_try),
(this_or_next|is_between,":troop_inv_slot_004","itm_sumpter_horse","itm_arrows"),
(this_or_next|eq,":troop_inv_slot_004","itm_warhorse_sarranid"),
(eq,":troop_inv_slot_004","itm_warhorse_steppe"),
(assign,":var006",15),
(else_try),
(this_or_next|is_between,":troop_inv_slot_004","itm_wooden_stick","itm_wooden_shield"),
(is_between,":troop_inv_slot_004","itm_darts","itm_torch"),
(assign,":var006",5),
(else_try),
(this_or_next|is_between,":troop_inv_slot_004","itm_leather_gloves","itm_wooden_stick"),
(this_or_next|eq,":troop_inv_slot_004","itm_plate_boots"),
(is_between,":troop_inv_slot_004","itm_wooden_shield","itm_darts"),
(assign,":var006",5),
(try_end),
(try_end),
(store_random_in_range,":random_x_007",0,100),
(try_begin),
(lt,":random_x_007",":var006"),
(troop_remove_item,"trp_player",":troop_inv_slot_004"),
(gt,":party_id_001",0),
(party_get_slot,":party_slot_008",":party_id_001",109),
(val_add, ":party_slot_008", 110),
(party_set_slot,":party_id_001",":party_slot_008",":troop_inv_slot_004"),
(val_sub, ":party_slot_008", 110),
(val_add, ":party_slot_008", 115),
(party_set_slot,":party_id_001",":party_slot_008",":troop_inv_slot_modifier_005"),
(val_sub, ":party_slot_008", 115),
(val_add, ":party_slot_008", 1),
(val_mod, ":party_slot_008", 5),
(party_set_slot,":party_id_001",109,":party_slot_008"),
(try_end),
(try_end),
(store_troop_gold,":troop_gold_009","trp_player"),
(store_div, ":var___x1", ":troop_gold_009", 5),
(assign,":var010",":var___x1"),
(store_div, ":var___x1", ":troop_gold_009", 10),
(assign,":var011",":var___x1"),
(store_random_in_range,":random_x_012",":var011",":var010"),
(troop_remove_gold,"trp_player",":random_x_012"),
]),

("party_calculate_loot", [
(store_script_param, ":party_id_001", 1),
(call_script, "script_calculate_main_party_shares"),
(assign,":var002",reg0),
(try_for_range, ":var003", 0, 5),
(store_add, ":slot_no_004", ":var003", 110),
(party_get_slot,":party_slot_005","$g_enemy_party",":slot_no_004"),
(try_begin),
(gt,":party_slot_005",0),
(party_set_slot,"$g_enemy_party",":slot_no_004",0),
(val_sub, ":slot_no_004", 110),
(val_add, ":slot_no_004", 115),
(party_get_slot,":party_slot_006","$g_enemy_party",":slot_no_004"),
(troop_add_item,"trp_temp_troop",":party_slot_005",":party_slot_006"),
(try_end),
(try_end),
(party_set_slot,"$g_enemy_party",109,0),
(assign,":var007",0),
(try_begin),
(this_or_next|party_slot_eq,"$g_enemy_party",0,11),
(this_or_next|party_slot_eq,"$g_enemy_party",0,18),
(party_slot_eq,"$g_enemy_party",0,15),
(store_mul, ":merch_amount_008", 10, 30),
(val_mul, ":merch_amount_008", ":::g_strength_contribution_of_player"),
(val_div, ":merch_amount_008", 100),
(val_div, ":merch_amount_008", ":var002"),
(try_begin),
(party_slot_eq,"$g_enemy_party",0,11),
(reset_item_probabilities),
(assign,":var009","itm_spice"),
(assign,":var010","itm_siege_supply"),
(else_try),
(party_slot_eq,"$g_enemy_party",0,18),
(val_div, ":merch_amount_008", 2),
(reset_item_probabilities),
(assign,":var009","itm_smoked_fish"),
(assign,":var010","itm_siege_supply"),
(else_try),
(val_div, ":merch_amount_008", 5),
(reset_item_probabilities),
(assign,":var009","itm_smoked_fish"),
(assign,":var010","itm_siege_supply"),
(try_end),
(store_sub, ":var011", 250, ":itm.spice"),
(try_for_range, ":item_id_012", ":var009", ":var010"),
(neg|party_slot_eq,"$g_enemy_party",0,18),
(store_add, ":slot_no_013", ":item_id_012", ":var011"),
(party_get_slot,":party_slot_014","$g_enemy_party",":slot_no_013"),
(else_try),
(assign,":party_slot_014",10000),
(val_add, ":party_slot_014", 1000),
(val_div, ":party_slot_014", 3),
(assign,":item_probability_015",100),
(val_mul, ":item_probability_015", 1000),
(val_div, ":item_probability_015", ":party_slot_014"),
(assign,reg0,":item_probability_015"),
(set_item_probability_in_merchandise,":item_id_012",":item_probability_015"),
(try_end),
(troop_add_merchandise,"trp_temp_troop",11,":merch_amount_008"),
(val_add, ":var007", ":merch_amount_008"),
(try_end),
(store_mul, ":probability_016", 10, 3),
(val_mul, ":probability_016", ":::g_strength_contribution_of_player"),
(party_get_skill_level, ":party_skill_lvl_017", "p_main_party", "skl_looting"),
(val_add, ":party_skill_lvl_017", 10),
(val_mul, ":probability_016", ":party_skill_lvl_017"),
(val_div, ":probability_016", 10),
(val_div, ":probability_016", ":var002"),
(party_get_num_companion_stacks,":party_num_companions_stacks_018",":party_id_001"),
(try_for_range, ":stack_no_019", 0, ":party_num_companions_stacks_018"),
(party_stack_get_troop_id,      ":troop_id_020",":party_id_001",":stack_no_019"),
(try_begin),
(neg|troop_is_hero,":troop_id_020"),
(party_stack_get_size,          ":party_stack_size_021",":party_id_001",":stack_no_019"),
(try_for_range, ":var022", 0, ":party_stack_size_021"),
(troop_loot_troop,"trp_temp_troop",":troop_id_020",":probability_016"),
(try_end),
(try_end),
(try_end),
(troop_get_inventory_capacity,":troop_inv_capacity_023","trp_temp_troop"),
(try_for_range, ":inventory_slot_no_024", 0, ":troop_inv_capacity_023"),
(troop_get_inventory_slot,":troop_inv_slot_025","trp_temp_troop",":inventory_slot_no_024"),
(try_begin),
(ge,":troop_inv_slot_025",0),
(val_add, ":var007", 1),
(try_end),
(try_end),
(assign,reg0,":var007"),
]),

("calculate_main_party_shares", [
(assign,":var001",10),
(party_get_num_companion_stacks,":party_num_companions_stacks_002","p_main_party"),
(try_for_range, ":stack_no_003", 1, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004","p_main_party",":stack_no_003"),
(try_begin),
(neg|troop_is_hero,":troop_id_004"),
(party_stack_get_size,          ":party_stack_size_005","p_main_party",":stack_no_003"),
(val_add, ":var001", ":party_stack_size_005"),
(else_try),
(val_add, ":var001", 3),
(try_end),
(try_end),
(assign,reg0,":var001"),
]),

("party_give_xp_and_gold", [
(store_script_param, ":party_id_001", 1),
(call_script, "script_calculate_main_party_shares"),
(assign,":var002",reg0),
(assign,":var003",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_004",":party_id_001"),
(try_for_range, ":stack_no_005", 0, ":party_num_companions_stacks_004"),
(party_stack_get_troop_id,      ":troop_id_006",":party_id_001",":stack_no_005"),
(try_begin),
(neg|troop_is_hero,":troop_id_006"),
(party_stack_get_size,          ":party_stack_size_007",":party_id_001",":stack_no_005"),
(store_character_level,":character_lvl_008",":troop_id_006"),
(store_add, ":var009", ":character_lvl_008", 10),
(val_mul, ":var009", ":var009"),
(val_div, ":var009", 10),
(store_mul, ":var010", ":var009", ":party_stack_size_007"),
(val_add, ":var003", ":var010"),
(try_end),
(try_end),
(val_mul, ":var003", ":::g_strength_contribution_of_player"),
(val_div, ":var003", 100),
(val_min,":var003",40000),
(assign,":var011",":var003"),
(store_random_in_range,":random_x_012",50,100),
(val_mul, ":var011", ":random_x_012"),
(val_div, ":var011", 100),
(party_add_xp, "p_main_party", ":var011"),
(store_mul, ":var013", ":var003", 10),
(val_min,":var013",60000),
(store_random_in_range,":random_x_012",50,100),
(val_mul, ":var013", ":random_x_012"),
(val_div, ":var013", 100),
(val_div, ":var013", ":var002"),
(party_get_num_companion_stacks,":party_num_companions_stacks_004","p_main_party"),
(try_for_range, ":stack_no_005", 0, ":party_num_companions_stacks_004"),
(party_stack_get_troop_id,      ":troop_id_006","p_main_party",":stack_no_005"),
(try_begin),
(troop_is_hero,":troop_id_006"),
(call_script, "script_troop_add_gold", ":troop_id_006", ":var013"),
(try_end),
(try_end),
]),

("setup_troop_meeting", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":dna", 2),
(call_script, "script_get_meeting_scene"),
(assign,":scene_id_003",reg0),
(modify_visitors_at_site,":scene_id_003"),
(reset_visitors),
(set_visitor,0,"trp_player"),
(try_begin),
(gt,":dna",-1),
(set_visitor,17,":troop_id_001",":dna"),
(else_try),
(set_visitor,17,":troop_id_001"),
(try_end),
(set_jump_mission,"mt_conversation_encounter"),
(jump_to_scene,":scene_id_003"),
(change_screen_map_conversation, ":troop_id_001"),
]),

("setup_party_meeting", [
(store_script_param, ":party_id_001", 1),
(try_begin),
(lt,":::g_encountered_party_relation",0),
(try_end),
(call_script, "script_get_meeting_scene"),
(assign,":scene_id_002",reg0),
(modify_visitors_at_site,":scene_id_002"),
(reset_visitors),
(set_visitor,0,"trp_player"),
(party_stack_get_troop_id,      ":troop_id_003",":party_id_001",0),
(party_stack_get_troop_dna,     ":party_stack_troop_dna_004",":party_id_001",0),
(set_visitor,17,":troop_id_003",":party_stack_troop_dna_004"),
(set_jump_mission,"mt_conversation_encounter"),
(jump_to_scene,":scene_id_002"),
(change_screen_map_conversation, ":troop_id_003"),
]),

("get_meeting_scene", [
(party_get_current_terrain,":party_cur_terrain_001","p_main_party"),
(assign,":var002","scn_random_scene"),
(try_begin),
(eq,":party_cur_terrain_001",2),
(assign,":var002","scn_meeting_scene_steppe"),
(else_try),
(eq,":party_cur_terrain_001",3),
(assign,":var002","scn_meeting_scene_plain"),
(else_try),
(eq,":party_cur_terrain_001",4),
(assign,":var002","scn_meeting_scene_snow"),
(else_try),
(eq,":party_cur_terrain_001",5),
(assign,":var002","scn_meeting_scene_desert"),
(else_try),
(eq,":party_cur_terrain_001",10),
(assign,":var002","scn_meeting_scene_steppe"),
(else_try),
(eq,":party_cur_terrain_001",11),
(assign,":var002","scn_meeting_scene_plain"),
(else_try),
(eq,":party_cur_terrain_001",12),
(assign,":var002","scn_meeting_scene_snow"),
(else_try),
(eq,":party_cur_terrain_001",13),
(assign,":var002","scn_meeting_scene_desert"),
(else_try),
(assign,":var002","scn_meeting_scene_plain"),
(try_end),
(assign,reg0,":var002"),
]),

("party_remove_all_companions", [
(store_script_param, ":party_id_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(try_for_range, ":stack_no_003", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004",":party_id_001",":stack_no_003"),
(party_stack_get_size,          ":party_stack_size_005",":party_id_001",":stack_no_003"),
(try_begin),
(troop_is_hero,":troop_id_004"),
(neg|is_between,":troop_id_004","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(neq,":troop_id_004","trp_player"),
(eq,":::g_prison_heroes",1),
(eq,":party_id_001","p_main_party"),
(store_random_in_range,":random_x_006",0,2),
(try_begin),
(neq,":random_x_006",0),
(troop_set_health,":troop_id_004",100),
(store_faction_of_party, ":party_faction_007", "$g_enemy_party"),
(assign,":var008",99999),
(assign,":var009",-1),
(try_for_range, ":p_010", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_011", ":p_010"),
(eq,":party_faction_011",":party_faction_007"),
(store_distance_to_party_from_party,":distance_parties_012",":p_010",":p_010"),
(lt,":distance_parties_012",":var008"),
(assign,":var008",":distance_parties_012"),
(assign,":var009",":p_010"),
(try_end),
(try_end),
(assign,reg1,":var009"),
(ge,":var009",0),
(store_random_in_range,":random_x_006",0,4),
(try_begin),
(neq,":random_x_006",0),
(party_add_prisoners,":var009",":troop_id_004",":party_stack_size_005"),
(troop_set_slot,":troop_id_004",8,":var009"),
(troop_set_slot,":troop_id_004",82,1),
(troop_set_slot,":troop_id_004",81,0),
(troop_set_slot,":troop_id_004",2,0),
(party_remove_members,":party_id_001",":troop_id_004",":party_stack_size_005"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s1,":str_store_party_name(var009)"),
(display_message, "str_your_hero_prisoned_at_s1"),
(try_end),
(try_end),
(else_try),
(assign,":var013",1000),
(try_for_range, ":var014", 0, ":var013"),
(store_random_in_range,":random_x_015","p_town_1","p_castle_1"),
(try_begin),
(neg|troop_slot_eq,":troop_id_004",60,":random_x_015"),
(neg|troop_slot_eq,":troop_id_004",59,":random_x_015"),
(assign,":var013",-1),
(try_end),
(try_end),
(troop_set_slot,":troop_id_004",12,":random_x_015"),
(troop_set_slot,":troop_id_004",82,1),
(troop_set_slot,":troop_id_004",81,0),
(troop_set_slot,":troop_id_004",2,0),
(party_remove_members,":party_id_001",":troop_id_004",":party_stack_size_005"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_id_004)"),
(str_store_string,s5,":str_store_party_name(random_x_015)"),
(display_message, "@@{!}{s4} is sent to {s5} after defeat"),
(try_end),
(try_end),
(else_try),
(this_or_next|troop_is_hero,":troop_id_004"),
(eq,":::g_move_heroes",1),
(party_remove_members,":party_id_001",":troop_id_004",":party_stack_size_005"),
(try_end),
]),

("party_remove_all_prisoners", [
(store_script_param, ":var001", 1),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_002",":var001"),
(try_for_range, ":var003", 0, ":party_num_prisoners_stacks_002"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_004",":var001",":var003"),
(try_begin),
(this_or_next|troop_is_hero,":party_prisoner_troop_id_004"),
(eq,":::g_move_heroes",1),
(party_get_prisoner_stack_size, ":party_prisoner_stack_size_005",":var001",":var003"),
(party_remove_members,":var001",":party_prisoner_troop_id_004",":party_prisoner_stack_size_005"),
(try_end),
(try_end),
]),

("party_add_party_companions", [
(store_script_param, ":var001", 1),
(store_script_param, ":party_id_002", 2),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_002"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_002",":stack_no_004"),
(try_begin),
(this_or_next|troop_is_hero,":troop_id_005"),
(eq,":::g_move_heroes",1),
(party_stack_get_size,          ":party_stack_size_006",":party_id_002",":stack_no_004"),
(party_add_members,":var001",":troop_id_005",":party_stack_size_006"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_007",":party_id_002",":stack_no_004"),
(party_wound_members,":var001",":troop_id_005",":party_stack_num_wounded_007"),
(try_end),
(try_end),
]),

("party_add_party_prisoners", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_003",":var002"),
(try_for_range, ":var004", 0, ":party_num_prisoners_stacks_003"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_005",":var002",":var004"),
(try_begin),
(this_or_next|troop_is_hero,":party_prisoner_troop_id_005"),
(eq,":::g_move_heroes",1),
(party_get_prisoner_stack_size, ":party_prisoner_stack_size_006",":var002",":var004"),
(party_add_members,":var001",":party_prisoner_troop_id_005",":party_prisoner_stack_size_006"),
(try_end),
(try_end),
]),

("party_prisoners_add_party_companions", [
(store_script_param, ":var001", 1),
(store_script_param, ":party_id_002", 2),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_002"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_002",":stack_no_004"),
(try_begin),
(this_or_next|troop_is_hero,":troop_id_005"),
(eq,":::g_move_heroes",1),
(party_stack_get_size,          ":party_stack_size_006",":party_id_002",":stack_no_004"),
(party_add_prisoners,":var001",":troop_id_005",":party_stack_size_006"),
(try_end),
(try_end),
]),

("party_prisoners_add_party_prisoners", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_003",":var002"),
(try_for_range, ":var004", 0, ":party_num_prisoners_stacks_003"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_005",":var002",":var004"),
(try_begin),
(this_or_next|troop_is_hero,":party_prisoner_troop_id_005"),
(eq,":::g_move_heroes",1),
(party_get_prisoner_stack_size, ":party_prisoner_stack_size_006",":var002",":var004"),
(party_add_prisoners,":var001",":party_prisoner_troop_id_005",":party_prisoner_stack_size_006"),
(try_end),
(try_end),
]),

("party_add_party", [
(store_script_param, ":var001", 1),
(store_script_param, ":party_id_002", 2),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_002"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_002",":stack_no_004"),
(try_begin),
(this_or_next|troop_is_hero,":troop_id_005"),
(eq,":::g_move_heroes",1),
(party_stack_get_size,          ":party_stack_size_006",":party_id_002",":stack_no_004"),
(party_add_members,":var001",":troop_id_005",":party_stack_size_006"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_007",":party_id_002",":stack_no_004"),
(party_wound_members,":var001",":troop_id_005",":party_stack_num_wounded_007"),
(try_end),
(try_end),
]),

("party_copy", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,"$g_move_heroes",1),
(party_clear,":var001"),
(call_script, "script_party_add_party", ":var001", ":var002"),
]),

("clear_party_group", [
(store_script_param, ":var001", 1),
(party_clear,":var001"),
(party_get_num_attached_parties, ":party_num_attached_parties_002", ":var001"),
(try_for_range, ":var003", 0, ":party_num_attached_parties_002"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_004", ":var001", ":var003"),
(call_script, "script_clear_party_group", ":party_attached_party_with_rank_004"),
(try_end),
]),

("party_add_wounded_members_as_prisoners", [
(store_script_param, ":var001", 1),
(store_script_param, ":party_id_002", 2),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_002"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_005",":party_id_002",":stack_no_004"),
(try_begin),
(ge,":party_stack_num_wounded_005",1),
(party_stack_get_troop_id,      ":troop_id_006",":party_id_002",":stack_no_004"),
(this_or_next|troop_is_hero,":troop_id_006"),
(eq,":::g_move_heroes",1),
(party_add_prisoners,":var001",":troop_id_006",":party_stack_num_wounded_005"),
(try_end),
(try_end),
]),

("get_nonempty_party_in_group", [
(store_script_param, ":var001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":var001"),
(try_begin),
(gt,":party_num_companions_stacks_002",0),
(assign,reg0,":var001"),
(else_try),
(assign,reg0,-1),
(party_get_num_attached_parties, ":party_num_attached_parties_003", ":var001"),
(try_for_range, ":var004", 0, ":party_num_attached_parties_003"),
(lt,reg0,0),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_005", ":var001", ":var004"),
(call_script, "script_get_nonempty_party_in_group", ":party_attached_party_with_rank_005"),
(try_end),
(try_end),
]),

("collect_prisoners_from_empty_parties", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_get_num_companions,":party_num_companions_003",":party_id_001"),
(try_begin),
(eq,":party_num_companions_003",0),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_004",":party_id_001"),
(try_for_range, ":var005", 0, ":party_num_prisoners_stacks_004"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_006",":party_id_001",":var005"),
(troop_is_hero,":party_prisoner_troop_id_006"),
(party_add_members,":var002",":party_prisoner_troop_id_006",1),
(try_end),
(try_end),
(party_get_num_attached_parties, ":party_num_attached_parties_007", ":party_id_001"),
(try_for_range, ":var008", 0, ":party_num_attached_parties_007"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_009", ":party_id_001", ":var008"),
(call_script, "script_collect_prisoners_from_empty_parties", ":party_attached_party_with_rank_009", ":var002"),
(try_end),
]),

("change_party_morale", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(party_get_morale, ":party_morale_003",":var001"),
(store_add, ":var004", ":party_morale_003", ":var002"),
(val_clamp,":var004",0, 100),
(party_set_morale, ":var001", ":var004"),
(str_store_string,s1,":str_store_party_name(var001)"),
(try_begin),
(lt,":var004",":party_morale_003"),
(store_sub, reg1, ":party_morale_003", ":var004"),
(else_try),
(gt,":var004",":party_morale_003"),
(store_sub, reg1, ":var004", ":party_morale_003"),
(try_end),
]),

("count_casualties_and_adjust_morale", [
(call_script, "script_calculate_main_party_shares"),
(assign,":var001",reg0),
(assign,":var002",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_003","p_player_casualties"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005","p_player_casualties",":stack_no_004"),
(party_stack_get_size,          ":party_stack_size_006","p_player_casualties",":stack_no_004"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_007","p_player_casualties",":stack_no_004"),
(store_mul, ":var008", ":party_stack_size_006", 2),
(store_sub,":var009",":party_stack_num_wounded_007"),
(store_character_level,":character_lvl_010",":troop_id_005"),
(store_add, ":var011", ":character_lvl_010", 3),
(try_begin),
(eq,":troop_id_005","trp_player"),
(val_add, ":character_lvl_010", 75),
(else_try),
(troop_is_hero,":troop_id_005"),
(val_add, ":character_lvl_010", 50),
(try_end),
(val_mul, ":var011", ":var011"),
(val_div, ":var011", 10),
(assign,reg0,":var011"),
(val_mul, ":var011", ":party_stack_size_006"),
(try_begin),
(neg|troop_is_hero,":troop_id_005"),
(val_mul, ":var011", ":var009"),
(val_div, ":var011", ":var008"),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg1,":party_stack_size_006"),
(assign,reg2,":var011"),
(display_message, "str_our_per_person__reg0_num_people__reg1_total_gain__reg2"),
(try_end),
(val_add, ":var002", ":var011"),
(try_end),
(assign,":var012",0),
(assign,":var013",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_003","p_enemy_casualties"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005","p_enemy_casualties",":stack_no_004"),
(party_stack_get_size,          ":party_stack_size_006","p_enemy_casualties",":stack_no_004"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_007","p_enemy_casualties",":stack_no_004"),
(store_mul, ":var008", ":party_stack_size_006", 2),
(store_sub, ":var009", ":var008", ":party_stack_num_wounded_007"),
(store_character_level,":character_lvl_010",":troop_id_005"),
(store_add, ":var011", ":character_lvl_010", 3),
(try_begin),
(troop_is_hero,":troop_id_005"),
(val_add, ":character_lvl_010", 50),
(try_end),
(val_mul, ":var011", ":var011"),
(val_div, ":var011", 10),
(assign,reg0,":var011"),
(val_mul, ":var011", ":party_stack_size_006"),
(try_begin),
(neg|troop_is_hero,":troop_id_005"),
(val_mul, ":var011", ":var009"),
(val_div, ":var011", ":var008"),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg1,":party_stack_size_006"),
(assign,reg2,":var011"),
(display_message, "str_ene_per_person__reg0_num_people__reg1_total_gain__reg2"),
(try_end),
(val_add, ":var013", ":var011"),
(val_add, ":var012", ":party_stack_size_006"),
(try_end),
(assign,":var014",0),
(try_begin),
(eq,":::any_allies_at_the_last_battle",1),
(party_get_num_companion_stacks,":party_num_companions_stacks_003","p_ally_casualties"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005","p_ally_casualties",":stack_no_004"),
(party_stack_get_size,          ":party_stack_size_006","p_ally_casualties",":stack_no_004"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_007","p_ally_casualties",":stack_no_004"),
(store_mul, ":var008", ":party_stack_size_006", 2),
(store_sub,":var009",":party_stack_num_wounded_007"),
(store_character_level,":character_lvl_010",":troop_id_005"),
(store_add, ":var011", ":character_lvl_010", 3),
(try_begin),
(troop_is_hero,":troop_id_005"),
(val_add, ":character_lvl_010", 50),
(try_end),
(val_mul, ":var011", ":var011"),
(val_div, ":var011", 10),
(assign,reg0,":var011"),
(val_mul, ":var011", ":party_stack_size_006"),
(try_begin),
(neg|troop_is_hero,":troop_id_005"),
(val_mul, ":var011", ":var009"),
(val_div, ":var011", ":var008"),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg1,":party_stack_size_006"),
(assign,reg2,":var011"),
(display_message, "str_all_per_person__reg0_num_people__reg1_total_gain__reg2"),
(try_end),
(val_add, ":var014", ":var011"),
(try_end),
(try_end),
(store_add, ":var015", ":var002", ":var014"),
(assign,":var016",":var013"),
(val_mul, ":var015", 100),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg0,":var016"),
(display_message, "@@{!}DEBUGS : enemy loses : {reg0}"),
(try_end),
(try_begin),
(gt,":var016",0),
(store_div, ":var___x1", ":var015", ":var016"),
(assign,":var017",":var___x1"),
(else_try),
(assign,":var017",1000),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg1,":var017"),
(display_message, "str_loss_ratio_is_reg1"),
(try_end),
(try_begin),
(neg|is_between,"$g_enemy_party","p_town_1","p_salt_mine"),
(store_sub, ":var018", 60, ":var017"),
(else_try),
(store_sub, ":var018", 100, ":var017"),
(try_end),
(try_begin),
(lt,":var018",0),
(val_div, ":var018", 2),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg0,":var018"),
(display_message, "@@{!}DEBUGS1 : total gain : {reg0}"),
(try_end),
(val_max,":var018",-60),
(val_mul, ":var018", ":var016"),
(val_div, ":var018", 100),
(store_mul, ":var019", ":var018", -1),
(val_mul, ":var018", ":::g_strength_contribution_of_player"),
(val_div, ":var018", 100),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg0,":var018"),
(display_message, "@@{!}DEBUGS2 : total gain : {reg0}"),
(try_end),
(try_begin),
(party_is_active,"$g_enemy_party"),
(assign,":var020",0),
(val_add, ":var020", 10),
(party_get_num_companion_stacks,":party_num_companions_stacks_003","$g_enemy_party"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005","$g_enemy_party",":stack_no_004"),
(party_stack_get_size,          ":party_stack_size_006","$g_enemy_party",":stack_no_004"),
(val_add, ":var020", ":party_stack_size_006"),
(try_end),
(assign,":var021",":var020"),
(party_get_num_attached_parties, ":party_num_attached_parties_022", "$g_enemy_party"),
(try_for_range, ":var023", 0, ":party_num_attached_parties_022"),
(val_add, ":var020", 10),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_024", "$g_enemy_party", ":var023"),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_attached_party_with_rank_024"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005",":party_attached_party_with_rank_024",":stack_no_004"),
(party_stack_get_size,          ":party_stack_size_006",":party_attached_party_with_rank_024",":stack_no_004"),
(val_add, ":var020", ":party_stack_size_006"),
(try_end),
(try_end),
(assign,":var025",":var020"),
(assign,reg5,":var025"),
(assign,reg6,":var019"),
(set_fixed_point_multiplier, 100),
(val_mul, ":var025", 100),
(store_sqrt, ":var026", ":var025"),
(val_div, ":var026", 100),
(val_div, ":var019", ":var026"),
(val_div, ":var019", 4),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg7,":var019"),
(display_message, "str_total_enemy_morale_gain__reg6_last_total_enemy_morale_gain__reg7_remaining_enemy_population__reg5"),
(try_end),
(store_mul, ":var027", ":var019", ":var021"),
(val_div, ":var027", ":var020"),
(try_begin),
(party_is_active,"$g_enemy_party"),
(call_script, "script_change_party_morale", "$g_enemy_party", ":var027"),
(party_get_num_attached_parties, ":party_num_attached_parties_022", "$g_enemy_party"),
(try_for_range, ":var023", 0, ":party_num_attached_parties_022"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_024", "$g_enemy_party", ":var023"),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_attached_party_with_rank_024"),
(assign,":var028",0),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005",":party_attached_party_with_rank_024",":stack_no_004"),
(party_stack_get_size,          ":party_stack_size_006",":party_attached_party_with_rank_024",":stack_no_004"),
(val_add, ":var028", ":party_stack_size_006"),
(try_end),
(store_mul, ":var027", ":var019", ":var028"),
(val_div, ":var027", ":var020"),
(call_script, "script_change_party_morale", ":party_attached_party_with_rank_024", ":var027"),
(try_end),
(try_end),
(try_end),
(assign,":var029",":var018"),
(val_div, ":var029", ":var001"),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg0,":var001"),
(assign,reg1,":var018"),
(display_message, "@@{!}DEBUGS3 : num player party shares:{reg0} - total gain:{reg1}"),
(try_end),
(call_script, "script_change_player_party_morale", ":var029"),
(store_mul, ":var030", ":var012", "$g_strength_contribution_of_player"),
(store_div, ":var___x1", ":var030", 8),
(assign,":var031",":var___x1"),
(try_begin),
(gt,":var031",2000),
(assign,":var031",2000),
(try_end),
(try_begin),
(ge,":::g_ally_party",0),
(store_div, ":var___x1", ":var031", 3),
(assign,":var032",":var___x1"),
(val_mul, ":var032", 2),
(store_faction_of_party, ":party_faction_033", "$g_ally_party"),
(faction_get_slot,":faction_slot_034",":party_faction_033",99),
(val_add, ":faction_slot_034", ":var032"),
(faction_set_slot,":party_faction_033",99,":faction_slot_034"),
(try_end),
(try_begin),
(neg|party_is_active,"$g_enemy_party"),
(ge,":::current_town",0),
(val_mul, ":var031", 2),
(store_faction_of_party, ":party_faction_033", "$current_town"),
(faction_get_slot,":faction_slot_034",":party_faction_033",99),
(val_add, ":faction_slot_034", ":var031"),
(faction_set_slot,":party_faction_033",99,":faction_slot_034"),
(else_try),
(party_is_active,"$g_enemy_party"),
(assign,":var035",0),
(try_begin),
(eq,":::players_kingdom","fac_player_supporters_faction"),
(neg|faction_slot_eq,"fac_player_supporters_faction",11,"trp_player"),
(assign,":var035",1),
(try_end),
(try_begin),
(eq,":var035",0),
(store_div, ":var___x1", ":var031", 3),
(assign,":var031",":var___x1"),
(val_mul, ":var031", 2),
(store_faction_of_party, ":party_faction_036", "$g_enemy_party"),
(faction_get_slot,":faction_slot_034",":party_faction_036",99),
(val_sub, ":faction_slot_034", ":var031"),
(faction_set_slot,":party_faction_036",99,":faction_slot_034"),
(try_end),
(try_end),
]),

("print_casualties_to_s0", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(str_clear, 0),
(assign,":var003",0),
(assign,":var004",0),
(assign,":var005",0),
(assign,":var006",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_007",":party_id_001"),
(try_for_range, ":stack_no_008", 0, ":party_num_companions_stacks_007"),
(party_stack_get_troop_id,      ":troop_id_009",":party_id_001",":stack_no_008"),
(party_stack_get_size,          ":party_stack_size_010",":party_id_001",":stack_no_008"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_011",":party_id_001",":stack_no_008"),
(try_begin),
(this_or_next|eq,":party_id_001","p_player_casualties"),
(eq,":party_id_001","p_main_party"),
(troop_get_slot,":troop_slot_012",":troop_id_009",146),
(troop_set_slot,":troop_id_009",146,0),
(else_try),
(party_get_attached_to, ":party_attached_013", ":party_id_001"),
(try_begin),
(this_or_next|eq,":party_id_001","p_ally_casualties"),
(ge,":party_attached_013",0),
(this_or_next|eq,":party_id_001","p_ally_casualties"),
(eq,":party_attached_013","p_main_party"),
(troop_get_slot,":troop_slot_012",":troop_id_009",147),
(troop_set_slot,":troop_id_009",147,0),
(else_try),
(troop_get_slot,":troop_slot_012",":troop_id_009",148),
(troop_set_slot,":troop_id_009",148,0),
(try_end),
(try_end),
(store_sub, ":var014", ":party_stack_size_010", ":party_stack_num_wounded_011"),
(val_sub, ":var014", ":troop_slot_012"),
(val_add, ":var005", ":var014"),
(val_add, ":var004", ":party_stack_num_wounded_011"),
(val_add, ":var006", ":troop_slot_012"),
(try_begin),
(this_or_next|gt,":var014",0),
(this_or_next|gt,":party_stack_num_wounded_011",0),
(gt,":troop_slot_012",0),
(store_add, reg3, ":var014", ":party_stack_num_wounded_011"),
(store_add, reg3, reg3, ":troop_slot_012"),
(str_store_string,s1,":str_store_troop_name_by_count(troop_id_009,reg3)"),
(try_begin),
(troop_is_hero,":troop_id_009"),
(assign,reg3,0),
(try_end),
(try_begin),
(gt,":var014",0),
(gt,":party_stack_num_wounded_011",0),
(gt,":troop_slot_012",0),
(assign,reg4,":var014"),
(assign,reg5,":party_stack_num_wounded_011"),
(assign,reg6,":troop_slot_012"),
(str_store_string,s2,":str_store_string("str_reg4_killed_reg5_wounded_reg6_routed")"),
(else_try),
(gt,":var014",0),
(gt,":troop_slot_012",0),
(assign,reg4,":var014"),
(assign,reg5,":troop_slot_012"),
(str_store_string,s2,":str_store_string("str_reg4_killed_reg5_routed")"),
(else_try),
(gt,":var014",0),
(gt,":party_stack_num_wounded_011",0),
(assign,reg4,":var014"),
(assign,reg5,":party_stack_num_wounded_011"),
(str_store_string,s2,":str_store_string("str_reg4_killed_reg5_wounded")"),
(else_try),
(gt,":party_stack_num_wounded_011",0),
(gt,":troop_slot_012",0),
(assign,reg4,":party_stack_num_wounded_011"),
(assign,reg5,":troop_slot_012"),
(str_store_string,s2,":str_store_string("str_reg4_wounded_reg5_routed")"),
(else_try),
(gt,":var014",0),
(assign,reg1,":var014"),
(str_store_string,s3,":str_store_string("@killed")"),
(str_store_string,s2,":str_store_string("str_reg1_blank_s3")"),
(else_try),
(gt,":party_stack_num_wounded_011",0),
(assign,reg1,":party_stack_num_wounded_011"),
(str_store_string,s3,":str_store_string("@wounded")"),
(str_store_string,s2,":str_store_string("str_reg1_blank_s3")"),
(else_try),
(assign,reg1,":troop_slot_012"),
(str_store_string,s3,":str_store_string("str_routed")"),
(str_store_string,s2,":str_store_string("str_reg1_blank_s3")"),
(try_end),
(try_begin),
(eq,":var002",1),
(try_begin),
(eq,":var003",0),
(str_store_string,s0,":str_store_string("@{!}{reg3?{reg3}:} {s1} ({s2})")"),
(else_try),
(str_store_string,s0,":str_store_string("@{!}{s0}, {reg3?{reg3}:} {s1} ({s2})")"),
(try_end),
(else_try),
(str_store_string,s0,":str_store_string("@{!}{s0}^{reg3?{reg3}:} {s1} ({s2})")"),
(try_end),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_begin),
(this_or_next|gt,":var005",0),
(this_or_next|gt,":var004",0),
(gt,":var006",0),
(store_add, ":var015", ":var005", ":var004"),
(val_add, ":var015", ":var006"),
(assign,reg3,":var015"),
(try_begin),
(gt,":var005",0),
(gt,":var004",0),
(gt,":var006",0),
(assign,reg4,":var005"),
(assign,reg5,":var004"),
(assign,reg6,":var006"),
(str_store_string,s2,":str_store_string("str_reg4_killed_reg5_wounded_reg6_routed")"),
(else_try),
(gt,":var005",0),
(gt,":var006",0),
(assign,reg4,":var005"),
(assign,reg5,":var006"),
(str_store_string,s2,":str_store_string("str_reg4_killed_reg5_routed")"),
(else_try),
(gt,":var005",0),
(gt,":var004",0),
(assign,reg4,":var005"),
(assign,reg5,":var004"),
(str_store_string,s2,":str_store_string("str_reg4_killed_reg5_wounded")"),
(else_try),
(gt,":var004",0),
(gt,":var006",0),
(assign,reg4,":var004"),
(assign,reg5,":var006"),
(str_store_string,s2,":str_store_string("str_reg4_wounded_reg5_routed")"),
(else_try),
(gt,":var005",0),
(str_store_string,s2,":str_store_string("@killed")"),
(else_try),
(gt,":var004",0),
(str_store_string,s2,":str_store_string("@wounded")"),
(else_try),
(str_store_string,s2,":str_store_string("str_routed")"),
(try_end),
(str_store_string,s0,":str_store_string("@{s0}^TOTAL: {reg3} ({s2})")"),
(else_try),
(try_begin),
(eq,":var002",1),
(str_store_string,s0,":str_store_string("@None")"),
(else_try),
(str_store_string,s0,":str_store_string("@^None")"),
(try_end),
(try_end),
]),

("write_fit_party_members_to_stack_selection", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_001"),
(assign,":slot_no_004",2),
(assign,":var005",0),
(try_for_range, ":stack_no_006", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_007",":party_id_001",":stack_no_006"),
(assign,":party_stack_size_008",0),
(try_begin),
(troop_is_hero,":troop_id_007"),
(try_begin),
(neg|troop_is_wounded,":troop_id_007"),
(this_or_next|eq,":var002",0),
(neq,":stack_no_006",0),
(assign,":party_stack_size_008",1),
(try_end),
(else_try),
(party_stack_get_size,          ":party_stack_size_008",":party_id_001",":stack_no_006"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_009",":party_id_001",":stack_no_006"),
(val_sub, ":party_stack_size_008", ":party_stack_num_wounded_009"),
(try_end),
(try_begin),
(gt,":party_stack_size_008",0),
(troop_set_slot,"trp_stack_selection_amounts",":slot_no_004",":party_stack_size_008"),
(troop_set_slot,"trp_stack_selection_ids",":slot_no_004",":troop_id_007"),
(val_add, ":slot_no_004", 1),
(try_end),
(val_add, ":var005", ":party_stack_size_008"),
(try_end),
(val_sub, ":slot_no_004", 2),
(troop_set_slot,"trp_stack_selection_amounts",0,":slot_no_004"),
(troop_set_slot,"trp_stack_selection_amounts",1,":var005"),
]),

("remove_fit_party_member_from_stack_selection", [
(store_script_param, ":slot_no_001", 1),
(val_add, ":slot_no_001", 2),
(troop_get_slot,":troop_slot_002","trp_stack_selection_amounts",":slot_no_001"),
(troop_get_slot,":troop_slot_003","trp_stack_selection_ids",":slot_no_001"),
(val_sub, ":troop_slot_002", 1),
(troop_set_slot,"trp_stack_selection_amounts",":slot_no_001",":troop_slot_002"),
(troop_get_slot,":troop_slot_004","trp_stack_selection_amounts",1),
(val_sub, ":troop_slot_004", 1),
(troop_set_slot,"trp_stack_selection_amounts",1,":troop_slot_004"),
(try_begin),
(le,":troop_slot_002",0),
(troop_get_slot,":troop_slot_005","trp_stack_selection_amounts",0),
(store_add, ":var006", ":troop_slot_005", 2),
(store_add, ":var007", ":slot_no_001", 1),
(try_for_range, ":slot_no_008", ":var007", ":var006"),
(store_sub, ":slot_no_009", ":slot_no_008", 1),
(troop_get_slot,":troop_slot_010","trp_stack_selection_amounts",":slot_no_008"),
(troop_set_slot,"trp_stack_selection_amounts",":slot_no_009",":troop_slot_010"),
(troop_get_slot,":troop_slot_010","trp_stack_selection_ids",":slot_no_008"),
(troop_set_slot,"trp_stack_selection_ids",":slot_no_009",":troop_slot_010"),
(try_end),
(val_sub, ":troop_slot_005", 1),
(troop_set_slot,"trp_stack_selection_amounts",0,":troop_slot_005"),
(try_end),
(assign,reg0,":troop_slot_003"),
]),

("remove_random_fit_party_member_from_stack_selection", [
(troop_get_slot,":troop_slot_001","trp_stack_selection_amounts",1),
(store_random_in_range,":random_x_002",0,":troop_slot_001"),
(troop_get_slot,":troop_slot_003","trp_stack_selection_amounts",0),
(store_add, ":var004", ":troop_slot_003", 2),
(try_for_range, ":slot_no_005", 2, ":var004"),
(troop_get_slot,":troop_slot_006","trp_stack_selection_amounts",":slot_no_005"),
(val_sub, ":random_x_002", ":troop_slot_006"),
(try_begin),
(lt,":random_x_002",0),
(assign,":var004",0),
(store_sub, ":var007", ":slot_no_005", 2),
(try_end),
(try_end),
(call_script, "script_remove_fit_party_member_from_stack_selection", ":var007"),
]),

("add_routed_party", [
(party_get_num_companion_stacks,":party_num_companions_stacks_001","p_routed_enemies"),
(assign,":var002",0),
(assign,":var003",0),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_001"),
(store_sub, ":var005", ":party_num_companions_stacks_001", ":stack_no_004"),
(try_begin),
(ge,":var005",":var003"),
(store_sub, ":stack_no_006", ":stack_no_004", ":var003"),
(party_stack_get_troop_id,      ":troop_id_007","p_routed_enemies",":stack_no_006"),
(try_begin),
(troop_is_hero,":troop_id_007"),
(party_stack_get_size,          ":party_stack_size_008","p_routed_enemies",":stack_no_006"),
(party_remove_members,"p_routed_enemies",":troop_id_007",1),
(le,":party_stack_size_008",1),
(val_add, ":var003", 1),
(try_end),
(else_try),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(ge,":var002",1),
(set_spawn_radius,2),
(spawn_around_party,"p_main_party","pt_routed_warriors"),
(assign,":party_id_009",reg0),
(party_set_slot,":party_id_009",30,-1),
(assign,":var010",0),
(assign,":var011","fac_neutral"),
(try_for_range, ":faction_id_012", 15, 21),
(faction_get_slot,":faction_slot_013",":faction_id_012",90),
(try_begin),
(gt,":faction_slot_013",":var010"),
(assign,":var010",":faction_slot_013"),
(assign,":var011",":faction_id_012"),
(try_end),
(try_end),
(party_set_faction,":party_id_009",":var011"),
(party_set_ai_behavior,":party_id_009",1),
(assign,":var014",1000000),
(try_for_parties, ":cur_party"),
(party_is_active,":cur_party"),
(party_get_slot,":party_slot_016",":cur_party",0),
(this_or_next|eq,":party_slot_016",2),
(eq,":party_slot_016",3),
(store_faction_of_party, ":faction_id_012", ":cur_party"),
(this_or_next|eq,":var011","fac_neutral"),
(eq,":faction_id_012",":var011"),
(party_get_position,pos1,":cur_party"),
(store_distance_to_party_from_party,":distance_parties_017",":cur_party",":cur_party"),
(lt,":distance_parties_017",":var014"),
(assign,":var014",":distance_parties_017"),
(assign,":var018",":cur_party"),
(try_end),
(try_end),
(party_get_position,pos1,"p_main_party"),
(party_get_position,pos2,":var018"),
(assign,":var014",1000000),
(try_for_range, ":var019", 0, 10),
(map_get_random_position_around_position,pos3,1,2),
(get_distance_between_positions,":distance_parties_017",2,3),
(try_begin),
(lt,":distance_parties_017",":var014"),
(assign,":var014",":distance_parties_017"),
(copy_position,63,3),
(try_end),
(try_end),
(party_set_position,":party_id_009",63),
(party_set_ai_object,":party_id_009",":party_id_009"),
(party_set_flags, ":party_id_009", 65536, 1),
(party_clear,":party_id_009"),
(party_get_num_companion_stacks,":party_num_companions_stacks_001","p_routed_enemies"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_001"),
(party_stack_get_troop_id,      ":troop_id_007","p_routed_enemies",":stack_no_004"),
(neg|troop_is_hero,":troop_id_007"),
(party_stack_get_size,          ":party_stack_size_008","p_routed_enemies",":stack_no_004"),
(party_add_members,":party_id_009",":troop_id_007",":party_stack_size_008"),
(try_end),
(try_end),
]),

("cf_training_ground_sub_routine_1_for_melee_details", [
(store_script_param, ":slot_no_001", 1),
(try_begin),
(ge,":::temp_3",":slot_no_001"),
(val_add, ":slot_no_001", 1),
(troop_get_slot,":troop_slot_002","trp_stack_selection_ids",":slot_no_001"),
(str_store_string,s0,":str_store_troop_name(troop_slot_002)"),
(try_end),
]),

("training_ground_sub_routine_2_for_melee_details", [
(store_script_param, ":var001", 1),
(val_sub, ":var001", 1),
(try_begin),
(lt,":var001",0),
(call_script, "script_remove_random_fit_party_member_from_stack_selection"),
(else_try),
(call_script, "script_remove_fit_party_member_from_stack_selection", ":var001"),
(try_end),
(assign,":var002",reg0),
(store_sub, ":slot_no_003", "$temp_2", 1),
(troop_set_slot,"trp_temp_array_a",":slot_no_003",":var002"),
(try_begin),
(eq,":::temp",":::temp_2"),
(call_script, "script_start_training_at_training_ground", -1, "$temp"),
(else_try),
(val_add, ":::temp_2", 1),
(jump_to_menu,"mnu_training_ground_selection_details_melee_2"),
(try_end),
]),

("cf_training_ground_sub_routine_for_training_result", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(store_script_param, ":var004", 4),
(store_character_level,":character_lvl_005",":troop_id_001"),
(store_add, ":var006", ":character_lvl_005", 5),
(store_mul, ":var007", ":var006", 3),
(val_min,":var007",100),
(store_sub, ":var008", ":var007", "$g_training_ground_training_hardness"),
(val_max,":var008",0),
(store_sub, ":var008", 100, ":var008"),
(val_mul, ":var008", ":var008"),
(val_div, ":var008", 10),
(store_mul, ":var009", ":var004", ":var008"),
(val_div, ":var009", 1000),
(try_begin),
(eq,":troop_id_001","trp_player"),
(val_mul, ":var009", 1),
(else_try),
(try_begin),
(eq,":::g_mt_mode",1),
(try_begin),
(this_or_next|troop_is_guarantee_ranged, ":troop_id_001"),
(troop_is_guarantee_horse, ":troop_id_001"),
(val_div, ":var009", 4),
(try_end),
(else_try),
(eq,":::g_mt_mode",3),
(try_begin),
(neg|troop_is_guarantee_horse, ":troop_id_001"),
(assign,":var009",0),
(try_end),
(else_try),
(neg|troop_is_guarantee_ranged, ":troop_id_001"),
(assign,":var009",0),
(try_end),
(try_end),
(val_add, ":character_lvl_005", 1),
(store_mul, ":var010", 100, ":character_lvl_005"),
(val_mul, ":var010", ":var003"),
(val_div, ":var010", 20),
(val_mul, ":var010", ":var009"),
(val_div, ":var010", 1000),
(store_mul, ":var011", ":var010", 3),
(val_div, ":var011", 2),
(store_div, ":var___x1", ":var010", 2),
(assign,":var012",":var___x1"),
(store_random_in_range,":random_x_013",":var012",":var011"),
(try_begin),
(gt,":random_x_013",0),
(try_begin),
(troop_is_hero,":troop_id_001"),
(add_xp_to_troop,":random_x_013",":troop_id_001"),
(store_div, ":var___x1", ":random_x_013", 50),
(assign,":amount_014",":var___x1"),
(gt,":amount_014",0),
(troop_raise_proficiency,":troop_id_001","$g_training_ground_used_weapon_proficiency",":amount_014"),
(try_end),
(else_try),
(party_add_xp_to_stack, "p_main_party", ":var002", ":random_x_013"),
(try_end),
(assign,reg0,":random_x_013"),
]),

("print_troop_owned_centers_in_numbers_to_s0", [
(store_script_param, ":var001", 1),
(str_store_string,s0,":str_store_string("@nothing")"),
(assign,":var002",0),
(assign,":var003",0),
(assign,":var004",0),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_005",7,":var001"),
(try_begin),
(party_slot_eq,":p_005",0,3),
(val_add, ":var002", 1),
(else_try),
(party_slot_eq,":p_005",0,2),
(val_add, ":var003", 1),
(else_try),
(val_add, ":var004", 1),
(try_end),
(try_end),
(assign,":var006",0),
(try_begin),
(gt,":var004",0),
(assign,reg0,":var004"),
(store_sub, reg1, reg0, 1),
(str_store_string,s0,":str_store_string("@{reg0} village{reg1?s:}")"),
(val_add, ":var006", 1),
(try_end),
(try_begin),
(gt,":var003",0),
(assign,reg0,":var003"),
(store_sub, reg1, reg0, 1),
(try_begin),
(eq,":var006",0),
(str_store_string,s0,":str_store_string("@{reg0} castle{reg1?s:}")"),
(else_try),
(str_store_string,s0,":str_store_string("@{reg0} castle{reg1?s:} and {s0}")"),
(try_end),
(val_add, ":var006", 1),
(try_end),
(try_begin),
(gt,":var002",0),
(assign,reg0,":var002"),
(store_sub, reg1, reg0, 1),
(try_begin),
(eq,":var006",0),
(str_store_string,s0,":str_store_string("@{reg0} town{reg1?s:}")"),
(else_try),
(eq,":var006",1),
(str_store_string,s0,":str_store_string("@{reg0} town{reg1?s:} and {s0}")"),
(else_try),
(str_store_string,s0,":str_store_string("@{reg0} town{reg1?s:}, {s0}")"),
(try_end),
(try_end),
(store_add, reg0, ":var004", ":var003"),
(val_add, reg0, ":var002"),
]),

("get_random_melee_training_weapon", [
(assign,":var001",-1),
(assign,":var002",-1),
(store_random_in_range,":random_x_003",0,3),
(try_begin),
(eq,":random_x_003",0),
(assign,":var001","itm_practice_staff"),
(else_try),
(eq,":random_x_003",1),
(assign,":var001","itm_practice_sword"),
(assign,":var002","itm_practice_shield"),
(else_try),
(assign,":var001","itm_heavy_practice_sword"),
(try_end),
(assign,reg0,":var001"),
(assign,reg1,":var002"),
]),

("start_training_at_training_ground", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(val_add, ":::g_training_ground_training_count", 1),
(set_jump_mission,"mt_training_ground_training"),
(assign,":var003",-1),
(assign,":var004",-1),
(assign,":var005",-1),
(assign,"$scene_num_total_gourds_destroyed",0),
(try_begin),
(eq,":var001",8),
(assign,"$g_training_ground_used_weapon_proficiency",3),
(assign,":var003","itm_practice_bow"),
(try_begin),
(eq,":::g_mt_mode",3),
(assign,":var004","itm_practice_arrows_100_amount"),
(else_try),
(assign,":var004","itm_practice_arrows_10_amount"),
(try_end),
(else_try),
(eq,":var001",9),
(assign,"$g_training_ground_used_weapon_proficiency",4),
(assign,":var003","itm_practice_crossbow"),
(assign,":var004","itm_practice_bolts_9_amount"),
(else_try),
(eq,":var001",10),
(assign,"$g_training_ground_used_weapon_proficiency",5),
(try_begin),
(eq,":::g_mt_mode",3),
(assign,":var004","itm_practice_throwing_daggers_100_amount"),
(else_try),
(assign,":var004","itm_practice_throwing_daggers"),
(try_end),
(else_try),
(eq,":var001",2),
(assign,"$g_training_ground_used_weapon_proficiency",0),
(assign,":var003","itm_practice_sword"),
(else_try),
(eq,":var001",4),
(assign,"$g_training_ground_used_weapon_proficiency",2),
(assign,":var003","itm_practice_lance"),
(else_try),
(assign,"$g_training_ground_used_weapon_proficiency",0),
(call_script, "script_get_random_melee_training_weapon"),
(assign,":var003",reg0),
(assign,":var004",reg1),
(try_end),
(try_begin),
(eq,":::g_mt_mode",3),
(assign,":var005","itm_practice_horse"),
(assign,"$g_training_ground_training_scene","scn_training_ground_horse_track_1"),
(val_add, ":::g_training_ground_training_scene", ":::g_encountered_party"),
(assign,"$g_training_ground_training_scene -","p_training_ground_1"),
(else_try),
(assign,"$g_training_ground_training_scene","scn_training_ground_ranged_melee_1"),
(val_add, ":::g_training_ground_training_scene", ":::g_encountered_party"),
(assign,"$g_training_ground_training_scene -","p_training_ground_1"),
(try_end),
(modify_visitors_at_site,"$g_training_ground_training_scene"),
(reset_visitors),
(set_visitor,0,"trp_player"),
(assign,":var006",-1),
(try_for_range, ":inventory_slot_no_007", 0, 4),
(troop_get_inventory_slot,":troop_inv_slot_008","trp_player",":inventory_slot_no_007"),
(try_begin),
(ge,":troop_inv_slot_008",0),
(item_get_type, ":item_type_009", ":troop_inv_slot_008"),
(eq,":item_type_009",":var001"),
(eq,":var006",-1),
(assign,":var006",":troop_inv_slot_008"),
(try_end),
(try_end),
(mission_tpl_entry_clear_override_items, "mt_training_ground_training", 0),
(mission_tpl_entry_add_override_item, "mt_training_ground_training", 0, "itm_practice_boots"),
(try_begin),
(ge,":var003",0),
(try_begin),
(ge,":var006",0),
(mission_tpl_entry_add_override_item, "mt_training_ground_training", 0, ":var006"),
(else_try),
(mission_tpl_entry_add_override_item, "mt_training_ground_training", 0, ":var003"),
(try_end),
(try_end),
(try_begin),
(ge,":var004",0),
(mission_tpl_entry_add_override_item, "mt_training_ground_training", 0, ":var004"),
(try_end),
(try_begin),
(ge,":var005",0),
(mission_tpl_entry_add_override_item, "mt_training_ground_training", 0, ":var005"),
(try_end),
(assign,":entry_no_010",5),
(troop_get_slot,":troop_slot_011","trp_stack_selection_amounts",1),
(store_add, ":var012", 5, ":troop_slot_011"),
(val_min,":var012",13),
(try_for_range, ":entry_no_010", 5, ":var012"),
(call_script, "script_remove_random_fit_party_member_from_stack_selection"),
(set_visitor,":entry_no_010",reg0),
(val_add, ":entry_no_010", 1),
(try_end),
(try_begin),
(eq,":::g_mt_mode",1),
(assign,":var013",0),
(try_for_range, ":slot_no_014", 0, ":var002"),
(troop_get_slot,":troop_slot_015","trp_temp_array_a",":slot_no_014"),
(store_add, ":entry_no_016", ":slot_no_014", 1),
(set_visitor,":entry_no_016",":troop_slot_015"),
(mission_tpl_entry_clear_override_items, "mt_training_ground_training", ":entry_no_016"),
(mission_tpl_entry_add_override_item, "mt_training_ground_training", ":entry_no_016", "itm_practice_boots"),
(call_script, "script_get_random_melee_training_weapon"),
(mission_tpl_entry_add_override_item, "mt_training_ground_training", ":entry_no_016", reg0),
(try_begin),
(ge,reg1,0),
(mission_tpl_entry_add_override_item, "mt_training_ground_training", ":entry_no_016", reg1),
(try_end),
(store_character_level,":character_lvl_017",":troop_slot_015"),
(val_add, ":character_lvl_017", 10),
(val_mul, ":character_lvl_017", ":character_lvl_017"),
(val_add, ":var013", ":character_lvl_017"),
(try_end),
(assign,"$g_training_ground_training_num_enemies",":var002"),
(assign,"$g_training_ground_training_hardness",":var013"),
(store_add, ":var018", "$g_training_ground_training_num_enemies", 4),
(val_mul, ":::g_training_ground_training_hardness", ":var018"),
(val_div, ":::g_training_ground_training_hardness", 2400),
(str_store_string,s0,":str_store_string()"),
(else_try),
(eq,":::g_mt_mode",3),
(try_begin),
(eq,":var001",8),
(assign,"$g_training_ground_training_hardness",350),
(assign,"$g_training_ground_training_num_gourds_to_destroy",30),
(else_try),
(eq,":var001",10),
(assign,"$g_training_ground_training_hardness",400),
(assign,"$g_training_ground_training_num_gourds_to_destroy",30),
(else_try),
(eq,":var001",2),
(assign,"$g_training_ground_training_hardness",200),
(assign,"$g_training_ground_training_num_gourds_to_destroy",45),
(else_try),
(eq,":var001",4),
(assign,"$g_training_ground_training_hardness",280),
(assign,"$g_training_ground_training_num_gourds_to_destroy",35),
(try_end),
(str_store_string,s0,":str_store_string()"),
(else_try),
(eq,":::g_mt_mode",2),
(store_mul, ":_g_training_ground_ranged_distance", ":var002", 100),
(assign,":var019",":var002"),
(val_mul, ":var019", ":var019"),
(try_begin),
(eq,":var001",8),
(val_mul, ":var019", 3),
(val_div, ":var019", 2),
(else_try),
(eq,":var001",10),
(val_mul, ":var019", 5),
(val_div, ":var019", 2),
(val_mul, ":var019", ":var002"),
(val_div, ":var019", 2),
(try_end),
(store_mul, ":_g_training_ground_training_hardness", 100, ":var019"),
(val_div, ":::g_training_ground_training_hardness", 6000),
(str_store_string,s0,":str_store_string()"),
(try_end),
(jump_to_menu,"mnu_training_ground_description"),
]),

("party_count_fit_regulars", [
(store_script_param, ":party_id_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(try_for_range, ":stack_no_003", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004",":party_id_001",":stack_no_003"),
(try_begin),
(neg|troop_is_hero,":troop_id_004"),
(party_stack_get_size,          ":party_stack_size_005",":party_id_001",":stack_no_003"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_006",":party_id_001",":stack_no_003"),
(val_sub, ":party_stack_size_005", ":party_stack_num_wounded_006"),
(val_add, 0, ":party_stack_size_005"), # reg0
(try_end),
(try_end),
]),

("party_count_fit_for_battle", [
(store_script_param, ":party_id_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(try_for_range, ":stack_no_003", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004",":party_id_001",":stack_no_003"),
(assign,":party_stack_size_005",0),
(try_begin),
(troop_is_hero,":troop_id_004"),
(try_begin),
(neg|troop_is_wounded,":troop_id_004"),
(assign,":party_stack_size_005",1),
(try_end),
(else_try),
(party_stack_get_size,          ":party_stack_size_005",":party_id_001",":stack_no_003"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_006",":party_id_001",":stack_no_003"),
(val_sub, ":party_stack_size_005", ":party_stack_num_wounded_006"),
(try_end),
(val_add, 0, ":party_stack_size_005"), # reg0
(try_end),
]),

("party_count_members_with_full_health", [
(store_script_param, ":party_id_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(try_for_range, ":stack_no_003", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004",":party_id_001",":stack_no_003"),
(try_begin),
(neq,":troop_id_004","trp_player"),
(assign,":party_stack_size_005",0),
(try_begin),
(troop_is_hero,":troop_id_004"),
(store_troop_health,":troop_health_006",":troop_id_004"),
(ge,":troop_health_006",80),
(assign,":party_stack_size_005",1),
(try_end),
(else_try),
(party_stack_get_size,          ":party_stack_size_005",":party_id_001",":stack_no_003"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_007",":party_id_001",":stack_no_003"),
(val_sub, ":party_stack_size_005", ":party_stack_num_wounded_007"),
(val_max,":party_stack_size_005",0),
(try_end),
(val_add, 0, ":party_stack_size_005"), # reg0
(try_end),
]),

("get_stack_with_rank", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_001"),
(assign,reg0,-1),
(assign,":var004",0),
(try_for_range, ":stack_no_005", 0, ":party_num_companions_stacks_003"),
(eq,reg0,-1),
(party_stack_get_troop_id,      ":troop_id_006",":party_id_001",":stack_no_005"),
(neg|troop_is_hero,":troop_id_006"),
(party_stack_get_size,          ":party_stack_size_007",":party_id_001",":stack_no_005"),
(party_stack_get_num_wounded,   ":party_stack_num_wounded_008",":party_id_001",":stack_no_005"),
(val_sub, ":party_stack_size_007", ":party_stack_num_wounded_008"),
(val_add, ":var004", ":party_stack_size_007"),
(lt,":var002",":var004"),
(assign,reg0,":stack_no_005"),
(try_end),
(try_end),
]),

("inflict_casualties_to_party", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var003", 2),
(party_clear,"p_temp_casualties"),
(call_script, "script_party_count_fit_regulars", ":party_id_001"),
(assign,":var002",reg0),
(try_for_range, ":var004", 0, ":var003"),
(gt,":var002",0),
(store_random_in_range,":random_x_005",0,":var002"),
(assign,reg1,":random_x_005"),
(call_script, "script_get_stack_with_rank", ":party_id_001", ":random_x_005"),
(assign,":stack_no_006",reg0),
(party_stack_get_troop_id,      ":troop_id_007",":party_id_001",":stack_no_006"),
(store_character_level,":character_lvl_008",":troop_id_007"),
(val_add, ":character_lvl_008", 5),
(assign,":var009",10000),
(val_div, ":var009", ":character_lvl_008"),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_010",0,10000),
(try_begin),
(lt,":random_x_010",":var009"),
(store_random_in_range,":random_x_011",0,2),
(try_begin),
(troop_is_hero,":troop_id_007"),
(store_troop_health,":troop_health_012",":troop_id_007"),
(val_sub, ":troop_health_012", 45),
(val_max,":troop_health_012",1),
(troop_set_health,":troop_id_007",":troop_health_012"),
(else_try),
(lt,":random_x_011",1),
(party_add_members,"p_temp_casualties",":troop_id_007",1),
(party_wound_members,"p_temp_casualties",":troop_id_007",1),
(party_wound_members,":party_id_001",":troop_id_007",1),
(else_try),
(party_add_members,"p_temp_casualties",":troop_id_007",1),
(party_remove_members,":party_id_001",":troop_id_007",1),
(try_end),
(try_end),
(try_end),
(val_sub, ":var002", 1),
(try_end),
]),

("move_members_with_ratio", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_003",":party_id_001"),
(try_for_range, ":stack_no_004", 0, ":party_num_prisoners_stacks_003"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_005",":party_id_001",":stack_no_004"),
(party_get_prisoner_stack_size, ":party_prisoner_stack_size_006",":party_id_001",":stack_no_004"),
(store_mul, ":var007", ":party_prisoner_stack_size_006", "$pin_number"),
(val_div, ":var007", 1000),
(party_remove_members,":party_id_001",":party_prisoner_troop_id_005",":var007"),
(assign,":var008",reg0),
(party_add_prisoners,":var002",":party_prisoner_troop_id_005",":var008"),
(try_end),
(party_get_num_companion_stacks,":party_num_prisoners_stacks_003",":party_id_001"),
(try_for_range, ":stack_no_004", 0, ":party_num_prisoners_stacks_003"),
(party_stack_get_troop_id,      ":party_prisoner_troop_id_005",":party_id_001",":stack_no_004"),
(party_stack_get_size,          ":party_prisoner_stack_size_006",":party_id_001",":stack_no_004"),
(store_mul, ":var007", ":party_prisoner_stack_size_006", "$pin_number"),
(val_div, ":var007", 1000),
(party_remove_members,":party_id_001",":party_prisoner_troop_id_005",":var007"),
(assign,":var008",reg0),
(party_add_members,":var002",":party_prisoner_troop_id_005",":var008"),
(try_end),
]),

("count_parties_of_faction_and_party_type", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_for_parties, ":cur_party"),
(party_is_active,":cur_party"),
(party_get_slot,":party_slot_004",":cur_party",0),
(store_faction_of_party, ":party_faction_005", ":cur_party"),
(eq,":party_slot_004",":var002"),
(eq,":party_faction_005",":var001"),
(val_add, 0, 1), # reg0
(try_end),
(try_end),
]),

("faction_get_number_of_armies", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_for_range, ":trp_003", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_003",2,2),
(store_troop_faction,":troop_faction_004",":trp_003"),
(eq,":troop_faction_004",":var001"),
(troop_get_slot,":troop_slot_005",":trp_003",10),
(ge,":troop_slot_005",0),
(party_is_active,":troop_slot_005"),
(call_script, "script_party_count_fit_regulars", ":troop_slot_005"),
(assign,":var006",reg0),
(call_script, "script_party_get_ideal_size", ":troop_slot_005"),
(assign,":var007",reg0),
(val_mul, ":var007", 60),
(val_div, ":var007", 100),
(gt,":var006",":var007"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("faction_recalculate_strength", [
(store_script_param, ":faction_id_001", 1),
(call_script, "script_faction_get_number_of_armies", ":faction_id_001"),
(assign,":var002",reg0),
(assign,":var003",0),
(assign,":var004",0),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(try_begin),
(eq,":party_faction_006",":faction_id_001"),
(try_begin),
(party_slot_eq,":p_005",0,2),
(val_add, ":var003", 1),
(else_try),
(party_slot_eq,":p_005",0,3),
(val_add, ":var004", 1),
(try_end),
(try_end),
(try_end),
(faction_set_slot,":faction_id_001",80,":var002"),
(faction_set_slot,":faction_id_001",81,":var003"),
(faction_set_slot,":faction_id_001",82,":var004"),
]),

("cf_select_random_town_with_faction", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.town_1", ":p.castle_1"),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(try_begin),
(eq,":party_faction_005",":var001"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var003",0),
(store_random_in_range,":random_x_006",0,":var003"),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.town_1", ":p.castle_1"),
(eq,":var002",-1),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(eq,":party_faction_005",":var001"),
(val_add, ":var003", 1),
(gt,":var003",":random_x_006"),
(assign,":var002",":p_004"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("cf_select_random_village_with_faction", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.village_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(try_begin),
(eq,":party_faction_005",":var001"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var003",0),
(store_random_in_range,":random_x_006",0,":var003"),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.village_1", ":p.salt_mine"),
(eq,":var002",-1),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(eq,":party_faction_005",":var001"),
(val_add, ":var003", 1),
(gt,":var003",":random_x_006"),
(assign,":var002",":p_004"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("cf_select_random_walled_center_with_faction", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-1),
(assign,":var004",0),
(try_for_range, ":p_005", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(try_begin),
(eq,":party_faction_006",":var001"),
(val_add, ":var004", 1),
(eq,":p_005",":var002"),
(val_add, ":var004", 99),
(try_end),
(try_end),
(try_begin),
(gt,":var004",0),
(store_random_in_range,":random_x_007",0,":var004"),
(try_for_range, ":p_005", ":p.town_1", ":p.village_1"),
(eq,":var003",-1),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(eq,":party_faction_006",":var001"),
(val_sub, ":random_x_007", 1),
(eq,":p_005",":var002"),
(val_sub, ":random_x_007", 99),
(try_end),
(try_end),
(lt,":random_x_007",0),
(assign,":var003",":p_005"),
(try_end),
(assign,reg0,":var003"),
]),

("cf_select_random_walled_center_with_faction_and_owner_priority_no_siege", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-1),
(assign,":var004",0),
(call_script, "script_lord_get_home_center", ":var002"),
(assign,":var005",reg0),
(try_for_range, ":p_006", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_007", ":p_006"),
(try_begin),
(eq,":party_faction_007",":faction_id_001"),
(party_slot_eq,":p_006",54,-1),
(val_add, ":var004", 1),
(eq,":var005",":p_006"),
(val_add, ":var004", 1000),
(try_end),
(try_end),
(try_begin),
(le,":var004",0),
(assign,"$g_there_is_no_avaliable_centers",1),
(try_for_range, ":p_006", ":p.town_1", ":p.village_1"),
(party_slot_eq,":p_006",54,-1),
(val_add, ":var004", 1),
(try_end),
(else_try),
(assign,"$g_there_is_no_avaliable_centers",0),
(try_end),
(faction_get_slot,":faction_slot_008",":faction_id_001",11),
(try_begin),
(this_or_next|eq,":::g_there_is_no_avaliable_centers",0),
(neq,":var002",":faction_slot_008"),
(store_random_in_range,":random_x_009",0,":var004"),
(try_for_range, ":p_006", ":p.town_1", ":p.village_1"),
(eq,":var003",-1),
(store_faction_of_party, ":party_faction_007", ":p_006"),
(this_or_next|eq,":::g_there_is_no_avaliable_centers",1),
(eq,":party_faction_007",":faction_id_001"),
(party_slot_eq,":p_006",54,-1),
(val_sub, ":random_x_009", 1),
(eq,":var005",":p_006"),
(eq,":::g_there_is_no_avaliable_centers",0),
(val_sub, ":random_x_009", 1000),
(try_end),
(try_end),
(lt,":random_x_009",0),
(assign,":var003",":p_006"),
(try_end),
(assign,reg0,":var003"),
]),

("cf_select_random_walled_center_with_faction_and_less_strength_priority", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-1),
(assign,":var004",0),
(try_for_range, ":p_005", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(try_begin),
(eq,":party_faction_006",":var001"),
(party_slot_eq,":p_005",54,-1),
(val_add, ":var004", 1),
(eq,":p_005",":var002"),
(val_add, ":var004", 99),
(try_end),
(try_end),
(try_begin),
(gt,":var004",0),
(store_random_in_range,":random_x_007",0,":var004"),
(try_for_range, ":p_005", ":p.town_1", ":p.village_1"),
(eq,":var003",-1),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(eq,":party_faction_006",":var001"),
(party_slot_eq,":p_005",54,-1),
(val_sub, ":random_x_007", 1),
(eq,":p_005",":var002"),
(val_sub, ":random_x_007", 99),
(try_end),
(try_end),
(lt,":random_x_007",0),
(assign,":var003",":p_005"),
(try_end),
(assign,reg0,":var003"),
]),

("cf_select_random_town_at_peace_with_faction", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.town_1", ":p.castle_1"),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(store_relation,":faction_relation_006",":party_faction_005",":var001"),
(try_begin),
(ge,":faction_relation_006",0),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var003",0),
(store_random_in_range,":random_x_007",0,":var003"),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.town_1", ":p.castle_1"),
(eq,":var002",-1),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(store_relation,":faction_relation_006",":party_faction_005",":var001"),
(ge,":faction_relation_006",0),
(val_add, ":var003", 1),
(gt,":var003",":random_x_007"),
(assign,":var002",":p_004"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("cf_select_random_town_at_peace_with_faction_in_trade_route", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-1),
(assign,":var004",0),
(try_for_range, ":slot_no_005", 190, 205),
(party_get_slot,":party_slot_006",":party_id_001",":slot_no_005"),
(try_begin),
(gt,":party_slot_006",0),
(store_faction_of_party, ":party_faction_007", ":party_slot_006"),
(store_relation,":faction_relation_008",":party_faction_007",":var002"),
(ge,":faction_relation_008",0),
(val_add, ":var004", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var004",0),
(store_random_in_range,":random_x_009",0,":var004"),
(try_for_range, ":slot_no_005", 190, 205),
(eq,":var003",-1),
(party_get_slot,":party_slot_006",":party_id_001",":slot_no_005"),
(gt,":party_slot_006",0),
(store_faction_of_party, ":party_faction_007", ":party_slot_006"),
(store_relation,":faction_relation_008",":party_faction_007",":var002"),
(ge,":faction_relation_008",0),
(val_sub, ":random_x_009", 1),
(lt,":random_x_009",0),
(assign,":var003",":party_slot_006"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var003"),
]),

("cf_select_most_profitable_town_at_peace_with_faction_in_trade_route", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-1),
(assign,":var004",0),
(store_sub, ":var005", 250, ":itm.spice"),
(try_for_range, ":slot_no_006", 190, 205),
(party_get_slot,":party_slot_007",":party_id_001",":slot_no_006"),
(try_begin),
(gt,":party_slot_007",0),
(store_faction_of_party, ":party_faction_008", ":party_slot_007"),
(store_relation,":faction_relation_009",":party_faction_008",":var002"),
(try_begin),
(ge,":faction_relation_009",0),
(assign,":var010",0),
(try_for_range, ":itm_011", ":itm.spice", ":itm.siege_supply"),
(neq,":itm_011","itm_butter"),
(neq,":itm_011","itm_cattle_meat"),
(neq,":itm_011","itm_chicken"),
(neq,":itm_011","itm_pork"),
(store_add, ":slot_no_012", ":itm_011", ":var005"),
(party_get_slot,":party_slot_013",":party_id_001",":slot_no_012"),
(party_get_slot,":party_slot_014",":party_slot_007",":slot_no_012"),
(gt,":party_slot_014",":party_slot_013"),
(store_sub, ":var015", ":party_slot_014", ":party_slot_013"),
(this_or_next|eq,":itm_011","itm_velvet"),
(eq,":itm_011","itm_spice"),
(val_mul, ":var015", 2),
(try_end),
(try_end),
(try_end),
(val_add, ":var010", ":var015"),
(try_end),
(gt,":var010",":var004"),
(assign,":var004",":var010"),
(assign,":var003",":party_slot_007"),
(try_end),
(try_begin),
(gt,":var003",-1),
(assign,reg0,":var003"),
(try_end),
]),

("shuffle_troop_slots", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(try_for_range, ":slot_no_004", ":var002", ":var003"),
(store_random_in_range,":random_x_005",":var002",":var003"),
(troop_get_slot,":troop_slot_006",":troop_id_001",":slot_no_004"),
(troop_get_slot,":troop_slot_007",":troop_id_001",":random_x_005"),
(troop_set_slot,":troop_id_001",":slot_no_004",":troop_slot_007"),
(troop_set_slot,":troop_id_001",":random_x_005",":troop_slot_006"),
(try_end),
]),

("get_quest", [
(store_script_param, ":troop_id_001", 1),
(store_character_level,":character_lvl_002","trp_player"),
(store_troop_faction,":troop_faction_003",":troop_id_001"),
(troop_get_slot,":troop_slot_004",":troop_id_001",10),
(troop_get_slot,":troop_slot_005",":troop_id_001",52),
(assign,":party_attached_006",-1),
(try_begin),
(gt,":troop_slot_004",0),
(party_get_attached_to, ":party_attached_006", ":troop_slot_004"),
(else_try),
(is_between,"$g_encountered_party","p_town_1","p_salt_mine"),
(assign,":party_attached_006","$g_encountered_party"),
(try_end),
(try_begin),
(troop_slot_eq,":troop_id_001",2,2),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(assign,":var007","qst_deliver_message"),
(assign,":var008","qst_follow_army"),
(assign,":var009","qst_destroy_bandit_lair"),
(assign,":var010","qst_blank_quest_2"),
(else_try),
(assign,":var007","qst_lend_surgeon"),
(assign,":var008","qst_follow_army"),
(assign,":var009",0),
(assign,":var010",0),
(try_end),
(else_try),
(is_between,":troop_id_001","trp_village_1_elder","trp_merchants_end"),
(assign,":var007","qst_deliver_grain"),
(assign,":var008","qst_eliminate_bandits_infesting_village"),
(assign,":var009","qst_blank_quest_6"),
(assign,":var010","qst_blank_quest_6"),
(else_try),
(is_between,":troop_id_001","trp_town_1_mayor","trp_village_1_elder"),
(assign,":var007","qst_move_cattle_herd"),
(assign,":var008","qst_deliver_grain"),
(assign,":var009","qst_blank_quest_11"),
(assign,":var010","qst_blank_quest_11"),
(else_try),
(assign,":var007","qst_rescue_lord_by_replace"),
(assign,":var008","qst_move_cattle_herd"),
(assign,":var009","qst_blank_quest_16"),
(assign,":var010","qst_blank_quest_16"),
(try_end),
(assign,":quest_id_011",-1),
(assign,":troop_id_012",-1),
(assign,":random_party_013",-1),
(assign,":party_faction_014",-1),
(assign,":troop_faction_015",-1),
(assign,":faction_slot_016",-1),
(assign,":var017",-1),
(assign,":var018",-1),
(assign,":var019",-1),
(assign,":random_x_020",-1),
(assign,":random_x_021",-1),
(assign,":var022",-1),
(assign,":var023",1),
(assign,":var024",0),
(assign,":character_lvl_025",0),
(assign,":var026",0),
(assign,":var027",0),
(assign,":var028",0),
(try_begin),
(eq,1,1),
(call_script, "script_get_dynamic_quest", "$g_talk_troop"),
(assign,":quest_id_011",reg0),
(assign,":var029",reg1),
(assign,":var030",reg2),
(assign,":var031",reg3),
(try_begin),
(eq,":quest_id_011","qst_track_down_bandits"),
(assign,":var018",":var030"),
(assign,":var027",60),
(assign,":var024",1000),
(assign,":character_lvl_025",1000),
(else_try),
(eq,":quest_id_011","qst_retaliate_for_border_incident"),
(assign,":troop_id_012",":var029"),
(assign,":party_faction_014",":var031"),
(assign,":var027",30),
(assign,":var024",1000),
(assign,":character_lvl_025",1000),
(else_try),
(eq,":quest_id_011","qst_cause_provocation"),
(assign,":party_faction_014",":var031"),
(assign,":var027",30),
(assign,":var028",100),
(assign,":var024",1000),
(assign,":character_lvl_025",1000),
(else_try),
(eq,":quest_id_011","qst_destroy_bandit_lair"),
(assign,":var018",":var030"),
(assign,":var027",60),
(assign,":var024",3000),
(assign,":character_lvl_025",1500),
(else_try),
(eq,":quest_id_011","qst_rescue_prisoner"),
(assign,":troop_id_012",":var029"),
(assign,":random_party_013",":var030"),
(assign,":var027",30),
(assign,":var028",5),
(assign,":var024",1500),
(assign,":character_lvl_025",3000),
(try_end),
(try_end),
(try_begin),
(eq,":quest_id_011",-1),
(try_for_range, ":var032", 0, 20),
(eq,":quest_id_011",-1),
(assign,":troop_id_012",-1),
(assign,":random_party_013",-1),
(assign,":party_faction_014",-1),
(assign,":troop_faction_015",-1),
(assign,":faction_slot_016",-1),
(assign,":var017",-1),
(assign,":var018",-1),
(assign,":var019",-1),
(assign,":random_x_020",-1),
(assign,":random_x_021",-1),
(assign,":var022",-1),
(assign,":var023",1),
(assign,":var024",0),
(assign,":character_lvl_025",0),
(assign,":var026",0),
(assign,":var027",0),
(assign,":var028",0),
(store_sub, ":var033", ":var008", ":var007"),
(store_sub, ":var034", ":var010", ":var009"),
(store_add, ":var035", ":var033", ":var034"),
(store_random_in_range,":random_x_036",0,":var035"),
(try_begin),
(lt,":random_x_036",":var033"),
(store_random_in_range,":random_x_036",":var007",":var008"),
(else_try),
(store_random_in_range,":random_x_036",":var009",":var010"),
(try_end),
(try_begin),
(neg|check_quest_active,":random_x_036"),
(neg|quest_slot_ge,":random_x_036",25,1),
(try_begin),
(eq,":random_x_036","qst_deliver_grain"),
(try_begin),
(is_between,":party_attached_006","p_village_1","p_salt_mine"),
(call_script, "script_get_troop_item_amount", ":troop_id_001", "itm_grain"),
(eq,reg0,0),
(neg|party_slot_ge,":party_attached_006",50,40),
(assign,":random_party_013",":party_attached_006"),
(store_random_in_range,":random_x_020",4,8),
(assign,":var027",30),
(assign,":var028",20),
(assign,":quest_id_011",":random_x_036"),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_deliver_cattle"),
(try_begin),
(is_between,":party_attached_006","p_village_1","p_salt_mine"),
(party_get_slot,":party_slot_037",":party_attached_006",205),
(try_begin),
(lt,":party_slot_037",50),
(assign,":random_party_013",":party_attached_006"),
(store_random_in_range,":random_x_020",5,10),
(assign,":var027",30),
(assign,":var028",20),
(assign,":quest_id_011",":random_x_036"),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_train_peasants_against_bandits"),
(try_begin),
(is_between,":party_attached_006","p_village_1","p_salt_mine"),
(store_skill_level,":skill_lvl_038","skl_trainer","trp_player"),
(try_begin),
(gt,":skill_lvl_038",0),
(store_random_in_range,":random_x_020",5,8),
(assign,":random_party_013",":party_attached_006"),
(assign,":var027",20),
(assign,":var028",40),
(assign,":quest_id_011",":random_x_036"),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_escort_merchant_caravan"),
(is_between,":party_attached_006","p_town_1","p_salt_mine"),
(store_random_party_in_range,":random_party_013","p_town_1","p_castle_1"),
(store_distance_to_party_from_party,":distance_parties_039",":party_attached_006",":party_attached_006"),
(assign,":character_lvl_025",":distance_parties_039"),
(val_add, ":character_lvl_025", 25),
(val_mul, ":character_lvl_025", 25),
(val_div, ":character_lvl_025", 20),
(store_random_in_range,":random_x_020",6,12),
(assign,"$escort_merchant_caravan_mode",0),
(assign,":quest_id_011",":random_x_036"),
(else_try),
(eq,":random_x_036","qst_deliver_wine"),
(is_between,":party_attached_006","p_town_1","p_salt_mine"),
(store_random_party_in_range,":random_party_013","p_town_1","p_castle_1"),
(store_random_in_range,":random_x_040",0,2),
(try_begin),
(eq,":random_x_040",0),
(assign,":var022","itm_quest_wine"),
(else_try),
(assign,":var022","itm_quest_ale"),
(try_end),
(store_random_in_range,":random_x_020",6,12),
(store_distance_to_party_from_party,":distance_parties_039",":party_attached_006",":party_attached_006"),
(assign,":character_lvl_025",":distance_parties_039"),
(val_add, ":character_lvl_025", 2),
(assign,":var041",5),
(val_add, ":var041", ":random_x_020"),
(val_mul, ":character_lvl_025", ":var041"),
(val_div, ":character_lvl_025", 100),
(val_mul, ":character_lvl_025", 10),
(store_item_value,"$qst_deliver_wine_debt",":var022"),
(val_mul, ":::qst_deliver_wine_debt", ":random_x_020"),
(val_mul, ":::qst_deliver_wine_debt", 6),
(val_div, ":::qst_deliver_wine_debt", 5),
(assign,":var027",7),
(assign,":var028",20),
(assign,":quest_id_011",":random_x_036"),
(else_try),
(eq,":random_x_036","qst_troublesome_bandits"),
(is_between,":party_attached_006","p_town_1","p_salt_mine"),
(store_character_level,":character_lvl_025","trp_player"),
(val_add, ":character_lvl_025", 20),
(val_mul, ":character_lvl_025", 35),
(val_div, ":character_lvl_025", 100),
(val_mul, ":character_lvl_025", 10),
(assign,":var027",30),
(assign,":var028",30),
(assign,":quest_id_011",":random_x_036"),
(else_try),
(eq,":random_x_036","qst_kidnapped_girl"),
(is_between,":party_attached_006","p_town_1","p_salt_mine"),
(store_random_in_range,":random_party_013","p_village_1","p_salt_mine"),
(store_character_level,":random_x_020",":"),
(val_add, ":random_x_020", 15),
(store_distance_to_party_from_party,":distance_parties_039",":party_attached_006",":party_attached_006"),
(val_add, ":distance_parties_039", 15),
(val_mul, ":distance_parties_039", 2),
(val_mul, ":random_x_020", ":distance_parties_039"),
(val_div, ":random_x_020", 100),
(val_mul, ":random_x_020", 10),
(assign,":character_lvl_025",":random_x_020"),
(val_div, ":character_lvl_025", 40),
(val_mul, ":character_lvl_025", 10),
(assign,":var027",15),
(assign,":var028",30),
(assign,":quest_id_011",":random_x_036"),
(else_try),
(eq,":random_x_036","qst_move_cattle_herd"),
(is_between,":party_attached_006","p_town_1","p_salt_mine"),
(call_script, "script_cf_select_random_town_at_peace_with_faction", ":troop_faction_003"),
(neq,":party_attached_006",reg0),
(assign,":random_party_013",reg0),
(store_distance_to_party_from_party,":distance_parties_039",":party_attached_006",":party_attached_006"),
(assign,":character_lvl_025",":distance_parties_039"),
(val_add, ":character_lvl_025", 25),
(val_mul, ":character_lvl_025", 50),
(val_div, ":character_lvl_025", 20),
(assign,":var027",30),
(assign,":var028",20),
(assign,":quest_id_011",":random_x_036"),
(else_try),
(eq,":random_x_036","qst_persuade_lords_to_make_peace"),
(is_between,":party_attached_006","p_town_1","p_salt_mine"),
(store_faction_of_party, ":party_faction_042", ":party_attached_006"),
(try_begin),
(call_script, "script_cf_faction_get_random_enemy_faction", ":party_faction_042"),
(assign,":faction_id_043",reg0),
(try_begin),
(call_script, "script_cf_get_random_lord_except_king_with_faction", ":party_faction_042"),
(assign,":troop_id_044",reg0),
(try_begin),
(this_or_next|troop_slot_eq,":troop_id_044",52,2),
(this_or_next|troop_slot_eq,":troop_id_044",52,3),
(this_or_next|troop_slot_eq,":troop_id_044",52,1),
(troop_slot_eq,":troop_id_044",52,5),
(call_script, "script_cf_get_random_lord_except_king_with_faction", ":faction_id_043"),
(assign,":troop_id_012",reg0),
(try_begin),
(this_or_next|troop_slot_eq,":troop_id_012",52,2),
(this_or_next|troop_slot_eq,":troop_id_012",52,3),
(this_or_next|troop_slot_eq,":troop_id_012",52,1),
(troop_slot_eq,":troop_id_012",52,5),
(assign,":faction_slot_016",":troop_id_044"),
(assign,":party_faction_014",":faction_id_043"),
(assign,":troop_faction_015",":party_faction_042"),
(assign,":character_lvl_025",12000),
(assign,":var026",7000),
(assign,":var027",30),
(assign,":var028",100),
(assign,":quest_id_011",":random_x_036"),
(else_try),
(eq,":random_x_036","qst_deal_with_looters"),
(is_between,":character_lvl_002",0,15),
(is_between,":party_attached_006","p_town_1","p_salt_mine"),
(store_faction_of_party, ":party_faction_042", ":party_attached_006"),
(store_num_parties_destroyed_by_player,":num_destroyed_parties_by_player_045","pt_looters"),
(party_template_set_slot,"pt_looters",1,":num_destroyed_parties_by_player_045"),
(quest_set_slot,":random_x_036",11,0),
(quest_set_slot,":random_x_036",9,"pt_looters"),
(assign,":character_lvl_025",500),
(assign,":var024",500),
(assign,":var027",20),
(assign,":var028",30),
(assign,":quest_id_011",":random_x_036"),
(else_try),
(eq,":random_x_036","qst_deal_with_night_bandits"),
(is_between,":character_lvl_002",0,15),
(is_between,":party_attached_006","p_town_1","p_salt_mine"),
(party_slot_ge,":party_attached_006",155,1),
(assign,":random_party_013",":party_attached_006"),
(assign,":var027",4),
(assign,":var028",15),
(assign,":quest_id_011",":random_x_036"),
(else_try),
(eq,":random_x_036","qst_rescue_lord_by_replace"),
(eq,1,0),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(is_between,":character_lvl_002",5,25),
(assign,":var046",-1),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_047",":troop_id_001",31),
(try_begin),
(gt,":troop_slot_047",0),
(troop_slot_ge,":troop_slot_047",8,0),
(assign,":var046",":troop_slot_047"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var046",-1),
(troop_get_slot,":troop_slot_047",":troop_id_001",30),
(try_begin),
(gt,":troop_slot_047",0),
(troop_slot_ge,":troop_slot_047",8,0),
(assign,":var046",":troop_slot_047"),
(try_end),
(try_end),
(try_begin),
(eq,":var046",-1),
(troop_get_slot,":troop_slot_047",":troop_id_001",33),
(try_begin),
(gt,":troop_slot_047",0),
(troop_slot_ge,":troop_slot_047",8,0),
(assign,":var046",":troop_slot_047"),
(try_end),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg0,":var046"),
(display_message, "str_prisoner_relative_is_reg0"),
(try_end),
(try_begin),
(gt,":var046",-1),
(call_script, "script_search_troop_prisoner_of_party", ":var046"),
(assign,":var048",reg0),
(try_begin),
(is_between,":var048","p_town_1","p_village_1"),
(assign,":random_party_013",":var048"),
(assign,":troop_id_012",":var046"),
(assign,":var027",30),
(assign,":var028",73),
(assign,":quest_id_011",":random_x_036"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_deliver_message_to_prisoner_lord"),
(eq,":::player_has_homage",0),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(is_between,":character_lvl_002",5,25),
(troop_get_slot,":troop_slot_047",":troop_id_001",31),
(try_begin),
(eq,":troop_slot_047",0),
(troop_get_slot,":troop_slot_047",":troop_id_001",30),
(try_end),
(try_begin),
(gt,":troop_slot_047",-1),
(troop_slot_ge,":troop_slot_047",8,0),
(call_script, "script_search_troop_prisoner_of_party", ":troop_slot_047"),
(assign,":var048",reg0),
(try_begin),
(is_between,":var048","p_town_1","p_castle_1"),
(assign,":random_party_013",":var048"),
(assign,":troop_id_012",":troop_slot_047"),
(assign,":var027",30),
(assign,":var028",30),
(assign,":quest_id_011",":random_x_036"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_duel_for_lady"),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(ge,":character_lvl_002",10),
(call_script, "script_cf_troop_get_random_enemy_troop_with_occupation", ":troop_id_001", 2),
(assign,":troop_slot_047",reg0),
(try_begin),
(neg|troop_slot_eq,":troop_id_001",30,":troop_slot_047"),
(neg|troop_slot_eq,":troop_id_001",31,":troop_slot_047"),
(neg|troop_slot_ge,":troop_slot_047",8,0),
(troop_slot_ge,":troop_slot_047",10,0),
(neg|troop_slot_eq,":troop_slot_047",52,6),
(neg|troop_slot_eq,":troop_slot_047",52,7),
(neg|troop_slot_eq,":troop_slot_047",52,1),
(assign,":troop_id_012",":troop_slot_047"),
(assign,":var027",30),
(assign,":var028",50),
(assign,":quest_id_011",":random_x_036"),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_lend_surgeon"),
(try_begin),
(eq,":::g_defending_against_siege",0),
(neq,":troop_slot_005",2),
(neq,":troop_slot_005",5),
(assign,":var049",0),
(assign,":var050",-1),
(party_get_num_companion_stacks,":party_num_companions_stacks_051","p_main_party"),
(try_for_range, ":stack_no_052", 1, ":party_num_companions_stacks_051"),
(party_stack_get_troop_id,      ":troop_id_053","p_main_party",":stack_no_052"),
(try_begin),
(troop_is_hero,":troop_id_053"),
(store_skill_level,":skill_lvl_054",10,":troop_id_053"),
(try_begin),
(gt,":skill_lvl_054",":var049"),
(assign,":var049",":skill_lvl_054"),
(assign,":var050",":troop_id_053"),
(try_end),
(try_end),
(try_end),
(store_character_level,":character_lvl_055","trp_player"),
(assign,":var056",5),
(val_div, ":character_lvl_055", 10),
(val_add, ":var056", ":character_lvl_055"),
(try_begin),
(ge,":var049",":var056"),
(assign,":faction_slot_016",":var050"),
(assign,":var023",1),
(assign,":var024",10),
(assign,":character_lvl_025",10),
(assign,":var028",50),
(assign,":quest_id_011",":random_x_036"),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_meet_spy_in_enemy_town"),
(eq,":::player_has_homage",0),
(try_begin),
(eq,":::players_kingdom",":troop_faction_003"),
(neq,":troop_slot_005",6),
(neq,":troop_slot_005",1),
(call_script, "script_troop_get_player_relation", ":troop_id_001"),
(assign,":var057",reg0),
(try_begin),
(gt,":var057",3),
(call_script, "script_cf_faction_get_random_enemy_faction", ":troop_faction_003"),
(assign,":var058",reg0),
(store_relation,":faction_relation_059",":var058","fac_player_supporters_faction"),
(try_begin),
(lt,":faction_relation_059",0),
(call_script, "script_cf_select_random_town_with_faction", ":var058"),
(assign,":var048",reg0),
(try_begin),
(call_script, "script_cf_center_get_free_walker", ":var048"),
(assign,":random_party_013",":var048"),
(store_random_in_range,":random_x_020","str_secret_sign_1","str_countersign_1"),
(assign,":quest_id_011",":random_x_036"),
(assign,":character_lvl_025",500),
(assign,":var027",30),
(assign,":var028",50),
(quest_set_slot,"qst_meet_spy_in_enemy_town",22,500),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_raid_caravan_to_start_war"),
(eq,1,0),
(try_begin),
(eq,":::players_kingdom",":troop_faction_003"),
(this_or_next|eq,":troop_slot_005",4),
(this_or_next|eq,":troop_slot_005",2),
(eq,":troop_slot_005",5),
(gt,":character_lvl_002",10),
(eq,1,0),
(neg|faction_slot_eq,":troop_faction_003",11,":troop_id_001"),
(call_script, "script_cf_faction_get_random_friendly_faction", ":troop_faction_003"),
(assign,":party_faction_014",reg0),
(store_troop_faction,":troop_faction_015",":troop_id_001"),
(assign,":var019","pt_kingdom_caravan_party"),
(assign,":random_x_020",2),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",30),
(assign,":var028",100),
(try_end),
(else_try),
(eq,":random_x_036","qst_deliver_message"),
(eq,":::player_has_homage",0),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(lt,":character_lvl_002",20),
(neg|troop_slot_ge,"trp_player",7,125),
(call_script, "script_cf_get_random_lord_in_a_center_with_faction", ":troop_faction_003"),
(assign,":troop_slot_047",reg0),
(try_begin),
(neq,":troop_slot_047",":troop_id_001"),
(call_script, "script_get_troop_attached_party", ":troop_slot_047"),
(assign,":var048",reg0),
(try_begin),
(neq,":party_attached_006",":var048"),
(assign,":random_party_013",":var048"),
(assign,":troop_id_012",":troop_slot_047"),
(assign,":var024",30),
(assign,":character_lvl_025",40),
(assign,":var028",10),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",30),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_escort_lady"),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(ge,":character_lvl_002",10),
(ge,":troop_id_001",0),
(assign,":troop_id_044",-1),
(try_for_range, ":trp_060", ":trp.knight_1_1_wife", ":trp.heroes_end"),
(troop_slot_eq,":trp_060",31,":troop_id_001"),
(assign,":troop_id_044",":trp_060"),
(try_end),
(try_begin),
(ge,":troop_id_044",0),
(troop_get_slot,":troop_slot_061",":troop_id_044",31),
(try_begin),
(eq,":troop_id_001",":troop_slot_061"),
(store_random_in_range,":random_x_040",0,2),
(try_begin),
(eq,":random_x_040",0),
(troop_get_slot,":troop_slot_062",":troop_id_001",30),
(try_begin),
(is_between,":troop_slot_062","trp_knight_1_1_wife","trp_heroes_end"),
(troop_get_slot,":troop_slot_061",":troop_slot_062",30),
(try_begin),
(eq,":troop_id_001",":troop_slot_061"),
(assign,":troop_id_044",":troop_slot_062"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":troop_id_044",0),
(troop_get_type,":troop_type_063",":troop_id_044"),
(try_begin),
(eq,":troop_type_063",1),
(gt,":party_attached_006",0),
(troop_slot_eq,":troop_id_044",12,":party_attached_006"),
(call_script, "script_cf_select_random_town_with_faction", ":troop_faction_003"),
(assign,":var048",reg0),
(try_begin),
(neq,":var048",":party_attached_006"),
(hero_can_join, ":"),
(assign,":faction_slot_016",":troop_id_044"),
(assign,":random_party_013",":var048"),
(assign,":var027",20),
(assign,":var028",30),
(assign,":quest_id_011",":random_x_036"),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_deliver_message_to_enemy_lord"),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(is_between,":character_lvl_002",5,25),
(neg|call_script, "script_cf_get_random_lord_from_another_faction_in_a_center", ":troop_faction_003"),
(assign,":troop_slot_047",reg0),
(call_script, "script_get_troop_attached_party", ":troop_slot_047"),
(assign,":random_party_013",reg0),
(assign,":troop_id_012",":troop_slot_047"),
(assign,":var023",1),
(assign,":var024",200),
(assign,":character_lvl_025",0),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",40),
(try_end),
(else_try),
(eq,":random_x_036","qst_deal_with_bandits_at_lords_village"),
(try_begin),
(neq,":troop_slot_005",5),
(neq,":troop_slot_005",2),
(ge,":::g_talk_troop_faction_relation",0),
(assign,":var064","p_salt_mine"),
(assign,":var048",-1),
(try_for_range, ":var065", ":p.village_1", ":var064"),
(party_slot_eq,":var065",7,":troop_id_001"),
(party_slot_eq,":var065",39,1),
(party_slot_eq,":var065",35,0),
(assign,":var048",":var065"),
(assign,":var064",0),
(try_end),
(try_begin),
(ge,":var048",0),
(neg|check_quest_active,"qst_eliminate_bandits_infesting_village"),
(assign,":random_party_013",":var048"),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",30),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_raise_troops"),
(try_begin),
(neq,":troop_slot_005",1),
(neq,":troop_faction_003","fac_player_supporters_faction"),
(ge,":::g_talk_troop_faction_relation",0),
(store_character_level,":character_lvl_055","trp_player"),
(try_begin),
(gt,":character_lvl_055",5),
(troop_slot_ge,"trp_player",7,100),
(store_random_in_range,":random_x_020",5,8),
(party_get_free_companions_capacity,":party_free_companions_capacity_066","p_main_party"),
(try_begin),
(le,":random_x_020",":party_free_companions_capacity_066"),
(faction_get_slot,":faction_slot_016",":troop_faction_003",41),
(store_random_in_range,":random_x_067",20,40),
(val_add, ":random_x_067", ":character_lvl_055"),
(val_div, ":random_x_067", 10),
(store_mul, ":character_lvl_025", ":random_x_020", 10),
(assign,":troop_id_012",":faction_slot_016"),
(try_for_range, ":var032", 0, ":random_x_067"),
(troop_get_upgrade_troop,":troop_upgrade_troop_id_068",":troop_id_012",0),
(try_begin),
(gt,":troop_upgrade_troop_id_068",0),
(assign,":troop_id_012",":troop_upgrade_troop_id_068"),
(val_mul, ":character_lvl_025", ":character_lvl_025"),
(val_div, ":character_lvl_025", ":character_lvl_025"),
(try_end),
(try_end),
(try_end),
(try_end),
(assign,":var024",":character_lvl_025"),
(val_mul, ":var024", 3),
(val_div, ":var024", 10),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",120),
(assign,":var028",15),
(try_end),
(else_try),
(eq,":random_x_036","qst_collect_taxes"),
(eq,":::player_has_homage",0),
(try_begin),
(neq,":troop_slot_005",6),
(neq,":troop_slot_005",7),
(ge,":::g_talk_troop_faction_relation",0),
(call_script, "script_cf_troop_get_random_leaded_town_or_village_except_center", ":troop_id_001", ":party_attached_006"),
(assign,":random_party_013",reg0),
(assign,":var023",1),
(assign,":character_lvl_025",0),
(assign,":var024",100),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",50),
(assign,":var028",20),
(try_end),
(else_try),
(eq,":random_x_036","qst_hunt_down_fugitive"),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(call_script, "script_cf_select_random_village_with_faction", ":troop_faction_003"),
(assign,":random_party_013",reg0),
(store_random_in_range,":random_x_021",0,1000000),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",30),
(assign,":var028",30),
(try_end),
(else_try),
(eq,":random_x_036","qst_kill_local_merchant"),
(eq,":::player_has_homage",0),
(try_begin),
(this_or_next|eq,":troop_slot_005",2),
(this_or_next|eq,":troop_slot_005",4),
(eq,":troop_slot_005",5),
(neg|faction_slot_eq,":troop_faction_003",11,":troop_id_001"),
(ge,":::g_talk_troop_faction_relation",0),
(gt,":character_lvl_002",5),
(is_between,":party_attached_006","p_town_1","p_castle_1"),
(assign,":var023",1),
(assign,":var024",300),
(assign,":character_lvl_025",1000),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",10),
(assign,":var028",30),
(try_end),
(else_try),
(eq,":random_x_036","qst_bring_back_runaway_serfs"),
(try_begin),
(neq,":troop_slot_005",6),
(neq,":troop_slot_005",7),
(ge,":::g_talk_troop_faction_relation",0),
(ge,":character_lvl_002",5),
(gt,":party_attached_006",0),
(eq,":::g_defending_against_siege",0),
(assign,":var069",-1),
(try_for_range, ":p_065", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_065",7,":troop_id_001"),
(store_distance_to_party_from_party,":distance_parties_039",":p_065",":p_065"),
(try_begin),
(lt,":distance_parties_039",25),
(assign,":var069",":p_065"),
(try_end),
(try_end),
(try_begin),
(ge,":var069",0),
(call_script, "script_cf_select_random_town_with_faction", ":troop_faction_003"),
(assign,":var048",reg0),
(try_begin),
(neq,":var048",":party_attached_006"),
(store_distance_to_party_from_party,":distance_parties_039",":var048",":var048"),
(try_begin),
(ge,":distance_parties_039",20),
(assign,":var019","pt_runaway_serfs"),
(assign,":var017",":var069"),
(assign,":random_party_013",":var048"),
(assign,":var023",1),
(assign,":var024",200),
(assign,":character_lvl_025",150),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",30),
(assign,":var028",20),
(assign,"$qst_bring_back_runaway_serfs_num_parties_returned",0),
(assign,"$qst_bring_back_runaway_serfs_num_parties_fleed",0),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_follow_spy"),
(eq,":::player_has_homage",0),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(neq,":troop_slot_005",6),
(party_get_skill_level, ":party_skill_lvl_070", "p_main_party", "skl_tracking"),
(try_begin),
(ge,":party_skill_lvl_070",2),
(ge,":character_lvl_002",10),
(eq,":::g_defending_against_siege",0),
(gt,":troop_slot_004",0),
(gt,":party_attached_006",0),
(party_slot_eq,"$g_encountered_party",0,3),
(party_get_position,pos2,"p_main_party"),
(assign,":var071",99999),
(assign,":var069",-1),
(try_for_range, ":var072", 0, 10),
(call_script, "script_cf_get_random_enemy_center", ":troop_slot_004"),
(assign,":var073",reg0),
(party_get_position,pos3,":var073"),
(map_get_random_position_around_position,pos4,3,6),
(get_distance_between_positions,":distance_074",2,4),
(try_begin),
(lt,":distance_074",":var071"),
(assign,":var071",":distance_074"),
(assign,":var069",":var073"),
(copy_position,63,4),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var069",0),
(assign,":var017",":var069"),
(assign,":var028",50),
(assign,":quest_id_011",":random_x_036"),
(assign,"$qst_follow_spy_run_away",0),
(assign,"$qst_follow_spy_meeting_state",0),
(assign,"$qst_follow_spy_meeting_counter",0),
(assign,"$qst_follow_spy_spy_back_in_town",0),
(assign,"$qst_follow_spy_partner_back_in_town",0),
(assign,"$qst_follow_spy_no_active_parties",0),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_capture_enemy_hero"),
(try_begin),
(eq,":::players_kingdom",":troop_faction_003"),
(neg|faction_slot_eq,"$players_kingdom",8,"trp_player"),
(ge,":character_lvl_002",15),
(call_script, "script_cf_faction_get_random_enemy_faction", ":troop_faction_003"),
(assign,":party_faction_014",reg0),
(assign,":var027",30),
(assign,":var028",80),
(assign,":character_lvl_025",2000),
(assign,":quest_id_011",":random_x_036"),
(try_end),
(else_try),
(eq,":random_x_036","qst_lend_companion"),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(assign,":var075",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_051","p_main_party"),
(try_for_range, ":stack_no_052", 0, ":party_num_companions_stacks_051"),
(party_stack_get_troop_id,      ":troop_id_053","p_main_party",":stack_no_052"),
(try_begin),
(troop_is_hero,":troop_id_053"),
(is_between,":troop_id_053","trp_npc1","trp_kingdom_1_lord"),
(store_character_level,":character_lvl_076",":troop_id_053"),
(try_begin),
(ge,":character_lvl_076",15),
(assign,":var077",0),
(try_for_range, ":var078", 0, ":qst.quests_end"),
(check_quest_active,":var078"),
(this_or_next|quest_slot_eq,":var078",2,":troop_id_053"),
(quest_slot_eq,":var078",4,":troop_id_053"),
(assign,":var077",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var077",0),
(val_add, ":var075", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var075",0),
(store_random_in_range,":random_x_079",0,":var075"),
(assign,":var075",0),
(assign,":troop_slot_047",-1),
(try_for_range, ":stack_no_052", 0, ":party_num_companions_stacks_051"),
(eq,":troop_slot_047",-1),
(party_stack_get_troop_id,      ":troop_id_053","p_main_party",":stack_no_052"),
(try_begin),
(troop_is_hero,":troop_id_053"),
(is_between,":troop_id_053","trp_npc1","trp_kingdom_1_lord"),
(neq,":troop_id_053","trp_player"),
(store_character_level,":character_lvl_076",":troop_id_053"),
(try_begin),
(ge,":character_lvl_076",15),
(assign,":var077",0),
(try_for_range, ":var078", 0, ":qst.quests_end"),
(check_quest_active,":var078"),
(this_or_next|quest_slot_eq,":var078",2,":troop_id_053"),
(quest_slot_eq,":var078",4,":troop_id_053"),
(assign,":var077",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var077",0),
(val_add, ":var075", 1),
(try_begin),
(gt,":var075",":random_x_079"),
(assign,":troop_slot_047",":troop_id_053"),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":troop_slot_047","trp_npc1","trp_kingdom_1_lord"),
(assign,":troop_id_012",":troop_slot_047"),
(store_current_day,":random_x_020"),
(val_add, ":random_x_020", 8),
(assign,":var023",1),
(assign,":var024",300),
(assign,":character_lvl_025",400),
(assign,":quest_id_011",":random_x_036"),
(assign,":var028",30),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_collect_debt"),
(eq,1,0),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(call_script, "script_cf_get_random_lord_in_a_center_with_faction", ":troop_faction_003"),
(assign,":troop_id_012",reg0),
(try_begin),
(neq,":troop_id_012",":troop_id_001"),
(call_script, "script_get_troop_attached_party", ":troop_id_012"),
(assign,":random_party_013",reg0),
(try_begin),
(neq,":party_attached_006",":random_party_013"),
(assign,":var024",30),
(assign,":character_lvl_025",40),
(assign,":quest_id_011",":random_x_036"),
(store_random_in_range,":random_x_020",6,9),
(val_mul, ":random_x_020", 500),
(store_div, ":var___x1", ":random_x_020", 5),
(assign,":var026",":var___x1"),
(assign,":var027",90),
(assign,":var028",20),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_incriminate_loyal_commander"),
(eq,":::player_has_homage",0),
(try_begin),
(neq,":troop_slot_005",7),
(neq,":troop_slot_005",6),
(eq,":::players_kingdom",":troop_faction_003"),
(ge,":character_lvl_002",10),
(faction_slot_eq,":troop_faction_003",11,":troop_id_001"),
(assign,":var080",1),
(assign,":var081",0),
(try_for_range, ":var032", 0, ":var080"),
(call_script, "script_cf_faction_get_random_enemy_faction", ":troop_faction_003"),
(assign,":faction_id_043",reg0),
(faction_get_slot,":troop_slot_047",":faction_id_043",11),
(assign,":var082",0),
(try_for_range, ":trp_083", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_083",2,2),
(neg|troop_slot_ge,":trp_083",8,0),
(neq,":troop_slot_047",":trp_083"),
(store_troop_faction,":troop_faction_084",":trp_083"),
(try_begin),
(eq,":faction_id_043",":troop_faction_084"),
(val_add, ":var082", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var082",0),
(assign,":troop_id_044",-1),
(store_random_in_range,":random_x_085",0,":var082"),
(try_for_range, ":trp_083", ":trp.npc1", ":trp.knight_1_1_wife"),
(eq,":troop_id_044",-1),
(troop_slot_eq,":trp_083",2,2),
(neq,":troop_slot_047",":trp_083"),
(store_troop_faction,":troop_faction_084",":trp_083"),
(try_begin),
(eq,":faction_id_043",":troop_faction_084"),
(val_sub, ":random_x_085", 1),
(try_begin),
(lt,":random_x_085",0),
(assign,":troop_id_044",":trp_083"),
(try_end),
(try_end),
(try_end),
(try_end),
(assign,":var048",-1),
(call_script, "script_get_troop_attached_party", ":troop_slot_047"),
(try_begin),
(is_between,reg0,"p_town_1","p_castle_1"),
(party_slot_eq,reg0,7,":troop_slot_047"),
(assign,":var048",reg0),
(assign,":var080",-1),
(assign,":var081",1),
(try_end),
(try_end),
(try_begin),
(eq,":var081",1),
(assign,"$incriminate_quest_sacrificed_troop",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_051","p_main_party"),
(try_for_range, ":stack_no_052", 1, ":party_num_companions_stacks_051"),
(eq,":::incriminate_quest_sacrificed_troop",0),
(party_stack_get_troop_id,      ":troop_id_053","p_main_party",":stack_no_052"),
(try_begin),
(neg|troop_is_hero,":troop_id_053"),
(store_character_level,":character_lvl_086",":troop_id_053"),
(try_begin),
(ge,":character_lvl_086",25),
(assign,"$incriminate_quest_sacrificed_troop",":troop_id_053"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":::incriminate_quest_sacrificed_troop",0),
(assign,":troop_id_012",":troop_slot_047"),
(assign,":faction_slot_016",":troop_id_044"),
(assign,":random_party_013",":var048"),
(assign,":party_faction_014",":faction_id_043"),
(assign,":var023",1),
(assign,":var024",700),
(assign,":character_lvl_025",1000),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",30),
(assign,":var028",180),
(try_end),
(try_end),
(else_try),
(eq,":random_x_036","qst_capture_prisoners"),
(eq,":::player_has_homage",0),
(try_begin),
(eq,":::players_kingdom",":troop_faction_003"),
(call_script, "script_cf_faction_get_random_enemy_faction", ":troop_faction_003"),
(assign,":faction_id_043",reg0),
(store_add, ":var087", 45, 1),
(store_random_in_range,":random_x_088",42,":var087"),
(faction_get_slot,":troop_slot_047",":faction_id_043",":random_x_088"),
(try_begin),
(gt,":troop_slot_047",0),
(store_random_in_range,":random_x_020",3,7),
(assign,":troop_id_012",":troop_slot_047"),
(assign,":party_faction_014",":faction_id_043"),
(assign,":var023",1),
(store_character_level,":character_lvl_025",":troop_slot_047"),
(val_add, ":character_lvl_025", 5),
(val_mul, ":character_lvl_025", ":character_lvl_025"),
(val_div, ":character_lvl_025", 5),
(val_mul, ":character_lvl_025", ":random_x_020"),
(assign,":var024",":character_lvl_025"),
(assign,":quest_id_011",":random_x_036"),
(assign,":var027",90),
(assign,":var028",20),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(neq,":quest_id_011",-1),
(try_begin),
(party_is_active,":random_party_013"),
(store_faction_of_party, ":party_faction_014", ":random_party_013"),
(try_end),
(quest_set_slot,":quest_id_011",2,":troop_id_012"),
(quest_set_slot,":quest_id_011",1,":random_party_013"),
(quest_set_slot,":quest_id_011",4,":faction_slot_016"),
(quest_set_slot,":quest_id_011",3,":party_faction_014"),
(quest_set_slot,":quest_id_011",15,":troop_faction_015"),
(quest_set_slot,":quest_id_011",7,":var017"),
(quest_set_slot,":quest_id_011",8,":var018"),
(quest_set_slot,":quest_id_011",9,":var019"),
(quest_set_slot,":quest_id_011",10,":random_x_020"),
(quest_set_slot,":quest_id_011",20,":var023"),
(quest_set_slot,":quest_id_011",21,":var024"),
(quest_set_slot,":quest_id_011",22,":character_lvl_025"),
(quest_set_slot,":quest_id_011",19,":var026"),
(quest_set_slot,":quest_id_011",23,":var027"),
(quest_set_slot,":quest_id_011",24,":var028"),
(quest_set_slot,":quest_id_011",11,0),
(quest_set_slot,":quest_id_011",6,":troop_id_001"),
(quest_set_slot,":quest_id_011",12,":party_attached_006"),
(quest_set_slot,":quest_id_011",13,":random_x_021"),
(quest_set_slot,":quest_id_011",14,":var022"),
(try_end),
(assign,reg0,":quest_id_011"),
]),

("get_dynamic_quest", [
(store_script_param, ":troop_id_001", 1),
(assign,":var002",-1),
(assign,":var003",-1),
(assign,":var004",-1),
(assign,":var005",-1),
(try_begin),
(eq,":troop_id_001",-1),
(else_try),
(neg|check_quest_active,"qst_rescue_prisoner"),
(this_or_next|troop_slot_eq,":troop_id_001",2,2),
(troop_slot_eq,":troop_id_001",2,6),
(assign,":var006",-1),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_get_slot,":troop_slot_008",":trp_007",8),
(try_begin),
(is_between,":troop_slot_008","p_town_1","p_village_1"),
(store_troop_faction,":troop_faction_009",":troop_id_001"),
(store_faction_of_party, ":party_faction_010", ":troop_slot_008"),
(store_relation,":faction_relation_011",":troop_faction_009",":party_faction_010"),
(try_begin),
(lt,":faction_relation_011",0),
(call_script, "script_troop_get_family_relation_to_troop", ":troop_id_001", ":trp_007"),
(try_begin),
(ge,reg0,10),
(assign,":var012",0),
(try_begin),
(call_script, "script_cf_prisoner_offered_parole", ":trp_007"),
(assign,":var012",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var012",0),
(neg|party_slot_eq,":troop_slot_008",7,"trp_player"),
(assign,":var006",":trp_007"),
(assign,":var013",":troop_slot_008"),
(try_end),
(try_end),
(try_begin),
(gt,":var006",-1),
(assign,":var002","qst_rescue_prisoner"),
(assign,":var003",":var006"),
(assign,":var004",":var013"),
(else_try),
(is_between,":troop_id_001","trp_town_1_mayor","trp_village_1_elder"),
(store_troop_faction,":troop_faction_014",":troop_id_001"),
(try_begin),
(neg|check_quest_active,"qst_retaliate_for_border_incident"),
(quest_slot_eq,"qst_retaliate_for_border_incident",25,0),
(assign,":var015",0),
(try_for_range, ":fac_016", ":fac.kingdom_1", ":fac.kingdoms_end"),
(call_script, "script_diplomacy_faction_get_diplomatic_status_with_faction", ":troop_faction_014", ":fac_016"),
(assign,":var017",reg0),
(try_begin),
(eq,":var017",-1),
(assign,":var018",reg1),
(try_begin),
(ge,":var018",10),
(try_for_range, ":trp_019", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_020",":trp_019"),
(try_begin),
(eq,":troop_faction_020",":fac_016"),
(troop_slot_eq,":trp_019",52,5),
(assign,":var015",":trp_019"),
(assign,":var021",":fac_016"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":var015","trp_npc1","trp_knight_1_1_wife"),
(assign,":var002","qst_retaliate_for_border_incident"),
(assign,":var003",":var015"),
(assign,":var005",":var021"),
(else_try),
(troop_slot_eq,":troop_id_001",2,2),
(neg|check_quest_active,"qst_destroy_bandit_lair"),
(quest_slot_eq,"qst_destroy_bandit_lair",25,0),
(assign,":var022",-1),
(try_for_range, ":pt_023", ":pt.steppe_bandits", ":pt.deserters"),
(party_template_get_slot,":party_template_slot_024",":pt_023",4),
(try_begin),
(gt,":party_template_slot_024","p_spawn_points_end"),
(assign,":var025",-1),
(assign,":var026",99999),
(try_for_range, ":p_027", ":p.town_1", ":p.castle_1"),
(store_distance_to_party_from_party,":distance_parties_028",":party_template_slot_024",":party_template_slot_024"),
(try_begin),
(lt,":distance_parties_028",":var026"),
(assign,":var025",":p_027"),
(assign,":var026",":distance_parties_028"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(party_slot_eq,":var025",7,":troop_id_001"),
(assign,":var022",":party_template_slot_024"),
(try_end),
(try_end),
(try_begin),
(gt,":var022","p_spawn_points_end"),
(assign,":var002","qst_destroy_bandit_lair"),
(assign,":var004",":var022"),
(else_try),
(is_between,":troop_id_001","trp_town_1_mayor","trp_village_1_elder"),
(neg|check_quest_active,"qst_track_down_bandits"),
(quest_slot_eq,"qst_track_down_bandits",25,0),
(assign,":var029",-1),
(try_for_range, ":p_030", ":p.town_1", ":p.castle_1"),
(party_slot_eq,":p_030",25,":troop_id_001"),
(assign,":var029",":p_030"),
(try_end),
(try_end),
(try_begin),
(gt,":var029",-1),
(call_script, "script_merchant_road_info_to_s42", ":var029"),
(assign,":var031",reg0),
(try_begin),
(party_is_active,":var031"),
(gt,":var031",0),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_traveller_attack_found"),
(try_end),
(try_end),
(try_end),
(assign,":var002","qst_track_down_bandits"),
(assign,":var004",":var031"),
(else_try),
(troop_slot_eq,":troop_id_001",52,5),
(store_troop_faction,":troop_faction_032",":troop_id_001"),
(assign,":var033",-1),
(try_for_range, ":trp_034", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_034",52,5),
(store_troop_faction,":troop_faction_035",":trp_034"),
(try_begin),
(eq,":troop_faction_035",":troop_faction_032"),
(assign,":var033",":trp_034"),
(try_end),
(try_end),
(try_begin),
(eq,":troop_id_001",":var033"),
(assign,":var036",-1),
(assign,":var037",-1),
(try_for_range, ":fac_038", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(neq,":fac_038",":troop_faction_032"),
(faction_slot_eq,":fac_038",21,0),
(neq,":fac_038",":::players_kingdom"),
(store_relation,":faction_relation_039",":fac_038",":troop_faction_032"),
(store_add, ":slot_no_040", ":troop_faction_032", 130),
(assign,":slot_no_040 -","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_041",":fac_038",":slot_no_040"),
(try_begin),
(ge,":faction_relation_039",0),
(le,":faction_slot_041",0),
(store_random_in_range,":random_x_042",0,100),
(try_begin),
(gt,":random_x_042",":var037"),
(assign,":var036",":fac_038"),
(assign,":var037",":random_x_042"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":var036","fac_player_supporters_faction","fac_kingdoms_end"),
(assign,":var002","qst_cause_provocation"),
(assign,":var005",":var036"),
(try_end),
(try_end),
(assign,reg0,":var002"),
(assign,reg1,":var003"),
(assign,reg2,":var004"),
(assign,reg3,":var005"),
]),

("get_political_quest", [
(store_script_param, ":var001", 1),
(assign,":quest_id_002",-1),
(assign,":var003",-1),
(assign,":var004",-1),
(try_begin),
(neg|check_quest_active,"qst_denounce_lord"),
(try_begin),
(ge,":::cheat_mode",1),
(quest_get_slot,reg4,"qst_denounce_lord",25),
(display_message, "@@{!}DEBUG -- Checking for denounce lord - eligible in {reg4} days"),
(try_end),
(try_begin),
(neg|quest_slot_ge,"qst_denounce_lord",25,1),
(neq,":var001",":::g_player_minister"),
(neg|troop_slot_eq,"trp_player",30,":var001"),
(neg|faction_slot_eq,"$players_kingdom",11,"trp_player"),
(neg|troop_slot_eq,"$g_talk_troop",52,2),
(neg|troop_slot_eq,"$g_talk_troop",52,6),
(assign,":var006",-1),
(assign,":var007",1),
(try_for_range, ":trp_008", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_009",":trp_008"),
(try_begin),
(eq,":troop_faction_009",":::players_kingdom"),
(neq,":trp_008",":var001"),
(neg|faction_slot_eq,":troop_faction_009",11,":trp_008"),
(this_or_next|check_quest_active,"qst_intrigue_against_lord"),
(neg|quest_slot_eq,"qst_intrigue_against_lord",2,":trp_008"),
(call_script, "script_troop_get_relation_with_troop", ":trp_008", ":var001"),
(assign,":var010",reg0),
(lt,":var010",":var007"),
(str_store_string,s4,":str_store_troop_name(trp_008)"),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- Rival found in {s4}"),
(try_end),
(try_end),
(try_begin),
(troop_slot_eq,"$g_talk_troop",52,5),
(assign,":var011",15),
(else_try),
(troop_slot_eq,"$g_talk_troop",52,2),
(assign,":var011",10),
(else_try),
(assign,":var011",5),
(try_end),
(call_script, "script_troop_get_relation_with_troop", ":trp_008", "trp_player"),
(assign,":var012",reg0),
(lt,":var012",":var011"),
(str_store_string,s4,":str_store_troop_name(trp_008)"),
(try_begin),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- {s4} is not close friend of player"),
(try_end),
(try_end),
(assign,":var013",0),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_015",":trp_014"),
(try_begin),
(eq,":troop_faction_015",":::players_kingdom"),
(call_script, "script_troop_get_relation_with_troop", ":trp_008", ":trp_014"),
(lt,reg0,0),
(val_add, ":var013", 1),
(try_end),
(try_end),
(str_store_string,s4,":str_store_troop_name(trp_008)"),
(ge,":::cheat_mode",1),
(assign,reg3,":var013"),
(display_message, "@@{!}DEBUG -- {s4} has {reg3} rivals"),
(try_end),
(this_or_next|ge,":var013",3),
(ge,":::cheat_mode",1),
(assign,":var007",":var010"),
(assign,":var006",":trp_008"),
(try_end),
(try_begin),
(is_between,":var006","trp_npc1","trp_knight_1_1_wife"),
(assign,":quest_id_002","qst_denounce_lord"),
(assign,":var003",":var006"),
(else_try),
(neg|check_quest_active,"qst_intrigue_against_lord"),
(try_begin),
(eq,":::cheat_mode",1),
(quest_get_slot,reg4,"qst_intrigue_against_lord",25),
(display_message, "@@{!}DEBUG -- Checking for intrigue - eligible in {reg4} days"),
(try_end),
(try_end),
(try_begin),
(neg|quest_slot_ge,"qst_intrigue_against_lord",25,1),
(neq,":var001",":::g_player_minister"),
(neg|troop_slot_eq,"trp_player",30,":var001"),
(neg|faction_slot_eq,"$players_kingdom",11,"trp_player"),
(try_begin),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- Trying for intrigue against lord"),
(try_end),
(try_end),
(assign,":var006",-1),
(assign,":var007",10),
(try_for_range, ":trp_008", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_009",":trp_008"),
(try_begin),
(eq,":troop_faction_009",":::players_kingdom"),
(neq,":trp_008",":var001"),
(neg|faction_slot_eq,":troop_faction_009",11,":trp_008"),
(this_or_next|check_quest_active,"qst_denounce_lord"),
(neg|quest_slot_eq,"qst_denounce_lord",2,":trp_008"),
(faction_get_slot,":faction_slot_016","$players_kingdom",11),
(call_script, "script_troop_get_relation_with_troop", ":trp_008", ":faction_slot_016"),
(assign,":var017",reg0),
(try_begin),
(lt,":var017",":var007"),
(str_store_string,s4,":str_store_troop_name(trp_008)"),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- {s4} has sufficiently low relation with liege"),
(try_end),
(try_end),
(call_script, "script_troop_get_relation_with_troop", ":trp_008", ":var001"),
(assign,":var010",reg0),
(lt,":var010",0),
(str_store_string,s4,":str_store_troop_name(trp_008)"),
(try_begin),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- {s4} has sufficiently low relation with giver troop"),
(try_end),
(try_end),
(call_script, "script_troop_get_relation_with_troop", ":trp_008", "trp_player"),
(assign,":var012",reg0),
(try_begin),
(lt,":var012",0),
(str_store_string,s4,":str_store_troop_name(trp_008)"),
(try_begin),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- {s4} has sufficiently low relation with player"),
(try_end),
(try_end),
(assign,":var007",":var017"),
(assign,":var006",":trp_008"),
(try_begin),
(is_between,":var006","trp_npc1","trp_knight_1_1_wife"),
(assign,":quest_id_002","qst_intrigue_against_lord"),
(assign,":var003",":var006"),
(else_try),
(try_begin),
(ge,":::cheat_mode",1),
(quest_get_slot,reg4,"qst_resolve_dispute",25),
(display_message, "@@{!}DEBUG -- Checking for resolve dispute - eligible in {reg4} days"),
(try_end),
(try_end),
(try_begin),
(neg|quest_slot_ge,"qst_resolve_dispute",25,1),
(this_or_next|troop_slot_eq,"trp_player",30,"$g_talk_troop"),
(eq,":::g_talk_troop",":::g_player_minister"),
(assign,":var006",-1),
(assign,":var018",-1),
(assign,":var019",20),
(try_for_range, ":trp_020", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_021",":trp_020"),
(eq,":troop_faction_021",":::players_kingdom"),
(neq,":trp_020",":::g_talk_troop"),
(try_for_range, ":trp_022", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_023",":trp_022"),
(eq,":troop_faction_023",":::players_kingdom"),
(neq,":trp_020",":trp_022"),
(neq,":trp_022",":::g_talk_troop"),
(call_script, "script_troop_get_relation_with_troop", ":trp_020", ":trp_022"),
(assign,":var024",reg0),
(lt,":var024",-5),
(call_script, "script_troop_get_relation_with_troop", ":trp_020", "trp_player"),
(assign,":var025",reg0),
(call_script, "script_troop_get_relation_with_troop", ":trp_022", "trp_player"),
(assign,":var026",reg0),
(gt,":var025",0),
(gt,":var026",0),
(store_mul, ":var027", ":var025", ":var026"),
(gt,":var027",":var019"),
(assign,":var019",":var027"),
(assign,":var006",":trp_020"),
(assign,":var018",":trp_022"),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":var006","trp_npc1","trp_knight_1_1_wife"),
(assign,":quest_id_002","qst_resolve_dispute"),
(assign,":var003",":var006"),
(assign,":var004",":var018"),
(else_try),
(try_begin),
(ge,":::cheat_mode",1),
(quest_get_slot,reg4,"qst_offer_gift",25),
(display_message, "@@{!}DEBUG -- Checking for offer gift - eligible in {reg4} days"),
(try_end),
(try_end),
(try_begin),
(neg|quest_slot_ge,"qst_offer_gift",25,1),
(assign,":var028",-1),
(assign,":var007",5),
(try_for_range, ":trp_029", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_030",":trp_029"),
(eq,":troop_faction_030",":::players_kingdom"),
(neq,":trp_029",":var001"),
(neg|faction_slot_eq,":troop_faction_030",11,":trp_029"),
(call_script, "script_troop_get_family_relation_to_troop", ":var001", ":trp_029"),
(assign,":var031",reg0),
(ge,":var031",":var007"),
(store_sub, ":var032", 0, ":var031"),
(call_script, "script_troop_get_relation_with_troop", "trp_player", ":trp_029"),
(assign,":var012",reg0),
(is_between,":var012",":var032",0),
(assign,":var007",":var031"),
(assign,":var028",":trp_029"),
(try_end),
(try_end),
(is_between,":var028","trp_npc1","trp_knight_1_1_wife"),
(assign,":quest_id_002","qst_offer_gift"),
(assign,":var003",":var028"),
(try_end),
(try_begin),
(gt,":quest_id_002",-1),
(quest_set_slot,":quest_id_002",2,":var003"),
(quest_set_slot,":quest_id_002",2,":var004"),
(quest_set_slot,":quest_id_002",6,":var001"),
(quest_set_slot,":quest_id_002",24,7), # var005
(try_end),
(assign,reg0,":quest_id_002"),
(assign,reg1,":var003"),
(assign,reg2,":var004"),
]),

("npc_find_quest_for_player_to_s11", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(try_for_range, ":trp_003", ":trp.npc1", ":trp.village_1_elder"),
(eq,":var002",-1),
(neg|troop_slot_eq,"trp_player",30,":trp_003"),
(gt,":trp_003",":::g_troop_list_no"),
(assign,"$g_troop_list_no",":trp_003"),
(try_begin),
(this_or_next|troop_slot_eq,":trp_003",2,2),
(is_between,":trp_003","trp_town_1_mayor","trp_village_1_elder"),
(neg|troop_slot_ge,":trp_003",8,"p_town_1"),
(is_between,":trp_003","trp_town_1_mayor","trp_village_1_elder"),
(assign,":party_faction_004",-1),
(try_for_range, ":p_005", ":p.town_1", ":p.castle_1"),
(party_slot_eq,":p_005",25,":trp_003"),
(store_faction_of_party, ":party_faction_004", ":p_005"),
(try_end),
(try_end),
(else_try),
(store_troop_faction,":party_faction_004",":trp_003"),
(try_end),
(eq,":var001",":party_faction_004"),
(call_script, "script_get_dynamic_quest", ":trp_003"),
(gt,reg0,-1),
(assign,":var002",":trp_003"),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(var002)"),
(display_message, "str_test_diagnostic_quest_found_for_s4"),
(try_end),
(assign,reg0,":var002"),
]),

("cf_get_random_enemy_center_within_range", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(store_faction_of_party, ":party_faction_004", ":var001"),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(store_relation,":faction_relation_007",":party_faction_004",":party_faction_006"),
(try_begin),
(lt,":faction_relation_007",0),
(store_distance_to_party_from_party,":distance_parties_008",":var001",":var001"),
(le,":distance_parties_008",":var002"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var003",0),
(store_random_in_range,":random_x_009",0,":var003"),
(assign,":var010","p_salt_mine"),
(try_for_range, ":p_005", ":p.town_1", ":var010"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(store_relation,":faction_relation_007",":party_faction_004",":party_faction_006"),
(lt,":faction_relation_007",0),
(store_distance_to_party_from_party,":distance_parties_008",":var001",":var001"),
(le,":distance_parties_008",":var002"),
(val_sub, ":random_x_009", 1),
(lt,":random_x_009",0),
(assign,":var011",":p_005"),
(assign,":var010",0),
(try_end),
(try_end),
(assign,reg0,":var011"),
]),

("cf_faction_get_random_enemy_faction", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(assign,":var003",0),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_slot_eq,":fac_004",21,0),
(store_relation,":faction_relation_005",":var001",":fac_004"),
(le,":faction_relation_005",-1),
(val_add, ":var003", 1),
(try_end),
(try_end),
(store_random_in_range,":random_x_006",0,":var003"),
(assign,":var003",0),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(eq,":var002",-1),
(faction_slot_eq,":fac_004",21,0),
(store_relation,":faction_relation_005",":var001",":fac_004"),
(le,":faction_relation_005",-1),
(val_add, ":var003", 1),
(gt,":var003",":random_x_006"),
(assign,":var002",":fac_004"),
(try_end),
(try_end),
(try_begin),
(neq,":var002",-1),
(assign,reg0,":var002"),
(try_end),
]),

("cf_faction_get_random_friendly_faction", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(assign,":var003",0),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_slot_eq,":fac_004",21,0),
(neq,":fac_004",":var001"),
(store_relation,":faction_relation_005",":var001",":fac_004"),
(ge,":faction_relation_005",0),
(val_add, ":var003", 1),
(try_end),
(try_end),
(store_random_in_range,":random_x_006",0,":var003"),
(assign,":var003",0),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(eq,":var002",-1),
(faction_slot_eq,":fac_004",21,0),
(neq,":fac_004",":var001"),
(store_relation,":faction_relation_005",":var001",":fac_004"),
(ge,":faction_relation_005",0),
(val_add, ":var003", 1),
(gt,":var003",":random_x_006"),
(assign,":var002",":fac_004"),
(try_end),
(try_end),
(try_begin),
(neq,":var002",-1),
(assign,reg0,":var002"),
(try_end),
]),

("cf_troop_get_random_enemy_troop_with_occupation", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-1),
(assign,":var004",0),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_005",2,":var002"),
(call_script, "script_troop_get_relation_with_troop", ":var001", ":trp_005"),
(lt,reg0,-10),
(val_add, ":var004", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var004",0),
(store_random_in_range,":random_x_006",0,":var004"),
(assign,":var004",0),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_005",2,":var002"),
(call_script, "script_troop_get_relation_with_troop", ":var001", ":trp_005"),
(lt,reg0,-10),
(val_add, ":var004", 1),
(eq,":random_x_006",":var004"),
(assign,":var003",":trp_005"),
(try_end),
(try_end),
(try_end),
(try_begin),
(neq,":var003",-1),
(assign,reg0,":var003"),
(try_end),
]),

("cf_get_random_lord_in_a_center_with_faction", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(assign,":var003",0),
(try_for_range, ":trp_004", ":trp.npc1", ":trp.heroes_end"),
(store_troop_faction,":troop_faction_005",":trp_004"),
(try_begin),
(eq,":var001",":troop_faction_005"),
(troop_slot_eq,":trp_004",2,2),
(neg|troop_slot_ge,":trp_004",8,0),
(troop_get_slot,":troop_slot_006",":trp_004",10),
(ge,":troop_slot_006",0),
(party_get_attached_to, ":party_attached_007", ":troop_slot_006"),
(is_between,":party_attached_007","p_town_1","p_salt_mine"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(store_random_in_range,":random_x_008",0,":var003"),
(assign,":var003",0),
(try_for_range, ":trp_004", ":trp.npc1", ":trp.heroes_end"),
(eq,":var002",-1),
(store_troop_faction,":troop_faction_005",":trp_004"),
(eq,":var001",":troop_faction_005"),
(troop_slot_eq,":trp_004",2,2),
(neg|troop_slot_ge,":trp_004",8,0),
(troop_get_slot,":troop_slot_006",":trp_004",10),
(ge,":troop_slot_006",0),
(party_get_attached_to, ":party_attached_007", ":troop_slot_006"),
(is_between,":party_attached_007","p_town_1","p_salt_mine"),
(val_add, ":var003", 1),
(lt,":random_x_008",":var003"),
(assign,":var002",":trp_004"),
(try_end),
(try_end),
(try_begin),
(neq,":var002",-1),
(assign,reg0,":var002"),
(try_end),
]),

("cf_get_random_lord_except_king_with_faction", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(assign,":var003",0),
(try_for_range, ":trp_004", ":trp.npc1", ":trp.heroes_end"),
(store_troop_faction,":troop_faction_005",":trp_004"),
(try_begin),
(eq,":var001",":troop_faction_005"),
(neg|faction_slot_eq,":var001",11,":trp_004"),
(troop_slot_eq,":trp_004",2,2),
(neg|troop_slot_ge,":trp_004",8,0),
(troop_get_slot,":troop_slot_006",":trp_004",10),
(ge,":troop_slot_006",0),
(val_add, ":var003", 1),
(try_end),
(try_end),
(store_random_in_range,":random_x_007",0,":var003"),
(assign,":var003",0),
(try_for_range, ":trp_004", ":trp.npc1", ":trp.heroes_end"),
(eq,":var002",-1),
(store_troop_faction,":troop_faction_005",":trp_004"),
(eq,":var001",":troop_faction_005"),
(neg|faction_slot_eq,":var001",11,":trp_004"),
(troop_slot_eq,":trp_004",2,2),
(neg|troop_slot_ge,":trp_004",8,0),
(troop_get_slot,":troop_slot_006",":trp_004",10),
(ge,":troop_slot_006",0),
(val_add, ":var003", 1),
(lt,":random_x_007",":var003"),
(assign,":var002",":trp_004"),
(try_end),
(try_end),
(try_begin),
(neq,":var002",-1),
(assign,reg0,":var002"),
(try_end),
]),

("cf_get_random_lord_from_another_faction_in_a_center", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(assign,":var003",0),
(try_for_range, ":trp_004", ":trp.npc1", ":trp.heroes_end"),
(store_troop_faction,":troop_faction_005",":trp_004"),
(try_begin),
(neq,":troop_faction_005",":var001"),
(store_relation,":faction_relation_006",":troop_faction_005","fac_player_supporters_faction"),
(store_relation,":faction_relation_007",":troop_faction_005",":var001"),
(lt,":faction_relation_007",0),
(ge,":faction_relation_006",0),
(troop_slot_eq,":trp_004",2,2),
(neg|troop_slot_ge,":trp_004",8,0),
(troop_get_slot,":troop_slot_008",":trp_004",10),
(ge,":troop_slot_008",0),
(party_get_attached_to, ":party_attached_009", ":troop_slot_008"),
(is_between,":party_attached_009","p_town_1","p_salt_mine"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(store_random_in_range,":random_x_010",0,":var003"),
(assign,":var003",0),
(try_for_range, ":trp_004", ":trp.npc1", ":trp.heroes_end"),
(eq,":var002",-1),
(store_troop_faction,":troop_faction_005",":trp_004"),
(neq,":troop_faction_005",":var001"),
(store_relation,":faction_relation_006",":troop_faction_005","fac_player_supporters_faction"),
(store_relation,":faction_relation_007",":troop_faction_005",":var001"),
(lt,":faction_relation_007",0),
(ge,":faction_relation_006",0),
(troop_slot_eq,":trp_004",2,2),
(neg|troop_slot_ge,":trp_004",8,0),
(troop_get_slot,":troop_slot_008",":trp_004",10),
(ge,":troop_slot_008",0),
(party_get_attached_to, ":party_attached_009", ":troop_slot_008"),
(is_between,":party_attached_009","p_town_1","p_salt_mine"),
(val_add, ":var003", 1),
(lt,":random_x_010",":var003"),
(assign,":var002",":trp_004"),
(try_end),
(try_end),
(try_begin),
(neq,":var002",-1),
(assign,reg0,":var002"),
(try_end),
]),

("get_closest_walled_center", [
(store_script_param, ":var001", 1),
(assign,":var002",9999999),
(try_for_range, ":p_003", ":p.town_1", ":p.village_1"),
(store_distance_to_party_from_party,":distance_parties_004",":var001",":var001"),
(try_begin),
(lt,":distance_parties_004",":var002"),
(assign,":var002",":distance_parties_004"),
(assign,-1,":p_003"), # reg0
(try_end),
(try_end),
]),

("get_closest_center", [
(store_script_param, ":var001", 1),
(assign,":var002",9999999),
(try_for_range, ":p_003", ":p.town_1", ":p.salt_mine"),
(store_distance_to_party_from_party,":distance_parties_004",":var001",":var001"),
(try_begin),
(lt,":distance_parties_004",":var002"),
(assign,":var002",":distance_parties_004"),
(assign,-1,":p_003"), # reg0
(try_end),
(try_end),
]),

("get_closest_center_of_faction", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",99999),
(assign,":var004",-1),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(try_begin),
(eq,":party_faction_006",":var002"),
(store_distance_to_party_from_party,":distance_parties_007",":var001",":var001"),
(lt,":distance_parties_007",":var003"),
(assign,":var003",":distance_parties_007"),
(assign,":var004",":p_005"),
(try_end),
(try_end),
(assign,reg0,":var004"),
]),

("get_closest_walled_center_of_faction", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",99999),
(assign,":var004",-1),
(try_for_range, ":p_005", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(try_begin),
(eq,":party_faction_006",":var002"),
(store_distance_to_party_from_party,":distance_parties_007",":var001",":var001"),
(lt,":distance_parties_007",":var003"),
(assign,":var003",":distance_parties_007"),
(assign,":var004",":p_005"),
(try_end),
(try_end),
(assign,reg0,":var004"),
]),

("let_nearby_parties_join_current_battle", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_character_level,":character_lvl_003","trp_player"),
(try_for_parties, ":cur_party"),
(party_is_active,":cur_party"),
(party_get_battle_opponent, ":party_battle_opponent_005", ":cur_party"),
(try_begin),
(lt,":party_battle_opponent_005",0),
(party_get_attached_to, ":party_attached_006", ":cur_party"),
(lt,":party_attached_006",0),
(get_party_ai_behavior,":party_ai_behavior_007",":cur_party"),
(neq,":party_ai_behavior_007",8),
(party_stack_get_troop_id,      ":troop_id_008",":cur_party",0),
(neg|is_between,":troop_id_008","trp_looter","trp_black_khergit_horseman"),
(assign,":var009",5),
(is_currently_night),
(assign,":var009",3),
(try_end),
(else_try),
(assign,":var009",3),
(try_begin),
(is_currently_night),
(assign,":var009",2),
(try_end),
(this_or_next|check_quest_active,"qst_track_down_bandits"),
(neg|quest_slot_eq,"qst_track_down_bandits",8,":cur_party"),
(this_or_next|check_quest_active,"qst_troublesome_bandits"),
(neg|quest_slot_eq,"qst_troublesome_bandits",8,":cur_party"),
(store_distance_to_party_from_party,":distance_parties_010",":cur_party",":cur_party"),
(try_begin),
(lt,":distance_parties_010",":var009"),
(store_faction_of_party, ":party_faction_011", ":cur_party"),
(store_faction_of_party, ":party_faction_012", "$g_enemy_party"),
(try_begin),
(eq,":party_faction_011","fac_player_supporters_faction"),
(assign,":faction_relation_013",100),
(else_try),
(store_relation,":faction_relation_013",":party_faction_011","fac_player_supporters_faction"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":party_faction_011",":party_faction_012"),
(assign,":faction_relation_014",100),
(else_try),
(store_relation,":faction_relation_014",":party_faction_011",":party_faction_012"),
(try_end),
(assign,":var015",1),
(neq,":::g_enemy_party",":::g_encountered_party"),
(assign,":var015",2),
(try_end),
(eq,":var001",0),
(lt,":faction_relation_013",0),
(gt,":faction_relation_014",0),
(party_get_slot,":party_slot_016",":cur_party",0),
(assign,":var017",0),
(try_begin),
(eq,1,1),
(party_stack_get_troop_id,      ":troop_id_008",":cur_party",0),
(try_begin),
(is_between,":troop_id_008","trp_looter","trp_black_khergit_horseman"),
(gt,":character_lvl_003",6),
(assign,":var017",1),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":party_slot_016",13),
(eq,":var017",1),
(get_party_ai_behavior,":party_ai_behavior_018",":cur_party"),
(try_begin),
(neq,":party_ai_behavior_018",5),
(party_quick_attach_to_current_battle, ":cur_party", ":var015"),
(str_store_string,s1,":str_store_party_name(cur_party)"),
(display_message, "str_s1_joined_battle_enemy"),
(else_try),
(try_begin),
(party_slot_eq,":cur_party",4,11),
(party_slot_eq,":cur_party",5,"trp_player"),
(assign,":var019",1),
(else_try),
(assign,":var019",0),
(try_end),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":var002",0),
(eq,":var019",1),
(gt,":faction_relation_013",0),
(lt,":faction_relation_014",0),
(assign,":var020",0),
(try_begin),
(party_slot_eq,":cur_party",4,11),
(party_slot_eq,":cur_party",5,"p_main_party"),
(assign,":var020",1),
(try_end),
(try_end),
(assign,":var021",1),
(try_begin),
(eq,":var001",1),
(eq,":var020",0),
(assign,":var021",0),
(eq,":party_faction_011",":::players_kingdom"),
(faction_slot_eq,"$players_kingdom",8,"trp_player"),
(assign,":var021",1),
(try_end),
(eq,":var021",1),
(party_get_slot,":party_slot_016",":cur_party",0),
(eq,":party_slot_016",13),
(party_stack_get_troop_id,      ":troop_id_022",":cur_party",0),
(call_script, "script_troop_get_player_relation", ":troop_id_022"),
(assign,":var023",reg0),
(assign,":var024",0),
(faction_slot_eq,"$players_kingdom",8,"trp_player"),
(eq,":var020",1),
(assign,":var024",1),
(try_end),
(this_or_next|ge,":var023",0),
(eq,":var024",1),
(party_quick_attach_to_current_battle, ":cur_party", 0),
(str_store_string,s1,":str_store_party_name(cur_party)"),
(display_message, "str_s1_joined_battle_friend"),
(try_end),
]),

("party_wound_all_members_aux", [
(store_script_param, ":party_id_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(try_for_range, ":stack_no_003", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004",":party_id_001",":stack_no_003"),
(try_begin),
(neg|troop_is_hero,":troop_id_004"),
(party_stack_get_size,          ":party_stack_size_005",":party_id_001",":stack_no_003"),
(party_wound_members,":party_id_001",":troop_id_004",":party_stack_size_005"),
(else_try),
(troop_set_health,":troop_id_004",0),
(try_end),
(try_end),
(party_get_num_attached_parties, ":party_num_attached_parties_006", ":party_id_001"),
(try_for_range, ":var007", 0, ":party_num_attached_parties_006"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_008", ":party_id_001", ":var007"),
(call_script, "script_party_wound_all_members_aux", ":party_attached_party_with_rank_008"),
(try_end),
]),

("party_wound_all_members", [
(store_script_param, ":party_id_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(try_for_range, ":stack_no_003", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004",":party_id_001",":stack_no_003"),
(try_begin),
(neg|troop_is_hero,":troop_id_004"),
(party_stack_get_size,          ":party_stack_size_005",":party_id_001",":stack_no_003"),
(party_wound_members,":party_id_001",":troop_id_004",":party_stack_size_005"),
(else_try),
(troop_set_health,":troop_id_004",0),
(try_end),
(try_end),
(party_get_num_attached_parties, ":party_num_attached_parties_006", ":party_id_001"),
(try_for_range, ":var007", 0, ":party_num_attached_parties_006"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_008", ":party_id_001", ":var007"),
(call_script, "script_party_wound_all_members_aux", ":party_attached_party_with_rank_008"),
(try_end),
]),

("calculate_battle_advantage", [
(call_script, "script_party_count_fit_for_battle", "p_collective_friends"),
(assign,":var001",reg0),
(party_get_skill_level, ":party_skill_lvl_002", "p_main_party", 15),
(party_get_skill_level, ":party_skill_lvl_003", "p_collective_friends", 15),
(val_max,":party_skill_lvl_002",":party_skill_lvl_003"),
(call_script, "script_party_count_fit_for_battle", "p_collective_enemy"),
(assign,":var004",reg0),
(party_get_skill_level, ":party_skill_lvl_005", "p_collective_enemy", 15),
(val_add, ":var001", 1),
(val_add, ":var004", 1),
(try_begin),
(ge,":var001",":var004"),
(val_mul, ":var001", 100),
(store_div, ":var___x1", ":var001", ":var004"),
(assign,":var006",":var___x1"),
(store_sub, ":var007", ":var006", 100),
(else_try),
(val_mul, ":var004", 100),
(store_div, ":var___x1", ":var004", ":var001"),
(assign,":var006",":var___x1"),
(store_sub, ":var007", 100, ":var006"),
(try_end),
(val_mul, ":var007", 2),
(val_mul, ":party_skill_lvl_002", 30),
(val_mul, ":party_skill_lvl_005", 30),
(val_add, ":var007", ":party_skill_lvl_002"),
(val_sub, ":var007", ":party_skill_lvl_005"),
(val_div, ":var007", 100),
(assign,reg0,":var007"),
(assign, reg0, 4294967295),
(display_message, "@{reg0}"),
]),

("cf_check_enemies_nearby", [
(get_player_agent_no,":agent_no_001"),
(try_begin),
(agent_is_alive,":agent_no_001"),
(agent_get_position,pos1,":agent_no_001"),
(set_fixed_point_multiplier, 100),
(try_for_agents, ":cur_agent"),
(neq,":cur_agent",":agent_no_001"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(neg|agent_is_ally,":cur_agent"),
(agent_get_position,pos2,":cur_agent"),
(get_distance_between_positions,":distance_004",1,2),
(le,":distance_004",1500),
(assign,0,1), # var002
(try_end),
(try_end),
(try_end),
]),

("get_heroes_attached_to_center_aux", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_001"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_001",":stack_no_004"),
(try_begin),
(troop_is_hero,":troop_id_005"),
(party_add_members,":var002",":troop_id_005",1),
(try_end),
(try_end),
(party_get_num_attached_parties, ":party_num_attached_parties_006", ":party_id_001"),
(try_for_range, ":var007", 0, ":party_num_attached_parties_006"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_008", ":party_id_001", ":var007"),
(call_script, "script_get_heroes_attached_to_center_aux", ":party_attached_party_with_rank_008", ":var002"),
(try_end),
]),

("get_heroes_attached_to_center", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_001"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_001",":stack_no_004"),
(try_begin),
(troop_is_hero,":troop_id_005"),
(party_add_members,":var002",":troop_id_005",1),
(try_end),
(try_end),
(party_get_num_attached_parties, ":party_num_attached_parties_006", ":party_id_001"),
(try_for_range, ":var007", 0, ":party_num_attached_parties_006"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_008", ":party_id_001", ":var007"),
(call_script, "script_get_heroes_attached_to_center_aux", ":party_attached_party_with_rank_008", ":var002"),
(try_end),
]),

("get_heroes_attached_to_center_as_prisoner_aux", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_003",":var001"),
(try_for_range, ":var004", 0, ":party_num_prisoners_stacks_003"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_005",":var001",":var004"),
(try_begin),
(troop_is_hero,":party_prisoner_troop_id_005"),
(party_add_members,":var002",":party_prisoner_troop_id_005",1),
(try_end),
(try_end),
(party_get_num_attached_parties, ":party_num_attached_parties_006", ":var001"),
(try_for_range, ":var007", 0, ":party_num_attached_parties_006"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_008", ":var001", ":var007"),
(call_script, "script_get_heroes_attached_to_center_as_prisoner_aux", ":party_attached_party_with_rank_008", ":var002"),
(try_end),
]),

("get_heroes_attached_to_center_as_prisoner", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_003",":var001"),
(try_for_range, ":var004", 0, ":party_num_prisoners_stacks_003"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_005",":var001",":var004"),
(try_begin),
(troop_is_hero,":party_prisoner_troop_id_005"),
(party_add_members,":var002",":party_prisoner_troop_id_005",1),
(try_end),
(try_end),
(party_get_num_attached_parties, ":party_num_attached_parties_006", ":var001"),
(try_for_range, ":var007", 0, ":party_num_attached_parties_006"),
(party_get_attached_party_with_rank, ":party_attached_party_with_rank_008", ":var001", ":var007"),
(call_script, "script_get_heroes_attached_to_center_as_prisoner_aux", ":party_attached_party_with_rank_008", ":var002"),
(try_end),
]),

("give_center_to_faction", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(eq,":var002","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_003","fac_player_supporters_faction",11),
(try_begin),
(eq,":faction_slot_003","trp_player"),
(try_begin),
(is_between,":var001","p_town_1","p_village_1"),
(assign,":var004",1),
(else_try),
(assign,":var004",0),
(try_end),
(try_end),
(try_for_range, ":p_005", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(eq,":party_faction_006","fac_player_supporters_faction"),
(val_add, ":var004", 1),
(try_end),
(ge,":var004",10),
(unlock_achievement, 55),
(try_end),
(try_begin),
(check_quest_active,"qst_join_siege_with_army"),
(quest_slot_eq,"qst_join_siege_with_army",1,":var001"),
(call_script, "script_abort_quest", "qst_join_siege_with_army", 0),
(faction_get_slot,":faction_slot_007","$players_kingdom",8),
(str_store_string,s9,":str_store_troop_name_link(faction_slot_007)"),
(setup_quest_text,"qst_follow_army"),
(str_store_string,s2,":str_store_string()"),
(call_script, "script_start_quest", "qst_follow_army", ":faction_slot_007"),
(assign,"$g_player_follow_army_warnings",0),
(try_end),
(call_script, "script_give_center_to_faction_aux", ":var001", ":var002"),
(call_script, "script_update_village_market_towns"),
(try_for_range, ":fac_008", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(call_script, "script_faction_recalculate_strength", ":fac_008"),
(try_end),
(assign,"$g_recalculate_ais",1),
(try_begin),
(eq,":var002","fac_player_supporters_faction"),
(faction_slot_eq,"fac_player_supporters_faction",21,2),
(call_script, "script_activate_player_faction", "trp_player"),
(try_end),
]),

("give_center_to_faction_aux", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(store_faction_of_party, ":party_faction_003", ":party_id_001"),
(party_set_faction,":party_id_001",":var002"),
(try_begin),
(party_slot_eq,":party_id_001",0,4),
(party_get_slot,":party_slot_004",":party_id_001",122),
(try_begin),
(gt,":party_slot_004",0),
(party_is_active,":party_slot_004"),
(party_set_faction,":party_slot_004",":var002"),
(try_end),
(try_end),
(try_begin),
(neq,":var002",":party_faction_003"),
(party_set_slot,":party_id_001",62,":party_faction_003"),
(party_get_slot,":party_slot_005",":party_id_001",7),
(party_set_slot,":party_id_001",7,-1),
(party_set_banner_icon, ":party_id_001", 0),
(call_script, "script_update_faction_notes", ":party_faction_003"),
(try_end),
(call_script, "script_update_faction_notes", ":var002"),
(call_script, "script_update_center_notes", ":party_id_001"),
(try_begin),
(ge,":party_slot_005",0),
(neq,":var002","fac_player_supporters_faction"),
(call_script, "script_update_troop_notes", ":party_slot_005"),
(try_end),
(try_for_range, ":p_006", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_006",120,":party_id_001"),
(call_script, "script_give_center_to_faction_aux", ":p_006", ":var002"),
(try_end),
]),

("change_troop_faction", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":faction_id_002", 2),
(try_begin),
(is_between,":faction_id_002","fac_player_supporters_faction","fac_kingdoms_end"),
(neg|faction_slot_eq,":faction_id_002",21,0),
(faction_set_slot,":faction_id_002",21,0),
(try_end),
(store_troop_faction,":troop_faction_003",":troop_id_001"),
(try_begin),
(faction_slot_eq,":troop_faction_003",8,":troop_id_001"),
(call_script, "script_check_and_finish_active_army_quests_for_faction", ":troop_faction_003"),
(try_begin),
(faction_slot_eq,":troop_faction_003",64,0),
(faction_set_slot,":troop_faction_003",64,1),
(store_current_hours,":cur_hours_004"),
(val_max,":cur_hours_004",0),
(faction_set_slot,":troop_faction_003",65,":cur_hours_004"),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_006",":trp_005"),
(eq,":troop_faction_006",":troop_faction_003"),
(troop_set_slot,":trp_005",154,-1),
(try_end),
(eq,":::players_kingdom",":troop_faction_003"),
(troop_set_slot,"trp_player",154,-1),
(try_end),
(eq,1,1),
(troop_get_slot,":troop_slot_007",":troop_id_001",10),
(try_begin),
(party_is_active,":troop_slot_007"),
(party_set_marshal, ":troop_slot_007", 0),
(try_end),
(try_end),
(faction_set_slot,":troop_faction_003",8,-1),
(troop_set_slot,":troop_id_001",154,-1),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_005",154,":troop_id_001"),
(troop_set_slot,":trp_005",154,-1),
(try_end),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(display_message, "@@{!}DEBUG - {s4} faction changed in normal faction change"),
(try_end),
(troop_set_faction,":troop_id_001",":faction_id_002"),
(troop_set_slot,":troop_id_001",50,0),
(troop_set_slot,":troop_id_001",53,0),
(troop_set_slot,":troop_id_001",54,0),
(troop_set_slot,":troop_id_001",47,0),
(call_script, "script_troop_set_title_according_to_faction", ":troop_id_001", ":faction_id_002"),
(try_begin),
(this_or_next|eq,":faction_id_002","fac_player_supporters_faction"),
(eq,":faction_id_002",":::players_kingdom"),
(call_script, "script_check_concilio_calradi_achievement"),
(try_end),
(try_for_range, ":p_008", ":p.town_1", ":p.village_1"),
(party_slot_eq,":p_008",7,":troop_id_001"),
(party_set_faction,":p_008",":faction_id_002"),
(try_for_range, ":p_009", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_009",120,":p_008"),
(party_set_faction,":p_009",":faction_id_002"),
(party_get_slot,":party_slot_010",":p_009",122),
(gt,":party_slot_010",0),
(party_is_active,":party_slot_010"),
(party_set_faction,":party_slot_010",":faction_id_002"),
(try_end),
(eq,1,1),
(party_get_slot,":party_slot_011",":p_009",7),
(neq,":party_slot_011",":troop_id_001"),
(party_set_slot,":p_009",7,-1),
(try_end),
(try_end),
(try_for_range, ":trp_012", ":trp.knight_1_1_wife", ":trp.heroes_end"),
(call_script, "script_get_kingdom_lady_social_determinants", ":trp_012"),
(assign,":var013",reg0),
(assign,":var014",reg1),
(try_begin),
(eq,":var013",":troop_id_001"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_012)"),
(display_message, "@@{!}DEBUG - {s4} faction changed by guardian moving"),
(try_end),
(try_end),
(troop_set_faction,":trp_012",":faction_id_002"),
(try_begin),
(troop_slot_eq,":trp_012",8,-1),
(troop_set_slot,":trp_012",12,":var014"),
(try_end),
(try_end),
(try_for_range, ":p_009", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_009",7,":troop_id_001"),
(store_faction_of_party, ":party_faction_015", ":p_009"),
(neq,":party_faction_015",":faction_id_002"),
(party_set_slot,":p_009",7,-1),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_016",":troop_id_001",10),
(try_begin),
(gt,":troop_slot_016",0),
(party_set_faction,":troop_slot_016",":faction_id_002"),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_017",":troop_slot_016"),
(try_for_range, ":var018", 0, ":party_num_prisoners_stacks_017"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_019",":troop_slot_016",":var018"),
(store_troop_faction,":troop_faction_020",":party_prisoner_troop_id_019"),
(troop_is_hero,":party_prisoner_troop_id_019"),
(eq,":troop_faction_020",":faction_id_002"),
(call_script, "script_remove_troop_from_prison", ":party_prisoner_troop_id_019"),
(party_remove_members,":troop_slot_016",":party_prisoner_troop_id_019",1),
(try_end),
(try_end),
(try_end),
(try_for_range, ":var021", 0, ":qst.quests_end"),
(check_quest_active,":var021"),
(quest_slot_eq,":var021",6,":troop_id_001"),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_s4_changing_sides_aborts_quest"),
(try_end),
(call_script, "script_abort_quest", ":var021", 0),
(try_end),
(try_for_range, ":trp_022", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_get_slot,":troop_slot_023",":trp_022",10),
(try_begin),
(party_is_active,":troop_slot_023"),
(party_get_attached_to, ":party_attached_024", ":troop_slot_023"),
(is_between,":party_attached_024","p_town_1","p_village_1"),
(store_faction_of_party, ":party_faction_025", ":troop_slot_023"),
(store_faction_of_party, ":party_faction_026", ":party_attached_024"),
(neq,":party_faction_025",":party_faction_026"),
(party_detach, ":troop_slot_023"),
(try_end),
(try_end),
(faction_get_slot,":faction_slot_027",":faction_id_002",11),
(try_begin),
(eq,":faction_slot_027","trp_player"),
(neq,":troop_id_001",":::g_talk_troop"),
(troop_set_slot,":troop_id_001",2,0),
(else_try),
(is_between,":faction_slot_027","trp_npc1","trp_knight_1_1_wife"),
(is_between,":troop_id_001","trp_npc1","trp_knight_1_1_wife"),
(call_script, "script_troop_change_relation_with_troop", ":faction_slot_027", ":troop_id_001", 5),
(val_add, ":::total_indictment_changes", 5),
(try_end),
(try_begin),
(troop_slot_ge,":troop_id_001",30,0),
(else_try),
(is_between,":troop_id_001","trp_npc1","trp_knight_1_1_wife"),
(try_for_range, ":slot_no_028", 35, 38),
(troop_get_slot,":troop_slot_029",":troop_id_001",":slot_no_028"),
(call_script, "script_courtship_event_lady_break_relation_with_suitor", ":troop_slot_029", ":troop_id_001"),
(try_end),
(call_script, "script_assign_troop_love_interests", ":troop_id_001"),
(else_try),
(is_between,":troop_id_001","trp_knight_1_1_wife","trp_heroes_end"),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.knight_1_1_wife"),
(try_for_range, ":slot_no_028", 35, 38),
(troop_slot_eq,":trp_005",":slot_no_028",":troop_id_001"),
(call_script, "script_courtship_event_lady_break_relation_with_suitor", ":troop_id_001", ":trp_005"),
(try_end),
(try_end),
(try_end),
(troop_get_slot,":troop_slot_030",":troop_id_001",10),
(try_for_range, ":p_008", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_008",0,4),
(party_get_slot,":party_slot_031",":p_008",34),
(eq,":party_slot_031",":troop_slot_030"),
(party_set_slot,":p_008",34,-1),
(party_slot_eq,":p_008",35,1),
(party_set_slot,":p_008",35,0),
(party_set_extra_text,":p_008", "str_empty_string"),
(try_end),
(else_try),
(party_get_slot,":party_slot_032",":p_008",54),
(try_begin),
(eq,":party_slot_032",":troop_slot_030"),
(party_set_slot,":p_008",54,-1),
(try_begin),
(party_slot_eq,":p_008",35,5),
(party_set_slot,":p_008",35,0),
(party_set_extra_text,":p_008", "str_empty_string"),
(try_end),
(try_end),
(try_end),
(call_script, "script_update_all_notes"),
(call_script, "script_update_village_market_towns"),
(assign,"$g_recalculate_ais",1),
]),

("troop_set_title_according_to_faction", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(is_between,":var002","fac_player_supporters_faction","fac_kingdoms_end"),
(str_store_string,s0,":str_store_troop_name_plural(troop_id_001)"),
(troop_get_type,":troop_type_003",":troop_id_001"),
(store_sub, ":var004", ":var002", ":fac.player_supporters_faction"),
(try_begin),
(eq,":troop_type_003",0),
(assign,":var004 +","str_faction_title_male_player"),
(else_try),
(assign,":var004 +","str_faction_title_female_player"),
(try_end),
(str_store_string,s1,":str_store_string(var004)"),
(troop_set_name, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_005",":troop_id_001",10),
(try_begin),
(gt,":troop_slot_005",0),
(str_store_string,s5,":str_store_troop_name(troop_id_001)"),
(party_set_name, ":troop_slot_005", "str_s5_s_party"),
(try_end),
(try_end),
]),

("give_center_to_lord", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(store_script_param, ":var003", 3),
(try_begin),
(eq,":::cheat_mode",1),
(ge,":troop_id_002",0),
(str_store_string,s4,":str_store_party_name(party_id_001)"),
(str_store_string,s5,":str_store_troop_name(troop_id_002)"),
(display_message, "@@{!}DEBUG -- {s4} awarded to {s5}"),
(try_end),
(try_begin),
(eq,":troop_id_002","trp_player"),
(unlock_achievement, 50),
(assign,":var004",1),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(neq,":p_005",":party_id_001"),
(party_slot_eq,":p_005",7,"trp_player"),
(val_add, ":var004", 1),
(try_end),
(ge,":var004",5),
(unlock_achievement, 51),
(try_end),
(party_get_slot,":party_slot_006",":party_id_001",7),
(try_begin),
(eq,":troop_id_002",-1),
(assign,":troop_faction_007","fac_player_supporters_faction"),
(party_set_banner_icon, ":party_id_001", 0),
(else_try),
(eq,":troop_id_002","trp_player"),
(assign,":troop_faction_007","$players_kingdom"),
(else_try),
(store_troop_faction,":troop_faction_007",":troop_id_002"),
(try_end),
(faction_get_slot,":faction_slot_008",":troop_faction_007",11),
(try_begin),
(eq,":faction_slot_008","trp_player"),
(try_begin),
(eq,1,1),
(troop_get_type,":troop_type_009","trp_player"),
(eq,":troop_type_009",1),
(unlock_achievement, 77),
(try_end),
(try_end),
(try_begin),
(eq,":faction_slot_008",":party_slot_006"),
(call_script, "script_add_log_entry", 22, ":faction_slot_008", ":party_id_001", ":troop_id_002", ":troop_faction_007"),
(troop_set_slot,":troop_id_002",47,0),
(try_end),
(try_begin),
(eq,":troop_id_002",-1),
(party_set_faction,":party_id_001","$players_kingdom"),
(else_try),
(eq,":troop_id_002","trp_player"),
(gt,":::players_kingdom",0),
(party_set_faction,":party_id_001","$players_kingdom"),
(else_try),
(eq,":troop_id_002","trp_player"),
(neg|is_between,"$players_kingdom","fac_player_supporters_faction","fac_kingdoms_end"),
(party_set_faction,":party_id_001","fac_player_supporters_faction"),
(else_try),
(party_set_faction,":party_id_001",":troop_faction_007"),
(try_end),
(party_set_slot,":party_id_001",7,":troop_id_002"),
(try_begin),
(party_slot_eq,":party_id_001",0,4),
(party_get_slot,":party_slot_010",":party_id_001",122),
(try_begin),
(gt,":party_slot_010",0),
(party_is_active,":party_slot_010"),
(store_faction_of_party, ":party_faction_011", ":party_id_001"),
(party_set_faction,":party_slot_010",":party_faction_011"),
(try_end),
(try_end),
(try_begin),
(this_or_next|party_slot_eq,":party_id_001",0,3),
(party_slot_eq,":party_id_001",0,2),
(gt,":troop_id_002",-1),
(troop_get_slot,":troop_slot_012",":troop_id_002",13),
(try_begin),
(gt,":troop_slot_012",0),
(assign,":troop_slot_012 -","spr_banner_a"),
(val_add, ":troop_slot_012", 1297036692682702894),
(party_set_banner_icon, ":party_id_001", ":troop_slot_012"),
(try_end),
(try_end),
(try_begin),
(gt,":troop_id_002",-1),
(call_script, "script_update_troop_notes", ":troop_id_002"),
(try_end),
(call_script, "script_update_center_notes", ":party_id_001"),
(try_begin),
(gt,":troop_faction_007",0),
(call_script, "script_update_faction_notes", ":troop_faction_007"),
(try_end),
(try_begin),
(ge,":party_slot_006",0),
(call_script, "script_update_troop_notes", ":party_slot_006"),
(store_troop_faction,":troop_faction_013",":party_slot_006"),
(call_script, "script_update_faction_notes", ":troop_faction_013"),
(try_end),
(try_begin),
(eq,":var003",1),
(this_or_next|party_slot_eq,":party_id_001",0,3),
(party_slot_eq,":party_id_001",0,2),
(assign,":var014",3),
(try_begin),
(party_slot_eq,":party_id_001",0,3),
(assign,":var014",9),
(try_end),
(try_for_range, ":var015", 0, ":var014"),
(call_script,"script_cf_reinforce_party"),
(try_end),
(try_for_range, ":var015", 0, 7),
(store_mul, ":var016", 150, ":var014"),
(store_mul, ":var017", 200, ":var014"),
(store_random_in_range,":random_x_018",":var016",":var017"),
(party_upgrade_with_xp, ":party_id_001", ":random_x_018", 0),
(try_end),
(try_end),
(faction_get_slot,":faction_slot_008",":troop_faction_007",11),
(store_current_hours,":cur_hours_019"),
(try_begin),
(gt,":cur_hours_019",0),
(gt,":troop_id_002",0),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_002", ":faction_slot_008", 10),
(val_add, ":::total_promotion_changes", 10),
(try_for_range, ":trp_020", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_020",2,2),
(neq,":trp_020",":troop_id_002"),
(store_troop_faction,":troop_faction_021",":trp_020"),
(try_begin),
(eq,":troop_faction_007",":troop_faction_021"),
(neq,":trp_020",":faction_slot_008"),
(call_script, "script_troop_get_relation_with_troop", ":trp_020", ":troop_id_002"),
(assign,":var022",reg0),
(store_div, ":var___x1", ":var022", 8),
(assign,":var023",":var___x1"),
(val_sub, ":var023", 2),
(val_clamp,":var023",-5, 3),
(try_begin),
(this_or_next|troop_slot_eq,":trp_020",52,7),
(troop_slot_eq,":trp_020",52,6),
(ge,":var022",0),
(val_max,":var023",0),
(else_try),
(this_or_next|troop_slot_eq,":trp_020",52,3),
(this_or_next|troop_slot_eq,":trp_020",52,5),
(troop_slot_eq,":trp_020",52,2),
(lt,":var023",0),
(val_mul, ":var023", 3),
(val_div, ":var023", 2),
(try_end),
(try_end),
(neq,":var023",0),
(try_begin),
(troop_slot_eq,":trp_020",154,":troop_id_002"),
(val_add, ":var023", 1),
(val_max,":var023",1),
(try_end),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":trp_020", ":faction_slot_008", ":var023"),
(val_add, ":::total_promotion_changes", ":var023"),
(try_begin),
(this_or_next|gt,":var023",-4),
(this_or_next|troop_slot_eq,":trp_020",47,1),
(troop_slot_eq,":trp_020",47,":party_id_001"),
(call_script, "script_add_log_entry", 26, ":trp_020", ":party_id_001", ":troop_id_002", ":troop_faction_007"),
(try_end),
(try_end),
(try_begin),
(is_between,":party_id_001","p_town_1","p_village_1"),
(try_for_range, ":p_024", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_024",120,":party_id_001"),
(store_faction_of_party, ":party_faction_025", ":p_024"),
(neq,":party_faction_025",":troop_faction_007"),
(call_script, "script_give_center_to_lord", ":p_024", ":troop_id_002", 0),
(try_end),
(try_end),
(try_end),
]),

("get_number_of_hero_centers", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_for_range, ":p_003", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_003",7,":var001"),
(val_add, ":var002", 1),
(try_end),
(assign,reg0,":var002"),
]),

("cf_get_random_enemy_center", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(store_faction_of_party, ":party_faction_004", ":var001"),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(store_relation,":faction_relation_007",":party_faction_004",":party_faction_006"),
(try_begin),
(lt,":faction_relation_007",0),
(store_distance_to_party_from_party,":distance_parties_008",":var001",":var001"),
(le,":distance_parties_008",":var002"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var003",0),
(store_random_in_range,":random_x_009",0,":var003"),
(assign,":var010","p_salt_mine"),
(try_for_range, ":p_005", ":p.town_1", ":var010"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(store_relation,":faction_relation_007",":party_faction_004",":party_faction_006"),
(lt,":faction_relation_007",0),
(store_distance_to_party_from_party,":distance_parties_008",":var001",":var001"),
(le,":distance_parties_008",":var002"),
(val_sub, ":random_x_009", 1),
(lt,":random_x_009",0),
(assign,":var011",":p_005"),
(assign,":var010",0),
(try_end),
(try_end),
(assign,reg0,":var011"),
]),

("find_travel_location", [
(store_script_param, ":var001", 1),
(store_faction_of_party, ":party_faction_002", ":var001"),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.town_1", ":p.salt_mine"),
(neq,":var001",":p_004"),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(eq,":party_faction_002",":party_faction_005"),
(store_distance_to_party_from_party,":distance_parties_006",":var001",":var001"),
(val_add, ":distance_parties_006", 1),
(assign,":var007",100000),
(val_div, ":var007", ":distance_parties_006"),
(val_add, ":var003", ":var007"),
(try_end),
(try_end),
(try_begin),
(eq,":var003",0),
(else_try),
(store_random_in_range,":random_x_008",0,":var003"),
(assign,":var003",0),
(assign,":var009",0),
(try_for_range, ":p_004", ":p.town_1", ":p.salt_mine"),
(eq,":var009",0),
(neq,":var001",":p_004"),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(try_begin),
(eq,":party_faction_002",":party_faction_005"),
(store_distance_to_party_from_party,":distance_parties_006",":var001",":var001"),
(val_add, ":distance_parties_006", 1),
(assign,":var007",100000),
(val_div, ":var007", ":distance_parties_006"),
(val_add, ":var003", ":var007"),
(try_begin),
(lt,":random_x_008",":var003"),
(assign,-1,":p_004"), # reg0
(assign,":var009",1),
(try_end),
(try_end),
(try_end),
(try_end),
]),

("get_relation_between_parties", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_faction_of_party, ":party_faction_003", ":var001"),
(store_faction_of_party, ":party_faction_004", ":var002"),
(try_begin),
(eq,":party_faction_003",":party_faction_004"),
(else_try),
(store_relation,":faction_relation_005",":party_faction_003",":party_faction_004"),
(assign,100,":faction_relation_005"), # reg0
(try_end),
]),

("calculate_weekly_party_wage", [
(store_script_param, ":party_id_001", 1),
(assign,":var002",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_001"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_001",":stack_no_004"),
(party_stack_get_size,          ":party_stack_size_006",":party_id_001",":stack_no_004"),
(call_script, "script_npc_get_troop_wage", ":troop_id_005", ":party_id_001"),
(assign,":var007",reg0),
(val_mul, ":var007", ":party_stack_size_006"),
(val_add, ":var002", ":var007"),
(try_end),
(assign,reg0,":var002"),
]),

("calculate_player_faction_wage", [
(assign,":var001",0),
(assign,":var002",0),
(try_for_parties, ":cur_party"),
(assign,":var004",0),
(try_begin),
(this_or_next|party_slot_eq,":cur_party",0,3),
(party_slot_eq,":cur_party",0,2),
(party_slot_eq,":cur_party",7,"trp_player"),
(assign,":var004",1),
(try_end),
(try_begin),
(this_or_next|eq,":cur_party","p_main_party"),
(eq,":var004",1),
(party_get_num_companion_stacks,":party_num_companions_stacks_005",":cur_party"),
(try_for_range, ":stack_no_006", 0, ":party_num_companions_stacks_005"),
(party_stack_get_troop_id,      ":troop_id_007",":cur_party",":stack_no_006"),
(party_stack_get_size,          ":party_stack_size_008",":cur_party",":stack_no_006"),
(call_script, "script_game_get_troop_wage", ":troop_id_007", ":cur_party"),
(assign,":var009",reg0),
(val_mul, ":var009", ":party_stack_size_008"),
(try_begin),
(eq,":var004",1),
(val_add, ":var002", ":var009"),
(else_try),
(val_add, ":var001", ":var009"),
(try_end),
(try_end),
(try_end),
(try_end),
(val_div, ":var002", 2),
(store_sub, ":var010", 14, "$g_cur_week_half_daily_wage_payments"),
(val_mul, ":var001", ":var010"),
(val_div, ":var001", 14),
(store_add, reg0, ":var001", ":var002"),
]),

("calculate_hero_weekly_net_income_and_add_to_wealth", [
(store_script_param, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_002",":troop_id_001",10),
(troop_get_slot,":troop_slot_003",":troop_id_001",11),
(assign,":var004",750),
(store_character_level,":character_lvl_005",":troop_id_001"),
(store_mul, ":var006", ":character_lvl_005", 10),
(val_add, ":var004", ":var006"),
(store_troop_faction,":troop_faction_007",":troop_id_001"),
(try_begin),
(faction_slot_eq,":troop_faction_007",11,":troop_id_001"),
(val_add, ":var004", 1000),
(try_end),
(try_begin),
(faction_slot_eq,":troop_faction_007",8,":troop_id_001"),
(val_add, ":var004", 1000),
(try_end),
(assign,":var008",0),
(try_begin),
(gt,":troop_slot_002",0),
(call_script, "script_calculate_weekly_party_wage", ":troop_slot_002"),
(assign,":var008",reg0),
(try_end),
(val_sub, ":var004", ":var008"),
(val_add, ":troop_slot_003", ":var004"),
(try_begin),
(lt,":troop_slot_003",0),
(store_sub, ":var009", 0, ":troop_slot_003"),
(val_mul, ":var009", 100),
(val_div, ":var009", ":var008"),
(val_div, ":var009", 5),
(call_script, "script_party_inflict_attrition", ":troop_slot_002", ":var009", 1),
(try_end),
(val_max,":troop_slot_003",0),
(troop_set_slot,":troop_id_001",11,":troop_slot_003"),
]),

("cf_reinforce_party", [
(store_script_param, ":party_id_001", 1),
(store_faction_of_party, ":party_faction_002", ":party_id_001"),
(party_get_slot,":party_slot_003",":party_id_001",0),
(try_begin),
(eq,":party_slot_003",13),
(party_stack_get_troop_id,      ":troop_id_004",":party_id_001",0),
(troop_get_slot,":party_faction_002",":troop_id_004",14),
(try_end),
(try_begin),
(eq,":party_faction_002","fac_player_supporters_faction"),
(party_get_slot,":party_slot_005",":party_id_001",7),
(try_begin),
(gt,":party_slot_005",0),
(troop_get_slot,":party_faction_002",":party_slot_005",14),
(else_try),
(party_get_slot,":party_faction_002",":party_id_001",61),
(try_end),
(try_end),
(faction_get_slot,":faction_slot_006",":party_faction_002",77),
(faction_get_slot,":faction_slot_007",":party_faction_002",78),
(faction_get_slot,":faction_slot_008",":party_faction_002",79),
(assign,":var009",0),
(store_random_in_range,":random_x_010",0,100),
(try_begin),
(this_or_next|eq,":party_slot_003",2),
(eq,":party_slot_003",3),
(try_begin),
(lt,":random_x_010",65),
(assign,":var009",":faction_slot_006"),
(else_try),
(assign,":var009",":faction_slot_007"),
(try_end),
(else_try),
(eq,":party_slot_003",13),
(try_begin),
(lt,":random_x_010",50),
(assign,":var009",":faction_slot_006"),
(else_try),
(lt,":random_x_010",75),
(assign,":var009",":faction_slot_007"),
(else_try),
(assign,":var009",":faction_slot_008"),
(try_end),
(else_try),
(try_end),
(try_begin),
(gt,":var009",0),
(party_add_template, ":party_id_001", ":var009"),
(try_end),
]),

("hire_men_to_kingdom_hero_party", [
(store_script_param, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_002",":troop_id_001",10),
(troop_get_slot,":troop_slot_003",":troop_id_001",11),
(assign,":var004",":troop_slot_003"),
(val_mul, ":var004", 3),
(val_div, ":var004", 4),
(call_script, "script_party_get_ideal_size", ":troop_slot_002"),
(assign,":var005",reg0),
(store_mul, ":var006", ":var005", 3),
(val_div, ":var006", 2),
(party_get_num_companions,":party_num_companions_007",":troop_slot_002"),
(store_faction_of_party, ":party_faction_008", ":troop_slot_002"),
(try_begin),
(this_or_next|eq,":party_faction_008",":::players_kingdom"),
(eq,":party_faction_008","fac_player_supporters_faction"),
(assign,":var009",450),
(else_try),
(game_get_reduce_campaign_ai, ":campaign_ai"),
(assign,":var009",450),
(try_begin),
(eq,":campaign_ai",0),
(assign,":var009",300),
(else_try),
(eq,":campaign_ai",1),
(assign,":var009",450),
(else_try),
(eq,":campaign_ai",2),
(assign,":var009",600),
(try_end),
(try_end),
(try_for_range, ":var012", 0, 1), # var011
(lt,":party_num_companions_007",":var005"),
(gt,":var004",":var009"),
(gt,":troop_slot_002",0),
(call_script, "script_cf_reinforce_party", ":troop_slot_002"),
(val_sub, ":troop_slot_003", ":var009"),
(troop_set_slot,":troop_id_001",11,":troop_slot_003"),
(else_try),
(gt,":party_num_companions_007",":var006"),
(store_troop_faction,":troop_faction_013",":troop_id_001"),
(party_get_num_companion_stacks,":party_num_companions_stacks_014",":troop_slot_002"),
(assign,":var015",0),
(assign,":var016",0),
(try_for_range, ":stack_no_017", 0, ":party_num_companions_stacks_014"),
(party_stack_get_troop_id,      ":troop_id_018",":troop_slot_002",":stack_no_017"),
(try_begin),
(neg|troop_is_hero,":troop_id_018"),
(party_stack_get_size,          ":party_stack_size_019",":troop_slot_002",":stack_no_017"),
(store_character_level,":character_lvl_020",":troop_id_018"),
(store_troop_faction,":troop_faction_021",":troop_id_018"),
(try_begin),
(eq,":troop_faction_013",":troop_faction_021"),
(val_mul, ":character_lvl_020", 3),
(try_end),
(try_end),
(val_mul, ":character_lvl_020", ":party_stack_size_019"),
(val_add, ":var015", ":party_stack_size_019"),
(val_add, ":var016", ":character_lvl_020"),
(try_begin),
(gt,":var015",0),
(store_div, ":var___x1", ":var016", ":var015"),
(assign,":var022",":var___x1"),
(try_for_range, ":stack_no_017", 0, ":party_num_companions_stacks_014"),
(party_stack_get_troop_id,      ":troop_id_018",":troop_slot_002",":stack_no_017"),
(try_begin),
(neg|troop_is_hero,":troop_id_018"),
(party_stack_get_size,          ":party_stack_size_019",":troop_slot_002",":stack_no_017"),
(store_character_level,":character_lvl_020",":troop_id_018"),
(store_troop_faction,":troop_faction_021",":troop_id_018"),
(try_begin),
(eq,":troop_faction_013",":troop_faction_021"),
(val_mul, ":character_lvl_020", 3),
(try_end),
(try_end),
(try_end),
(store_sub, ":var023", ":var022", ":character_lvl_020"),
(val_div, ":var023", 3),
(store_add, ":var024", 10, ":var023"),
(try_begin),
(gt,":var024",0),
(call_script, "script_get_percentage_with_randomized_round", ":party_stack_size_019", ":var024"),
(try_begin),
(gt,reg0,0),
(party_remove_members,":troop_slot_002",":troop_id_018",reg0),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
]),

("get_percentage_with_randomized_round", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_mul, ":var003", ":var001", ":var002"),
(val_div, ":var003", 100),
(store_mul, ":var004", ":var003", 100),
(val_div, ":var004", ":var002"),
(store_sub, ":var005", ":var001", ":var004"),
(try_begin),
(gt,":var005",0),
(store_mul, ":var006", ":var005", ":var002"),
(store_random_in_range,":random_x_007",0,100),
(try_begin),
(lt,":random_x_007",":var006"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(assign,reg0,":var003"),
]),

("create_cattle_herd", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":party_id_003",-1),
(set_spawn_radius,1),
(spawn_around_party,":var001","pt_cattle_herd"),
(assign,":party_id_003",reg0),
(party_get_position,pos1,":var001"),
(call_script, "script_map_get_random_position_around_position_within_range", 1, 2),
(party_set_position,":party_id_003",2),
(party_set_slot,":party_id_003",0,17),
(party_set_slot,":party_id_003",4,-1),
(party_set_ai_behavior,":party_id_003",0),
(party_set_slot,":party_id_003",30,-1),
(try_begin),
(gt,":var002",0),
(party_clear,":party_id_003"),
(party_add_members,":party_id_003","trp_cattle",":var002"),
(try_end),
(assign,reg0,":party_id_003"),
]),

("buy_cattle_from_village", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(try_for_range, ":var004", 0, ":var002"),
(call_script, "script_game_event_buy_item", "itm_cattle_meat", 0),
(call_script, "script_game_event_buy_item", "itm_cattle_meat", 0),
(try_end),
(party_get_slot,":party_slot_005",":party_id_001",205),
(val_sub, ":party_slot_005", ":var002"),
(party_set_slot,":party_id_001",205,":party_slot_005"),
(store_mul, ":gold_006", ":var003", ":var002"),
(troop_remove_gold,"trp_player",":gold_006"),
(assign,":var007",1),
(try_for_parties, ":cur_party"),
(eq,":var007",1),
(party_slot_eq,":cur_party",0,17),
(store_distance_to_party_from_party,":distance_parties_009",":party_id_001",":party_id_001"),
(lt,":distance_parties_009",6),
(assign,":var010",1),
(check_quest_active,"qst_move_cattle_herd"),
(quest_slot_eq,"qst_move_cattle_herd",8,":cur_party"),
(assign,":var010",0),
(try_end),
(eq,":var010",1),
(party_add_members,":cur_party","trp_cattle",":var002"),
(assign,":var007",0),
(assign,reg0,":cur_party"),
(try_end),
(try_begin),
(eq,":var007",1),
(call_script, "script_create_cattle_herd", ":party_id_001", ":var002"),
(try_end),
]),

("kill_cattle_from_herd", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(troop_clear_inventory,"trp_temp_troop"),
(store_mul, ":add_amount_003", ":var002", 2),
(troop_add_items,"trp_temp_troop","itm_cattle_meat",":add_amount_003"),
(troop_get_inventory_capacity,":troop_inv_capacity_004","trp_temp_troop"),
(try_for_range, ":inventory_slot_no_005", 0, ":troop_inv_capacity_004"),
(troop_get_inventory_slot,":troop_inv_slot_006","trp_temp_troop",":inventory_slot_no_005"),
(try_begin),
(eq,":troop_inv_slot_006","itm_cattle_meat"),
(troop_set_inventory_slot_modifier,"trp_temp_troop",":inventory_slot_no_005",37),
(try_end),
(try_end),
(party_get_num_companions,":party_num_companions_007",":party_id_001"),
(try_begin),
(ge,":var002",":party_num_companions_007"),
(remove_party,":party_id_001"),
(else_try),
(party_remove_members,":party_id_001","trp_cattle",":var002"),
(try_end),
]),

("create_kingdom_hero_party", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(store_troop_faction,":troop_faction_003",":troop_id_001"),
(assign,"$pout_party",-1),
(try_begin),
(eq,":::g_there_is_no_avaliable_centers",0),
(set_spawn_radius,0),
(else_try),
(set_spawn_radius,15),
(try_end),
(spawn_around_party,":var002","pt_kingdom_hero_party"),
(assign,"$pout_party",reg0),
(party_set_faction,"$pout_party",":troop_faction_003"),
(party_set_slot,"$pout_party",0,13),
(call_script, "script_party_set_ai_state", "$pout_party", -1, -1),
(troop_set_slot,":troop_id_001",10,"$pout_party"),
(party_add_leader,"$pout_party",":troop_id_001"),
(str_store_string,s5,":str_store_troop_name(troop_id_001)"),
(party_set_name, "$pout_party", "str_s5_s_party"),
(party_set_slot,"$pout_party",30,-1),
(troop_get_slot,":troop_slot_004",":troop_id_001",13),
(try_begin),
(gt,":troop_slot_004",0),
(assign,":troop_slot_004 -","spr_banner_a"),
(val_add, ":troop_slot_004", 1297036692682702894),
(party_set_banner_icon, "$pout_party", ":troop_slot_004"),
(try_end),
(try_begin),
(troop_slot_eq,":troop_id_001",28,0),
(troop_set_slot,":troop_id_001",28,1),
(assign,":var005",20),
(try_begin),
(eq,1,1),
(store_troop_faction,":troop_faction_006",":troop_id_001"),
(try_begin),
(faction_slot_eq,":troop_faction_006",11,":troop_id_001"),
(assign,":var005",50),
(try_end),
(try_end),
(try_for_range, ":var007", 0, ":var005"),
(call_script, "script_hire_men_to_kingdom_hero_party", ":troop_id_001"),
(try_end),
(assign,":var008",0),
(game_get_reduce_campaign_ai, ":campaign_ai"),
(try_begin),
(this_or_next|eq,":troop_faction_003","fac_player_supporters_faction"),
(eq,":troop_faction_003",":::players_kingdom"),
(assign,":var008",0),
(else_try),
(eq,":campaign_ai",0),
(assign,":var008",2),
(else_try),
(eq,":campaign_ai",1),
(assign,":var008",1),
(else_try),
(eq,":campaign_ai",2),
(assign,":var008",0),
(try_end),
(troop_get_slot,":troop_slot_010",":troop_id_001",7),
(store_div, ":var___x1", ":troop_slot_010", 100),
(assign,":var011",":var___x1"),
(val_add, ":var008", ":var011"),
(try_for_range, ":var007", 0, ":var008"),
(call_script, "script_upgrade_hero_party", "$pout_party", 4000),
(try_end),
(try_end),
]),

("create_kingdom_party_if_below_limit", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":var002", 2),
(call_script, "script_count_parties_of_faction_and_party_type", ":faction_id_001", ":var002"),
(assign,":var003",reg0),
(assign,":var004",0),
(faction_get_slot,":faction_slot_005",":faction_id_001",82),
(try_begin),
(eq,":var002",11),
(try_begin),
(eq,":faction_slot_005",0),
(assign,":var004",0),
(else_try),
(eq,":faction_slot_005",1),
(assign,":var004",1),
(else_try),
(eq,":faction_slot_005",2),
(assign,":var004",3),
(else_try),
(assign,":var004",5),
(try_end),
(try_end),
(try_begin),
(lt,":var003",":var004"),
(call_script,"script_cf_create_kingdom_party"),
(try_end),
]),

("cf_create_kingdom_party", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":var002", 2),
(str_store_string,s7,":str_store_faction_name(faction_id_001)"),
(assign,":var003","str_no_string"),
(faction_get_slot,":faction_slot_004",":faction_id_001",78),
(try_begin),
(eq,":var002",11),
(assign,":var005","pt_kingdom_caravan_party"),
(try_end),
(assign,":party_id_006",-1),
(try_begin),
(eq,1,1),
(try_begin),
(eq,":var002",11),
(call_script, "script_cf_select_random_town_with_faction", ":faction_id_001", -1),
(set_spawn_radius,0),
(else_try),
(call_script, "script_cf_select_random_walled_center_with_faction", ":faction_id_001", -1),
(set_spawn_radius,1),
(try_end),
(assign,":party_id_007",reg0),
(try_begin),
(is_between,":party_id_007","p_town_1","p_salt_mine"),
(spawn_around_party,":party_id_007",":var005"),
(assign,":party_id_006",reg0),
(party_set_faction,":party_id_006",":faction_id_001"),
(try_begin),
(eq,":var002",11),
(party_set_slot,":party_id_006",123,":party_id_007"),
(party_set_slot,":party_id_006",126,":party_id_007"),
(try_end),
(try_end),
(party_set_slot,":party_id_006",0,":var002"),
(party_set_slot,":party_id_006",4,-1),
(try_begin),
(neq,":var003","str_no_string"),
(party_set_name, ":party_id_006", ":var003"),
(try_end),
(try_begin),
(eq,":var002",11),
(try_begin),
(eq,":faction_id_001","fac_player_supporters_faction"),
(party_get_slot,":party_slot_008",":party_id_007",61),
(faction_get_slot,":faction_slot_004",":party_slot_008",78),
(try_end),
(party_add_template, ":party_id_006", ":faction_slot_004"),
(party_add_template, ":party_id_006", ":faction_slot_004"),
(party_set_ai_behavior,":party_id_006",1),
(party_set_ai_object,":party_id_006",":party_id_006"),
(party_set_flags, ":party_id_006", 65536, 1),
(store_sub, ":var009", 250, ":itm.spice"),
(try_for_range, ":itm_010", ":itm.spice", ":itm.siege_supply"),
(store_add, ":slot_no_011", ":itm_010", ":var009"),
(party_set_slot,":party_id_006",":slot_no_011",1000),
(try_end),
(try_end),
(try_end),
(try_begin),
(ge,":party_id_006",0),
(assign,reg0,":party_id_006"),
(try_end),
]),

("get_troop_attached_party", [
(store_script_param, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_002",":troop_id_001",10),
(assign,":party_attached_003",-1),
(try_begin),
(ge,":troop_slot_002",0),
(party_get_attached_to, ":party_attached_003", ":troop_slot_002"),
(try_end),
(assign,reg0,":party_attached_003"),
]),

("center_get_food_consumption", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_begin),
(party_slot_eq,":var001",0,3),
(assign,":var002",500),
(else_try),
(party_slot_eq,":var001",0,2),
(assign,":var002",50),
(try_end),
(assign,reg0,":var002"),
]),

("center_get_food_store_limit", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_begin),
(party_slot_eq,":var001",0,3),
(assign,":var002",50000),
(else_try),
(party_slot_eq,":var001",0,2),
(assign,":var002",1500),
(try_end),
(assign,reg0,":var002"),
]),

("refresh_village_merchant_inventory", [
(store_script_param, ":party_id_001", 1),
(party_get_slot,":party_slot_002",":party_id_001",25),
(reset_item_probabilities),
(party_get_slot,":party_slot_003",":party_id_001",120),
(assign,":var004",0),
(try_for_range, ":itm_005", ":itm.spice", ":itm.siege_supply"),
(call_script, "script_center_get_production", ":party_id_001", ":itm_005"),
(assign,":item_probability_006",reg0),
(call_script, "script_center_get_production", ":party_slot_003", ":itm_005"),
(val_div, reg0, 5),
(val_add, ":item_probability_006", reg0),
(val_max,":item_probability_006",5),
(val_add, ":var004", ":item_probability_006"),
(try_end),
(try_begin),
(eq,1,1),
(party_get_slot,":party_slot_007",":party_id_001",50),
(val_div, ":party_slot_007", 15),
(store_add, ":merch_amount_008", ":party_slot_007", 1),
(try_end),
(try_for_range, ":itm_005", ":itm.spice", ":itm.siege_supply"),
(call_script, "script_center_get_production", ":party_id_001", ":itm_005"),
(assign,":item_probability_006",reg0),
(call_script, "script_center_get_production", ":party_slot_003", ":itm_005"),
(val_div, reg0, 5),
(val_add, ":item_probability_006", reg0),
(val_max,":item_probability_006",5),
(val_mul, ":item_probability_006", ":merch_amount_008"),
(val_mul, ":item_probability_006", 100),
(val_div, ":item_probability_006", ":var004"),
(set_item_probability_in_merchandise,":itm_005",":item_probability_006"),
(try_end),
(troop_clear_inventory,":party_slot_002"),
(troop_add_merchandise,":party_slot_002",11,":merch_amount_008"),
(troop_ensure_inventory_space,":party_slot_002",80),
(store_troop_gold,":troop_gold_009",":party_slot_002"),
(try_begin),
(gt,":troop_gold_009",3500),
(store_div, ":var___x1", ":troop_gold_009", 3000),
(assign,":var010",":var___x1"),
(store_mul, ":gold_011", ":var010", 3000),
(troop_remove_gold,":party_slot_002",":gold_011"),
(call_script, "script_change_center_prosperity", ":party_id_001", ":var010"),
(try_end),
]),

("refresh_village_defenders", [
(store_script_param, ":party_id_001", 1),
(try_begin),
(eq,1,1),
(party_get_num_companions,":party_num_companions_003",":party_id_001"),
(try_begin),
(lt,":party_num_companions_003",50), # var002
(party_add_template, ":party_id_001", "pt_village_defenders"),
(try_end),
(try_end),
]),

("village_set_state", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(eq,":var002",0),
(party_set_extra_text,":party_id_001", "str_empty_string"),
(party_set_slot,":party_id_001",34,-1),
(else_try),
(eq,":var002",1),
(party_set_extra_text,":party_id_001", ":"@"),
(else_try),
(eq,":var002",2),
(party_set_extra_text,":party_id_001", ":"@"),
(party_set_slot,":party_id_001",34,-1),
(call_script, "script_change_center_prosperity", ":party_id_001", -60),
(val_add, ":::newglob_total_prosperity_from_villageloot", -60),
(try_begin),
(eq,5,0),
(party_get_slot,":party_slot_003",":party_id_001",7),
(try_begin),
(is_between,":party_slot_003","trp_npc1","trp_knight_1_1_wife"),
(store_troop_faction,":troop_faction_004",":party_slot_003"),
(faction_get_slot,":faction_slot_005",":troop_faction_004",11),
(call_script, "script_troop_change_relation_with_troop", ":party_slot_003", ":faction_slot_005", -1),
(val_add, ":::total_battle_ally_changes", -1),
(try_end),
(try_end),
(else_try),
(eq,":var002",5),
(party_set_extra_text,":party_id_001", ":"@"),
(try_for_parties, ":cur_party"),
(gt,":cur_party","p_spawn_points_end"),
(party_slot_eq,":cur_party",0,11),
(party_slot_eq,":cur_party",5,":party_id_001"),
(party_get_slot,":party_slot_007",":cur_party",126),
(store_faction_of_party, ":party_faction_008", ":cur_party"),
(try_begin),
(call_script, "script_cf_select_most_profitable_town_at_peace_with_faction_in_trade_route", ":party_slot_007", ":party_faction_008"),
(assign,":var009",reg0),
(try_begin),
(is_between,":var009","p_town_1","p_salt_mine"),
(party_set_ai_behavior,":cur_party",1),
(party_set_ai_object,":cur_party",":cur_party"),
(party_set_flags, ":cur_party", 65536, 0),
(party_set_slot,":cur_party",4,13),
(party_set_slot,":cur_party",5,":var009"),
(try_end),
(try_end),
(try_end),
(try_end),
(party_set_slot,":party_id_001",35,":var002"),
]),

("process_village_raids", [
(try_for_range, ":p_001", ":p.village_1", ":p.salt_mine"),
(this_or_next|is_between,":p_001","p_village_16","p_village_23"),
(this_or_next|is_between,":p_001","p_village_49","p_village_51"),
(this_or_next|eq,":p_001","p_village_75"),
(is_between,":p_001","p_village_85","p_village_87"),
(assign,":var002",1297036692682702872),
(assign,":var003",1297036692682702873),
(assign,":var004",1297036692682702874),
(else_try),
(is_between,":p_001","p_village_91","p_salt_mine"),
(assign,":var002",1297036692682702865),
(assign,":var003",1297036692682702870),
(assign,":var004",1297036692682702871),
(else_try),
(assign,":var002",1297036692682702863),
(assign,":var003",1297036692682702866),
(assign,":var004",1297036692682702867),
(party_get_slot,":party_slot_005",":p_001",36),
(try_begin),
(party_slot_eq,":p_001",35,0),
(val_sub, ":party_slot_005", 5),
(val_max,":party_slot_005",0),
(party_set_slot,":p_001",36,":party_slot_005"),
(try_begin),
(lt,":party_slot_005",50),
(try_begin),
(eq,1,1),
(party_get_icon, ":party_icon_006", ":p_001"),
(neq,":party_icon_006",":var002"),
(party_set_icon, ":p_001", ":var002"),
(try_end),
(party_slot_ge,":p_001",38,1),
(party_set_slot,":p_001",38,0),
(party_clear_particle_systems, ":p_001"),
(try_end),
(else_try),
(party_slot_eq,":p_001",35,1),
(assign,":var007",1),
(party_get_slot,":party_slot_008",":p_001",34),
(try_begin),
(ge,":party_slot_008",0),
(party_is_active,":party_slot_008"),
(this_or_next|eq,":party_slot_008","p_main_party"),
(eq,":::g_player_is_captive",0),
(store_distance_to_party_from_party,":distance_parties_009",":p_001",":p_001"),
(try_begin),
(lt,":distance_parties_009",4),
(assign,":var007",0),
(try_end),
(try_end),
(try_begin),
(eq,":var007",1),
(call_script, "script_village_set_state", ":p_001", 0),
(party_set_slot,":p_001",38,0),
(party_clear_particle_systems, ":p_001"),
(else_try),
(assign,":var010",11),
(party_get_slot,":party_slot_011",":p_001",34),
(try_begin),
(eq,1,1),
(party_get_skill_level, ":party_skill_lvl_012", ":party_slot_011", "skl_looting"),
(val_add, ":var010", ":party_skill_lvl_012"),
(try_end),
(try_begin),
(party_slot_eq,":p_001",132,1),
(val_mul, ":var010", 2),
(val_div, ":var010", 3),
(try_end),
(val_add, ":party_slot_005", ":var010"),
(party_set_slot,":p_001",36,":party_slot_005"),
(try_begin),
(ge,":party_slot_005",50),
(party_slot_eq,":p_001",38,0),
(party_add_particle_system, ":p_001", "psys_map_village_fire"),
(party_add_particle_system, ":p_001", "psys_map_village_fire_smoke"),
(party_set_icon, ":p_001", ":var003"),
(party_set_slot,":p_001",38,1),
(try_end),
(try_begin),
(gt,":party_slot_005",100),
(str_store_string,s1,":str_store_party_name_link(p_001)"),
(party_stack_get_troop_id,      ":troop_id_013",":party_slot_011",0),
(try_begin),
(ge,":troop_id_013",0),
(str_store_string,s2,":str_store_party_name(party_slot_011)"),
(display_log_message,":"),
(try_begin),
(eq,1,1),
(party_get_slot,":party_slot_014",":p_001",7),
(try_begin),
(is_between,":party_slot_014","trp_npc1","trp_knight_1_1_wife"),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_013", ":party_slot_014", -1),
(val_add, ":::total_battle_enemy_changes", -1),
(try_end),
(try_end),
(try_end),
(troop_get_slot,":troop_slot_015",":troop_id_013",11),
(party_get_slot,":party_slot_016",":p_001",0),
(store_mul, ":var017", ":party_slot_016", 60),
(val_add, ":troop_slot_015", ":var017"),
(troop_set_slot,":troop_id_013",11,":troop_slot_015"),
(try_begin),
(is_between,":party_slot_014","trp_npc1","trp_knight_1_1_wife"),
(troop_get_slot,":troop_slot_018",":party_slot_014",11),
(val_sub, ":troop_slot_018", ":var017"),
(val_max,":troop_slot_018",0),
(troop_set_slot,":party_slot_014",11,":troop_slot_018"),
(try_end),
(call_script, "script_village_set_state", ":p_001", 2),
(party_set_slot,":p_001",47,0),
(party_set_slot,":p_001",48,0),
(party_set_slot,":p_001",36,0),
(party_set_slot,":p_001",37,0),
(try_begin),
(eq,1,1),
(store_faction_of_party, ":party_faction_019", ":p_001"),
(try_begin),
(this_or_next|party_slot_eq,":p_001",7,"trp_player"),
(eq,":party_faction_019","fac_player_supporters_faction"),
(call_script, "script_add_notification_menu", "mnu_notification_village_raided", ":p_001", ":troop_id_013"),
(try_end),
(try_end),
(call_script, "script_add_log_entry", 1, ":troop_id_013", ":p_001", -1, -1),
(store_faction_of_party, ":party_faction_020", ":party_slot_011"),
(call_script, "script_faction_inflict_war_damage_on_faction", ":party_faction_020", ":party_faction_019", 5),
(try_end),
(try_end),
(else_try),
(party_slot_eq,":p_001",35,2),
(party_get_slot,":party_slot_021",":p_001",37),
(val_add, ":party_slot_021", 1),
(party_set_slot,":p_001",37,":party_slot_021"),
(try_begin),
(ge,":party_slot_021",10),
(party_slot_eq,":p_001",38,1),
(party_clear_particle_systems, ":p_001"),
(party_add_particle_system, ":p_001", "psys_map_village_looted_smoke"),
(party_set_slot,":p_001",38,2),
(try_end),
(try_begin),
(gt,":party_slot_021",50),
(party_slot_eq,":p_001",38,2),
(party_clear_particle_systems, ":p_001"),
(party_set_slot,":p_001",38,3),
(party_set_icon, ":p_001", ":var004"),
(try_end),
(try_begin),
(gt,":party_slot_021",100),
(call_script, "script_village_set_state", ":p_001", 0),
(party_set_slot,":p_001",37,0),
(party_clear_particle_systems, ":p_001"),
(party_set_slot,":p_001",38,0),
(party_set_icon, ":p_001", ":var002"),
(try_end),
(try_end),
(try_end),
]),

("process_sieges", [
(try_for_range, ":p_001", ":p.town_1", ":p.village_1"),
(party_get_slot,":party_slot_002",":p_001",65),
(val_sub, ":party_slot_002", 20),
(val_max,":party_slot_002",0),
(party_set_slot,":p_001",65,":party_slot_002"),
(party_get_slot,":party_slot_003",":p_001",53),
(call_script, "script_center_get_food_store_limit", ":p_001"),
(assign,":var004",reg0),
(try_begin),
(eq,1,1),
(party_get_slot,":party_slot_005",":p_001",54),
(try_begin),
(ge,":party_slot_005",0),
(try_begin),
(eq,1,1),
(try_begin),
(is_between,":p_001","p_castle_1","p_village_1"),
(store_random_in_range,":random_x_006",0,3),
(try_begin),
(eq,":random_x_006",0),
(assign,":var007",-1),
(else_try),
(assign,":var007",0),
(try_end),
(try_end),
(else_try),
(assign,":var007",-4),
(try_end),
(call_script, "script_change_center_prosperity", ":p_001", ":var007"),
(val_add, ":::newglob_total_prosperity_from_townloot", ":var007"),
(try_end),
(store_faction_of_party, ":party_faction_008", ":p_001"),
(assign,":var009",0),
(eq,1,1),
(try_begin),
(neg|party_is_active,":party_slot_005"),
(assign,":var009",1),
(else_try),
(store_distance_to_party_from_party,":distance_parties_010",":p_001",":p_001"),
(try_begin),
(gt,":distance_parties_010",5),
(assign,":var009",1),
(else_try),
(store_faction_of_party, ":party_faction_011", ":party_slot_005"),
(store_relation,":faction_relation_012",":party_faction_011",":party_faction_008"),
(try_begin),
(ge,":faction_relation_012",0),
(assign,":var009",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var009",1),
(try_for_range, ":trp_013", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_013",2,2),
(troop_get_slot,":troop_slot_014",":trp_013",10),
(ge,":troop_slot_014",0),
(party_is_active,":troop_slot_014"),
(store_faction_of_party, ":party_faction_015", ":troop_slot_014"),
(store_relation,":faction_relation_012",":party_faction_015",":party_faction_008"),
(lt,":faction_relation_012",0),
(store_distance_to_party_from_party,":distance_parties_016",":p_001",":p_001"),
(lt,":distance_parties_016",4),
(assign,":party_slot_005",":troop_slot_014"),
(party_set_slot,":p_001",54,":troop_slot_014"),
(assign,":var009",0),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var009",1),
(call_script, "script_lift_siege", ":p_001", 1),
(else_try),
(call_script, "script_center_get_food_consumption", ":p_001"),
(assign,":var017",reg0),
(val_sub, ":party_slot_003", ":var017"),
(try_begin),
(le,":party_slot_003",0),
(store_random_in_range,":random_x_018",0,100),
(try_begin),
(lt,":random_x_018",10),
(call_script, "script_party_wound_all_members", ":p_001"),
(try_end),
(try_end),
(try_end),
(else_try),
(val_add, ":party_slot_003", 30),
(val_min,":party_slot_003",":var004"),
(val_max,":party_slot_003",0),
(party_set_slot,":p_001",53,":party_slot_003"),
(try_end),
]),

("lift_siege", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_set_slot,":party_id_001",54,-1),
(call_script, "script_village_set_state", ":party_id_001", 0),
(try_begin),
(eq,":party_id_001",":::g_player_besiege_town"),
(assign,"$g_siege_method",0),
(try_end),
(try_begin),
(eq,":var002",1),
(str_store_string,s3,":str_store_party_name_link(party_id_001)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
]),

("process_alarms", [
(assign,":var001","$g_alarm_modula"),
(val_add, ":::g_alarm_modula", 1),
(try_begin),
(eq,":::g_alarm_modula",3),
(assign,"$g_alarm_modula",0),
(try_end),
(try_for_range, ":p_002", ":p.town_1", ":p.salt_mine"),
(store_mod,":var003",":p_002",3),
(try_begin),
(eq,":var003",":var001"),
(party_set_slot,":p_002",55,-1),
(party_set_slot,":p_002",66,0),
(party_set_slot,":p_002",67,0),
(assign,":var004",3),
(try_begin),
(is_currently_night),
(assign,":var004",2),
(try_end),
(try_end),
(try_begin),
(party_slot_eq,":p_002",132,1),
(val_mul, ":var004", 2),
(else_try),
(neg|is_between,":p_002","p_village_1","p_salt_mine"),
(val_add, ":var004", 1),
(val_mul, ":var004", 2),
(try_end),
(store_faction_of_party, ":party_faction_005", ":p_002"),
(try_for_parties, ":cur_party"),
(this_or_next|party_slot_eq,":cur_party",0,13),
(eq,":cur_party","p_main_party"),
(store_faction_of_party, ":party_faction_007", ":cur_party"),
(try_begin),
(eq,":cur_party","p_main_party"),
(assign,":party_faction_007","$players_kingdom"),
(try_end),
(try_begin),
(eq,":party_faction_007",":party_faction_005"),
(store_distance_to_party_from_party,":distance_parties_008",":cur_party",":cur_party"),
(try_begin),
(le,":distance_parties_008",":var004"),
(party_get_slot,":party_slot_009",":cur_party",56),
(party_get_slot,":party_slot_010",":p_002",66),
(val_add, ":party_slot_010", ":party_slot_009"),
(party_set_slot,":p_002",66,":party_slot_010"),
(else_try),
(neq,":party_faction_007",":party_faction_005"),
(store_distance_to_party_from_party,":distance_parties_008",":cur_party",":cur_party"),
(try_begin),
(lt,":distance_parties_008",10),
(store_current_hours,":cur_hours_011"),
(store_sub, ":slot_no_012", ":party_faction_007", ":fac.player_supporters_faction"),
(val_add, ":slot_no_012", 350),
(party_set_slot,":p_002",":slot_no_012",":cur_hours_011"),
(try_end),
(try_end),
(store_relation,":faction_relation_013",":party_faction_005",":party_faction_007"),
(try_begin),
(lt,":faction_relation_013",0),
(le,":distance_parties_008",":var004"),
(party_get_slot,":party_slot_009",":cur_party",56),
(party_get_slot,":party_slot_014",":p_002",67),
(val_add, ":party_slot_014", ":party_slot_009"),
(party_set_slot,":p_002",67,":party_slot_014"),
(party_set_slot,":p_002",55,":cur_party"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_for_range, ":p_002", ":p.town_1", ":p.salt_mine"),
(store_mod,":var003",":p_002",3),
(try_begin),
(eq,":var003",":var001"),
(try_begin),
(is_between,":p_002","p_town_1","p_village_1"),
(party_slot_ge,":p_002",55,0),
(party_get_slot,":party_slot_010",":p_002",66),
(party_get_slot,":party_slot_014",":p_002",67),
(party_get_battle_opponent, ":party_battle_opponent_015", ":p_002"),
(try_begin),
(ge,":::cheat_mode",1),
(ge,":party_battle_opponent_015",0),
(str_store_string,s7,":str_store_party_name(p_002)"),
(str_store_string,s6,":str_store_party_name(party_battle_opponent_015)"),
(display_message, "@@{!}DEBUG : There are already enemies ({s6}) inside {s7}."),
(try_end),
(try_end),
(try_begin),
(lt,":party_battle_opponent_015",0),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_party_name(p_002)"),
(assign,reg3,":party_slot_010"),
(assign,reg4,":party_slot_014"),
(display_message, "@@{!}DEBUG -- Calculating sortie for {s4} strength of {reg3} vs {reg4} enemies"),
(try_end),
(try_end),
(store_mul, ":var016", ":party_slot_014", 14),
(val_div, ":var016", 10),
(try_begin),
(gt,":party_slot_010",":var016"),
(assign,":var017",0),
(try_for_parties, ":cur_party"),
(party_get_attached_to, ":party_attached_019", ":cur_party"),
(eq,":party_attached_019",":p_002"),
(party_slot_eq,":cur_party",0,13),
(party_get_slot,":party_slot_009",":cur_party",56),
(ge,":party_slot_009",100),
(party_detach, ":cur_party"),
(call_script, "script_party_set_ai_state", ":cur_party", 4, ":p_002"),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_party_name(cur_party)"),
(display_message, "str_s4_sorties"),
(try_end),
(eq,":var017",0),
(assign,":var017",":cur_party"),
(try_end),
(party_is_in_town,"p_main_party",":p_002"),
(eq,":::g_player_is_captive",0),
(gt,":var017",0),
(call_script, "script_add_notification_menu", "mnu_notification_sortie_possible", ":p_002", ":cur_party"),
(try_end),
(store_faction_of_party, ":party_faction_005", ":p_002"),
(this_or_next|eq,":::cheat_mode",1),
(this_or_next|party_slot_eq,":p_002",7,"trp_player"),
(eq,":party_faction_005",":::players_kingdom"),
(party_get_slot,":party_slot_020",":p_002",55),
(ge,":party_slot_020",0),
(store_distance_to_party_from_party,":distance_parties_021","p_main_party","p_main_party"),
(assign,":var022",0),
(this_or_next|party_slot_eq,":p_002",7,"trp_player"),
(eq,":party_faction_005","fac_player_supporters_faction"),
(party_slot_eq,":p_002",134,1),
(assign,":var022",1),
(try_end),
(this_or_next|eq,":::cheat_mode",1),
(this_or_next|ge,":distance_parties_021",30),
(eq,":var022",1),
(str_store_string,s1,":str_store_party_name_link(p_002)"),
(party_get_slot,":party_slot_023",":p_002",67),
(try_begin),
(lt,":party_slot_023",500),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(lt,":party_slot_023",1000),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(lt,":party_slot_023",2000),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(lt,":party_slot_023",4000),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(lt,":party_slot_023",8000),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(lt,":party_slot_023",16000),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_end),
]),

("allow_vassals_to_join_indoor_battle", [
(try_for_range, ":trp_001", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_001",2,2),
(neg|troop_slot_ge,":trp_001",8,0),
(troop_get_slot,":troop_slot_002",":trp_001",10),
(try_begin),
(gt,":troop_slot_002",0),
(party_is_active,":troop_slot_002"),
(party_get_attached_to, ":party_attached_003", ":troop_slot_002"),
(lt,":party_attached_003",0),
(store_troop_faction,":troop_faction_004",":trp_001"),
(party_slot_eq,":troop_slot_002",4,11),
(party_get_slot,":party_slot_005",":troop_slot_002",5),
(gt,":party_slot_005",0),
(party_is_active,":party_slot_005"),
(assign,":party_battle_opponent_006",-1),
(party_slot_eq,":party_slot_005",4,7),
(party_get_slot,":party_slot_007",":party_slot_005",5),
(party_get_battle_opponent, ":party_battle_opponent_008", ":party_slot_007"),
(try_begin),
(party_is_active,":party_battle_opponent_008"),
(assign,":party_battle_opponent_006",":party_slot_007"),
(assign,":party_slot_007",":party_battle_opponent_008"),
(else_try),
(party_slot_eq,":party_slot_005",4,10),
(party_get_slot,":party_slot_007",":party_slot_005",5),
(try_begin),
(ge,":party_slot_007",0),
(neg|is_between,":party_slot_007","p_town_1","p_salt_mine"),
(party_is_active,":party_slot_007"),
(party_get_battle_opponent, ":party_battle_opponent_006", ":party_slot_007"),
(else_try),
(assign,":party_battle_opponent_006",-1),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":party_battle_opponent_006","p_town_1","p_village_1"),
(party_get_attached_to, ":party_attached_009", ":party_slot_005"),
(eq,":party_attached_009",":party_battle_opponent_006"),
(store_faction_of_party, ":party_faction_010", ":party_battle_opponent_006"),
(eq,":party_faction_010",":troop_faction_004"),
(party_is_active,":party_slot_007"),
(call_script, "script_party_set_ai_state", ":troop_slot_002", 10, ":party_slot_007"),
(eq,":::cheat_mode",1),
(str_store_string,s7,":str_store_party_name(troop_slot_002)"),
(str_store_string,s6,":str_store_party_name(party_slot_007)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(else_try),
(party_slot_eq,":troop_slot_002",4,11),
(party_get_slot,":party_slot_005",":troop_slot_002",5),
(try_begin),
(gt,":party_slot_005",0),
(party_is_active,":party_slot_005"),
(party_get_battle_opponent, ":party_battle_opponent_006", ":party_slot_005"),
(try_begin),
(is_between,":party_battle_opponent_006","p_town_1","p_village_1"),
(party_get_attached_to, ":party_attached_009", ":troop_slot_002"),
(try_begin),
(neq,":party_attached_009",":party_battle_opponent_006"),
(party_is_active,":party_battle_opponent_006"),
(call_script, "script_party_set_ai_state", ":troop_slot_002", 10, ":party_battle_opponent_006"),
(try_end),
(try_end),
(try_end),
(try_end),
]),

("party_set_ai_state", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(party_get_slot,":party_slot_004",":party_id_001",4),
(party_get_slot,":party_slot_005",":party_id_001",5),
(party_get_attached_to, ":party_attached_006", ":party_id_001"),
(assign,":var007",0),
(try_begin),
(is_between,":party_attached_006","p_town_1","p_salt_mine"),
(assign,":var007",":party_attached_006"),
(try_end),
(assign,":troop_id_008",-1),
(try_begin),
(party_is_active,":party_id_001"),
(party_stack_get_troop_id,      ":troop_id_008",":party_id_001",0),
(store_faction_of_party, ":party_faction_009", ":party_id_001"),
(try_end),
(try_begin),
(lt,":troop_id_008",0),
(else_try),
(try_begin),
(is_between,":var007","p_town_1","p_village_1"),
(party_slot_eq,":var007",54,-1),
(call_script, "script_troop_does_business_in_center", ":troop_id_008", ":var007"),
(else_try),
(party_slot_eq,":party_id_001",4,16),
(party_get_slot,":party_slot_010",":party_id_001",5),
(try_begin),
(is_between,":party_slot_010","p_village_1","p_salt_mine"),
(neg|party_slot_eq,":party_slot_010",35,1),
(neg|party_slot_eq,":party_slot_010",35,2),
(store_distance_to_party_from_party,":distance_parties_011",":party_id_001",":party_id_001"),
(try_begin),
(lt,":distance_parties_011",3),
(call_script, "script_troop_does_business_in_center", ":troop_id_008", ":party_slot_010"),
(try_end),
(try_end),
(try_end),
(party_set_slot,":party_id_001",63,0),
(try_begin),
(eq,":party_slot_004",":var002"),
(eq,":party_slot_005",":var003"),
(else_try),
(assign,":var012",100),
(assign,":party_aggressiveness_013",8),
(assign,":party_courage_014",8),
(try_begin),
(this_or_next|eq,":var002",12),
(eq,":var002",11),
(party_set_ai_behavior,":party_id_001",10),
(party_set_ai_object,":party_id_001",":party_id_001"),
(party_set_flags, ":party_id_001", 65536, 0),
(try_begin),
(gt,":var007",0),
(party_detach, ":party_id_001"),
(try_end),
(try_begin),
(eq,":var002",12),
(assign,":party_aggressiveness_013",9),
(assign,":party_courage_014",9),
(assign,":var012",80),
(else_try),
(assign,":party_aggressiveness_013",6),
(assign,":party_courage_014",9),
(assign,":var012",10),
(try_end),
(else_try),
(eq,":var002",1),
(party_get_position,pos1,":var003"),
(map_get_random_position_around_position,pos2,1,2),
(party_set_ai_behavior,":party_id_001",6),
(party_set_ai_target_position,":party_id_001",2),
(party_set_ai_object,":party_id_001",":party_id_001"),
(party_set_flags, ":party_id_001", 65536, 0),
(party_set_slot,":party_id_001",63,1),
(party_set_slot,":party_id_001",8,0),
(try_begin),
(gt,":var007",0),
(neq,":var007",":var003"),
(party_detach, ":party_id_001"),
(try_end),
(assign,":party_aggressiveness_013",1),
(assign,":party_courage_014",9),
(assign,":var012",20),
(else_try),
(eq,":var002",7),
(party_set_ai_behavior,":party_id_001",1),
(party_set_ai_object,":party_id_001",":party_id_001"),
(party_set_flags, ":party_id_001", 65536, 0),
(try_begin),
(gt,":var007",0),
(neq,":var007",":var003"),
(party_detach, ":party_id_001"),
(try_end),
(assign,":party_aggressiveness_013",7),
(assign,":party_courage_014",9),
(assign,":var012",100),
(else_try),
(eq,":var002",4),
(party_get_position,pos1,":var003"),
(map_get_random_position_around_position,pos2,1,1),
(party_set_ai_behavior,":party_id_001",6),
(party_set_ai_target_position,":party_id_001",2),
(party_set_ai_object,":party_id_001",":party_id_001"),
(try_begin),
(faction_slot_eq,":party_faction_009",4,5),
(party_set_ai_patrol_radius,":party_id_001",1),
(else_try),
(party_set_ai_patrol_radius,":party_id_001",5),
(try_end),
(party_set_flags, ":party_id_001", 65536, 0),
(party_set_slot,":party_id_001",63,1),
(party_set_slot,":party_id_001",8,0),
(try_begin),
(gt,":var007",0),
(party_detach, ":party_id_001"),
(try_end),
(try_begin),
(ge,":troop_id_008",0),
(faction_slot_eq,":party_faction_009",8,":troop_id_008"),
(faction_slot_eq,":party_faction_009",4,5),
(party_get_position,pos3,":party_id_001"),
(get_distance_between_positions,":distance_015",1,3),
(try_begin),
(ge,":distance_015",800),
(assign,":var012",10),
(assign,":party_aggressiveness_013",1),
(assign,":party_courage_014",8),
(else_try),
(assign,":var012",100),
(assign,":party_aggressiveness_013",8),
(assign,":party_courage_014",8),
(try_end),
(else_try),
(assign,":party_aggressiveness_013",8),
(assign,":party_courage_014",8),
(assign,":var012",100),
(try_end),
(else_try),
(eq,":var002",16),
(party_get_position,pos1,":var003"),
(map_get_random_position_around_position,pos2,1,2),
(party_set_ai_behavior,":party_id_001",6),
(party_set_ai_target_position,":party_id_001",2),
(party_set_ai_object,":party_id_001",":party_id_001"),
(party_set_flags, ":party_id_001", 65536, 0),
(party_set_slot,":party_id_001",8,0),
(try_begin),
(gt,":var007",0),
(neq,":var007",":var003"),
(party_detach, ":party_id_001"),
(try_end),
(assign,":party_aggressiveness_013",8),
(assign,":party_courage_014",8),
(assign,":var012",100),
(else_try),
(eq,":var002",5),
(party_get_position,pos1,":var003"),
(map_get_random_position_around_position,pos2,1,1),
(party_set_ai_behavior,":party_id_001",2),
(party_set_ai_patrol_radius,":party_id_001",10),
(party_set_ai_target_position,":party_id_001",2),
(party_set_ai_object,":party_id_001",":party_id_001"),
(party_set_flags, ":party_id_001", 65536, 0),
(party_set_slot,":party_id_001",63,1),
(party_set_slot,":party_id_001",8,0),
(try_begin),
(gt,":var007",0),
(neq,":var007",":var003"),
(party_detach, ":party_id_001"),
(try_end),
(try_begin),
(ge,":troop_id_008",0),
(faction_slot_eq,":party_faction_009",8,":troop_id_008"),
(assign,":party_aggressiveness_013",1),
(assign,":party_courage_014",8),
(assign,":var012",20),
(else_try),
(assign,":party_aggressiveness_013",7),
(assign,":party_courage_014",8),
(assign,":var012",100),
(try_end),
(else_try),
(eq,":var002",10),
(party_set_ai_behavior,":party_id_001",4),
(party_set_ai_object,":party_id_001",":party_id_001"),
(party_set_flags, ":party_id_001", 65536, 0),
(try_begin),
(gt,":var007",0),
(party_detach, ":party_id_001"),
(try_end),
(try_begin),
(ge,":troop_id_008",0),
(faction_slot_eq,":party_faction_009",8,":troop_id_008"),
(faction_slot_eq,":party_faction_009",4,5),
(assign,":var012",10),
(assign,":party_aggressiveness_013",1),
(assign,":party_courage_014",8),
(else_try),
(assign,":party_aggressiveness_013",8),
(assign,":party_courage_014",8),
(assign,":var012",100),
(try_end),
(else_try),
(eq,":var002",14),
(party_set_ai_behavior,":party_id_001",1),
(party_set_ai_object,":party_id_001",":party_id_001"),
(party_set_flags, ":party_id_001", 65536, 1),
(party_set_slot,":party_id_001",30,-1),
(try_begin),
(gt,":var007",0),
(neq,":var007",":var003"),
(party_detach, ":party_id_001"),
(try_end),
(assign,":party_aggressiveness_013",3),
(assign,":party_courage_014",4),
(assign,":var012",100),
(else_try),
(eq,":var002",-1),
(party_set_ai_behavior,":party_id_001",0),
(party_set_flags, ":party_id_001", 65536, 0),
(try_end),
(try_begin),
(troop_slot_eq,":troop_id_008",52,1),
(val_add, ":party_aggressiveness_013", 2),
(val_add, ":party_courage_014", 2),
(else_try),
(troop_slot_eq,":troop_id_008",52,5),
(val_sub, ":party_aggressiveness_013", 1),
(val_sub, ":party_courage_014", 1),
(try_end),
(party_set_slot,":party_id_001",4,":var002"),
(party_set_slot,":party_id_001",5,":var003"),
(party_set_aggressiveness, ":party_id_001", ":party_aggressiveness_013"),
(party_set_courage, ":party_id_001", ":party_courage_014"),
(party_set_ai_initiative,":party_id_001",":var012"),
(try_end),
(try_end),
(try_begin),
(ge,":troop_id_008",0),
(party_set_helpfulness, ":party_id_001", 101),
(try_begin),
(troop_slot_eq,":troop_id_008",52,1),
(party_set_helpfulness, ":party_id_001", 200),
(else_try),
(troop_slot_eq,":troop_id_008",52,7),
(party_set_helpfulness, ":party_id_001", 150),
(else_try),
(party_slot_eq,":party_id_001",4,11),
(party_set_helpfulness, ":party_id_001", 110),
(else_try),
(troop_slot_eq,":troop_id_008",52,2),
(party_set_helpfulness, ":party_id_001", 90),
(else_try),
(troop_slot_eq,":troop_id_008",52,3),
(party_set_helpfulness, ":party_id_001", 80),
(else_try),
(troop_slot_eq,":troop_id_008",52,5),
(party_set_helpfulness, ":party_id_001", 50),
(try_end),
(try_end),
]),

("cf_party_under_player_suggestion", [
(store_script_param, ":party_id_001", 1),
(try_begin),
(party_slot_eq,":party_id_001",244,"trp_kingdom_heroes_including_player_begin"),
(party_get_slot,":party_slot_002",":party_id_001",4),
(try_begin),
(party_slot_eq,":party_id_001",245,":party_slot_002"),
(party_get_slot,":party_slot_003",":party_id_001",5),
(party_slot_eq,":party_id_001",246,":party_slot_003"),
(store_current_hours,":cur_hours_004"),
(party_get_slot,":party_slot_005",":party_id_001",247),
(val_sub, ":cur_hours_004", ":party_slot_005"),
(try_end),
(try_end),
]),

("troop_does_business_in_center", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":party_id_002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_001",10),
(store_current_hours,":cur_hours_004"),
(try_begin),
(is_between,":party_id_002","p_town_1","p_village_1"),
(party_set_slot,":troop_slot_003",71,":cur_hours_004"),
(try_begin),
(eq,1,1),
(call_script, "script_lord_get_home_center", ":troop_id_001"),
(eq,":party_id_002",reg0),
(party_set_slot,":troop_slot_003",69,":cur_hours_004"),
(try_end),
(try_end),
(try_begin),
(party_slot_eq,":party_id_002",7,":troop_id_001"),
(party_get_slot,":party_slot_005",":party_id_002",47),
(party_get_slot,":party_slot_006",":party_id_002",48),
(troop_get_slot,":troop_slot_007",":troop_id_001",11),
(val_add, ":troop_slot_007", ":party_slot_005"),
(val_add, ":troop_slot_007", ":party_slot_006"),
(troop_set_slot,":troop_id_001",11,":troop_slot_007"),
(party_set_slot,":party_id_002",47,0),
(party_set_slot,":party_id_002",48,0),
(try_begin),
(this_or_next|eq,":::cheat_mode",3),
(eq,":::cheat_mode",1),
(assign,reg1,":troop_slot_007"),
(str_store_string,s4,":str_store_party_name(party_id_002)"),
(add_troop_note_from_sreg,":troop_id_001",1,"str_current_wealth_reg1_taxes_last_collected_from_s4", 0),
(try_end),
(try_end),
(try_begin),
(is_between,":party_id_002","p_village_1","p_salt_mine"),
(party_get_slot,":party_slot_008",":party_id_002",90),
(party_get_slot,":party_slot_009",":party_id_002",91),
(party_set_slot,":party_id_002",91,-1),
(party_add_members,":troop_slot_003",":party_slot_008",":party_slot_009"),
(try_end),
(try_begin),
(eq,1,1),
(party_get_slot,":party_slot_010",":troop_slot_003",70),
(store_sub, ":var011", ":cur_hours_004", ":party_slot_010"),
(try_begin),
(gt,":var011",72),
(troop_slot_eq,":troop_id_001",30,-1),
(try_for_range, ":slot_no_012", 35, 38),
(troop_get_slot,":troop_slot_013",":troop_id_001",":slot_no_012"),
(gt,":troop_slot_013",0),
(troop_get_slot,":troop_slot_014",":troop_slot_013",12),
(eq,":party_id_002",":troop_slot_014"),
(call_script, "script_courtship_event_troop_court_lady", ":troop_id_001", ":troop_slot_013"),
(party_set_slot,":troop_slot_003",70,":cur_hours_004"),
(try_end),
(try_end),
(try_end),
]),

("process_kingdom_parties_ai", [
(try_for_range, ":trp_001", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_001",2,2),
(neg|troop_slot_ge,":trp_001",8,0),
(troop_get_slot,":troop_slot_002",":trp_001",10),
(gt,":troop_slot_002",0),
(call_script, "script_process_hero_ai", ":trp_001"),
(try_end),
(try_end),
]),

("process_hero_ai", [
(store_script_param, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_002",":troop_id_001",10),
(try_begin),
(party_is_active,":troop_slot_002"),
(store_faction_of_party, ":party_faction_003", ":troop_slot_002"),
(party_get_slot,":party_slot_004",":troop_slot_002",4),
(party_get_slot,":party_slot_005",":troop_slot_002",5),
(try_begin),
(eq,":party_slot_004",1),
(try_begin),
(party_slot_eq,":party_slot_005",54,-1),
(store_distance_to_party_from_party,":distance_parties_006",":troop_slot_002",":troop_slot_002"),
(try_begin),
(lt,":distance_parties_006",3),
(try_begin),
(party_slot_eq,":troop_slot_002",4,11),
(party_get_slot,":party_slot_007",":troop_slot_002",5),
(party_set_slot,":party_slot_005",54,":party_slot_007"),
(else_try),
(party_set_slot,":party_slot_005",54,":troop_slot_002"),
(try_end),
(try_end),
(store_current_hours,":cur_hours_008"),
(party_set_slot,":party_slot_005",64,":cur_hours_008"),
(str_store_string,s1,":str_store_party_name_link(party_slot_005)"),
(str_store_string,s2,":str_store_troop_name_link(troop_id_001)"),
(str_store_string,s3,":str_store_faction_name_link(party_faction_003)"),
(display_log_message,":"),
(try_begin),
(eq,1,1),
(store_faction_of_party, ":party_faction_009", ":party_slot_005"),
(try_begin),
(this_or_next|party_slot_eq,":party_slot_005",7,"trp_player"),
(eq,":party_faction_009","fac_player_supporters_faction"),
(call_script, "script_add_notification_menu", "mnu_notification_center_under_siege", ":party_slot_005", ":troop_id_001"),
(try_end),
(try_end),
(call_script, "script_village_set_state", ":party_slot_005", 5),
(assign,"$g_recalculate_ais",1),
(try_end),
(else_try),
(eq,":party_slot_004",5),
(party_slot_eq,":troop_slot_002",8,0),
(assign,":var010",0),
(try_for_range, ":p_011", ":p.village_1", ":p.salt_mine"),
(eq,":var010",0),
(store_faction_of_party, ":party_faction_012", ":p_011"),
(try_begin),
(party_slot_eq,":p_011",7,"trp_player"),
(store_relation,":faction_relation_013","fac_player_supporters_faction",":party_faction_003"),
(else_try),
(store_relation,":faction_relation_013",":party_faction_012",":party_faction_003"),
(try_end),
(try_begin),
(lt,":faction_relation_013",0),
(store_distance_to_party_from_party,":distance_parties_014",":p_011",":p_011"),
(try_begin),
(lt,":distance_parties_014",15),
(party_slot_eq,":p_011",35,0),
(assign,":var010",":p_011"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var010",0),
(is_between,":party_slot_005","p_village_1","p_salt_mine"),
(assign,":var010",":party_slot_005"),
(try_end),
(try_begin),
(gt,":var010",0),
(call_script, "script_party_set_ai_state", ":troop_slot_002", 5, ":var010"),
(try_begin),
(faction_slot_eq,":party_faction_003",8,":troop_id_001"),
(faction_slot_eq,":party_faction_003",4,3),
(faction_set_slot,":party_faction_003",5,":var010"),
(try_end),
(party_get_position,pos1,":var010"),
(map_get_random_position_around_position,pos2,1,1),
(party_set_ai_behavior,":troop_slot_002",6),
(party_set_ai_target_position,":troop_slot_002",2),
(party_set_ai_object,":troop_slot_002",":troop_slot_002"),
(party_set_slot,":troop_slot_002",8,1),
(try_end),
(else_try),
(eq,":party_slot_004",5),
(try_begin),
(eq,1,1),
(store_distance_to_party_from_party,":distance_parties_006",":troop_slot_002",":troop_slot_002"),
(try_begin),
(lt,":distance_parties_006",2),
(try_begin),
(party_slot_eq,":party_slot_005",35,0),
(call_script, "script_village_set_state", ":party_slot_005", 1),
(party_set_slot,":party_slot_005",34,":troop_slot_002"),
(try_begin),
(eq,1,1),
(store_faction_of_party, ":party_faction_015", ":party_slot_005"),
(try_begin),
(this_or_next|party_slot_eq,":party_slot_005",7,"trp_player"),
(eq,":party_faction_015","fac_player_supporters_faction"),
(store_distance_to_party_from_party,":distance_parties_014","p_main_party","p_main_party"),
(try_begin),
(this_or_next|ge,":distance_parties_014",30),
(party_slot_eq,":party_slot_005",134,1),
(call_script, "script_add_notification_menu", "mnu_notification_village_raid_started", ":party_slot_005", ":troop_id_001"),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(party_slot_eq,":party_slot_005",35,1),
(else_try),
(party_set_slot,":troop_slot_002",8,0),
(try_end),
(try_end),
(else_try),
(eq,":party_slot_004",14),
(try_begin),
(eq,1,1),
(party_get_battle_opponent, ":party_battle_opponent_016", ":troop_slot_002"),
(try_begin),
(ge,":party_battle_opponent_016",0),
(call_script, "script_party_set_ai_state", ":troop_slot_002", -1, -1),
(party_set_flags, ":troop_slot_002", 65536, 0),
(party_set_slot,":troop_slot_002",30,-1),
(try_end),
(try_end),
(else_try),
(eq,":party_slot_004",4),
(try_begin),
(party_slot_eq,":troop_slot_002",8,0),
(store_distance_to_party_from_party,":distance_parties_006",":troop_slot_002",":troop_slot_002"),
(try_begin),
(lt,":distance_parties_006",6),
(party_set_slot,":troop_slot_002",8,1),
(party_set_aggressiveness, ":troop_slot_002", 8),
(party_set_courage, ":troop_slot_002", 8),
(party_set_ai_initiative,":troop_slot_002",100),
(party_set_ai_behavior,":troop_slot_002",3),
(party_set_ai_object,":troop_slot_002",":troop_slot_002"),
(try_end),
(try_end),
(else_try),
(eq,":party_slot_004",7),
(try_end),
(try_end),
]),

("begin_assault_on_center", [
(store_script_param, ":var001", 1),
(try_for_range, ":trp_002", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_002",2,2),
(neg|troop_slot_ge,":trp_002",8,0),
(troop_get_slot,":troop_slot_003",":trp_002",10),
(gt,":troop_slot_003",0),
(party_is_active,":troop_slot_003"),
(assign,":var004",0),
(try_begin),
(party_slot_eq,":troop_slot_003",4,1),
(party_slot_eq,":troop_slot_003",5,":var001"),
(party_slot_eq,":troop_slot_003",8,0),
(assign,":var004",1),
(else_try),
(party_slot_eq,":troop_slot_003",4,11),
(party_get_slot,":party_slot_005",":troop_slot_003",5),
(try_begin),
(gt,":party_slot_005",0),
(party_is_active,":party_slot_005"),
(party_slot_eq,":party_slot_005",4,1),
(party_slot_eq,":party_slot_005",5,":var001"),
(call_script, "script_party_set_ai_state", ":troop_slot_003", 1, ":var001"),
(assign,":var004",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var004",1),
(party_set_ai_behavior,":troop_slot_003",4),
(party_set_ai_object,":troop_slot_003",":troop_slot_003"),
(party_set_flags, ":troop_slot_003", 65536, 1),
(party_set_slot,":troop_slot_003",8,1),
(try_end),
(try_end),
]),

("select_faction_marshall", [
]),

("get_center_faction_relation_including_player", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_faction_of_party, ":party_faction_003", ":var001"),
(store_relation,":faction_relation_004",":party_faction_003",":var002"),
(try_begin),
(party_slot_eq,":var001",7,"trp_player"),
(store_relation,":faction_relation_004","fac_player_supporters_faction",":var002"),
(try_end),
(assign,reg0,":faction_relation_004"),
]),

("update_report_to_army_quest_note", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(try_begin),
(neg|le,":::number_of_report_to_army_quest_notes",13),
(faction_get_slot,":faction_slot_004",":faction_id_001",8),
(try_begin),
(eq,":faction_id_001",":::players_kingdom"),
(neq,":var002",":var003"),
(check_quest_active,"qst_report_to_army"),
(ge,":faction_slot_004",0),
(str_store_string,s11,":str_store_troop_name_link(faction_slot_004)"),
(store_current_hours,":cur_hours_005"),
(call_script, "script_game_get_date_text", 0, ":cur_hours_005"),
(try_begin),
(this_or_next|eq,":var002",1),
(this_or_next|eq,":var002",2),
(eq,":var002",5),
(faction_get_slot,":faction_slot_006",":faction_id_001",5),
(try_begin),
(ge,":faction_slot_006",0),
(str_store_string,s21,":str_store_party_name_link(faction_slot_006)"),
(try_end),
(try_end),
(try_begin),
(eq,":var002",1),
(try_begin),
(ge,":::g_gathering_reason",0),
(str_store_string,s21,":str_store_party_name_link(_g_gathering_reason)"),
(str_store_string,s14,":str_store_string("str_we_should_prepare_to_defend_s21_but_we_should_gather_our_forces_until_we_are_strong_enough_to_engage_them")"),
(else_try),
(str_store_string,s14,":str_store_string("str_it_is_time_to_go_on_the_offensive_and_we_must_first_assemble_the_army")"),
(try_end),
(str_store_string,s14,":str_store_string("@({s1}) {s11}: {s14}")"),
(add_quest_note_from_sreg,"qst_report_to_army","$number_of_report_to_army_quest_notes",14, 0),
(val_add, ":::number_of_report_to_army_quest_notes", 1),
(else_try),
(eq,":var002",5),
(try_begin),
(is_between,":faction_slot_006","p_town_1","p_village_1"),
(str_store_string,s14,":str_store_string("str_we_should_ride_to_break_the_siege_of_s21")"),
(str_store_string,s14,":str_store_string("@({s1}) {s11}: {s14}")"),
(add_quest_note_from_sreg,"qst_report_to_army","$number_of_report_to_army_quest_notes",14, 0),
(val_add, ":::number_of_report_to_army_quest_notes", 1),
(else_try),
(is_between,":faction_slot_006","p_village_1","p_salt_mine"),
(str_store_string,s14,":str_store_string("str_we_should_ride_to_defeat_the_enemy_gathered_near_s21")"),
(str_store_string,s14,":str_store_string("@({s1}) {s11}: {s14}")"),
(add_quest_note_from_sreg,"qst_report_to_army","$number_of_report_to_army_quest_notes",14, 0),
(val_add, ":::number_of_report_to_army_quest_notes", 1),
(try_end),
(else_try),
(this_or_next|eq,":var002",3),
(eq,":var002",2),
(try_begin),
(is_between,":faction_slot_006","p_town_1","p_village_1"),
(str_store_string,s14,":str_store_string("str_we_believe_the_fortress_will_be_worth_the_effort_to_take_it")"),
(str_store_string,s14,":str_store_string("@{s14} ({s21})")"),
(str_store_string,s14,":str_store_string("@({s1}) {s11}: {s14}")"),
(add_quest_note_from_sreg,"qst_report_to_army","$number_of_report_to_army_quest_notes",14, 0),
(val_add, ":::number_of_report_to_army_quest_notes", 1),
(else_try),
(is_between,":faction_slot_006","p_village_1","p_salt_mine"),
(str_store_string,s14,":str_store_string("str_we_shall_leave_a_fiery_trail_through_the_heart_of_the_enemys_lands_targeting_the_wealthy_settlements_if_we_can")"),
(str_store_string,s14,":str_store_string("@{s14} ({s21})")"),
(str_store_string,s14,":str_store_string("@({s1}) {s11}: {s14}")"),
(add_quest_note_from_sreg,"qst_report_to_army","$number_of_report_to_army_quest_notes",14, 0),
(val_add, ":::number_of_report_to_army_quest_notes", 1),
(try_end),
(try_end),
(try_end),
(try_end),
]),

("decide_faction_ai", [
(store_script_param, ":faction_id_001", 1),
(faction_get_slot,":faction_slot_002",":faction_id_001",4),
(faction_get_slot,":faction_slot_003",":faction_id_001",5),
(faction_get_slot,":faction_slot_004",":faction_id_001",8),
(try_begin),
(faction_slot_eq,":faction_id_001",21,0),
(neq,":faction_id_001","fac_player_supporters_faction"),
(ge,":faction_slot_004","trp_player"),
(store_troop_faction,":troop_faction_005",":faction_slot_004"),
(try_begin),
(eq,":faction_slot_004","trp_player"),
(assign,":troop_faction_005","$players_kingdom"),
(try_end),
(assign,":var006",0),
(try_begin),
(eq,":faction_slot_004","trp_player"),
(eq,":::g_player_is_captive",1),
(assign,":var006",1),
(try_end),
(try_begin),
(this_or_next|eq,":troop_faction_005",":faction_id_001"),
(this_or_next|troop_slot_ge,":faction_slot_004",150,80),
(this_or_next|eq,":var006",1),
(troop_slot_ge,":faction_slot_004",8,0),
(assign,":var007",0),
(try_begin),
(eq,":faction_slot_004","trp_player"),
(assign,":var008",0),
(gt,":::g_player_days_as_marshal",1),
(try_for_range, ":trp_009", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_009",2,2),
(store_troop_faction,":troop_faction_010",":trp_009"),
(eq,":troop_faction_010",":faction_id_001"),
(call_script, "script_npc_decision_checklist_troop_follow_or_not", ":trp_009"),
(eq,reg0,1),
(val_add, ":var008", 1),
(try_end),
(try_end),
(try_end),
(lt,":var008",4),
(assign,":var007",1),
(try_end),
(this_or_next|eq,":faction_slot_002",0),
(this_or_next|eq,":faction_slot_002",6),
(this_or_next|eq,":troop_faction_005",":faction_id_001"),
(this_or_next|eq,":var007",1),
(this_or_next|eq,":var006",1),
(troop_slot_ge,":faction_slot_004",8,0),
(this_or_next|faction_slot_eq,":faction_id_001",64,0),
(this_or_next|eq,":var006",1),
(troop_slot_ge,":faction_slot_004",8,0),
(faction_set_slot,":faction_id_001",64,1),
(store_current_hours,":cur_hours_011"),
(val_max,":cur_hours_011",0),
(faction_set_slot,":faction_id_001",65,":cur_hours_011"),
(faction_get_slot,":faction_slot_012",":faction_id_001",8),
(try_begin),
(ge,":faction_slot_012",0),
(troop_get_slot,":troop_slot_013",":faction_slot_012",10),
(party_is_active,":troop_slot_013"),
(party_set_marshal, ":troop_slot_013", 0),
(try_end),
(try_end),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(faction_slot_eq,"$players_kingdom",8,"trp_player"),
(call_script, "script_add_notification_menu", "mnu_notification_relieved_as_marshal", 0, 0),
(else_try),
(neq,":faction_slot_012","trp_player"),
(call_script, "script_change_troop_renown", ":faction_slot_012", 15),
(try_end),
(faction_set_slot,":faction_id_001",8,-1),
(assign,":faction_slot_004",-1),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_015",":trp_014"),
(try_begin),
(eq,":troop_faction_015",":faction_id_001"),
(troop_set_slot,":trp_014",154,-1),
(try_end),
(try_end),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(troop_set_slot,"trp_player",154,-1),
(try_end),
(else_try),
(eq,":faction_slot_004",-1),
(neg|faction_slot_ge,":faction_id_001",64,1),
(faction_slot_eq,":faction_id_001",21,0),
(neq,":faction_id_001","fac_player_supporters_faction"),
(faction_set_slot,":faction_id_001",64,1),
(store_current_hours,":cur_hours_011"),
(val_max,":cur_hours_011",0),
(faction_set_slot,":faction_id_001",65,":cur_hours_011"),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_015",":trp_014"),
(try_begin),
(eq,":troop_faction_015",":faction_id_001"),
(troop_set_slot,":trp_014",154,-1),
(try_end),
(try_end),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(troop_set_slot,"trp_player",154,-1),
(try_end),
(else_try),
(eq,":faction_slot_004","trp_player"),
(neq,":::players_kingdom",":faction_id_001"),
(faction_set_slot,":faction_id_001",64,1),
(store_current_hours,":cur_hours_011"),
(val_max,":cur_hours_011",0),
(faction_set_slot,":faction_id_001",65,":cur_hours_011"),
(faction_get_slot,":faction_slot_012",":faction_id_001",8),
(try_begin),
(ge,":faction_slot_012",0),
(troop_get_slot,":troop_slot_013",":faction_slot_012",10),
(try_begin),
(party_is_active,":troop_slot_013"),
(party_set_marshal, ":troop_slot_013", 0),
(try_end),
(try_end),
(faction_set_slot,":faction_id_001",8,-1),
(assign,":faction_slot_004",-1),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_015",":trp_014"),
(try_begin),
(eq,":troop_faction_015",":faction_id_001"),
(troop_set_slot,":trp_014",154,-1),
(try_end),
(try_end),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(troop_set_slot,"trp_player",154,-1),
(try_end),
(try_begin),
(eq,1,1),
(faction_get_slot,":faction_slot_016",":faction_id_001",64),
(try_begin),
(is_between,":faction_slot_016","p_town_1","p_salt_mine"),
(store_faction_of_party, ":party_faction_017", ":faction_slot_016"),
(try_begin),
(neq,":party_faction_017",":faction_id_001"),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_faction_name(faction_id_001)"),
(str_store_string,s5,":str_store_party_name(party_faction_017)"),
(display_message, "@@{!}DEBUG -- {s4} drops {s5} as issue as it has changed hands"),
(try_end),
(try_end),
(faction_set_slot,":faction_id_001",64,0),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_015",":trp_014"),
(eq,":troop_faction_015",":faction_id_001"),
(troop_set_slot,":trp_014",154,-1),
(try_end),
(eq,":::players_kingdom",":faction_id_001"),
(troop_set_slot,"trp_player",154,-1),
(try_end),
(try_begin),
(faction_slot_ge,":faction_id_001",64,1),
(neq,":faction_id_001","fac_player_supporters_faction"),
(this_or_next|faction_slot_ge,":faction_id_001",64,"p_town_1"),
(this_or_next|faction_slot_eq,":faction_id_001",4,0),
(faction_slot_eq,":faction_id_001",4,6),
(faction_get_slot,":faction_slot_018",":faction_id_001",11),
(assign,":var019",0),
(assign,":var020",0),
(assign,":troop_id_021",-1),
(troop_set_slot,"trp_player",46,0),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_set_slot,":trp_014",46,0),
(try_end),
(try_for_range, ":trp_022", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_023",":trp_022"),
(try_begin),
(eq,":troop_faction_023",":faction_id_001"),
(val_add, ":var019", 1),
(troop_get_slot,":troop_slot_024",":trp_022",154),
(gt,":troop_slot_024",-1),
(val_add, ":var020", 1),
(troop_get_slot,":troop_slot_025",":troop_slot_024",46),
(val_add, ":troop_slot_025", 1),
(troop_set_slot,":troop_slot_024",46,":troop_slot_025"),
(gt,":troop_id_021",-1),
(troop_get_slot,":troop_slot_026",":troop_id_021",46),
(try_begin),
(gt,":troop_slot_025",":troop_slot_026"),
(assign,":troop_id_021",":troop_slot_024"),
(else_try),
(eq,":troop_id_021",-1),
(assign,":troop_id_021",":troop_slot_024"),
(try_end),
(try_end),
(try_end),
(store_div, ":var___x1", ":var019", 5),
(assign,":var027",":var___x1"),
(val_mul, ":var027", 4),
(store_current_hours,":cur_hours_028"),
(faction_get_slot,":faction_slot_029",":faction_id_001",65),
(val_sub, ":cur_hours_028", ":faction_slot_029"),
(this_or_next|gt,":var020",":var027"),
(ge,":cur_hours_028",120),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg4,":var020"),
(assign,reg5,":var027"),
(assign,reg7,":cur_hours_028"),
(str_store_string,s4,":str_store_faction_name(faction_id_001)"),
(display_message, "@@{!}DEBUG -- Issue resolution for {s4}: {reg4} votes for a quorum of {reg5} - {reg7} hours on agenda"),
(try_end),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- Faction resolves political issue"),
(try_end),
(assign,":troop_id_030",-1),
(try_begin),
(eq,1,1),
(call_script, "script_troop_get_relation_with_troop", ":faction_slot_018", ":troop_id_021"),
(try_begin),
(this_or_next|ge,reg0,10),
(this_or_next|troop_slot_eq,":faction_slot_018",154,":troop_id_021"),
(troop_slot_eq,":faction_slot_018",154,-1),
(assign,":troop_id_030",":troop_id_021"),
(else_try),
(gt,":faction_slot_018",-1),
(troop_get_slot,":troop_slot_031",":faction_slot_018",154),
(try_begin),
(ge,":troop_slot_031",-1),
(assign,":troop_id_030",":troop_slot_031"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":troop_id_030",-1),
(else_try),
(eq,":troop_id_030","trp_player"),
(eq,":::players_kingdom",":faction_id_001"),
(call_script, "script_add_notification_menu", "mnu_notification_player_faction_political_issue_resolved_for_player", 0, 0),
(else_try),
(eq,":troop_id_030","trp_player"),
(neq,":::players_kingdom",":faction_id_001"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_faction_name(faction_id_001)"),
(str_store_string,s5,":str_store_party_name(troop_id_030)"),
(display_message, "@@{!}DEBUG -- {s4} drops {s5} as winner - for having changed sides"),
(try_end),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_015",":trp_014"),
(try_begin),
(eq,":troop_faction_015",":faction_id_001"),
(troop_set_slot,":trp_014",154,-1),
(try_end),
(try_end),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(troop_set_slot,"trp_player",154,-1),
(try_end),
(else_try),
(store_troop_faction,":troop_faction_032",":troop_id_030"),
(try_begin),
(neq,":troop_faction_032",":faction_id_001"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_faction_name(faction_id_001)"),
(str_store_string,s5,":str_store_party_name(troop_id_030)"),
(display_message, "@@{!}DEBUG -- {s4} drops {s5} as winner - for having changed sides"),
(try_end),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_015",":trp_014"),
(try_begin),
(eq,":troop_faction_015",":faction_id_001"),
(troop_set_slot,":trp_014",154,-1),
(try_end),
(try_end),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(troop_set_slot,"trp_player",154,-1),
(try_end),
(else_try),
(faction_get_slot,":faction_slot_033",":faction_id_001",64),
(try_begin),
(eq,":faction_slot_033",1),
(is_between,":troop_id_030","trp_npc1","trp_knight_1_1_wife"),
(this_or_next|is_between,":troop_id_030","trp_npc1","trp_knight_1_1_wife"),
(eq,":::players_kingdom",":faction_id_001"),
(assign,":faction_slot_004",":troop_id_030"),
(else_try),
(is_between,":faction_slot_033","p_town_1","p_salt_mine"),
(call_script, "script_give_center_to_lord", ":faction_slot_033", ":troop_id_030", 0),
(try_begin),
(eq,":faction_slot_033",":::g_castle_requested_by_player"),
(party_slot_ge,":faction_slot_033",7,"trp_npc1"),
(store_faction_of_party, ":party_faction_034", ":faction_slot_033"),
(try_begin),
(eq,":party_faction_034",":::players_kingdom"),
(assign,"$g_center_to_give_to_player",":faction_slot_033"),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_035","trp_player",30),
(try_begin),
(is_between,":troop_slot_035","trp_npc1","trp_knight_1_1_wife"),
(eq,":::g_castle_requested_for_troop",":troop_slot_035"),
(neq,":troop_id_030",":troop_slot_035"),
(jump_to_menu,"mnu_requested_castle_granted_to_another_female"),
(else_try),
(jump_to_menu,"mnu_requested_castle_granted_to_another"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":faction_id_001",":::players_kingdom"),
(call_script, "script_add_notification_menu", "mnu_notification_player_faction_political_issue_resolved", ":faction_slot_033", ":troop_id_030"),
(try_end),
(faction_set_slot,":faction_id_001",64,0),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_015",":trp_014"),
(try_begin),
(eq,":troop_faction_015",":faction_id_001"),
(troop_set_slot,":trp_014",154,-1),
(try_end),
(try_end),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(troop_set_slot,"trp_player",154,-1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(faction_get_slot,":faction_slot_036",":faction_id_001",64),
(try_begin),
(le,":faction_slot_036",0),
(assign,":var038",0),
(assign,":var039",0),
(troop_set_slot,"trp_player",46,0),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_set_slot,":trp_014",46,0),
(try_end),
(try_end),
(try_for_range, ":p_040", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_041", ":p_040"),
(try_begin),
(eq,":party_faction_041",":faction_id_001"),
(party_get_slot,":party_slot_042",":p_040",7),
(try_begin),
(lt,":party_slot_042",0),
(val_add, ":var038", 1),
(eq,":var039",0),
(assign,":var039",":p_040"),
(try_end),
(else_try),
(troop_set_slot,":party_slot_042",46,1),
(try_end),
(try_end),
(store_add, ":var043", 0, ":var038"), # var037
(ge,":var043",2),
(faction_set_slot,":faction_id_001",64,":var039"),
(store_current_hours,":cur_hours_011"),
(faction_set_slot,":faction_id_001",65,":cur_hours_011"),
(try_for_range, ":trp_014", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_015",":trp_014"),
(eq,":troop_faction_015",":faction_id_001"),
(troop_set_slot,":trp_014",154,-1),
(try_end),
(try_end),
(eq,":::players_kingdom",":faction_id_001"),
(troop_set_slot,"trp_player",154,-1),
(try_end),
(try_begin),
(neg|faction_slot_eq,":faction_id_001",8,":faction_slot_004"),
(eq,":::players_kingdom",":faction_id_001"),
(str_store_string,s1,":str_store_troop_name_link(faction_slot_004)"),
(str_store_string,s2,":str_store_faction_name_link(faction_id_001)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(call_script, "script_check_and_finish_active_army_quests_for_faction", ":faction_id_001"),
(try_end),
(try_begin),
(neg|faction_slot_eq,":faction_id_001",8,":faction_slot_004"),
(gt,":faction_slot_004",-1),
(call_script, "script_appoint_faction_marshall", ":faction_id_001", ":faction_slot_004"),
(try_end),
(try_begin),
(eq,":faction_id_001",":::players_kingdom"),
(eq,":faction_slot_004","trp_player"),
(assign,":faction_slot_044","trp_player"),
(else_try),
(is_between,":faction_slot_004","trp_npc1","trp_knight_1_1_wife"),
(assign,":faction_slot_044",":faction_slot_004"),
(else_try),
(faction_get_slot,":faction_slot_044",":faction_id_001",11),
(try_end),
(call_script, "script_npc_decision_checklist_faction_ai_alt", ":faction_slot_044"),
(assign,":var045",reg0),
(assign,":party_id_046",reg1),
(try_begin),
(neq,":var045",":faction_slot_002"),
(eq,":var045",1),
(faction_get_slot,":faction_slot_004",":faction_id_001",8),
(try_begin),
(ge,":faction_slot_004",0),
(troop_get_slot,":troop_slot_047",":faction_slot_004",10),
(party_set_slot,":troop_slot_047",5,-1),
(assign,"$g_gathering_new_started",1),
(call_script, "script_npc_decision_checklist_party_ai", ":faction_slot_004"),
(call_script, "script_party_set_ai_state", ":troop_slot_047", reg0, reg1),
(assign,"$g_gathering_new_started",0),
(else_try),
(eq,":var045",":faction_slot_002"),
(eq,":var045",1),
(faction_get_slot,":faction_slot_004",":faction_id_001",8),
(try_begin),
(ge,":faction_slot_004",0),
(troop_get_slot,":troop_slot_047",":faction_slot_004",10),
(party_get_slot,":party_slot_048",":troop_slot_047",5),
(try_begin),
(ge,":party_slot_048",0),
(ge,":troop_slot_047",0),
(party_is_active,":troop_slot_047"),
(party_is_active,":party_slot_048"),
(store_distance_to_party_from_party,":distance_parties_049",":troop_slot_047",":troop_slot_047"),
(try_begin),
(le,":distance_parties_049",5),
(party_set_slot,":troop_slot_047",5,-1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(faction_set_slot,":faction_id_001",4,":var045"),
(faction_set_slot,":faction_id_001",5,":party_id_046"),
(call_script, "script_update_report_to_army_quest_note", ":faction_id_001", ":var045", ":faction_slot_002"),
(try_begin),
(eq,":var045",6),
(store_current_hours,":cur_hours_011"),
(faction_set_slot,":faction_id_001",94,":cur_hours_011"),
(try_begin),
(eq,":::g_player_eligible_feast_center_no",":party_id_046"),
(assign,"$g_player_eligible_feast_center_no",-1),
(try_end),
(try_begin),
(is_between,":party_id_046","p_town_1","p_castle_1"),
(party_set_slot,":party_id_046",156,2),
(try_end),
(try_end),
(try_begin),
(neq,":var045",":faction_slot_002"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s5,":str_store_faction_name(faction_id_001)"),
(display_message, "str_s5_decides_s14"),
(try_end),
(store_current_hours,":cur_hours_011"),
(faction_set_slot,":faction_id_001",97,":cur_hours_011"),
(try_begin),
(eq,":faction_slot_002",6),
(call_script, "script_faction_conclude_feast", ":faction_id_001", ":faction_slot_003"),
(try_end),
(try_begin),
(eq,":var045",6),
(faction_get_slot,":faction_slot_050",":faction_id_001",5),
(party_get_slot,":party_slot_051",":faction_slot_050",7),
(try_begin),
(check_quest_active,"qst_wed_betrothed"),
(quest_slot_eq,"qst_wed_betrothed",6,":party_slot_051"),
(neg|quest_slot_ge,"qst_wed_betrothed",23,362),
(call_script, "script_add_notification_menu", "mnu_notification_player_wedding_day", ":party_slot_051", ":faction_slot_050"),
(else_try),
(check_quest_active,"qst_wed_betrothed_female"),
(quest_get_slot,":quest_slot_052","qst_wed_betrothed",6),
(store_troop_faction,":troop_faction_053",":quest_slot_052"),
(try_begin),
(eq,":troop_faction_053",":faction_id_001"),
(neg|quest_slot_ge,"qst_wed_betrothed",23,362),
(call_script, "script_add_notification_menu", "mnu_notification_player_kingdom_holds_feast", ":party_slot_051", ":faction_slot_050"),
(else_try),
(eq,":::players_kingdom",":faction_id_001"),
(troop_slot_ge,"trp_player",7,150),
(party_get_slot,":party_slot_051",":faction_slot_050",7),
(call_script, "script_add_notification_menu", "mnu_notification_player_kingdom_holds_feast", ":party_slot_051", ":faction_slot_050"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":faction_slot_002",1),
(is_between,":var045",2,6),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s5,":str_store_faction_name(faction_id_001)"),
(display_message, "str_s5_begins_offensive"),
(try_end),
(try_begin),
(eq,1,1),
(assign,":var054",0),
(assign,":var055",-1),
(assign,":var056",30),
(troop_get_slot,":troop_slot_057",":faction_slot_004",10),
(try_begin),
(party_is_active,":troop_slot_057"),
(try_for_range, ":trp_058", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_059",":trp_058"),
(try_begin),
(eq,":troop_faction_059",":faction_id_001"),
(troop_get_slot,":troop_slot_060",":trp_058",10),
(party_is_active,":troop_slot_060"),
(party_slot_eq,":troop_slot_060",4,11),
(party_slot_eq,":troop_slot_060",5,":troop_slot_057"),
(val_add, ":var054", 1),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_party_name(troop_slot_060)"),
(display_message, "@@{!}DEBUG -- {s4} participates in offensive"),
(try_end),
(try_end),
(store_party_size_wo_prisoners,":party_size_wo_prisoners_061",":troop_slot_060"),
(val_sub, ":party_size_wo_prisoners_061", 50),
(val_abs,":party_size_wo_prisoners_061"),
(lt,":party_size_wo_prisoners_061",":var056"),
(assign,":var055",":troop_slot_060"),
(assign,":var056",":party_size_wo_prisoners_061"),
(try_end),
(gt,":var054",2),
(party_is_active,":var055"),
(party_is_active,":troop_slot_057"),
(call_script, "script_party_set_ai_state", ":var055", 12, ":troop_slot_057"),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_party_name(var055)"),
(display_message, "@@{!}DEBUG -- {s4} chosen as screen"),
(try_end),
(else_try),
(store_current_hours,":cur_hours_011"),
(try_begin),
(this_or_next|eq,":faction_slot_002",1),
(this_or_next|eq,":faction_slot_002",2),
(this_or_next|eq,":faction_slot_002",3),
(eq,":faction_slot_002",4),
(this_or_next|eq,":var045",0),
(eq,":var045",6),
(call_script, "script_check_and_finish_active_army_quests_for_faction", ":faction_id_001"),
(faction_set_slot,":faction_id_001",95,":cur_hours_011"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(neg|faction_slot_eq,":faction_id_001",4,2),
(check_quest_active,"qst_join_siege_with_army"),
(call_script, "script_abort_quest", "qst_join_siege_with_army", 0),
(try_end),
(try_begin),
(this_or_next|eq,":var045",6),
(eq,":var045",0),
(store_current_hours,":cur_hours_062"),
(faction_get_slot,":faction_slot_063",":faction_id_001",97),
(val_sub, ":cur_hours_062", ":faction_slot_063"),
(try_begin),
(ge,":cur_hours_062",18),
(store_current_hours,":cur_hours_011"),
(faction_set_slot,":faction_id_001",96,":cur_hours_011"),
(try_end),
(try_end),
]),

("check_and_finish_active_army_quests_for_faction", [
(store_script_param, ":faction_id_001", 1),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(try_begin),
(check_quest_active,"qst_report_to_army"),
(call_script, "script_cancel_quest", "qst_report_to_army"),
(try_end),
(assign,":var002",0),
(try_for_range, ":qst_003", ":qst.deliver_cattle_to_army", ":qst.rescue_lord_by_replace"),
(check_quest_active,":qst_003"),
(call_script, "script_cancel_quest", ":qst_003"),
(troop_get_slot,":troop_slot_004",":qst_003",6),
(assign,":var002",1),
(try_end),
(check_quest_active,"qst_follow_army"),
(assign,":var002",1),
(troop_get_slot,":troop_slot_004","qst_follow_army",6),
(call_script, "script_end_quest", "qst_follow_army"),
(try_end),
(eq,":var002",1),
(faction_get_slot,":faction_slot_005",":faction_id_001",95),
(store_current_hours,":cur_hours_006"),
(store_sub, ":var007", ":cur_hours_006", ":faction_slot_005"),
(store_mul, ":var008", ":var007", 5),
(val_div, ":var008", 50),
(val_mul, ":var008", 50),
(val_add, ":var008", 50),
(add_xp_as_reward,":var008"),
(call_script, "script_troop_change_relation_with_troop", "trp_player", ":troop_slot_004", 2),
(try_end),
]),

("troop_get_player_relation", [
(store_script_param, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_002",":troop_id_001",52),
(troop_get_slot,":troop_slot_003",":troop_id_001",22),
(assign,":var004",0),
(try_begin),
(eq,":troop_slot_002",2),
(val_add, ":troop_slot_003", -3),
(try_end),
(try_begin),
(ge,":::player_honor",0),
(try_begin),
(this_or_next|eq,":troop_slot_002",6),
(eq,":troop_slot_002",7),
(store_div, ":var___x1", "$player_honor", 3),
(assign,":var004",":var___x1"),
(try_end),
(try_end),
(try_begin),
(lt,":::player_honor",0),
(try_begin),
(this_or_next|eq,":troop_slot_002",6),
(eq,":troop_slot_002",7),
(store_div, ":var___x1", "$player_honor", 3),
(assign,":var004",":var___x1"),
(else_try),
(eq,":troop_slot_002",1),
(store_div, ":var___x1", "$player_honor", 5),
(assign,":var004",":var___x1"),
(try_end),
(try_end),
(val_add, ":troop_slot_003", ":var004"),
(val_clamp,":troop_slot_003",-100, 101),
(assign,reg0,":troop_slot_003"),
]),

("change_troop_renown", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_001",7),
(try_begin),
(gt,":var002",0),
(assign,reg4,":var002"),
(store_div, ":var___x1", ":troop_slot_003", 200),
(assign,":var004",":var___x1"),
(val_sub, ":var002", ":var004"),
(val_max,":var002",0),
(try_begin),
(eq,":troop_id_001","trp_player"),
(assign,reg5,":var002"),
(eq,":::cheat_mode",1),
(display_message, "str_renown_change_of_reg4_reduced_to_reg5_because_of_high_existing_renown"),
(try_end),
(try_end),
(store_add, ":var005", ":troop_slot_003", ":var002"),
(val_max,":var005",0),
(troop_set_slot,":troop_id_001",7,":var005"),
(try_begin),
(eq,":troop_id_001","trp_player"),
(try_begin),
(ge,":var005",50),
(try_begin),
(eq,1,1),
(troop_get_type,":troop_type_006","trp_player"),
(eq,":troop_type_006",1),
(unlock_achievement, 79),
(try_end),
(try_end),
(str_store_string,s1,":str_store_troop_name(troop_id_001)"),
(assign,reg12,":var002"),
(val_abs,reg12),
(try_begin),
(gt,":var002",0),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(lt,":var002",0),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_end),
(call_script, "script_update_troop_notes", ":troop_id_001"),
]),

("change_player_relation_with_troop", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(neq,":troop_id_001","trp_player"),
(neg|is_between,":troop_id_001","trp_farmer","trp_town_walker_1"),
(neq,":troop_id_001",-1),
(neq,":var002",0),
(call_script, "script_troop_get_player_relation", ":troop_id_001"),
(assign,":var003",reg0),
(troop_get_slot,":troop_slot_004",":troop_id_001",22),
(val_add, ":troop_slot_004", ":var002"),
(val_clamp,":troop_slot_004",-100, 101),
(try_begin),
(eq,1,1),
(troop_set_slot,":troop_id_001",22,":troop_slot_004"),
(try_begin),
(le,":troop_slot_004",-50),
(unlock_achievement, 29),
(try_end),
(str_store_string,s1,":str_store_troop_name_link(troop_id_001)"),
(call_script, "script_troop_get_player_relation", ":troop_id_001"),
(assign,":var005",reg0),
(try_begin),
(neq,":var003",":var005"),
(assign,reg1,":var003"),
(assign,reg2,":var005"),
(try_begin),
(gt,":var002",0),
(display_message, "str_troop_relation_increased"),
(else_try),
(lt,":var002",0),
(display_message, "str_troop_relation_detoriated"),
(try_end),
(try_end),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(assign,"$g_talk_troop_relation",":var005"),
(call_script, "script_setup_talk_info"),
(try_end),
(call_script, "script_update_troop_notes", ":troop_id_001"),
(try_end),
(try_end),
]),

("change_player_relation_with_center", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_get_slot,":party_slot_003",":party_id_001",26),
(assign,reg1,":party_slot_003"),
(val_add, ":party_slot_003", ":var002"),
(val_clamp,":party_slot_003",-100, 100),
(assign,reg2,":party_slot_003"),
(party_set_slot,":party_id_001",26,":party_slot_003"),
(try_begin),
(le,":party_slot_003",-50),
(unlock_achievement, 29),
(try_end),
(str_store_string,s1,":str_store_party_name_link(party_id_001)"),
(try_begin),
(gt,":var002",0),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(lt,":var002",0),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_begin),
(party_slot_eq,":party_id_001",0,4),
(call_script, "script_update_volunteer_troops_in_village", ":party_id_001"),
(try_end),
(try_begin),
(this_or_next|is_between,"$g_talk_troop","trp_village_1_elder","trp_merchants_end"),
(is_between,"$g_talk_troop","trp_town_1_mayor","trp_village_1_elder"),
(assign,"$g_talk_troop_relation",":party_slot_003"),
(call_script, "script_setup_talk_info"),
(try_end),
]),

("change_player_relation_with_faction", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":var002", 2),
(store_relation,":faction_relation_003",":faction_id_001","fac_player_supporters_faction"),
(assign,reg1,":faction_relation_003"),
(val_add, ":faction_relation_003", ":var002"),
(assign,reg2,":faction_relation_003"),
(set_relation,":faction_id_001",":faction_id_001",":faction_relation_003"),
(set_relation,":faction_id_001",":faction_id_001",":faction_relation_003"),
(try_begin),
(le,":faction_relation_003",-50),
(unlock_achievement, 29),
(try_end),
(str_store_string,s1,":str_store_faction_name_link(faction_id_001)"),
(try_begin),
(gt,":var002",0),
(display_message, "str_faction_relation_increased"),
(else_try),
(lt,":var002",0),
(display_message, "str_faction_relation_detoriated"),
(try_end),
(call_script, "script_update_all_notes"),
]),

("set_player_relation_with_faction", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_relation,":faction_relation_003",":var001","fac_player_supporters_faction"),
(store_sub, ":var004", ":var002", ":faction_relation_003"),
(call_script, "script_change_player_relation_with_faction", ":var001", ":var004"),
]),

("change_player_relation_with_faction_ex", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":var002", 2),
(store_relation,":faction_relation_003",":faction_id_001","fac_player_supporters_faction"),
(assign,reg1,":faction_relation_003"),
(val_add, ":faction_relation_003", ":var002"),
(assign,reg2,":faction_relation_003"),
(set_relation,":faction_id_001",":faction_id_001",":faction_relation_003"),
(set_relation,":faction_id_001",":faction_id_001",":faction_relation_003"),
(str_store_string,s1,":str_store_faction_name_link(faction_id_001)"),
(try_begin),
(gt,":var002",0),
(display_message, "str_faction_relation_increased"),
(else_try),
(lt,":var002",0),
(display_message, "str_faction_relation_detoriated"),
(try_end),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_slot_eq,":fac_004",21,0),
(neq,":faction_id_001",":fac_004"),
(store_relation,":faction_relation_005",":faction_id_001",":fac_004"),
(store_relation,":faction_relation_003",":fac_004","fac_player_supporters_faction"),
(store_mul, ":var006", ":var002", ":faction_relation_005"),
(val_div, ":var006", 100),
(val_add, ":faction_relation_003", ":var006"),
(set_relation,":fac_004",":fac_004",":faction_relation_003"),
(set_relation,":fac_004",":fac_004",":faction_relation_003"),
(try_end),
(try_begin),
(faction_slot_eq,"fac_player_supporters_faction",21,0),
(try_for_range, ":fac_007", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_slot_eq,":fac_007",21,0),
(call_script, "script_update_faction_notes", ":fac_007"),
(try_end),
(try_end),
]),

("cf_get_random_active_faction_except_player_faction_and_faction", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_for_range, ":fac_003", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(neq,":fac_003","fac_player_supporters_faction"),
(neq,":fac_003",":var001"),
(faction_slot_eq,":fac_003",21,0),
(val_add, ":var002", 1),
(try_end),
(try_begin),
(gt,":var002",0),
(assign,":var004",-1),
(store_random_in_range,":random_x_005",0,":var002"),
(try_for_range, ":fac_003", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(ge,":random_x_005",0),
(neq,":fac_003","fac_player_supporters_faction"),
(neq,":fac_003",":var001"),
(faction_slot_eq,":fac_003",21,0),
(val_sub, ":random_x_005", 1),
(lt,":random_x_005",0),
(assign,":var004",":fac_003"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var004"),
]),

("make_kingdom_hostile_to_player", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(lt,":var002",0),
(store_relation,":faction_relation_003",":var001","fac_player_supporters_faction"),
(val_min,":faction_relation_003",0),
(val_add, ":faction_relation_003", ":var002"),
(call_script, "script_set_player_relation_with_faction", ":var001", ":faction_relation_003"),
(try_end),
]),

("change_player_honor", [
(store_script_param, ":var001", 1),
(val_add, ":::player_honor", ":var001"),
(try_begin),
(gt,":var001",0),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(lt,":var001",0),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
]),

("change_player_party_morale", [
(store_script_param, ":var001", 1),
(party_get_morale, ":party_morale_002","p_main_party"),
(val_clamp,":party_morale_002",0, 100),
(store_add, ":var003", ":party_morale_002", ":var001"),
(val_clamp,":var003",0, 100),
(party_set_morale, "p_main_party", ":var003"),
(try_begin),
(lt,":var003",":party_morale_002"),
(store_sub, reg1, ":party_morale_002", ":var003"),
(display_message, "str_party_lost_morale"),
(else_try),
(gt,":var003",":party_morale_002"),
(store_sub, reg1, ":var003", ":party_morale_002"),
(display_message, "str_party_gained_morale"),
(try_end),
]),

("cf_player_has_item_without_modifier", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(player_has_item,":var001"),
(troop_get_inventory_capacity,":troop_inv_capacity_004","trp_player"),
(try_for_range, ":inventory_slot_no_005", 0, ":troop_inv_capacity_004"),
(troop_get_inventory_slot,":troop_inv_slot_006","trp_player",":inventory_slot_no_005"),
(eq,":troop_inv_slot_006",":var001"),
(troop_get_inventory_slot_modifier,":troop_inv_slot_modifier_007","trp_player",":inventory_slot_no_005"),
(neq,":troop_inv_slot_modifier_007",":var002"),
(assign,0,1), # var003
(assign,":troop_inv_capacity_004",0),
(try_end),
(try_end),
]),

("get_player_party_morale_values", [
(party_get_num_companion_stacks,":party_num_companions_stacks_001","p_main_party"),
(assign,":var002",0),
(try_for_range, ":stack_no_003", 1, ":party_num_companions_stacks_001"),
(party_stack_get_troop_id,      ":troop_id_004","p_main_party",":stack_no_003"),
(try_begin),
(troop_is_hero,":troop_id_004"),
(val_add, ":var002", 1),
(else_try),
(party_stack_get_size,          ":party_stack_size_005","p_main_party",":stack_no_003"),
(val_add, ":var002", ":party_stack_size_005"),
(try_end),
(try_end),
(assign,"$g_player_party_morale_modifier_party_size",":var002"),
(store_skill_level,":skill_lvl_006","skl_leadership","trp_player"),
(try_begin),
(eq,":::players_kingdom","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_007","$players_kingdom",11),
(try_begin),
(eq,":faction_slot_007","trp_player"),
(store_mul, ":_g_player_party_morale_modifier_leadership", ":skill_lvl_006", 15),
(else_try),
(store_mul, ":_g_player_party_morale_modifier_leadership", ":skill_lvl_006", 12),
(try_end),
(try_end),
(assign,":var008","$g_player_party_morale_modifier_leadership"),
(val_sub, ":var008", ":::g_player_party_morale_modifier_party_size"),
(val_add, ":var008", 50),
(assign,"$g_player_party_morale_modifier_food",0),
(try_for_range, ":itm_009", ":itm.smoked_fish", ":itm.siege_supply"),
(call_script, "script_cf_player_has_item_without_modifier", ":itm_009", 41),
(item_get_slot,":item_slot_010",":itm_009",1),
(val_mul, ":item_slot_010", 3),
(val_div, ":item_slot_010", 2),
(val_add, ":::g_player_party_morale_modifier_food", ":item_slot_010"),
(try_end),
(val_add, ":var008", ":::g_player_party_morale_modifier_food"),
(try_begin),
(eq,":::g_player_party_morale_modifier_food",0),
(assign,"$g_player_party_morale_modifier_no_food",30),
(val_sub, ":var008", ":::g_player_party_morale_modifier_no_food"),
(else_try),
(assign,"$g_player_party_morale_modifier_no_food",0),
(try_end),
(assign,"$g_player_party_morale_modifier_debt",0),
(try_begin),
(gt,":::g_player_debt_to_party_members",0),
(call_script, "script_calculate_player_faction_wage"),
(assign,":var011",reg0),
(store_mul, ":_g_player_party_morale_modifier_debt", "$g_player_debt_to_party_members", 10),
(val_max,":var011",1),
(val_div, ":::g_player_party_morale_modifier_debt", ":var011"),
(val_clamp,"$g_player_party_morale_modifier_debt",1, 31),
(val_sub, ":var008", ":::g_player_party_morale_modifier_debt"),
(try_end),
(val_clamp,":var008",0, 100),
(assign,reg0,":var008"),
]),

("diplomacy_start_war_between_kingdoms", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":faction_id_002", 2),
(store_script_param, ":var003", 3),
(call_script, "script_npc_decision_checklist_peace_or_war", ":faction_id_001", ":faction_id_002", -1),
(assign,":var004",reg1),
(try_begin),
(eq,":faction_id_001","fac_player_supporters_faction"),
(assign,":var005",90),
(else_try),
(eq,":var004","str_s12s15_declared_war_to_control_calradia"),
(assign,":var005",90),
(else_try),
(eq,":var004","str_s12s15_considers_s16_to_be_dangerous_and_untrustworthy_and_shehe_wants_to_bring_s16_down"),
(assign,":var005",91),
(else_try),
(eq,":var004","str_s12s15_is_anxious_to_reclaim_old_lands_such_as_s18_now_held_by_s16"),
(assign,":var005",92),
(else_try),
(eq,":var004","str_s12s15_faces_too_much_internal_discontent_to_feel_comfortable_ignoring_recent_provocations_by_s16s_subjects"),
(assign,":var005",94),
(else_try),
(eq,":var004","str_s12s15_is_alarmed_by_the_growing_power_of_s16"),
(assign,":var005",93),
(try_end),
(call_script, "script_add_log_entry", ":var005", ":faction_id_001", 0, 0, ":faction_id_002"),
(call_script, "script_diplomacy_faction_get_diplomatic_status_with_faction", ":faction_id_001", ":faction_id_002"),
(assign,":var006",reg0),
(try_begin),
(eq,":var003",1),
(eq,":var006",-1),
(call_script, "script_faction_follows_controversial_policy", ":faction_id_001", 83),
(else_try),
(eq,":var003",1),
(eq,":var006",0),
(call_script, "script_faction_follows_controversial_policy", ":faction_id_001", 80),
(else_try),
(eq,":var006",1),
(call_script, "script_faction_follows_controversial_policy", ":faction_id_001", 84),
(try_end),
(store_relation,":faction_relation_007",":faction_id_001",":faction_id_002"),
(val_min,":faction_relation_007",-10),
(val_add, ":faction_relation_007", -30),
(set_relation,":faction_id_001",":faction_id_001",":faction_relation_007"),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(store_relation,":faction_relation_007","fac_player_supporters_faction",":faction_id_002"),
(val_min,":faction_relation_007",-30),
(call_script, "script_set_player_relation_with_faction", ":faction_id_002", ":faction_relation_007"),
(else_try),
(eq,":::players_kingdom",":faction_id_002"),
(store_relation,":faction_relation_007","fac_player_supporters_faction",":faction_id_001"),
(val_min,":faction_relation_007",-30),
(call_script, "script_set_player_relation_with_faction", ":faction_id_001", ":faction_relation_007"),
(try_end),
(try_begin),
(eq,":var003",1),
(str_store_string,s1,":str_store_faction_name_link(faction_id_001)"),
(str_store_string,s2,":str_store_faction_name_link(faction_id_002)"),
(display_log_message,":"),
(store_current_hours,":cur_hours_008"),
(faction_set_slot,":faction_id_001",98,":cur_hours_008"),
(faction_set_slot,":faction_id_002",98,":cur_hours_008"),
(store_add, ":slot_no_009", ":faction_id_002", 120),
(store_add, ":slot_no_010", ":faction_id_002", 130),
(assign,":slot_no_009 -","fac_player_supporters_faction"),
(assign,":slot_no_010 -","fac_player_supporters_faction"),
(faction_set_slot,":faction_id_001",":slot_no_009",0),
(faction_set_slot,":faction_id_001",":slot_no_010",0),
(store_add, ":slot_no_009", ":faction_id_001", 120),
(store_add, ":slot_no_010", ":faction_id_001", 130),
(assign,":slot_no_009 -","fac_player_supporters_faction"),
(assign,":slot_no_010 -","fac_player_supporters_faction"),
(faction_set_slot,":faction_id_002",":slot_no_009",0),
(faction_set_slot,":faction_id_002",":slot_no_010",0),
(call_script, "script_add_notification_menu", "mnu_notification_war_declared", ":faction_id_001", ":faction_id_002"),
(call_script, "script_update_faction_notes", ":faction_id_001"),
(call_script, "script_update_faction_notes", ":faction_id_002"),
(assign,"$g_recalculate_ais",1),
(try_end),
(try_begin),
(check_quest_active,"qst_cause_provocation"),
(neg|check_quest_succeeded,"qst_cause_provocation"),
(this_or_next|eq,":::players_kingdom",":faction_id_001"),
(eq,":::players_kingdom",":faction_id_002"),
(call_script, "script_abort_quest", "qst_cause_provocation", 0),
(try_end),
]),

("diplomacy_party_attacks_neutral", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":party_id_002", 2),
(store_faction_of_party, ":party_faction_003", ":party_id_001"),
(store_faction_of_party, ":party_faction_004", ":party_id_002"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_001",0),
(try_begin),
(eq,":party_id_001","p_main_party"),
(neq,":party_faction_003","fac_player_supporters_faction"),
(assign,":party_faction_003","$players_kingdom"),
(else_try),
(eq,":party_id_001","p_main_party"),
(eq,":party_faction_003","fac_player_supporters_faction"),
(try_end),
(try_begin),
(eq,":party_id_001","p_main_party"),
(store_relation,":faction_relation_006",":party_faction_003",":party_faction_004"),
(try_begin),
(ge,":faction_relation_006",0),
(call_script, "script_change_player_honor", -2),
(try_end),
(try_end),
(try_begin),
(check_quest_active,"qst_cause_provocation"),
(quest_slot_eq,"qst_cause_provocation",3,":party_faction_004"),
(quest_get_slot,":quest_slot_007","qst_cause_provocation",6),
(store_troop_faction,":party_faction_003",":quest_slot_007"),
(call_script, "script_succeed_quest", "qst_cause_provocation"),
(try_end),
(call_script, "script_diplomacy_faction_get_diplomatic_status_with_faction", ":party_faction_003", ":party_faction_004"),
(assign,":var008",reg0),
(try_begin),
(eq,":party_faction_003","fac_player_supporters_faction"),
(neg|faction_slot_eq,"fac_player_supporters_faction",21,0),
(else_try),
(eq,":var008",-2),
(else_try),
(eq,":party_faction_003","fac_player_supporters_faction"),
(faction_slot_eq,":party_faction_003",11,"trp_player"),
(call_script, "script_faction_follows_controversial_policy", "fac_player_supporters_faction", 80),
(else_try),
(eq,":var008",1),
(party_stack_get_troop_id,      ":troop_id_009",":party_id_002",0),
(try_begin),
(neg|is_between,":troop_id_009","trp_npc1","trp_knight_1_1_wife"),
(store_faction_of_party, ":party_faction_010", ":party_id_002"),
(faction_get_slot,":troop_id_009",":party_faction_010",11),
(try_end),
(call_script, "script_add_log_entry", 77, ":troop_id_005", -1, ":troop_id_009", ":party_faction_003"),
(else_try),
(call_script, "script_add_log_entry", 76, ":troop_id_005", -1, ":troop_id_009", ":party_faction_003"),
(try_end),
(try_begin),
(is_between,":party_id_002","p_village_1","p_salt_mine"),
(call_script, "script_add_log_entry", 1, ":troop_id_005", ":party_id_002", -1, ":party_faction_004"),
(else_try),
(party_get_template_id,":party_template_id_011",":party_id_002"),
(try_begin),
(neq,":party_template_id_011","pt_kingdom_hero_party"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s5,":str_store_faction_name(party_faction_004)"),
(display_message, "@@{!}DEbug - {s5} caravan attacked"),
(try_end),
(try_end),
(call_script, "script_add_log_entry", 3, ":troop_id_005", -1, -1, ":party_faction_004"),
(try_end),
(store_add, ":slot_no_012", ":party_faction_003", 130),
(assign,":slot_no_012 -","fac_player_supporters_faction"),
(faction_set_slot,":party_faction_004",":slot_no_012",0),
(store_add, ":slot_no_013", ":party_faction_003", 130),
(assign,":slot_no_013 -","fac_player_supporters_faction"),
(try_begin),
(neq,":var008",-2),
(faction_slot_eq,":party_faction_004",":slot_no_013",0),
(faction_set_slot,":party_faction_004",":slot_no_013",30),
(try_end),
]),

("party_calculate_and_set_nearby_friend_enemy_follower_strengths", [
(store_script_param, ":party_id_001", 1),
(assign,":var002",0),
(assign,":var003",0),
(assign,":var004",0),
(store_faction_of_party, ":party_faction_005", ":party_id_001"),
(assign,":var006","trp_knight_1_1_wife"),
(val_add, ":var006", 1),
(try_for_range, ":var007", ":trp.npc1", ":var006"),
(eq,":var007","trp_knight_1_1_wife"),
(assign,":troop_id_008","trp_player"),
(else_try),
(assign,":troop_id_008",":var007"),
(try_begin),
(troop_slot_eq,":troop_id_008",2,2),
(troop_get_slot,":troop_slot_009",":troop_id_008",10),
(ge,":troop_slot_009",0),
(party_is_active,":troop_slot_009"),
(store_troop_faction,":troop_faction_010",":troop_id_008"),
(store_relation,":faction_relation_011",":troop_faction_010",":party_faction_005"),
(try_begin),
(this_or_next|eq,":faction_relation_011",0),
(eq,":troop_faction_010",":party_faction_005"),
(neq,":party_id_001",":troop_slot_009"),
(party_get_slot,":party_slot_012",":troop_slot_009",56),
(neg|is_between,":party_id_001","p_town_1","p_salt_mine"),
(party_slot_eq,":troop_slot_009",4,11),
(party_get_slot,":party_slot_013",":troop_slot_009",5),
(try_begin),
(eq,":party_slot_013",":party_id_001"),
(val_add, ":var002", ":party_slot_012"),
(else_try),
(store_distance_to_party_from_party,":distance_parties_014",":troop_slot_009",":troop_slot_009"),
(try_begin),
(lt,":distance_parties_014",20),
(try_begin),
(lt,":distance_parties_014",5),
(assign,":var015",":party_slot_012"),
(else_try),
(lt,":distance_parties_014",10),
(store_div, ":var___x1", ":party_slot_012", 2),
(assign,":var015",":var___x1"),
(else_try),
(lt,":distance_parties_014",15),
(store_div, ":var___x1", ":party_slot_012", 4),
(assign,":var015",":var___x1"),
(else_try),
(store_div, ":var___x1", ":party_slot_012", 8),
(assign,":var015",":var___x1"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":troop_faction_010",":party_faction_005"),
(gt,":faction_relation_011",0),
(val_add, ":var003", ":var015"),
(else_try),
(lt,":faction_relation_011",0),
(val_add, ":var004", ":var015"),
(try_end),
(try_end),
(party_set_slot,":party_id_001",59,":var002"),
(party_set_slot,":party_id_001",57,":var003"),
(party_set_slot,":party_id_001",58,":var004"),
]),

("init_ai_calculation", [
(try_for_range, ":trp_001", ":trp.npc1", ":trp.heroes_end"),
(troop_slot_eq,":trp_001",2,2),
(troop_get_slot,":troop_slot_002",":trp_001",10),
(party_is_active,":troop_slot_002"),
(call_script, "script_party_calculate_strength", ":troop_slot_002", 0),
(try_end),
(try_end),
(call_script, "script_party_calculate_strength", "p_main_party", 0),
(try_for_range, ":p_003", ":p.town_1", ":p.village_1"),
(call_script, "script_party_calculate_strength", ":p_003", 0),
(try_end),
(try_for_range, ":p_003", ":p.town_1", ":p.village_1"),
(call_script, "script_party_calculate_and_set_nearby_friend_enemy_follower_strengths", ":p_003"),
(try_end),
(try_for_range, ":trp_001", ":trp.npc1", ":trp.heroes_end"),
(troop_get_slot,":troop_slot_004",":trp_001",10),
(try_begin),
(gt,":troop_slot_004",0),
(party_is_active,":troop_slot_004"),
(call_script, "script_party_calculate_and_set_nearby_friend_enemy_follower_strengths", ":troop_slot_004"),
(try_end),
(try_end),
(call_script, "script_party_calculate_and_set_nearby_friend_enemy_follower_strengths", "p_main_party"),
]),

("recalculate_ais", [
(call_script, "script_init_ai_calculation"),
(try_for_range, ":fac_001", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(assign,reg8,":fac_001"),
(try_begin),
(faction_slot_eq,":fac_001",21,0),
(call_script, "script_decide_faction_ai", ":fac_001"),
(try_end),
(try_end),
(try_for_range, ":trp_002", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":fac_001",":trp_002"),
(try_begin),
(troop_slot_eq,":trp_002",2,2),
(call_script, "script_calculate_troop_ai", ":trp_002"),
(try_end),
(try_end),
]),

("calculate_troop_ai", [
(store_script_param, ":troop_id_001", 1),
(try_begin),
(troop_slot_eq,":troop_id_001",2,2),
(neg|troop_slot_ge,":troop_id_001",8,0),
(troop_get_slot,":troop_slot_002",":troop_id_001",10),
(try_begin),
(gt,":troop_slot_002",0),
(party_is_active,":troop_slot_002"),
(call_script, "script_npc_decision_checklist_party_ai", ":troop_id_001"),
(call_script, "script_party_set_ai_state", ":troop_slot_002", reg0, reg1),
(try_end),
(try_end),
]),

("diplomacy_start_peace_between_kingdoms", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":faction_id_002", 2),
(store_script_param, ":var003", 3),
(store_relation,":faction_relation_004",":faction_id_001",":faction_id_002"),
(val_max,":faction_relation_004",0),
(set_relation,":faction_id_001",":faction_id_001",":faction_relation_004"),
(call_script, "script_exchange_prisoners_between_factions", ":faction_id_001", ":faction_id_002"),
(try_begin),
(eq,":::players_kingdom",":faction_id_001"),
(store_relation,":faction_relation_004","fac_player_supporters_faction",":faction_id_002"),
(val_max,":faction_relation_004",0),
(call_script, "script_set_player_relation_with_faction", ":faction_id_002", ":faction_relation_004"),
(call_script, "script_event_kingdom_make_peace_with_kingdom", ":faction_id_002", "fac_player_supporters_faction"),
(else_try),
(eq,":::players_kingdom",":faction_id_002"),
(store_relation,":faction_relation_004","fac_player_supporters_faction",":faction_id_001"),
(val_max,":faction_relation_004",0),
(call_script, "script_set_player_relation_with_faction", ":faction_id_001", ":faction_relation_004"),
(call_script, "script_event_kingdom_make_peace_with_kingdom", ":faction_id_001", "fac_player_supporters_faction"),
(try_end),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(try_begin),
(this_or_next|eq,":party_faction_006",":faction_id_002"),
(eq,":party_faction_006",":faction_id_001"),
(party_get_slot,":party_slot_007",":p_005",54),
(ge,":party_slot_007",0),
(party_is_active,":party_slot_007"),
(store_faction_of_party, ":party_faction_008", ":party_slot_007"),
(this_or_next|eq,":party_faction_008",":faction_id_002"),
(eq,":party_faction_008",":faction_id_001"),
(call_script, "script_lift_siege", ":p_005", 0),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":::players_kingdom",":faction_id_001"),
(eq,":::players_kingdom",":faction_id_002"),
(ge,":::g_player_besiege_town",0),
(party_is_active,"$g_player_besiege_town"),
(store_faction_of_party, ":party_faction_009", "$g_player_besiege_town"),
(try_begin),
(this_or_next|eq,":party_faction_009",":faction_id_002"),
(eq,":party_faction_009",":faction_id_001"),
(call_script, "script_lift_siege", "$g_player_besiege_town", 0),
(assign,"$g_player_besiege_town",-1),
(try_end),
(try_end),
(try_begin),
(eq,":var003",1),
(str_store_string,s1,":str_store_faction_name_link(faction_id_001)"),
(str_store_string,s2,":str_store_faction_name_link(faction_id_002)"),
(display_log_message,":"),
(call_script, "script_add_notification_menu", "mnu_notification_peace_declared", ":faction_id_001", ":faction_id_002"),
(call_script, "script_event_kingdom_make_peace_with_kingdom", ":faction_id_001", ":faction_id_002"),
(call_script, "script_event_kingdom_make_peace_with_kingdom", ":faction_id_002", ":faction_id_001"),
(assign,"$g_recalculate_ais",1),
(try_end),
(try_begin),
(eq,1,1),
(store_add, ":slot_no_010", ":faction_id_001", 120),
(assign,":slot_no_010 -","fac_player_supporters_faction"),
(faction_set_slot,":faction_id_002",":slot_no_010",40),
(store_add, ":slot_no_010", ":faction_id_002", 120),
(assign,":slot_no_010 -","fac_player_supporters_faction"),
(faction_set_slot,":faction_id_001",":slot_no_010",40),
(store_add, ":slot_no_011", ":faction_id_002", 140),
(assign,":slot_no_011 -","fac_player_supporters_faction"),
(faction_set_slot,":faction_id_001",":slot_no_011",0),
(store_add, ":slot_no_012", ":faction_id_001", 140),
(assign,":slot_no_012 -","fac_player_supporters_faction"),
(faction_set_slot,":faction_id_002",":slot_no_012",0),
(try_end),
]),

("event_kingdom_make_peace_with_kingdom", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(check_quest_active,"qst_capture_prisoners"),
(try_begin),
(eq,":::players_kingdom",":var001"),
(quest_slot_eq,"qst_capture_prisoners",3,":var002"),
(call_script, "script_cancel_quest", "qst_capture_prisoners"),
(else_try),
(eq,":::players_kingdom",":var002"),
(quest_slot_eq,"qst_capture_prisoners",3,":var001"),
(call_script, "script_cancel_quest", "qst_capture_prisoners"),
(try_end),
(try_end),
(try_begin),
(check_quest_active,"qst_capture_enemy_hero"),
(try_begin),
(eq,":::players_kingdom",":var001"),
(quest_slot_eq,"qst_capture_enemy_hero",3,":var002"),
(call_script, "script_cancel_quest", "qst_capture_enemy_hero"),
(else_try),
(eq,":::players_kingdom",":var002"),
(quest_slot_eq,"qst_capture_enemy_hero",3,":var001"),
(call_script, "script_cancel_quest", "qst_capture_enemy_hero"),
(try_end),
(try_end),
(try_begin),
(check_quest_active,"qst_persuade_lords_to_make_peace"),
(quest_get_slot,":quest_slot_003","qst_persuade_lords_to_make_peace",2),
(quest_get_slot,":quest_slot_004","qst_persuade_lords_to_make_peace",4),
(try_begin),
(lt,":quest_slot_003",0),
(val_mul, ":quest_slot_003", -1),
(try_end),
(try_begin),
(lt,":quest_slot_004",0),
(val_mul, ":quest_slot_004", -1),
(try_end),
(store_troop_faction,":troop_faction_005",":quest_slot_003"),
(store_troop_faction,":troop_faction_006",":quest_slot_004"),
(try_begin),
(this_or_next|eq,":troop_faction_005",":var001"),
(eq,":troop_faction_006",":var001"),
(this_or_next|eq,":troop_faction_005",":var002"),
(eq,":troop_faction_006",":var002"),
(call_script, "script_cancel_quest", "qst_persuade_lords_to_make_peace"),
(try_end),
(try_end),
(try_begin),
(this_or_next|faction_slot_eq,":var002",11,"trp_player"),
(faction_slot_eq,":var001",11,"trp_player"),
(call_script, "script_change_player_right_to_rule", 3),
(try_end),
]),

("randomly_start_war_peace_new", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_begin),
(is_between,"$players_kingdom","fac_kingdom_1","fac_kingdoms_end"),
(assign,":var002",1),
(try_end),
(try_for_range, ":fac_003", ":fac.kingdom_1", ":fac.kingdoms_end"),
(faction_slot_eq,":fac_003",21,0),
(try_for_range, ":fac_004", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(neq,":fac_003",":fac_004"),
(faction_slot_eq,":fac_004",21,0),
(call_script, "script_npc_decision_checklist_peace_or_war", ":fac_003", ":fac_004", -1),
(assign,":var005",reg0),
(store_relation,":faction_relation_006",":fac_003",":fac_004"),
(try_begin),
(lt,":faction_relation_006",0),
(try_begin),
(eq,":fac_003",":::players_kingdom"),
(assign,":var002",0),
(try_end),
(try_begin),
(ge,":var005",1),
(try_begin),
(eq,":fac_004","fac_player_supporters_faction"),
(store_mul, ":var007", ":var005", 2),
(store_random_in_range,":random_x_008",0,20),
(try_begin),
(lt,":random_x_008",":var007"),
(call_script, "script_add_notification_menu", "mnu_question_peace_offer", ":fac_003", 0),
(try_end),
(try_end),
(else_try),
(call_script, "script_npc_decision_checklist_peace_or_war", ":fac_004", ":fac_003", -1),
(assign,":var009",reg0),
(try_begin),
(ge,":var009",1),
(store_mul, ":var007", ":var005", ":var009"),
(store_random_in_range,":random_x_008",0,20),
(try_begin),
(lt,":random_x_008",":var007"),
(try_begin),
(eq,":::g_include_diplo_explanation",0),
(assign,"$g_include_diplo_explanation",":fac_003"),
(str_store_string,s57,":str_store_string("str_s14")"),
(try_end),
(try_end),
(try_end),
(call_script, "script_diplomacy_start_peace_between_kingdoms", ":fac_003", ":fac_004", ":var001"),
(try_end),
(else_try),
(ge,":faction_relation_006",0),
(call_script, "script_npc_decision_checklist_peace_or_war", ":fac_003", ":fac_004", -1),
(try_begin),
(le,reg0,0),
(assign,":var010",reg0),
(call_script, "script_diplomacy_faction_get_diplomatic_status_with_faction", ":fac_003", ":fac_004"),
(try_begin),
(le,reg0,0),
(val_add, ":var010", reg0),
(val_sub, ":var010", 1),
(val_add, ":var010", ":var001"),
(store_mul, ":var011", ":var010", ":var010"),
(store_random_in_range,":random_x_008",0,50),
(try_begin),
(lt,":random_x_008",":var011"),
(try_begin),
(eq,":::g_include_diplo_explanation",0),
(assign,"$g_include_diplo_explanation",":fac_003"),
(str_store_string,s57,":str_store_string("str_s14")"),
(try_end),
(try_end),
(try_end),
(try_end),
(call_script, "script_diplomacy_start_war_between_kingdoms", ":fac_003", ":fac_004", ":var001"),
(try_begin),
(eq,":var001",0),
(store_random_in_range,":random_x_012",10,120),
(store_add, ":slot_no_013", ":fac_003", 140),
(assign,":slot_no_013 -","fac_player_supporters_faction"),
(faction_set_slot,":fac_004",":slot_no_013",":random_x_012"),
(store_add, ":slot_no_013", ":fac_004", 140),
(assign,":slot_no_013 -","fac_player_supporters_faction"),
(faction_set_slot,":fac_003",":slot_no_013",":random_x_012"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var002",1),
(val_add, ":::players_kingdom_days_at_peace", 1),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg3,"$players_kingdom_days_at_peace"),
(display_message, "@@{!}DEBUG -- Player's kingdom has had {reg3} days of peace"),
(try_end),
(else_try),
(assign,"$players_kingdom_days_at_peace",0),
(try_end),
]),

("exchange_prisoners_between_factions", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-1),
(assign,":var004",-1),
(assign,":var005",0),
(try_begin),
(this_or_next|eq,":::players_kingdom",":var002"),
(eq,":::players_kingdom",":var001"),
(assign,":var003","fac_player_faction"),
(assign,":var004","fac_player_supporters_faction"),
(assign,":var005",1),
(try_end),
(try_for_parties, ":cur_party"),
(store_faction_of_party, ":party_faction_007", ":cur_party"),
(try_begin),
(this_or_next|eq,":party_faction_007",":var004"),
(this_or_next|eq,":party_faction_007",":var003"),
(this_or_next|eq,":party_faction_007",":var002"),
(eq,":party_faction_007",":var001"),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_008",":cur_party"),
(try_for_range, ":var009", 0, ":party_num_prisoners_stacks_008"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_010",":cur_party",":var009"),
(assign,":var011",0),
(try_begin),
(is_between,":party_prisoner_troop_id_010","trp_npc1","trp_kingdom_1_lord"),
(eq,":var005",1),
(assign,":var011",1),
(else_try),
(neg|is_between,":party_prisoner_troop_id_010","trp_npc1","trp_kingdom_1_lord"),
(store_troop_faction,":troop_faction_012",":party_prisoner_troop_id_010"),
(try_begin),
(this_or_next|eq,":troop_faction_012",":var004"),
(this_or_next|eq,":troop_faction_012",":var003"),
(this_or_next|eq,":troop_faction_012",":var002"),
(eq,":troop_faction_012",":var001"),
(assign,":var011",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var011",1),
(try_begin),
(troop_is_hero,":party_prisoner_troop_id_010"),
(call_script, "script_remove_troop_from_prison", ":party_prisoner_troop_id_010"),
(try_end),
(try_end),
(party_get_prisoner_stack_size, ":party_prisoner_stack_size_013",":cur_party",":var009"),
(party_remove_members,":cur_party",":party_prisoner_troop_id_010",":party_prisoner_stack_size_013"),
(try_end),
(try_end),
]),

("add_notification_menu", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(try_begin),
(eq,":::g_infinite_camping",0),
(assign,":var004",1),
(try_for_range, ":slot_no_005", 0, ":var004"),
(neg|troop_slot_ge,"trp_notification_menu_types",":slot_no_005",1),
(val_add, ":var004", 1),
(else_try),
(troop_set_slot,"trp_notification_menu_types",":slot_no_005",":var001"),
(troop_set_slot,"trp_notification_menu_var1",":slot_no_005",":var002"),
(troop_set_slot,"trp_notification_menu_var2",":slot_no_005",":var003"),
(try_end),
(try_end),
]),

("finish_quest", [
(store_script_param, ":quest_id_001", 1),
(store_script_param, ":var002", 2),
(quest_get_slot,":quest_slot_003",":quest_id_001",6),
(quest_get_slot,":quest_slot_004",":quest_id_001",20),
(quest_get_slot,":quest_slot_005",":quest_id_001",21),
(quest_get_slot,":quest_slot_006",":quest_id_001",22),
(try_begin),
(lt,":var002",100),
(val_mul, ":quest_slot_005", ":var002"),
(val_div, ":quest_slot_005", 100),
(val_mul, ":quest_slot_006", ":var002"),
(val_div, ":quest_slot_006", 100),
(assign,":var007",":var002"),
(val_sub, ":var007", 75),
(val_mul, ":quest_slot_004", ":var007"),
(val_div, ":quest_slot_004", 100),
(else_try),
(val_mul, ":quest_slot_004", 4),
(val_add, ":quest_slot_004", 1),
(call_script, "script_change_player_relation_with_troop", ":quest_slot_003", ":quest_slot_004"),
(try_end),
(add_xp_as_reward,":quest_slot_005"),
(call_script, "script_troop_add_gold", "trp_player", ":quest_slot_006"),
(call_script, "script_end_quest", ":quest_id_001"),
]),

("get_information_about_troops_position", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":reg3", 2),
(troop_get_type,reg4,":troop_id_001"),
(str_store_string,s2,":str_store_troop_name(troop_id_001)"),
(assign,":var002",0),
(troop_get_slot,":troop_slot_003",":troop_id_001",12),
(try_begin),
(gt,":troop_slot_003",0),
(is_between,":troop_slot_003","p_town_1","p_salt_mine"),
(str_store_string,s3,":str_store_party_name_link(troop_slot_003)"),
(str_store_string,s1,":str_store_string()"),
(assign,":var002",1),
(else_try),
(troop_get_slot,":troop_slot_004",":troop_id_001",10),
(try_begin),
(gt,":troop_slot_004",0),
(call_script, "script_get_troop_attached_party", ":troop_id_001"),
(assign,":troop_slot_003",reg0),
(try_begin),
(is_between,":troop_slot_003","p_town_1","p_salt_mine"),
(str_store_string,s3,":str_store_party_name_link(troop_slot_003)"),
(str_store_string,s1,":str_store_string()"),
(assign,":var002",1),
(else_try),
(get_party_ai_behavior,":party_ai_behavior_005",":troop_slot_004"),
(try_begin),
(eq,":party_ai_behavior_005",1),
(get_party_ai_object,":party_ai_object_006",":troop_slot_004"),
(try_begin),
(is_between,":party_ai_object_006","p_town_1","p_salt_mine"),
(call_script, "script_get_closest_center", ":troop_slot_004"),
(str_store_string,s4,":str_store_party_name_link(reg0)"),
(str_store_string,s3,":str_store_party_name_link(party_ai_object_006)"),
(str_store_string,s1,":str_store_string()"),
(assign,":var002",1),
(else_try),
(call_script, "script_get_closest_center", ":troop_slot_004"),
(str_store_string,s3,":str_store_party_name_link(reg0)"),
(str_store_string,s1,":str_store_string()"),
(assign,":var002",1),
(try_end),
(try_end),
(try_end),
(else_try),
(troop_slot_ge,":troop_id_001",8,0),
(try_for_range, ":troop_slot_003", ":p.town_1", ":p.village_1"),
(party_count_prisoners_of_type,":party_prisoners_of_type_007",":troop_slot_003",":troop_id_001"),
(try_begin),
(gt,":party_prisoners_of_type_007",0),
(assign,":var002",1),
(str_store_string,s3,":str_store_party_name_link(troop_slot_003)"),
(str_store_string,s1,":str_store_string()"),
(try_end),
(try_end),
(try_begin),
(eq,":var002",0),
(str_store_string,s1,":str_store_string()"),
(assign,":var002",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var002",0),
(str_store_string,s1,":str_store_string()"),
(try_end),
(assign,reg0,":var002"),
]),

("recruit_troop_as_companion", [
(store_script_param, ":troop_id_001", 1),
(troop_set_slot,":troop_id_001",2,5),
(troop_set_slot,":troop_id_001",12,-1),
(troop_set_auto_equip,":troop_id_001",0),
(party_add_members,"p_main_party",":troop_id_001",1),
(str_store_string,s6,":str_store_troop_name(troop_id_001)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(troop_set_note_available, ":troop_id_001", 1),
(try_begin),
(is_between,":troop_id_001","trp_npc1","trp_kingdom_1_lord"),
(store_sub, ":var002", ":troop_id_001", ":trp.npc1"),
(set_achievement_stat, 45, ":var002", 1),
(assign,":var003",0),
(try_for_range, ":var004", 0, 16),
(get_achievement_stat, ":var005", 45, ":var004"),
(eq,":var005",1),
(val_add, ":var003", 1),
(try_end),
(ge,":var003",6),
(unlock_achievement, 45),
(try_end),
]),

("setup_random_scene", [
(party_get_current_terrain,":party_cur_terrain_001","p_main_party"),
(assign,":var002","scn_random_scene"),
(try_begin),
(eq,":party_cur_terrain_001",2),
(assign,":var002","scn_random_scene_steppe"),
(else_try),
(eq,":party_cur_terrain_001",3),
(assign,":var002","scn_random_scene_plain"),
(else_try),
(eq,":party_cur_terrain_001",4),
(assign,":var002","scn_random_scene_snow"),
(else_try),
(eq,":party_cur_terrain_001",5),
(assign,":var002","scn_random_scene_desert"),
(else_try),
(eq,":party_cur_terrain_001",10),
(assign,":var002","scn_random_scene_steppe_forest"),
(else_try),
(eq,":party_cur_terrain_001",11),
(assign,":var002","scn_random_scene_plain_forest"),
(else_try),
(eq,":party_cur_terrain_001",12),
(assign,":var002","scn_random_scene_snow_forest"),
(else_try),
(eq,":party_cur_terrain_001",13),
(assign,":var002","scn_random_scene_desert_forest"),
(else_try),
(eq,":party_cur_terrain_001",0),
(assign,":var002","scn_water"),
(else_try),
(eq,":party_cur_terrain_001",7),
(assign,":var002","scn_random_scene_plain"),
(try_end),
(jump_to_scene,":var002"),
]),

("enter_dungeon", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(set_jump_mission,":var002"),
(mission_tpl_entry_set_override_flags, ":var002", 0, 256),
(try_begin),
(eq,":::sneaked_into_town",1),
(mission_tpl_entry_set_override_flags, ":var002", 0, 447),
(mission_tpl_entry_clear_override_items, ":var002", 0),
(mission_tpl_entry_add_override_item, ":var002", 0, "itm_pilgrim_hood"),
(mission_tpl_entry_add_override_item, ":var002", 0, "itm_pilgrim_disguise"),
(mission_tpl_entry_add_override_item, ":var002", 0, "itm_practice_staff"),
(mission_tpl_entry_add_override_item, ":var002", 0, "itm_throwing_daggers"),
(try_end),
(party_get_slot,":party_slot_003",":party_id_001",12),
(modify_visitors_at_site,":party_slot_003"),
(reset_visitors),
(assign,":entry_no_004",16),
(call_script, "script_get_heroes_attached_to_center_as_prisoner", ":party_id_001", "p_temp_party"),
(party_get_num_companion_stacks,":party_num_companions_stacks_005","p_temp_party"),
(try_for_range, ":stack_no_006", 0, ":party_num_companions_stacks_005"),
(party_stack_get_troop_id,      ":troop_id_007","p_temp_party",":stack_no_006"),
(assign,":var008",0),
(try_begin),
(party_slot_eq,":party_id_001",7,"trp_player"),
(else_try),
(call_script, "script_cf_prisoner_offered_parole", ":troop_id_007"),
(assign,":var008",1),
(else_try),
(assign,":var008",0),
(try_end),
(try_begin),
(eq,":var008",0),
(lt,":entry_no_004",32),
(set_visitor,":entry_no_004",":troop_id_007"),
(val_add, ":entry_no_004", 1),
(try_end),
(try_end),
(set_jump_entry,0),
(jump_to_scene,":party_slot_003"),
(scene_set_slot,":party_slot_003",0,1),
(change_screen_mission),
]),

("enter_court", [
(store_script_param, ":party_id_001", 1),
(assign,"$talk_context",1),
(set_jump_mission,"mt_visit_town_castle"),
(mission_tpl_entry_clear_override_items, "mt_visit_town_castle", 0),
(party_get_slot,":party_slot_002",":party_id_001",11),
(modify_visitors_at_site,":party_slot_002"),
(reset_visitors),
(store_faction_of_party, ":party_faction_003", ":party_id_001"),
(faction_get_slot,":faction_slot_004",":party_faction_003",49),
(try_begin),
(le,":faction_slot_004",0),
(assign,":faction_slot_004","trp_swadian_sergeant"),
(try_end),
(set_visitor,6,":faction_slot_004"),
(set_visitor,7,":faction_slot_004"),
(assign,":entry_no_005",16),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_006","trp_player",30),
(try_begin),
(gt,":troop_slot_006",0),
(troop_slot_eq,":troop_slot_006",12,":party_id_001"),
(set_visitor,":entry_no_005",":troop_slot_006"),
(val_add, ":entry_no_005", 1),
(else_try),
(troop_get_slot,":troop_slot_007","trp_player",34),
(try_begin),
(gt,":troop_slot_007",0),
(troop_slot_eq,":troop_slot_007",12,":party_id_001"),
(set_visitor,":entry_no_005",":troop_slot_007"),
(val_add, ":entry_no_005", 1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":::g_player_court",":party_id_001"),
(gt,":::g_player_minister",0),
(neg|troop_slot_eq,"trp_player",30,"$g_player_minister"),
(set_visitor,":entry_no_005","$g_player_minister"),
(val_add, ":entry_no_005", 1),
(try_end),
(try_begin),
(eq,":::g_player_court",":party_id_001"),
(faction_slot_eq,":party_faction_003",11,"trp_player"),
(try_for_range, ":trp_008", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_009",":trp_008"),
(eq,":troop_faction_009","fac_player_supporters_faction"),
(troop_slot_eq,":trp_008",2,0),
(neg|troop_slot_ge,":trp_008",8,0),
(neq,":trp_008",":::g_player_minister"),
(set_visitor,":entry_no_005",":trp_008"),
(val_add, ":entry_no_005", 1),
(try_end),
(try_end),
(call_script, "script_get_heroes_attached_to_center", ":party_id_001", "p_temp_party"),
(party_get_num_companion_stacks,":party_num_companions_stacks_010","p_temp_party"),
(try_for_range, ":stack_no_011", 0, ":party_num_companions_stacks_010"),
(party_stack_get_troop_id,      ":troop_id_012","p_temp_party",":stack_no_011"),
(try_begin),
(lt,":entry_no_005",32),
(set_visitor,":entry_no_005",":troop_id_012"),
(val_add, ":entry_no_005", 1),
(try_end),
(try_end),
(try_for_range, ":trp_013", ":trp.knight_1_1_wife", ":trp.heroes_end"),
(store_troop_faction,":troop_faction_015",":trp_013"),
(try_begin),
(neq,":trp_013","trp_knight_1_1_wife"),
(troop_slot_eq,":trp_013",12,":party_id_001"),
(assign,":var014",0),
(try_begin),
(this_or_next|troop_slot_eq,"trp_player",30,":trp_013"),
(this_or_next|troop_slot_eq,"trp_player",34,":trp_013"),
(this_or_next|troop_slot_eq,":trp_013",30,"trp_player"),
(troop_slot_eq,":trp_013",34,"trp_player"),
(assign,":var014",0),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_013)"),
(display_message, "str_s4_is_present_at_the_center_and_in_place_of_honor"),
(try_end),
(try_end),
(else_try),
(neq,":troop_faction_015",":party_faction_003"),
(assign,":var014",1),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_013)"),
(display_message, "str_s4_is_present_at_the_center_as_a_refugee"),
(try_end),
(else_try),
(troop_slot_ge,":trp_013",30,1),
(try_begin),
(faction_slot_eq,":party_faction_003",4,6),
(faction_slot_eq,":party_faction_003",5,":party_id_001"),
(assign,":var014",0),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_013)"),
(display_message, "str_s4_is_present_at_the_center_and_not_attending_the_feast"),
(try_end),
(else_try),
(assign,":var014",1),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_013)"),
(display_message, "str_s4_is_present_at_the_center_and_is_married"),
(try_end),
(try_end),
(else_try),
(faction_slot_eq,":party_faction_003",4,6),
(faction_slot_eq,":party_faction_003",5,":party_id_001"),
(assign,":var014",1),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_013)"),
(display_message, "@@{!}DEBUG -- {s4} is present at the center and is attending the feast"),
(try_end),
(else_try),
(troop_slot_ge,":trp_013",5,2),
(assign,":var014",0),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_013)"),
(display_message, "@@{!}DEBUG -- {s4} is present at the center and is awaiting the player in private"),
(try_end),
(else_try),
(call_script, "script_get_kingdom_lady_social_determinants", ":trp_013"),
(call_script, "script_npc_decision_checklist_male_guardian_assess_suitor", reg0, "trp_player"),
(try_begin),
(gt,reg0,0),
(assign,":var014",1),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_013)"),
(display_message, "@@{!}DEBUG -- {s4} is present at the center and is allowed to meet the player"),
(try_end),
(else_try),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_013)"),
(display_message, "@@{!}DEBUG -- {s4}is present at the center and is not allowed to meet the player"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var014",1),
(lt,":entry_no_005",32),
(set_visitor,":entry_no_005",":trp_013"),
(val_add, ":entry_no_005", 1),
(try_end),
(try_end),
(set_jump_entry,0),
(jump_to_scene,":party_slot_002"),
(scene_set_slot,":party_slot_002",0,1),
(change_screen_mission),
]),

("setup_meet_lady", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":party_id_002", 2),
(troop_set_slot,":troop_id_001",38,"trp_player"),
(set_jump_mission,"mt_visit_town_castle"),
(party_get_slot,":party_slot_003",":party_id_002",11),
(modify_visitors_at_site,":party_slot_003"),
(reset_visitors),
(troop_set_age, "trp_nurse_for_lady", 100),
(set_visitor,7,"trp_nurse_for_lady"),
(set_visitor,16,":troop_id_001"), # entry_no_004
(assign,"$talk_context",16),
(jump_to_scene,":party_slot_003"),
(scene_set_slot,":party_slot_003",0,1),
(change_screen_mission),
]),

("find_high_ground_around_pos1", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(val_mul, ":var002", 100),
(str_store_string,s10,":get_scene_boundaries(11)"),
(team_get_leader, ":team_leader_003", ":var001"),
(agent_get_position,pos1,":team_leader_003"),
(set_fixed_point_multiplier, 100),
(position_get_x,":pos_x_004",1),
(position_get_y,":pos_y_005",1),
(store_sub, ":var006", ":pos_x_004", ":var002"),
(store_sub, ":var007", ":pos_y_005", ":var002"),
(store_add, ":var008", ":pos_x_004", ":var002"),
(store_add, ":var009", ":pos_y_005", ":var002"),
(position_get_x,":pos_x_010",10),
(position_get_x,":pos_x_011",11),
(position_get_y,":pos_y_012",10),
(position_get_y,":pos_y_013",11),
(val_add, ":pos_x_010", 2000),
(val_sub, ":pos_x_011", 2000),
(val_add, ":pos_y_012", 2000),
(val_sub, ":pos_y_013", 2000),
(val_max,":var006",":pos_x_010"),
(val_max,":var007",":pos_y_012"),
(val_min,":var008",":pos_x_011"),
(val_min,":var009",":pos_y_013"),
(store_div, ":var___x1", ":var006", 100),
(assign,":var014",":var___x1"),
(store_div, ":var___x1", ":var007", 100),
(assign,":var015",":var___x1"),
(store_div, ":var___x1", ":var008", 100),
(assign,":var016",":var___x1"),
(store_div, ":var___x1", ":var009", 100),
(assign,":var017",":var___x1"),
(assign,":var018",-10000),
(copy_position,52,1),
(init_position,15),
(try_for_range, ":var019", ":var014", ":var016"),
(store_mul, ":var020", ":var019", 100),
(try_for_range, ":var021", ":var015", ":var017"),
(store_mul, ":var022", ":var021", 100),
(position_set_x,15,":var020"),
(position_set_y,15,":var022"),
(position_set_z,15,10000),
(position_set_z_to_ground_level, 15),
(position_get_z,":pos_z_023",15),
(gt,":pos_z_023",":var018"),
(copy_position,52,15),
(assign,":var018",":pos_z_023"),
(try_end),
(try_end),
]),

("select_battle_tactic", [
(assign,"$ai_team_1_battle_tactic",0),
(get_player_agent_no,":agent_no_001"),
(agent_get_team, ":agent_team_no_002", ":agent_no_001"),
(try_begin),
(num_active_teams_le,2),
(try_begin),
(eq,":agent_team_no_002",0),
(assign,"$ai_team_1",1),
(else_try),
(assign,"$ai_team_1",0),
(try_end),
(assign,"$ai_team_2",-1),
(else_try),
(try_begin),
(eq,":agent_team_no_002",0),
(assign,"$ai_team_1",1),
(else_try),
(assign,"$ai_team_1",0),
(try_end),
(store_add, "$ai_team_2", ":agent_team_no_002", 2),
(try_end),
(call_script, "script_select_battle_tactic_aux", "$ai_team_1", 0),
(assign,"$ai_team_1_battle_tactic",reg0),
(try_begin),
(ge,":::ai_team_2",0),
(assign,":var003",0),
(try_begin),
(eq,":::ai_team_1_battle_tactic",1),
(assign,":var003",1),
(try_end),
(call_script, "script_select_battle_tactic_aux", "$ai_team_2", ":var003"),
(assign,"$ai_team_2_battle_tactic",reg0),
(try_end),
]),

("select_battle_tactic_aux", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(get_player_agent_no,":agent_no_004"),
(agent_get_team, ":agent_team_no_005", ":agent_no_004"),
(try_begin),
(eq,":::cant_leave_encounter",1),
(teams_are_enemies, ":var001", ":agent_team_no_005"),
(assign,":var002",1),
(try_end),
(call_script, "script_team_get_class_percentages", ":var001", 0),
(assign,":var006",reg1),
(assign,":var007",reg2),
(call_script, "script_team_get_class_percentages", ":var001", 1),
(store_random_in_range,":random_x_008",0,100),
(try_begin),
(eq,1,1),
(assign,":var009",0),
(try_begin),
(teams_are_enemies, ":var001", ":agent_team_no_005"),
(party_slot_eq,"$g_enemy_party",0,13),
(assign,":var009",1),
(else_try),
(neg|teams_are_enemies, ":var001", ":agent_team_no_005"),
(gt,":::g_ally_party",0),
(party_slot_eq,"$g_ally_party",0,13),
(assign,":var009",1),
(try_end),
(try_begin),
(eq,":var009",1),
(store_faction_of_party, ":party_faction_010", "$g_enemy_party"),
(neq,":party_faction_010","fac_kingdom_3"),
(try_begin),
(eq,":var002",0),
(gt,":var006",50),
(lt,":var007",35),
(assign,":var003",1),
(else_try),
(lt,":random_x_008",80),
(assign,":var003",2),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var003"),
]),

("battle_tactic_init", [
(call_script, "script_battle_tactic_init_aux", "$ai_team_1", "$ai_team_1"_battle_tactic),
(try_begin),
(ge,":::ai_team_2",0),
(call_script, "script_battle_tactic_init_aux", "$ai_team_2", "$ai_team_2"_battle_tactic),
(try_end),
(try_for_agents, ":cur_agent"),
(agent_set_slot,":cur_agent",15,0),
(try_end),
]),

("battle_tactic_init_aux", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(team_get_leader, ":team_leader_003", ":var001"),
(try_begin),
(eq,":var002",1),
(agent_get_position,pos1,":team_leader_003"),
(call_script, "script_find_high_ground_around_pos1", ":var001", 30),
(copy_position,1,52),
(call_script, "script_find_high_ground_around_pos1", ":var001", 30),
(copy_position,1,52),
(call_script, "script_find_high_ground_around_pos1", ":var001", 30),
(team_give_order, ":var001", 9, 0),
(team_set_order_position, ":var001", 9, 52),
(team_give_order, ":var001", 1, 5),
(team_give_order, ":var001", 1, 5),
(else_try),
(eq,":var002",2),
(team_get_leader, ":team_leader_003", ":var001"),
(try_begin),
(ge,":team_leader_003",0),
(agent_set_speed_limit,":team_leader_003",8),
(agent_get_position,pos60,":team_leader_003"),
(team_give_order, ":var001", 9, 0),
(team_set_order_position, ":var001", 9, 60),
(try_end),
(try_end),
]),

("calculate_team_powers", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,1,1),
(assign,":var002",0),
(try_begin),
(agent_is_ally,":var001"),
(assign,":var002",1),
(try_end),
(try_end),
(assign,":var003",0),
(assign,":var004",0),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(try_begin),
(eq,1,1),
(assign,":var006",0),
(agent_is_ally,":cur_agent"),
(assign,":var006",1),
(try_end),
(eq,1,1),
(agent_get_horse,":agent_horse_007",":cur_agent"),
(try_begin),
(neq,":agent_horse_007",-1),
(assign,":var008",2),
(else_try),
(assign,":var008",1),
(try_end),
(try_end),
(try_begin),
(eq,":var002",":var006"),
(val_add, ":var003", ":var008"),
(else_try),
(val_add, ":var004", ":var008"),
(try_end),
(assign,reg0,":var003"),
(assign,reg1,":var004"),
]),

("apply_effect_of_other_people_on_courage_scores", [
(get_player_agent_no,":agent_no_001"),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(neq,":cur_agent",":agent_no_001"),
(agent_get_position,pos0,":cur_agent"),
(try_begin),
(agent_is_ally,":cur_agent"),
(assign,":var003",1),
(else_try),
(assign,":var003",0),
(try_end),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(eq,1,0),
(try_begin),
(agent_is_ally,":cur_agent"),
(assign,":var005",1),
(else_try),
(assign,":var005",0),
(try_end),
(try_begin),
(eq,":var003",":var005"),
(agent_get_slot,":agent_slot_006",":cur_agent",15),
(agent_get_troop_id,":troop_id_008", ":cur_agent"),
(try_begin),
(eq,":cur_agent",":agent_no_001"),
(assign,":var007",6),
(else_try),
(troop_is_hero,":troop_id_008"),
(try_begin),
(neq,":agent_slot_006",1),
set absolute to 1 to retrieve actual hps, ":cur_agent",
(try_begin),
(eq,":agent_hit_points_009",100),
(assign,":var007",6),
(else_try),
(ge,":agent_hit_points_009",75),
(assign,":var007",5),
(else_try),
(ge,":agent_hit_points_009",60),
(assign,":var007",4),
(else_try),
(ge,":agent_hit_points_009",45),
(assign,":var007",3),
(else_try),
(ge,":agent_hit_points_009",30),
(assign,":var007",2),
(else_try),
(ge,":agent_hit_points_009",15),
(assign,":var007",1),
(try_end),
(try_end),
(else_try),
(assign,":var007",4),
(try_end),
(else_try),
(try_begin),
(neq,":agent_slot_006",1),
set absolute to 1 to retrieve actual hps, ":cur_agent",
(try_begin),
(eq,":agent_hit_points_009",100),
(assign,":var007",4),
(else_try),
(ge,":agent_hit_points_009",75),
(assign,":var007",3),
(else_try),
(ge,":agent_hit_points_009",50),
(assign,":var007",2),
(else_try),
(ge,":agent_hit_points_009",25),
(assign,":var007",1),
(try_end),
(try_begin),
(agent_is_ally,":cur_agent"),
(val_sub, ":var007", 1),
(try_end),
(else_try),
(assign,":var007",2),
(try_end),
(try_end),
(try_begin),
(neq,":agent_slot_006",1),
(val_mul, ":var007", 1),
(try_begin),
(eq,1,1),
(agent_get_slot,":agent_slot_006",":cur_agent",15),
(eq,":agent_slot_006",0),
(val_mul, ":var007", 0),
(try_end),
(else_try),
(try_begin),
(eq,1,1),
(agent_get_slot,":agent_slot_006",":cur_agent",15),
(try_begin),
(eq,":agent_slot_006",0),
(val_mul, ":var007", -2),
(else_try),
(val_mul, ":var007", -1),
(try_end),
(try_end),
(try_end),
(neq,":var007",0),
(agent_get_position,pos1,":cur_agent"),
(get_distance_between_positions,":distance_010",0,1),
(try_begin),
(ge,":var007",0),
(try_begin),
(lt,":distance_010",2000),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 50),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",4000),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 40),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",7000),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 30),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",11000),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 20),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",16000),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 10),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(try_end),
(try_end),
(else_try),
(try_begin),
(lt,":distance_010",200),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 15),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",400),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 13),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",600),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 11),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",800),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 9),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",1200),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 7),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",2400),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 5),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",4800),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 3),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(else_try),
(lt,":distance_010",9600),
(agent_get_slot,":agent_slot_011",":cur_agent",16),
(val_mul, ":var007", 1),
(val_add, ":agent_slot_011", ":var007"),
(agent_set_slot,":cur_agent",16,":agent_slot_011"),
(try_end),
(try_end),
(try_end),
]),

("apply_death_effect_on_courage_scores", [
(store_script_param, ":agent_id_001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(agent_is_human,":agent_id_001"),
(try_begin),
(agent_is_ally,":agent_id_001"),
(assign,":var003",1),
(else_try),
(assign,":var003",0),
(try_end),
(agent_get_position,pos0,":agent_id_001"),
(assign,":var004",0),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_get_position,pos1,":cur_agent"),
(get_distance_between_positions,":distance_006",0,1),
(le,":distance_006",1300),
(try_begin),
(agent_is_ally,":cur_agent"),
(assign,":var007",1),
(else_try),
(assign,":var007",0),
(try_end),
(try_end),
(eq,":var003",":var007"),
(val_add, ":var004", 1),
(try_end),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(try_begin),
(agent_is_ally,":cur_agent"),
(assign,":var007",1),
(else_try),
(assign,":var007",0),
(try_end),
(try_begin),
(neq,":var003",":var007"),
(assign,":var008",10),
(else_try),
(assign,":var008",-15),
(val_add, ":var008", ":var004"),
(try_begin),
(gt,":var008",-5),
(assign,":var008",-5),
(try_end),
(agent_get_slot,":agent_slot_009",":agent_id_001",15),
(try_begin),
(eq,":agent_slot_009",1),
(val_div, ":var008", 3),
(try_end),
(try_end),
(agent_get_position,pos1,":cur_agent"),
(get_distance_between_positions,":distance_006",0,1),
(try_begin),
(eq,":var002",":cur_agent"),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 20),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(try_end),
(try_begin),
(lt,":distance_006",100),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 150),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",200),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 120),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",300),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 100),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",400),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 90),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",600),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 80),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",800),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 70),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",1000),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 60),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",1500),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 50),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",2500),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 40),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",4000),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 30),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",6500),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 20),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(else_try),
(lt,":distance_006",10000),
(agent_get_slot,":agent_slot_010",":cur_agent",16),
(val_mul, ":var008", 10),
(val_add, ":agent_slot_010", ":var008"),
(agent_set_slot,":cur_agent",16,":agent_slot_010"),
(try_end),
(try_end),
(try_end),
]),

("decide_run_away_or_not", [
(store_script_param, ":agent_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(agent_get_team, ":agent_team_no_004", ":agent_id_001"),
(agent_get_division ,":agent_division_005", ":agent_id_001"),
(try_begin),
(lt,":agent_division_005",9),
(team_get_movement_order, ":team_movement_order_006", ":agent_team_no_004", ":agent_division_005"),
(try_begin),
(eq,":team_movement_order_006",14),
(assign,":var003",1),
(try_end),
(try_end),
(agent_get_slot,":agent_slot_007",":agent_id_001",15),
(try_begin),
(eq,":agent_slot_007",0),
(try_begin),
(eq,":var003",1),
(agent_start_running_away, ":agent_id_001"),
(agent_set_slot,":agent_id_001",15,1),
(else_try),
(ge,":var002",45),
(agent_get_slot,":agent_slot_008",":agent_id_001",16),
set absolute to 1 to retrieve actual hps, ":agent_id_001",
(val_mul, ":agent_hit_points_009", 4),
(try_begin),
(agent_is_ally,":agent_id_001"),
(val_sub, ":agent_hit_points_009", 100),
(try_end),
(val_mul, ":agent_hit_points_009", 10),
(store_sub, ":var010", 3500, ":agent_hit_points_009"),
(try_begin),
(lt,":agent_slot_008",":var010"),
(agent_get_troop_id,":troop_id_011", ":agent_id_001"),
(try_begin),
(neg|troop_is_hero,":troop_id_011"),
(agent_start_running_away, ":agent_id_001"),
(agent_set_slot,":agent_id_001",15,1),
(try_end),
(try_end),
(try_end),
(else_try),
(neq,":var003",1),
(agent_get_slot,":agent_slot_008",":agent_id_001",16),
set absolute to 1 to retrieve actual hps, ":agent_id_001",
(val_mul, ":agent_hit_points_009", 4),
(try_begin),
(agent_is_ally,":agent_id_001"),
(val_sub, ":agent_hit_points_009", 100),
(try_end),
(val_mul, ":agent_hit_points_009", 10),
(store_sub, ":var012", 3700, ":agent_hit_points_009"),
(try_begin),
(ge,":agent_slot_008",":var012"),
(agent_stop_run_away, ":agent_id_001"),
(agent_set_slot,":agent_id_001",15,0),
(try_end),
(try_end),
]),

("battle_tactic_apply", [
(call_script, "script_battle_tactic_apply_aux", "$ai_team_1", "$ai_team_1"_battle_tactic),
(assign,"$ai_team_1_battle_tactic",reg0),
(try_begin),
(ge,":::ai_team_2",0),
(call_script, "script_battle_tactic_apply_aux", "$ai_team_2", "$ai_team_2"_battle_tactic),
(assign,"$ai_team_2_battle_tactic",reg0),
(try_end),
]),

("battle_tactic_apply_aux", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_mission_timer_a,":m_timer_a_003"),
(try_begin),
(eq,":var002",1),
(copy_position,1,52),
(call_script, "script_get_closest3_distance_of_enemies_at_pos1", ":var001", 1),
(assign,":var004",reg0),
(assign,":var005",reg1),
(try_begin),
(this_or_next|ge,":var005",1000),
(lt,":var004",4000),
(assign,":var002",0),
(team_give_order, ":var001", 9, 2),
(try_end),
(else_try),
(eq,":var002",2),
(team_get_leader, ":team_leader_006", ":var001"),
(try_begin),
(ge,":team_leader_006",0),
(agent_is_alive,":team_leader_006"),
(agent_set_speed_limit,":team_leader_006",9),
(call_script, "script_team_get_average_position_of_enemies", ":var001"),
(copy_position,60,0),
(agent_get_position,pos61,":team_leader_006"),
(position_transform_position_to_local, 62,61,60),
(position_normalize_origin,":var007",62),
(convert_from_fixed_point, ":var007"),
(assign,reg17,":var007"),
(position_get_x,":pos_x_008",62),
(position_get_y,":pos_y_009",62),
(val_mul, ":pos_x_008", 23),
(val_mul, ":pos_y_009", 23),
(position_set_x,62,":pos_x_008"),
(position_set_y,62,":pos_y_009"),
(position_transform_position_to_parent,63,61,62),
(position_set_z_to_ground_level, 63),
(team_give_order, ":var001", 9, 0),
(team_set_order_position, ":var001", 9, 63),
(agent_get_position,pos1,":team_leader_006"),
(try_begin),
(lt,":var007",50),
(ge,":m_timer_a_003",30),
(assign,":var002",0),
(team_give_order, ":var001", 9, 2),
(agent_set_speed_limit,":team_leader_006",60),
(try_end),
(else_try),
(assign,":var002",0),
(team_give_order, ":var001", 9, 2),
(try_end),
(try_end),
(try_begin),
(neq,":var002",0),
(ge,":m_timer_a_003",300),
(assign,":var002",0),
(team_give_order, ":var001", 9, 2),
(team_get_leader, ":team_leader_006", ":var001"),
(agent_set_speed_limit,":team_leader_006",60),
(try_end),
(assign,reg0,":var002"),
]),

("team_get_class_percentages", [
(store_script_param, ":var005", 1),
(store_script_param, ":var006", 2),
(assign,":var001",0),
(assign,":var002",0),
(assign,":var003",0),
(assign,":var004",0),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_team, ":agent_team_no_008", ":cur_agent"),
(assign,":var009",0),
(try_begin),
(eq,":var006",1),
(teams_are_enemies, ":agent_team_no_008", ":var005"),
(assign,":var009",1),
(else_try),
(eq,":agent_team_no_008",":var005"),
(assign,":var009",1),
(try_end),
(eq,":var009",1),
(val_add, ":var004", 1),
(agent_get_class ,":agent_class_010", ":cur_agent"),
(try_begin),
(eq,":agent_class_010",0),
(val_add, ":var001", 1),
(else_try),
(eq,":agent_class_010",1),
(val_add, ":var002", 1),
(else_try),
(eq,":agent_class_010",2),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_begin),
(eq,":var004",0),
(assign,":var004",1),
(try_end),
(store_mul, ":var011", ":var001", 100),
(val_div, ":var011", ":var004"),
(store_mul, ":var012", ":var002", 100),
(val_div, ":var012", ":var004"),
(store_mul, ":var013", ":var003", 100),
(val_div, ":var013", ":var004"),
(assign,reg0,":var011"),
(assign,reg1,":var012"),
(assign,reg2,":var013"),
]),

("get_closest3_distance_of_enemies_at_pos1", [
(store_script_param, ":var004", 1),
(assign,":var001",100000),
(assign,":var002",100000),
(assign,":var003",100000),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_team, ":agent_team_no_006", ":cur_agent"),
(teams_are_enemies, ":agent_team_no_006", ":var004"),
(agent_get_position,pos2,":cur_agent"),
(get_distance_between_positions,":distance_007",2,1),
(try_begin),
(lt,":distance_007",":var001"),
(assign,":var003",":var002"),
(assign,":var002",":var001"),
(assign,":var001",":distance_007"),
(else_try),
(lt,":distance_007",":var002"),
(assign,":var003",":var002"),
(assign,":var002",":distance_007"),
(else_try),
(lt,":distance_007",":var003"),
(assign,":var003",":distance_007"),
(try_end),
(try_end),
(try_end),
(assign,":var008",0),
(assign,":var009",0),
(try_begin),
(lt,":var001",100000),
(val_add, ":var008", ":var001"),
(val_add, ":var009", 1),
(try_end),
(try_begin),
(lt,":var002",100000),
(val_add, ":var008", ":var002"),
(val_add, ":var009", 1),
(try_end),
(try_begin),
(lt,":var003",100000),
(val_add, ":var008", ":var003"),
(val_add, ":var009", 1),
(try_end),
(assign,":var010",100000),
(try_begin),
(gt,":var009",0),
(store_div, ":var___x1", ":var008", ":var009"),
(assign,":var010",":var___x1"),
(try_end),
(assign,reg0,":var010"),
(assign,reg1,":var001"),
(assign,reg2,":var002"),
(assign,reg3,":var003"),
]),

("team_get_average_position_of_enemies", [
(store_script_param, ":var001", 1),
(init_position,0),
(assign,":var002",0),
(assign,":var003",0),
(assign,":var004",0),
(assign,":var005",0),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_team, ":agent_team_no_007", ":cur_agent"),
(teams_are_enemies, ":var001", ":agent_team_no_007"),
(agent_get_position,pos62,":cur_agent"),
(position_get_x,":pos_x_008",62),
(position_get_y,":pos_y_009",62),
(position_get_z,":pos_z_010",62),
(val_add, ":var003", ":pos_x_008"),
(val_add, ":var004", ":pos_y_009"),
(val_add, ":var005", ":pos_z_010"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(le,":var002",0),
(assign,":var002",1),
(try_end),
(store_div, ":var___x1", ":var003", ":var002"),
(assign,":var011",":var___x1"),
(store_div, ":var___x1", ":var004", ":var002"),
(assign,":var012",":var___x1"),
(store_div, ":var___x1", ":var005", ":var002"),
(assign,":var013",":var___x1"),
(position_set_x,0,":var011"),
(position_set_y,0,":var012"),
(position_set_z,0,":var013"),
(assign,reg0,":var002"),
]),

("search_troop_prisoner_of_party", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(try_for_parties, ":cur_party"),
(eq,":var002",-1),
(this_or_next|eq,":cur_party","p_main_party"),
(ge,":cur_party","p_town_1"),
(party_count_prisoners_of_type,":party_prisoners_of_type_004",":cur_party",":var001"),
(gt,":party_prisoners_of_type_004",0),
(assign,":var002",":cur_party"),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("change_debt_to_troop", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_001",21),
(assign,reg1,":troop_slot_003"),
(val_add, ":troop_slot_003", ":var002"),
(assign,reg2,":troop_slot_003"),
(troop_set_slot,":troop_id_001",21,":troop_slot_003"),
(str_store_string,s1,":str_store_troop_name_link(troop_id_001)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
]),

("abort_quest", [
(store_script_param, ":quest_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-1),
(assign,":var004",-2),
(try_begin),
(this_or_next|eq,":quest_id_001","qst_deliver_message_to_enemy_lord"),
(eq,":quest_id_001","qst_deliver_message"),
(assign,":var003",-2),
(assign,":var004",-3),
(else_try),
(eq,":quest_id_001","qst_kidnapped_girl"),
(party_remove_members,"p_main_party","trp_kidnapped_girl",1),
(quest_get_slot,":quest_slot_005","qst_kidnapped_girl",8),
(try_begin),
(party_is_active,":quest_slot_005"),
(remove_party,":quest_slot_005"),
(try_end),
(else_try),
(eq,":quest_id_001","qst_escort_lady"),
(quest_get_slot,":quest_slot_006","qst_escort_lady",4),
(party_remove_members,"p_main_party",":quest_slot_006",1),
(assign,":var003",-2),
(assign,":var004",-3),
(else_try),
(eq,":quest_id_001","qst_raise_troops"),
(quest_get_slot,":quest_slot_007",":quest_id_001",6),
(call_script, "script_change_debt_to_troop", ":quest_slot_007", 100),
(assign,":var003",-4),
(assign,":var004",-5),
(else_try),
(eq,":quest_id_001","qst_deal_with_looters"),
(try_for_parties, ":cur_party"),
(party_get_template_id,":party_template_id_009",":cur_party"),
(try_begin),
(eq,":party_template_id_009","pt_looters"),
(party_set_flags, ":cur_party", 262144, 0),
(try_end),
(try_end),
(assign,":var003",-4),
(assign,":var004",-5),
(else_try),
(eq,":quest_id_001","qst_deal_with_bandits_at_lords_village"),
(quest_get_slot,":quest_slot_007",":quest_id_001",6),
(call_script, "script_change_debt_to_troop", ":quest_slot_007", 200),
(assign,":var003",-5),
(assign,":var004",-6),
(else_try),
(eq,":quest_id_001","qst_collect_taxes"),
(quest_get_slot,":quest_slot_010",":quest_id_001",22),
(quest_set_slot,":quest_id_001",22,0),
(quest_get_slot,":quest_slot_007",":quest_id_001",6),
(call_script, "script_change_debt_to_troop", ":quest_slot_007", ":quest_slot_010"),
(assign,":var003",-4),
(assign,":var004",-6),
(else_try),
(eq,":quest_id_001","qst_hunt_down_fugitive"),
(assign,":var003",-3),
(assign,":var004",-4),
(else_try),
(eq,":quest_id_001","qst_kill_local_merchant"),
(else_try),
(eq,":quest_id_001","qst_bring_back_runaway_serfs"),
(assign,":var003",-1),
(assign,":var004",-1),
(else_try),
(eq,":quest_id_001","qst_collect_debt"),
(try_begin),
(quest_slot_eq,"qst_collect_debt",11,1),
(quest_get_slot,":quest_slot_011","qst_collect_debt",10),
(quest_get_slot,":quest_slot_012","qst_collect_debt",6),
(call_script, "script_change_debt_to_troop", ":quest_slot_012", ":quest_slot_011"),
(assign,":var003",-3),
(assign,":var004",-6),
(else_try),
(assign,":var003",-3),
(assign,":var004",-4),
(try_end),
(else_try),
(eq,":quest_id_001","qst_deal_with_bandits_at_lords_village"),
(assign,":var003",-6),
(assign,":var004",-6),
(else_try),
(eq,":quest_id_001","qst_cause_provocation"),
(assign,":var003",-10),
(assign,":var004",-13),
(else_try),
(eq,":quest_id_001","qst_persuade_lords_to_make_peace"),
(assign,":var003",-10),
(assign,":var004",-13),
(else_try),
(eq,":quest_id_001","qst_deal_with_night_bandits"),
(assign,":var003",-1),
(assign,":var004",-1),
(else_try),
(eq,":quest_id_001","qst_follow_spy"),
(assign,":var003",-2),
(assign,":var004",-3),
(try_begin),
(party_is_active,"$qst_follow_spy_spy_party"),
(remove_party,"$qst_follow_spy_spy_party"),
(try_end),
(try_begin),
(party_is_active,"$qst_follow_spy_spy_partners_party"),
(remove_party,"$qst_follow_spy_spy_partners_party"),
(try_end),
(else_try),
(eq,":quest_id_001","qst_capture_enemy_hero"),
(assign,":var003",-3),
(assign,":var004",-4),
(else_try),
(eq,":quest_id_001","qst_lend_companion"),
(quest_get_slot,":quest_slot_013","qst_lend_companion",2),
(troop_set_slot,":quest_slot_013",151,8),
(troop_set_slot,":quest_slot_013",150,0),
(else_try),
(eq,":quest_id_001","qst_lend_surgeon"),
(quest_get_slot,":quest_slot_013","qst_lend_surgeon",2),
(troop_set_slot,":quest_slot_013",151,8),
(troop_set_slot,":quest_slot_013",150,0),
(else_try),
(eq,":quest_id_001","qst_incriminate_loyal_commander"),
(assign,":var003",-5),
(assign,":var004",-6),
(else_try),
(eq,":quest_id_001","qst_lend_surgeon"),
(else_try),
(eq,":quest_id_001","qst_rescue_lord_by_replace"),
(assign,":var003",-1),
(assign,":var004",-1),
(else_try),
(eq,":quest_id_001","qst_deliver_message_to_prisoner_lord"),
(assign,":var003",0),
(assign,":var004",-1),
(else_try),
(eq,":quest_id_001","qst_duel_for_lady"),
(assign,":var003",-1),
(assign,":var004",-1),
(else_try),
(eq,":quest_id_001","qst_follow_army"),
(assign,":var003",0),
(assign,":var004",0),
(else_try),
(eq,":quest_id_001","qst_deliver_cattle_to_army"),
(assign,":var003",0),
(assign,":var004",0),
(else_try),
(eq,":quest_id_001","qst_join_siege_with_army"),
(assign,":var003",-1),
(assign,":var004",-2),
(else_try),
(eq,":quest_id_001","qst_scout_waypoints"),
(assign,":var003",0),
(assign,":var004",0),
(else_try),
(eq,":quest_id_001","qst_deliver_grain"),
(assign,":var003",-6),
(assign,":var004",-7),
(else_try),
(eq,":quest_id_001","qst_deliver_cattle"),
(assign,":var003",-3),
(assign,":var004",-4),
(else_try),
(eq,":quest_id_001","qst_train_peasants_against_bandits"),
(assign,":var003",-4),
(assign,":var004",-5),
(else_try),
(eq,":quest_id_001","qst_deliver_wine"),
(assign,":var003",-1),
(assign,":var004",-3),
(val_add, ":::debt_to_merchants_guild", ":::qst_deliver_wine_debt"),
(else_try),
(eq,":quest_id_001","qst_move_cattle_herd"),
(assign,":var003",-1),
(assign,":var004",-3),
(else_try),
(eq,":quest_id_001","qst_escort_merchant_caravan"),
(assign,":var003",-1),
(assign,":var004",-3),
(else_try),
(eq,":quest_id_001","qst_troublesome_bandits"),
(assign,":var003",-1),
(assign,":var004",-2),
(else_try),
(eq,":quest_id_001","qst_join_faction"),
(assign,":var003",-3),
(assign,":var004",-3),
(try_begin),
(eq,1,1),
(call_script, "script_get_number_of_hero_centers", "trp_player"),
(try_begin),
(gt,reg0,0),
(call_script, "script_change_player_relation_with_faction", "$g_invite_faction", -10),
(try_end),
(try_end),
(try_begin),
(quest_slot_eq,"qst_join_faction",26,1),
(call_script, "script_diplomacy_start_war_between_kingdoms", "fac_player_supporters_faction", "$g_invite_faction", 0),
(call_script, "script_change_player_honor", -5),
(quest_set_slot,"qst_join_faction",26,0),
(try_end),
(assign,"$g_invite_faction",0),
(assign,"$g_invite_faction_lord",0),
(assign,"$g_invite_offered_center",0),
(else_try),
(eq,":quest_id_001","qst_eliminate_bandits_infesting_village"),
(assign,":var003",-3),
(assign,":var004",-3),
(else_try),
(ge,":quest_id_001","qst_resolve_dispute"),
(assign,":var014",-2),
(assign,":var003",0),
(assign,":var004",0),
(else_try),
(ge,":quest_id_001","qst_consult_with_minister"),
(assign,":var014",-2),
(assign,":var003",0),
(assign,":var004",0),
(try_end),
(try_begin),
(gt,":var002",0),
(lt,":quest_id_001","qst_resolve_dispute"),
(quest_get_slot,":quest_slot_012",":quest_id_001",6),
(assign,":var015",":var003"),
(try_begin),
(eq,":var002",2),
(assign,":var015",":var004"),
(try_end),
(try_begin),
(this_or_next|is_between,":quest_slot_012","trp_village_1_elder","trp_merchants_end"),
(is_between,":quest_slot_012","trp_town_1_mayor","trp_village_1_elder"),
(quest_get_slot,":quest_slot_016",":quest_id_001",12),
(call_script, "script_change_player_relation_with_center", ":quest_slot_016", ":var015"),
(else_try),
(call_script, "script_change_player_relation_with_troop", ":quest_slot_012", ":var015"),
(try_end),
(try_end),
(call_script, "script_fail_quest", ":quest_id_001"),
(try_begin),
(gt,":var002",0),
(neq,":quest_id_001","qst_consult_with_minister"),
(neq,":quest_id_001","qst_resolve_dispute"),
(neq,":quest_id_001","qst_visit_lady"),
(neq,":quest_id_001","qst_formal_marriage_proposal"),
(neq,":quest_id_001","qst_duel_courtship_rival"),
(neq,":quest_id_001","qst_follow_army"),
(neq,":quest_id_001","qst_denounce_lord"),
(neq,":quest_id_001","qst_intrigue_against_lord"),
(neq,":quest_id_001","qst_offer_gift"),
(neq,":quest_id_001","qst_organize_feast"),
(call_script, "script_objectionable_action", 4, "str_fail_quest"),
(try_end),
(try_begin),
(eq,":quest_id_001","qst_resolve_dispute"),
(faction_slot_eq,"$players_kingdom",11,"trp_player"),
(call_script, "script_change_player_right_to_rule", ":var014"),
(try_for_range, ":trp_017", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_018",":trp_017"),
(eq,":troop_faction_018","fac_player_supporters_faction"),
(call_script, "script_troop_change_relation_with_troop", ":trp_017", "trp_player", ":var014"),
(try_end),
(try_end),
(try_begin),
(eq,":quest_id_001","qst_organize_feast"),
(call_script, "script_add_notification_menu", "mnu_notification_feast_quest_expired", 0, 0),
(try_end),
(call_script, "script_end_quest", ":quest_id_001"),
]),

("cf_is_quest_troop", [
(store_script_param, ":var001", 1),
(try_for_range, ":quest_id_003", 0, ":qst.quests_end"),
(check_quest_active,":quest_id_003"),
(quest_get_slot,":quest_slot_004",":quest_id_003",2),
(quest_get_slot,":quest_slot_005",":quest_id_003",4),
(quest_get_slot,":quest_slot_006",":quest_id_003",6),
(this_or_next|eq,":quest_slot_004",":var001"),
(this_or_next|eq,":quest_slot_005",":var001"),
(eq,":quest_slot_006",":var001"),
(assign,0,1), # var002
(try_end),
(try_end),
]),

("check_friendly_kills", [
(get_player_agent_own_troop_kill_count,":agent_own_troop_kill_count_001",":"),
(try_begin),
(neq,":::g_player_current_own_troop_kills",":agent_own_troop_kill_count_001"),
(val_sub, ":agent_own_troop_kill_count_001", ":::g_player_current_own_troop_kills"),
(val_add, ":::g_player_current_own_troop_kills", ":agent_own_troop_kill_count_001"),
(val_mul, ":agent_own_troop_kill_count_001", -1),
(call_script, "script_change_player_party_morale", ":agent_own_troop_kill_count_001"),
(try_end),
]),

("simulate_retreat", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(call_script, "script_music_set_situation_with_culture", 32768),
(set_show_messages,0),
(assign,":var004",0),
(assign,":var005",0),
(assign,":var006",1),
(try_begin),
(eq,1,1),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_set_slot,":cur_agent",3,1),
(agent_get_troop_id,":troop_id_008", ":cur_agent"),
(store_character_level,":character_lvl_009",":troop_id_008"),
(val_add, ":character_lvl_009", 5),
(try_begin),
(troop_is_hero,":troop_id_008"),
(val_add, ":character_lvl_009", 5),
(try_end),
(try_begin),
(agent_is_ally,":cur_agent"),
(val_add, ":var004", ":character_lvl_009"),
(else_try),
(val_add, ":var005", ":character_lvl_009"),
(try_end),
(try_end),
(try_begin),
(eq,":::pin_player_fallen",0),
(lt,":var005",":var004"),
(eq,":var003",1),
(assign,":var006",0),
(try_end),
(try_end),
(try_begin),
(eq,":var006",1),
(assign,"$g_last_mission_player_damage",0),
(party_clear,"p_temp_party"),
(party_clear,"p_temp_party_2"),
(call_script, "script_simulate_battle_with_agents_aux", 0, ":var001"),
(call_script, "script_simulate_battle_with_agents_aux", 1, ":var002"),
(assign,":var010",0),
(try_begin),
(gt,":::g_last_mission_player_damage",0),
(assign,":var010",1),
(assign,reg1,"$g_last_mission_player_damage"),
(str_store_string,s12,":str_store_string("str_casualty_display_hp")"),
(else_try),
(str_clear, 12),
(try_end),
(call_script, "script_print_casualties_to_s0", "p_temp_party", 1),
(try_begin),
(eq,1,1),
(party_get_num_companion_stacks,":party_num_companions_stacks_011","p_temp_party"),
(try_begin),
(gt,":party_num_companions_stacks_011",0),
(assign,":var010",1),
(try_end),
(try_end),
(str_store_string,s10,":str_store_string_reg(0)"),
(call_script, "script_print_casualties_to_s0", "p_temp_party_2", 1),
(try_begin),
(eq,1,1),
(party_get_num_companion_stacks,":party_num_companions_stacks_011","p_temp_party_2"),
(try_begin),
(gt,":party_num_companions_stacks_011",0),
(assign,":var010",1),
(try_end),
(try_end),
(str_store_string,s11,":str_store_string_reg(0)"),
(try_begin),
(eq,":var010",1),
(dialog_box,"str_casualty_display",5),
(try_end),
(try_end),
(set_show_messages,1),
(assign,":var012",0),
(assign,":var013",0),
(assign,":var014",0),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(try_begin),
(agent_is_ally,":cur_agent"),
(val_add, ":var014", 1),
(neg|agent_is_alive,":cur_agent"),
(val_add, ":var012", 1),
(try_end),
(else_try),
(neg|agent_is_alive,":cur_agent"),
(val_add, ":var013", 1),
(try_end),
(store_add, ":var015", ":var012", ":var013"),
(try_begin),
(gt,":var015",0),
(store_mul, ":var016", ":var012", 100),
(val_div, ":var016", ":var015"),
(val_mul, ":var016", ":var012"),
(val_div, ":var016", ":var014"),
(val_mul, ":var016", -30),
(val_div, ":var016", 100),
(call_script, "script_change_player_party_morale", ":var016"),
(try_end),
]),

("simulate_battle_with_agents_aux", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(get_player_agent_no,":agent_no_003"),
(try_for_agents, ":cur_agent"),
(neq,":agent_no_003",":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_slot_eq,":cur_agent",3,1),
(try_begin),
(agent_is_ally,":cur_agent"),
(assign,":var005",0),
(else_try),
(assign,":var005",1),
(try_end),
(try_begin),
(eq,":var005",":var001"),
(agent_get_position,pos2,":cur_agent"),
(assign,":var006",-1),
(assign,":var007",100000),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(try_begin),
(agent_is_ally,":cur_agent"),
(assign,":var009",0),
(else_try),
(assign,":var009",1),
(try_end),
(try_end),
(this_or_next|eq,":cur_agent",":agent_no_003"),
(eq,":::pin_player_fallen",0),
(neq,":var001",":var009"),
(agent_get_position,pos3,":cur_agent"),
(get_distance_between_positions,":distance_010",2,3),
(lt,":distance_010",":var007"),
(assign,":var007",":distance_010"),
(assign,":var006",":cur_agent"),
(try_end),
(ge,":var006",0),
(agent_get_class ,":agent_class_011", ":cur_agent"),
(assign,":var012",1),
(assign,":var013",0),
(try_begin),
(eq,":agent_class_011",1),
(assign,":var013",2),
(else_try),
(eq,":agent_class_011",2),
(assign,":var012",2),
(try_end),
(try_end),
(agent_get_class ,":agent_class_011", ":var006"),
(assign,":var014",1),
(try_begin),
(eq,":agent_class_011",2),
(assign,":var014",2),
(try_end),
(assign,":var015",18000),
(val_add, ":var007", 3000),
(val_div, ":var015", ":var007"),
(val_mul, ":var015", 2),
(val_mul, ":var015", ":var012"),
(val_div, ":var015", ":var014"),
(val_add, ":var015", ":var013"),
(assign,":var016",":var002"),
(agent_get_troop_id,":troop_id_017", ":var006"),
(agent_get_troop_id,":troop_id_018", ":cur_agent"),
(store_character_level,":character_lvl_019",":troop_id_017"),
(store_character_level,":character_lvl_020",":troop_id_018"),
(store_sub, ":var021", ":character_lvl_020", ":character_lvl_019"),
(val_div, ":var021", 5),
(val_add, ":var016", ":var021"),
(try_begin),
(eq,":var006",":agent_no_003"),
(val_div, ":var016", 2),
set absolute to 1 to retrieve actual hps, ":agent_no_003",
(try_end),
(try_for_range, ":var023", 0, ":var015"),
(store_random_in_range,":random_x_024",0,100),
(try_begin),
(lt,":random_x_024",":var016"),
(agent_deliver_damage_to_agent, ":cur_agent", ":var006"),
(try_end),
(try_end),
(try_begin),
(eq,":var006",":agent_no_003"),
set absolute to 1 to retrieve actual hps, ":agent_no_003",
(store_sub, ":var026", ":agent_hit_points_022", ":agent_hit_points_025"),
(val_add, ":::g_last_mission_player_damage", ":var026"),
(try_end),
(try_begin),
(neg|agent_is_alive,":var006"),
(try_begin),
(eq,":var001",1),
(party_add_members,"p_temp_party",":troop_id_017",1),
(agent_is_wounded,":var006"),
(party_wound_members,"p_temp_party",":troop_id_017",1),
(try_end),
(else_try),
(party_add_members,"p_temp_party_2",":troop_id_017",1),
(try_begin),
(agent_is_wounded,":var006"),
(party_wound_members,"p_temp_party_2",":troop_id_017",1),
(try_end),
(try_end),
]),

("map_get_random_position_around_position_within_range", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(val_mul, ":var001", 100),
(assign,":var003",1),
(try_for_range, ":var004", 0, 20),
(eq,":var003",1),
(map_get_random_position_around_position,pos2,1,":var002"),
(get_distance_between_positions,":distance_005",2,1),
(ge,":distance_005",":var001"),
(assign,":var003",0),
(try_end),
(try_end),
]),

("get_number_of_unclaimed_centers_by_player", [
(assign,":var001",0),
(try_for_range, ":p_002", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_003", ":p_002"),
(try_begin),
(eq,":party_faction_003","fac_player_supporters_faction"),
(party_slot_eq,":p_002",9,0),
(party_get_num_companion_stacks,":party_num_companions_stacks_004",":p_002"),
(ge,":party_num_companions_stacks_004",1),
(assign,-1,":p_002"), # reg1
(val_add, ":var001", 1),
(try_end),
(try_end),
(assign,reg0,":var001"),
]),

("cf_troop_check_troop_is_enemy", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(call_script, "script_troop_get_relation_with_troop", ":var001", ":var002"),
]),

("troop_get_leaded_center_with_index", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-1),
(assign,":var004",0),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(eq,":var003",-1),
(party_slot_eq,":p_005",7,":var001"),
(val_add, ":var004", 1),
(gt,":var004",":var002"),
(assign,":var003",":p_005"),
(try_end),
(try_end),
(assign,reg0,":var003"),
]),

("cf_troop_get_random_leaded_walled_center_with_less_strength_priority", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.town_1", ":p.village_1"),
(party_slot_eq,":p_004",7,":var001"),
(party_slot_eq,":p_004",54,-1),
(val_add, ":var003", 1),
(eq,":p_004",":var002"),
(val_add, ":var003", 99),
(try_end),
(try_end),
(try_begin),
(gt,":var003",0),
(store_random_in_range,":random_x_005",0,":var003"),
(assign,":var006",-1),
(try_for_range, ":p_004", ":p.town_1", ":p.village_1"),
(eq,":var006",-1),
(party_slot_eq,":p_004",7,":var001"),
(party_slot_eq,":p_004",54,-1),
(val_sub, ":random_x_005", 1),
(eq,":p_004",":var002"),
(val_sub, ":random_x_005", 99),
(try_end),
(try_end),
(lt,":random_x_005",0),
(assign,":var006",":p_004"),
(try_end),
(assign,reg0,":var006"),
]),

("cf_troop_get_random_leaded_town_or_village_except_center", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.town_1", ":p.salt_mine"),
(neg|party_slot_eq,":p_004",0,2),
(party_slot_eq,":p_004",7,":var001"),
(neq,":p_004",":var002"),
(val_add, ":var003", 1),
(try_end),
(try_begin),
(gt,":var003",0),
(store_random_in_range,":random_x_005",0,":var003"),
(assign,":var006","p_salt_mine"),
(try_for_range, ":p_004", ":p.town_1", ":var006"),
(neg|party_slot_eq,":p_004",0,2),
(party_slot_eq,":p_004",7,":var001"),
(neq,":p_004",":var002"),
(val_sub, ":random_x_005", 1),
(lt,":random_x_005",0),
(assign,":var007",":p_004"),
(assign,":var006",0),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var007"),
]),

("troop_write_owned_centers_to_s2", [
(store_script_param, ":troop_id_001", 1),
(call_script, "script_get_number_of_hero_centers", ":troop_id_001"),
(assign,":var002",reg0),
(str_store_string,s5,":str_store_troop_name(troop_id_001)"),
(try_begin),
(gt,":var002",1),
(try_for_range, ":var003", 1, ":var002"),
(call_script, "script_troop_get_leaded_center_with_index", ":troop_id_001", ":var003"),
(str_store_string,s50,":str_store_party_name_link(reg0)"),
(try_begin),
(eq,":var003",1),
(call_script, "script_troop_get_leaded_center_with_index", ":troop_id_001", 0),
(str_store_string,s51,":str_store_party_name_link(reg0)"),
(str_store_string,s51,":str_store_string("str_s50_and_s51")"),
(else_try),
(str_store_string,s51,":str_store_string("str_s50_comma_s51")"),
(try_end),
(try_end),
(str_store_string,s2,":str_store_string("str_s5_is_the_ruler_of_s51")"),
(else_try),
(eq,":var002",1),
(call_script, "script_troop_get_leaded_center_with_index", ":troop_id_001", 0),
(str_store_string,s51,":str_store_party_name_link(reg0)"),
(str_store_string,s2,":str_store_string("str_s5_is_the_ruler_of_s51")"),
(else_try),
(store_troop_faction,":troop_faction_004",":troop_id_001"),
(str_store_string,s6,":str_store_faction_name_link(troop_faction_004)"),
(str_store_string,s2,":str_store_string("str_s5_is_a_nobleman_of_s6")"),
(try_end),
]),

("troop_write_family_relations_to_s1", [
(str_clear, 1),
]),

("troop_get_family_relation_to_troop", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(troop_get_type,":troop_type_003",":troop_id_001"),
(assign,":var004",0),
(troop_get_slot,":troop_slot_005",":troop_id_001",30),
(troop_get_slot,":troop_slot_006",":troop_id_002",30),
(try_begin),
(gt,":troop_slot_005",-1),
(troop_get_slot,":troop_slot_007",":troop_slot_005",31),
(else_try),
(assign,":troop_slot_007",-1),
(try_end),
(try_begin),
(gt,":troop_slot_006",-1),
(troop_get_slot,":troop_slot_008",":troop_slot_006",31),
(else_try),
(assign,":troop_slot_008",-1),
(try_end),
(try_begin),
(gt,":troop_slot_006",-1),
(troop_get_slot,":troop_slot_009",":troop_slot_006",32),
(else_try),
(assign,":troop_slot_009",-1),
(try_end),
(troop_get_slot,":troop_slot_010",":troop_id_001",31),
(troop_get_slot,":troop_slot_011",":troop_id_002",31),
(troop_get_slot,":troop_slot_012",":troop_id_001",32),
(troop_get_slot,":troop_slot_013",":troop_id_002",32),
(try_begin),
(is_between,":troop_slot_010","trp_npc1","trp_heroes_end"),
(troop_get_slot,":troop_slot_014",":troop_slot_010",31),
(else_try),
(assign,":troop_slot_014",-1),
(try_end),
(try_begin),
(is_between,":troop_slot_011","trp_npc1","trp_heroes_end"),
(troop_get_slot,":troop_slot_015",":troop_slot_011",31),
(else_try),
(assign,":troop_slot_015",-1),
(try_end),
(troop_get_slot,":troop_slot_016",":troop_id_001",33),
(troop_get_slot,":troop_slot_017",":troop_id_002",33),
(str_store_string,s11,":str_store_string("str_no_relation")"),
(try_begin),
(eq,":troop_id_001",":troop_id_002"),
(else_try),
(eq,":troop_slot_005",":troop_id_002"),
(assign,":var004",20),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_wife")"),
(else_try),
(str_store_string,s11,":str_store_string("str_husband")"),
(try_end),
(else_try),
(eq,":troop_slot_011",":troop_id_001"),
(assign,":var004",15),
(str_store_string,s11,":str_store_string("str_father")"),
(else_try),
(eq,":troop_slot_013",":troop_id_001"),
(assign,":var004",15),
(str_store_string,s11,":str_store_string("str_mother")"),
(else_try),
(this_or_next|eq,":troop_slot_010",":troop_id_002"),
(eq,":troop_slot_012",":troop_id_002"),
(assign,":var004",15),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_daughter")"),
(else_try),
(str_store_string,s11,":str_store_string("str_son")"),
(try_end),
(else_try),
(gt,":troop_slot_010",-1),
(eq,":troop_slot_010",":troop_slot_011"),
(assign,":var004",10),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_sister")"),
(else_try),
(str_store_string,s11,":str_store_string("str_brother")"),
(try_end),
(else_try),
(eq,":troop_slot_017",":troop_id_001"),
(assign,":var004",10),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_sister")"),
(else_try),
(str_store_string,s11,":str_store_string("str_brother")"),
(try_end),
(else_try),
(eq,":troop_slot_016",":troop_id_002"),
(assign,":var004",10),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_sister")"),
(else_try),
(str_store_string,s11,":str_store_string("str_brother")"),
(try_end),
(else_try),
(gt,":troop_slot_014",-1),
(eq,":troop_slot_014",":troop_slot_011"),
(assign,":var004",4),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_niece")"),
(else_try),
(str_store_string,s11,":str_store_string("str_nephew")"),
(try_end),
(else_try),
(gt,":troop_slot_015",-1),
(eq,":troop_slot_015",":troop_slot_010"),
(assign,":var004",4),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_aunt")"),
(else_try),
(str_store_string,s11,":str_store_string("str_uncle")"),
(try_end),
(else_try),
(gt,":troop_slot_014",0),
(eq,":troop_slot_015",":troop_slot_014"),
(assign,":var004",2),
(str_store_string,s11,":str_store_string("str_cousin")"),
(else_try),
(eq,":troop_slot_007",":troop_id_002"),
(assign,":var004",5),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_daughterinlaw")"),
(else_try),
(str_store_string,s11,":str_store_string("str_soninlaw")"),
(try_end),
(else_try),
(eq,":troop_slot_008",":troop_id_001"),
(assign,":var004",5),
(str_store_string,s11,":str_store_string("str_fatherinlaw")"),
(else_try),
(eq,":troop_slot_009",":troop_id_001"),
(neq,":troop_slot_009","trp_player"),
(assign,":var004",5),
(str_store_string,s11,":str_store_string("str_motherinlaw")"),
(else_try),
(gt,":troop_slot_007",-1),
(eq,":troop_slot_007",":troop_slot_011"),
(assign,":var004",5),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_sisterinlaw")"),
(else_try),
(str_store_string,s11,":str_store_string("str_brotherinlaw")"),
(try_end),
(else_try),
(gt,":troop_slot_008",-1),
(eq,":troop_slot_008",":troop_slot_010"),
(assign,":var004",5),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_sisterinlaw")"),
(else_try),
(str_store_string,s11,":str_store_string("str_brotherinlaw")"),
(try_end),
(else_try),
(gt,":troop_slot_006",-1),
(troop_slot_eq,":troop_slot_006",33,":troop_id_001"),
(assign,":var004",5),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_sisterinlaw")"),
(else_try),
(str_store_string,s11,":str_store_string("str_brotherinlaw")"),
(try_end),
(else_try),
(gt,":troop_slot_005",-1),
(troop_slot_eq,":troop_slot_005",33,":troop_id_002"),
(assign,":var004",5),
(try_begin),
(eq,":troop_type_003",1),
(str_store_string,s11,":str_store_string("str_sisterinlaw")"),
(else_try),
(str_store_string,s11,":str_store_string("str_brotherinlaw")"),
(try_end),
(try_end),
(assign,reg4,":troop_type_003"),
(assign,reg0,":var004"),
]),

("collect_friendly_parties", [
(party_collect_attachments_to_party, "p_main_party", "p_collective_friends"),
(try_begin),
(gt,":::g_ally_party",0),
(party_collect_attachments_to_party, "$g_ally_party", "p_temp_party"),
(assign,"$g_move_heroes",1),
(call_script, "script_party_add_party", "p_collective_friends", "p_temp_party"),
(try_end),
]),

("encounter_calculate_fit", [
(call_script, "script_party_count_fit_for_battle", "p_main_party"),
(call_script, "script_collect_friendly_parties"),
(call_script, "script_party_count_fit_for_battle", "p_collective_friends"),
(assign,"$g_friend_fit_for_battle",reg0),
(party_clear,"p_collective_ally"),
(try_begin),
(gt,":::g_ally_party",0),
(party_is_active,"$g_ally_party"),
(party_collect_attachments_to_party, "$g_ally_party", "p_collective_ally"),
(try_end),
(party_clear,"p_collective_enemy"),
(try_begin),
(party_is_active,"$g_enemy_party"),
(party_collect_attachments_to_party, "$g_enemy_party", "p_collective_enemy"),
(try_end),
(call_script, "script_party_count_fit_for_battle", "p_collective_enemy"),
(assign,"$g_enemy_fit_for_battle",reg0),
(assign,reg11,"$g_enemy_fit_for_battle"),
(assign,reg10,"$g_friend_fit_for_battle"),
]),

("encounter_init_variables", [
(assign,"$capture_screen_shown",0),
(assign,"$loot_screen_shown",0),
(assign,"$thanked_by_ally_leader",0),
(assign,"$g_battle_result",0),
(assign,"$cant_leave_encounter",0),
(assign,"$cant_talk_to_enemy",0),
(assign,"$last_defeated_hero",0),
(assign,"$last_freed_hero",0),
(call_script, "script_encounter_calculate_fit"),
(call_script, "script_party_copy", "p_main_party_backup", "p_main_party"),
(call_script, "script_party_calculate_strength", "p_main_party", 0),
(assign,"$g_starting_strength_main_party",reg0),
(call_script, "script_party_copy", "p_encountered_party_backup", "p_collective_enemy"),
(call_script, "script_party_calculate_strength", "p_collective_enemy", 0),
(assign,"$g_starting_strength_enemy_party",reg0),
(assign,"$g_strength_contribution_of_player",100),
(call_script, "script_party_copy", "p_collective_friends_backup", "p_collective_friends"),
(call_script, "script_party_calculate_strength", "p_collective_friends", 0),
(assign,"$g_starting_strength_friends",reg0),
(store_mul, ":_g_strength_contribution_of_player", "$g_starting_strength_main_party", 100),
(try_begin),
(gt,":::g_starting_strength_friends",0),
(val_div, ":::g_strength_contribution_of_player", ":::g_starting_strength_friends"),
(else_try),
(assign,"$g_strength_contribution_of_player",100),
(try_end),
(party_clear,"p_routed_enemies"),
(assign,"$num_routed_us",0),
(assign,"$num_routed_allies",0),
(assign,"$num_routed_enemies",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_001","p_main_party"),
(try_for_range, ":stack_no_002", 0, ":party_num_companions_stacks_001"),
(party_stack_get_troop_id,      ":troop_id_003","p_main_party",":stack_no_002"),
(try_begin),
(eq,1,1),
(troop_set_slot,":troop_id_003",146,0),
(try_end),
(try_end),
(party_get_num_companion_stacks,":party_num_companions_stacks_001","p_collective_friends"),
(try_for_range, ":stack_no_002", 0, ":party_num_companions_stacks_001"),
(party_stack_get_troop_id,      ":troop_id_003","p_collective_friends",":stack_no_002"),
(try_begin),
(eq,1,1),
(troop_set_slot,":troop_id_003",147,0),
(try_end),
(try_end),
(party_get_num_companion_stacks,":party_num_companions_stacks_001","p_collective_enemy"),
(try_for_range, ":stack_no_002", 0, ":party_num_companions_stacks_001"),
(party_stack_get_troop_id,      ":troop_id_003","p_collective_enemy",":stack_no_002"),
(try_begin),
(eq,1,1),
(troop_set_slot,":troop_id_003",148,0),
(try_end),
(try_end),
(try_for_range, ":faction_id_004", 15, 21),
(faction_set_slot,":faction_id_004",90,0),
(try_end),
(assign,"$routed_party_added",0),
(party_clear,"p_total_enemy_casualties"),
]),

("calculate_renown_value", [
(call_script, "script_party_calculate_strength", "p_main_party", 0),
(assign,":var001",reg0),
(call_script, "script_party_calculate_strength", "p_collective_enemy", 0),
(assign,":var002",reg0),
(call_script, "script_party_calculate_strength", "p_collective_friends", 0),
(assign,":var003",reg0),
(val_add, ":var003", 1),
(store_mul, ":var004", ":var002", 100),
(val_div, ":var004", ":var003"),
(assign,":var005",":var002"),
(val_mul, ":var005", ":var004"),
(val_div, ":var005", 100),
(val_mul, ":var005", ":var001"),
(val_div, ":var005", ":var003"),
(store_div, ":var___x1", ":var005", 5),
(assign,"$battle_renown_value",":var___x1"),
(val_min,"$battle_renown_value",2500),
(convert_to_fixed_point, "$battle_renown_value"),
(store_sqrt, "$battle_renown_value", "$battle_renown_value"),
(convert_from_fixed_point, "$battle_renown_value"),
(assign,reg8,"$battle_renown_value"),
(assign, reg0, 4294967295),
(display_message, "@{reg0}"),
]),

("cf_get_first_agent_with_troop_id", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(try_for_agents, ":cur_agent"),
(eq,":var002",-1),
(agent_get_troop_id,":troop_id_004", ":cur_agent"),
(eq,":troop_id_004",":var001"),
(assign,":var002",":cur_agent"),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("cf_team_get_average_position_of_agents_with_type_to_pos1", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(assign,":var004",0),
(assign,":var005",0),
(assign,":var006",0),
(set_fixed_point_multiplier, 100),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_team, ":agent_team_no_008", ":cur_agent"),
(eq,":agent_team_no_008",":var001"),
(agent_get_division ,":agent_division_009", ":cur_agent"),
(this_or_next|eq,":var002",":agent_division_009"),
(eq,":var002",9),
(agent_get_position,pos1,":cur_agent"),
(position_get_x,":pos_x_010",1),
(val_add, ":var003", ":pos_x_010"),
(position_get_y,":pos_y_011",1),
(val_add, ":var004", ":pos_y_011"),
(position_get_z,":pos_z_012",1),
(val_add, ":var005", ":pos_z_012"),
(val_add, ":var006", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var006",1),
(val_div, ":var003", ":var006"),
(val_div, ":var004", ":var006"),
(val_div, ":var005", ":var006"),
(init_position,1),
(position_move_x,1,":var003"),
(position_move_y,1,":var004"),
(position_move_z,1,":var005"),
(try_end),
]),

("cf_turn_windmill_fans", [
(store_script_param, ":var001", 1),
(scene_prop_get_instance, ":scp_instance_002", "spr_windmill_fan_turning", ":var001"),
(try_begin),
(ge,":scp_instance_002",0),
(prop_instance_get_position, pos1, ":scp_instance_002"),
(position_rotate_y,1,10),
(prop_instance_animate_to_position, ":scp_instance_002", 1, 100),
(val_add, ":var001", 1),
(try_end),
]),

("print_party_members", [
(store_script_param, ":party_id_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(assign,reg10,":party_num_companions_stacks_002"),
(try_for_range, ":stack_no_003", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_004",":party_id_001",":stack_no_003"),
(try_begin),
(troop_is_hero,":troop_id_004"),
(try_begin),
(eq,":stack_no_003",0),
(str_store_string,s51,":str_store_troop_name(troop_id_004)"),
(try_end),
(try_end),
(str_store_string,s52,":str_store_troop_name(troop_id_004)"),
(try_begin),
(eq,":stack_no_003",1),
(str_store_string,s51,":str_store_string("str_s52_and_s51")"),
(else_try),
(gt,":stack_no_003",1),
(str_store_string,s51,":str_store_string("str_s52_comma_s51")"),
(try_end),
(try_end),
(try_begin),
(eq,":party_num_companions_stacks_002",0),
(str_store_string,s51,":str_store_string("str_noone")"),
(try_end),
]),

("round_value", [
(store_script_param, ":var001", 1),
(try_begin),
(lt,":var001",100),
(neq,":var001",0),
(val_add, ":var001", 5),
(val_div, ":var001", 10),
(val_mul, ":var001", 10),
(try_begin),
(eq,":var001",0),
(assign,":var001",5),
(try_end),
(else_try),
(lt,":var001",300),
(val_add, ":var001", 25),
(val_div, ":var001", 50),
(val_mul, ":var001", 50),
(else_try),
(val_add, ":var001", 50),
(val_div, ":var001", 100),
(val_mul, ":var001", 100),
(try_end),
(assign,reg0,":var001"),
]),

("change_banners_and_chest", [
(party_get_slot,":party_slot_001","$g_encountered_party",7),
(try_begin),
(ge,":party_slot_001",0),
(troop_get_slot,":troop_slot_002",":party_slot_001",13),
(try_begin),
(gt,":troop_slot_002",0),
(replace_scene_props, "spr_banner_a",":troop_slot_002"),
(else_try),
(replace_scene_props, "spr_banner_a","spr_empty"),
(try_end),
(try_end),
(try_begin),
(neq,":party_slot_001","trp_player"),
(replace_scene_props, "spr_player_chest","spr_locked_player_chest"),
(try_end),
]),

("remove_siege_objects", [
(replace_scene_props, "spr_battlement_a_destroyed","spr_battlement_a"),
(replace_scene_props, "spr_snowy_castle_battlement_a_destroyed","spr_snowy_castle_battlement_a"),
(replace_scene_props, "spr_castle_e_battlement_a_destroyed","spr_castle_e_battlement_a"),
(replace_scene_props, "spr_castle_battlement_a_destroyed","spr_castle_battlement_a"),
(replace_scene_props, "spr_castle_battlement_b_destroyed","spr_castle_battlement_b"),
(replace_scene_props, "spr_earth_wall_a2","spr_earth_wall_a"),
(replace_scene_props, "spr_earth_wall_b2","spr_earth_wall_b"),
(replace_scene_props, "spr_belfry_platform_b","spr_empty"),
(replace_scene_props, "spr_belfry_platform_a","spr_empty"),
(replace_scene_props, "spr_belfry_a","spr_empty"),
(replace_scene_props, "spr_belfry_wheel","spr_empty"),
(replace_scene_props, "spr_siege_ladder_move_6m","spr_empty"),
(replace_scene_props, "spr_siege_ladder_move_8m","spr_empty"),
(replace_scene_props, "spr_siege_ladder_move_10m","spr_empty"),
(replace_scene_props, "spr_siege_ladder_move_12m","spr_empty"),
(replace_scene_props, "spr_siege_ladder_move_14m","spr_empty"),
(replace_scene_props, "spr_siege_ladder_12m","spr_empty"),
(replace_scene_props, "spr_siege_ladder_14m","spr_empty"),
(replace_scene_props, "spr_mangonel","spr_empty"),
(replace_scene_props, "spr_trebuchet_old","spr_empty"),
(replace_scene_props, "spr_trebuchet_new","spr_empty"),
(replace_scene_props, "spr_stone_ball","spr_empty"),
(replace_scene_props, "spr_Village_fire_big","spr_empty"),
]),

("describe_relation_to_s63", [
(store_script_param, ":var001", 1),
(store_add, ":var002", ":var001", 100),
(val_add, ":var002", 5),
(store_div, ":var___x1", ":var002", 10),
(assign,":var003",":var___x1"),
(val_clamp,":var003",0, 20),
(assign,":var004","str_relation_mnus_100"),
(val_add, ":var004", ":var003"),
(str_store_string,s63,":str_store_string(var004)"),
]),

("describe_center_relation_to_s3", [
(store_script_param, ":var001", 1),
(store_add, ":var002", ":var001", 100),
(val_add, ":var002", 5),
(store_div, ":var___x1", ":var002", 10),
(assign,":var003",":var___x1"),
(val_clamp,":var003",0, 20),
(assign,":var004","str_center_relation_mnus_100"),
(val_add, ":var004", ":var003"),
(str_store_string,s3,":str_store_string(var004)"),
]),

("center_ambiance_sounds", [
(assign,":var001",-1),
(assign,":var002",-1),
(assign,":var003",-1),
(assign,":var004",-1),
(assign,":var005",-1),
(try_begin),
(party_slot_eq,"$g_encountered_party",0,4),
(try_begin),
(neg|is_currently_night),
(assign,":var003","snd_distant_dog_bark"),
(assign,":var003","snd_distant_chicken"),
(else_try),
(assign,":var001","snd_distant_dog_bark"),
(assign,":var002","snd_distant_owl"),
(try_end),
(else_try),
(party_slot_eq,"$g_encountered_party",0,3),
(try_begin),
(neg|is_currently_night),
(assign,":var001","snd_distant_carpenter"),
(assign,":var002","snd_distant_blacksmith"),
(assign,":var003","snd_distant_dog_bark"),
(else_try),
(assign,":var001","snd_distant_dog_bark"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_006",0,7),
(try_begin),
(eq,":random_x_006",1),
(ge,":var001",0),
(play_sound,":var001"),
(else_try),
(eq,":random_x_006",2),
(ge,":var002",0),
(play_sound,":var002"),
(else_try),
(eq,":random_x_006",3),
(ge,":var003",0),
(play_sound,":var003"),
(else_try),
(eq,":random_x_006",4),
(ge,":var004",0),
(play_sound,":var004"),
(else_try),
(eq,":random_x_006",5),
(ge,":var005",0),
(play_sound,":var005"),
(try_end),
(try_end),
]),

("center_set_walker_to_type", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(store_add, ":slot_no_004", 180, ":var002"),
(party_set_slot,":party_id_001",":slot_no_004",":var003"),
(party_get_slot,":party_slot_005",":party_id_001",61),
(faction_get_slot,":faction_slot_006",":party_slot_005",10),
(store_random_in_range,":random_x_007",0,2),
(try_begin),
(party_slot_eq,":party_id_001",0,4),
(val_add, ":random_x_007", 55),
(else_try),
(val_add, ":random_x_007", 53),
(try_end),
(try_begin),
(eq,":var003",3),
(assign,":slot_no_008",":random_x_007"),
(val_add, ":random_x_007", 4),
(try_end),
(faction_get_slot,":faction_slot_009",":faction_slot_006",":random_x_007"),
(try_begin),
(eq,":var003",3),
(faction_get_slot,":faction_slot_010",":faction_slot_006",":slot_no_008"),
(try_for_range, ":itm_011", ":itm.horse_meat", ":itm.wooden_stick"),
(store_item_kind_count,":item_kind_count_012",":itm_011",":faction_slot_010"),
(try_begin),
(ge,":item_kind_count_012",1),
(store_item_kind_count,":item_kind_count_012",":itm_011",":faction_slot_009"),
(lt,":item_kind_count_012",1),
(troop_add_items,":faction_slot_009",":itm_011",1),
(try_end),
(try_end),
(store_random_in_range,":random_x_013",12,15),
(assign,":var014",0),
(try_for_range, ":itm_011", ":itm.horse_meat", ":itm.wooden_stick"),
(store_item_kind_count,":item_kind_count_012",":itm_011",":faction_slot_009"),
(try_begin),
(ge,":item_kind_count_012",1),
(item_get_type, ":item_type_015", ":itm_011"),
(eq,":item_type_015",":random_x_013"),
(val_add, ":var014", 1),
puts cost of items to reg0,
(try_end),
(try_end),
(store_random_in_range,":random_x_016",0,":var014"),
(assign,":var014",-1),
(try_for_range, ":itm_011", ":itm.horse_meat", ":itm.wooden_stick"),
(store_item_kind_count,":item_kind_count_012",":itm_011",":faction_slot_010"),
(try_begin),
(ge,":item_kind_count_012",1),
(item_get_type, ":item_type_015", ":itm_011"),
(eq,":item_type_015",":random_x_013"),
(val_add, ":var014", 1),
(eq,":var014",":random_x_016"),
(troop_add_items,":faction_slot_009",":itm_011",1),
(assign,":var017",":itm_011"),
(try_end),
(try_end),
(assign,"$spy_item_worn",":var017"),
(assign,"$spy_quest_troop",":faction_slot_009"),
(troop_equip_items,":faction_slot_009"),
(try_end),
(store_add, ":slot_no_018", 160, ":var002"),
(party_set_slot,":party_id_001",":slot_no_018",":faction_slot_009"),
(store_random_in_range,":random_x_019",0,1000000),
(store_add, ":slot_no_020", 170, ":var002"),
(party_set_slot,":party_id_001",":slot_no_020",":random_x_019"),
]),

("cf_center_get_free_walker", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_for_range, ":var003", 0, 8),
(store_add, ":var004", 180, ":var003"),
(try_begin),
(party_slot_eq,":var001",":var004",0),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var002",0),
(store_random_in_range,":random_x_005",0,":var002"),
(try_for_range, ":var003", 0, 8),
(store_add, ":var004", 180, ":var003"),
(party_slot_eq,":var001",":var004",0),
(val_sub, ":var002", 1),
(eq,":var002",":random_x_005"),
(assign,-1,":var003"), # reg0
(try_end),
(try_end),
]),

("center_remove_walker_type_from_walkers", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_for_range, ":var003", 0, 8),
(store_add, ":var004", 180, ":var003"),
(try_begin),
(party_slot_eq,":var001",":var004",":var002"),
(call_script, "script_center_set_walker_to_type", ":var001", ":var003", 0),
(try_end),
(try_end),
]),

("init_town_walkers", [
(try_begin),
(eq,":::town_nighttime",0),
(try_for_range, ":var001", 0, 8),
(store_add, ":slot_no_002", 160, ":var001"),
(party_get_slot,":party_slot_003","$current_town",":slot_no_002"),
(gt,":party_slot_003",0),
(store_add, ":entry_no_004", 32, ":var001"),
(set_visitor,":entry_no_004",":party_slot_003"),
(try_end),
(try_end),
]),

("cf_enter_center_location_bandit_check", [
(try_begin),
(neq,":::town_nighttime",0),
(party_slot_ge,"$current_town",155,1),
(eq,":::g_defending_against_siege",0),
(eq,":::sneaked_into_town",0),
(try_begin),
(party_slot_eq,"$current_town",0,4),
(party_get_slot,":party_slot_001","$current_town",10),
(else_try),
(party_get_slot,":party_slot_001","$current_town",10),
(try_end),
(try_end),
(modify_visitors_at_site,":party_slot_001"),
(reset_visitors),
(party_get_slot,":party_slot_002","$current_town",155),
(store_character_level,":character_lvl_003","trp_player"),
(set_jump_mission,"mt_bandits_at_night"),
(try_begin),
(party_slot_eq,"$current_town",0,4),
(assign,":number_of_troops_004",2),
(store_div, ":var___x1", ":character_lvl_003", 10),
(assign,":var005",":var___x1"),
(val_add, ":number_of_troops_004", ":var005"),
(try_for_range, ":var006", 0, 3),
(gt,":character_lvl_003",10),
(store_random_in_range,":random_x_007",0,100),
(lt,":random_x_007",":character_lvl_003"),
(val_add, ":number_of_troops_004", 1),
(try_end),
(try_end),
(set_visitors,4,":party_slot_002",":number_of_troops_004"),
(assign,"$num_center_bandits",":number_of_troops_004"),
(set_jump_entry,2),
(else_try),
(assign,":number_of_troops_004",1),
(assign,"$num_center_bandits",0),
(try_begin),
(gt,":character_lvl_003",15),
(store_random_in_range,":random_x_007",0,100),
(try_begin),
(lt,":random_x_007",":character_lvl_003"),
(assign,":number_of_troops_004",2),
(try_end),
(try_end),
(val_add, ":::num_center_bandits", ":number_of_troops_004"),
(set_visitors,11,":party_slot_002",":number_of_troops_004"),
(assign,":number_of_troops_004",1),
(try_begin),
(gt,":character_lvl_003",20),
(store_random_in_range,":random_x_007",0,100),
(try_begin),
(lt,":random_x_007",":character_lvl_003"),
(assign,":number_of_troops_004",2),
(try_end),
(try_end),
(set_visitors,27,":party_slot_002",":number_of_troops_004"),
(val_add, ":::num_center_bandits", ":number_of_troops_004"),
(try_begin),
(gt,":character_lvl_003",9),
(assign,":number_of_troops_004",1),
(try_begin),
(gt,":character_lvl_003",25),
(store_random_in_range,":random_x_007",0,100),
(try_begin),
(lt,":random_x_007",":character_lvl_003"),
(assign,":number_of_troops_004",2),
(try_end),
(try_end),
(set_visitors,28,":party_slot_002",":number_of_troops_004"),
(val_add, ":::num_center_bandits", ":number_of_troops_004"),
(try_end),
(assign,"$town_entered",1),
(assign,"$all_doors_locked",1),
(try_end),
(display_message, "@@You have run into a trap! {reg1}"),
(assign, 4294910498, 4294910498), # reg1
(display_message, "@@You are attacked by a group of bandits! {reg1}"),
(jump_to_scene,":party_slot_001"),
(change_screen_mission),
]),

("init_town_agent", [
(store_script_param, ":var001", 1),
(agent_get_troop_id,":troop_id_002", ":var001"),
(set_fixed_point_multiplier, 100),
(assign,":var003",-1),
(try_begin),
(this_or_next|is_between,":troop_id_002","trp_town_1_armorer","trp_town_1_weaponsmith"),
(is_between,":troop_id_002","trp_town_1_weaponsmith","trp_town_1_tavernkeeper"),
(try_begin),
(eq,1,1),
(troop_get_type,":troop_type_004",":troop_id_002"),
(try_begin),
(eq,":troop_type_004",0),
(agent_set_animation, ":var001", "anim_stand_townguard"),
(else_try),
(agent_set_animation, ":var001", "anim_stand_townguard"),
(try_end),
(try_end),
(else_try),
(is_between,":troop_id_002","trp_knight_1_1_wife","trp_heroes_end"),
(assign,":var003","anim_stand_lady"),
(else_try),
(is_between,":troop_id_002","trp_npc1","trp_knight_1_1_wife"),
(assign,":var003","anim_stand_lord"),
(else_try),
(is_between,":troop_id_002","trp_farmer","trp_town_walker_1"),
(assign,":var003","anim_stand_townguard"),
(try_end),
(try_begin),
(ge,":var003",0),
(agent_set_stand_action, ":var001", ":var003"),
(agent_set_animation, ":var001", ":var003"),
(store_random_in_range,":random_x_005",0,100),
(agent_set_animation_progress, ":var001", ":random_x_005"),
(try_end),
]),

("init_town_walker_agents", [
(try_for_agents, ":cur_agent"),
(agent_get_troop_id,":troop_id_003", ":cur_agent"),
(try_begin),
(is_between,":troop_id_003","trp_town_walker_1","trp_tournament_master"),
(val_add, 0, 1), # var001
(agent_get_position,pos1,":cur_agent"),
(try_for_range, ":var004", 9, 40),
(entry_point_get_position, pos2, ":var004"),
(get_distance_between_positions,":distance_005",1,2),
(lt,":distance_005",200),
(agent_set_slot,":cur_agent",0,":var004"),
(try_end),
(try_end),
(call_script, "script_set_town_walker_destination", ":cur_agent"),
(try_end),
]),

("agent_get_town_walker_details", [
(store_script_param, ":var001", 1),
(agent_get_entry_no,":agent_entry_no_002",":var001"),
(store_sub, ":var003", ":agent_entry_no_002", 32),
(store_add, ":slot_no_004", 180, ":var003"),
(party_get_slot,":party_slot_005","$current_town",":slot_no_004"),
(store_add, ":slot_no_006", 170, ":var003"),
(party_get_slot,":party_slot_007","$current_town",":slot_no_006"),
(assign,reg0,":party_slot_005"),
(assign,reg1,":party_slot_007"),
(assign,reg2,":var003"),
]),

("town_walker_occupation_string_to_s14", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(str_store_string,s14,":str_store_string("str_i_take_what_work_i_can_sirmadame_i_carry_water_or_help_the_merchants_with_their_loads_or_help_build_things_if_theres_things_to_be_built")"),
(call_script, "script_agent_get_town_walker_details", ":var001"),
(assign,":var003",reg0),
(assign,":var004",reg1),
(assign,":var005",-1),
(assign,":var006",0),
(try_for_range, ":itm_007", ":itm.spice", ":itm.siege_supply"),
(call_script, "script_center_get_production", "$g_encountered_party", ":itm_007"),
(val_add, ":var006", reg0),
(try_end),
(val_max,":var006",1),
(store_mod,":var008",":var004",":var006"),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg4,":var004"),
(assign,reg5,":var006"),
(assign,reg7,":var008"),
(display_message, "str_dna_reg4_total_production_reg5_modula_reg7"),
(try_end),
(try_for_range, ":itm_007", ":itm.spice", ":itm.siege_supply"),
(gt,":var008",-1),
(call_script, "script_center_get_production", "$g_encountered_party", ":itm_007"),
(val_sub, ":var008", reg0),
(try_begin),
(lt,":var008",0),
(eq,":::cheat_mode",1),
(str_store_string,s9,":str_store_item_name(itm_007)"),
(display_message, "str_agent_produces_s9"),
(try_end),
(assign,":var005",":itm_007"),
(try_end),
(try_begin),
(eq,":var003",1),
(is_between,"$g_encountered_party","p_town_1","p_castle_1"),
(str_store_string,s14,":str_store_string("str_im_not_doing_anything_sirmadame_theres_no_work_to_be_had_around_here_these_days")"),
(else_try),
(eq,":var003",1),
(str_store_string,s14,":str_store_string("str_im_not_doing_anything_sirmadame_i_have_no_land_of_my_own_and_theres_no_work_to_be_had_around_here_these_days")"),
(else_try),
(eq,":var003",2),
(str_store_string,s14,":str_store_string("str_why_im_still_living_off_of_your_kindness_and_goodness_sirmadame_hopefully_there_will_be_work_shortly")"),
(else_try),
(eq,":var005","itm_grain"),
(is_between,"$g_encountered_party","p_town_1","p_castle_1"),
(str_store_string,s14,":str_store_string("str_i_work_in_the_fields_just_outside_the_walls_where_they_grow_grain_we_dont_quite_grow_enough_to_meet_our_needs_though_and_have_to_import_grain_from_the_surrounding_countryside")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_grain"),
(str_store_string,s14,":str_store_string("str_i_work_mostly_in_the_fields_growing_grain_in_the_town_they_grind_it_to_make_bread_or_ale_and_we_can_also_boil_it_as_a_porridge")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_ale"),
(str_store_string,s14,":str_store_string("str_i_work_in_the_breweries_making_ale_the_poor_folk_drink_a_lot_of_it_as_its_cheaper_than_wine_we_make_it_with_grain_brought_in_from_the_countryside")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_bread"),
(str_store_string,s14,":str_store_string("str_i_work_in_a_mill_grinding_flour_to_make_bread_bread_is_cheap_keeps_well_and_fills_the_stomach")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_dried_meat"),
(str_store_string,s14,":str_store_string("str_i_tend_cattle_we_dry_and_salt_meat_to_preserve_it_and_make_cheese_from_the_milk")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_cheese"),
(str_store_string,s14,":str_store_string("str_i_tend_cattle_we_dry_and_salt_meat_to_preserve_it_and_make_cheese_from_the_milk_so_it_doesnt_spoil")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_butter"),
(str_store_string,s14,":str_store_string("str_i_tend_cattle_we_dry_and_salt_meat_to_preserve_it_and_make_cheese_from_the_milk_so_it_doesnt_spoil")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_wool"),
(str_store_string,s14,":str_store_string("str_i_tend_sheep_we_send_the_wool_to_the_cities_to_be_woven_into_cloth_and_make_mutton_sausage_when_we_cull_the_herds")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_sausages"),
(str_store_string,s14,":str_store_string("str_i_tend_sheep_we_send_the_wool_to_the_cities_to_be_woven_into_cloth_and_make_mutton_sausage_when_we_cull_the_herds")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_wool_cloth"),
(str_store_string,s14,":str_store_string("str_i_work_at_a_loom_spinning_cloth_from_wool_wool_is_some_of_the_cheapest_cloth_you_can_buy_but_it_will_still_keep_you_warm")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_smoked_fish"),
(str_store_string,s14,":str_store_string("str_i_crew_a_fishing_boat_we_salt_and_smoke_the_flesh_to_sell_it_far_inland")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_salt"),
(str_store_string,s14,":str_store_string("str_i_sift_salt_from_a_nearby_flat_they_need_salt_everywhere_to_preserve_meat_and_fish")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_iron"),
(str_store_string,s14,":str_store_string("str_i_mine_iron_from_a_vein_in_a_nearby_cliffside_they_use_it_to_make_tools_arms_and_other_goods")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_pottery"),
(str_store_string,s14,":str_store_string("str_i_make_pottery_which_people_use_to_store_grain_and_carry_water")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_tools"),
(str_store_string,s14,":str_store_string("str_trade_explanation_tools")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_oil"),
(str_store_string,s14,":str_store_string("str_trade_explanation_oil")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_linen"),
(str_store_string,s14,":str_store_string("str_trade_explanation_linen")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_velvet"),
(str_store_string,s14,":str_store_string("str_trade_explanation_velvet")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_spice"),
(str_store_string,s14,":str_store_string("str_trade_explanation_spice")"),
(assign,":var002",1),
(else_try),
(eq,":var005","itm_apples"),
(str_store_string,s14,":str_store_string("str_trade_explanation_apples")"),
(assign,":var002",1),
(try_end),
(try_begin),
(eq,":var002",1),
(assign,":var009",-1),
(store_skill_level,":skill_lvl_010","skl_trade","trp_player"),
(try_begin),
(is_between,"$g_encountered_party","p_village_1","p_salt_mine"),
(party_get_slot,":party_slot_011","$g_encountered_party",121),
(else_try),
(assign,":party_slot_011","$g_encountered_party"),
(try_end),
(store_sub, ":var012", 250, ":itm.spice"),
(store_add, ":slot_no_013", ":var005", ":var012"),
(party_get_slot,":party_slot_014",":party_slot_011",":slot_no_013"),
(val_add, ":party_slot_014", 400),
(store_mul, ":var015", ":skill_lvl_010", 35),
(try_begin),
(is_between,"$g_encountered_party","p_village_1","p_salt_mine"),
(val_add, ":party_slot_014", 200),
(try_end),
(val_sub, ":party_slot_014", ":var015"),
(try_for_range, ":slot_no_016", 190, 205),
(party_get_slot,":party_slot_017",":party_slot_011",":slot_no_016"),
(party_get_slot,":party_slot_018",":party_slot_017",":slot_no_013"),
(eq,":::cheat_mode",1),
(assign,reg4,":party_slot_018"),
(assign,reg5,":party_slot_014"),
(str_store_string,s10,":str_store_party_name(party_slot_017)"),
(display_message, "str_s10_has_reg4_needs_reg5"),
(try_end),
(gt,":party_slot_018",":party_slot_014"),
(assign,":var009",":party_slot_017"),
(assign,":party_slot_014",":party_slot_018"),
(try_end),
(is_between,":var009","p_town_1","p_salt_mine"),
(str_store_string,s15,":str_store_party_name(var009)"),
(str_store_string,s14,":str_store_string("str_s14_i_hear_that_you_can_find_a_good_price_for_it_in_s15")"),
(try_end),
]),

("tick_town_walkers", [
(try_for_agents, ":cur_agent"),
(agent_get_troop_id,":troop_id_002", ":cur_agent"),
(try_begin),
(is_between,":troop_id_002","trp_town_walker_1","trp_tournament_master"),
(agent_get_slot,":agent_slot_003",":cur_agent",0),
(entry_point_get_position, pos1, ":agent_slot_003"),
(lt,":agent_slot_003",32),
(init_position,2),
(position_set_y,2,250),
(position_transform_position_to_parent,1,1,2),
(try_end),
(agent_get_position,pos2,":cur_agent"),
(get_distance_between_positions,":distance_004",1,2),
(lt,":distance_004",400),
(assign,":random_x_005",0),
(lt,":agent_slot_003",32),
(store_random_in_range,":random_x_005",0,100),
(try_end),
(lt,":random_x_005",20),
(call_script, "script_set_town_walker_destination", ":cur_agent"),
(try_end),
]),

("set_town_walker_destination", [
(store_script_param, ":agent_id_001", 1),
(assign,reg0,9),
(assign,reg1,10),
(try_for_agents, ":cur_agent"),
(agent_get_troop_id,":troop_id_003", ":cur_agent"),
(try_begin),
(is_between,":troop_id_003","trp_town_walker_1","trp_tournament_master"),
(agent_get_slot,":agent_slot_004",":cur_agent",0),
(try_begin),
(eq,":agent_slot_004",9),
(assign,reg0,0),
(else_try),
(eq,":agent_slot_004",10),
(assign,reg1,0),
(else_try),
(eq,":agent_slot_004",12),
(assign,12,0), # reg2
(else_try),
(eq,":agent_slot_004",32),
(assign,32,0), # reg3
(else_try),
(eq,":agent_slot_004",33),
(assign,33,0), # reg4
(else_try),
(eq,":agent_slot_004",34),
(assign,34,0), # reg5
(else_try),
(eq,":agent_slot_004",35),
(assign,35,0), # reg6
(else_try),
(eq,":agent_slot_004",36),
(assign,36,0), # reg7
(else_try),
(eq,":agent_slot_004",37),
(assign,37,0), # reg8
(else_try),
(eq,":agent_slot_004",38),
(assign,38,0), # reg9
(else_try),
(eq,":agent_slot_004",39),
(assign,39,0), # reg10
(try_end),
(try_end),
(try_end),
(assign,":var005",100),
(assign,":agent_slot_004",0),
(try_for_range, ":var006", 0, ":var005"),
(shuffle_range,0,0),
(try_begin),
(gt,reg0,0),
(assign,":agent_slot_004",reg0),
(assign,":var005",0),
(try_end),
(try_end),
(try_begin),
(gt,":agent_slot_004",0),
(agent_set_slot,":agent_id_001",0,":agent_slot_004"),
(entry_point_get_position, pos1, ":agent_slot_004"),
(try_begin),
(lt,":agent_slot_004",32),
(init_position,2),
(position_set_y,2,250),
(position_transform_position_to_parent,1,1,2),
(try_end),
(agent_set_scripted_destination,":agent_id_001",1,0),
(agent_set_speed_limit,":agent_id_001",5),
(try_end),
]),

("town_init_doors", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,1,1),
(assign,":var002",0),
(try_begin),
(eq,":var001",1),
(assign,":var002",1),
(else_try),
(eq,":var001",0),
(eq,":::town_nighttime",0),
(assign,":var002",1),
(try_end),
(try_begin),
(eq,":var002",1),
(assign,":var003",1),
(try_for_range, ":var004", 0, ":var003"),
(scene_prop_get_instance, ":scp_instance_005", "spr_towngate_door_left", ":var004"),
(ge,":scp_instance_005",0),
(val_add, ":var003", 1),
(prop_instance_get_position, pos1, ":scp_instance_005"),
(position_rotate_z,1,-100),
(prop_instance_animate_to_position, ":scp_instance_005", 1, 1),
(try_end),
(try_end),
(assign,":var003",1),
(try_for_range, ":var004", 0, ":var003"),
(scene_prop_get_instance, ":scp_instance_005", "spr_towngate_rectangle_door_left", ":var004"),
(try_begin),
(ge,":scp_instance_005",0),
(val_add, ":var003", 1),
(prop_instance_get_position, pos1, ":scp_instance_005"),
(position_rotate_z,1,-80),
(prop_instance_animate_to_position, ":scp_instance_005", 1, 1),
(try_end),
(try_end),
(assign,":var003",1),
(try_for_range, ":var004", 0, ":var003"),
(scene_prop_get_instance, ":scp_instance_005", "spr_towngate_door_right", ":var004"),
(try_begin),
(ge,":scp_instance_005",0),
(val_add, ":var003", 1),
(prop_instance_get_position, pos1, ":scp_instance_005"),
(position_rotate_z,1,100),
(prop_instance_animate_to_position, ":scp_instance_005", 1, 1),
(try_end),
(try_end),
(assign,":var003",1),
(try_for_range, ":var004", 0, ":var003"),
(scene_prop_get_instance, ":scp_instance_005", "spr_towngate_rectangle_door_right", ":var004"),
(ge,":scp_instance_005",0),
(val_add, ":var003", 1),
(prop_instance_get_position, pos1, ":scp_instance_005"),
(position_rotate_z,1,80),
(prop_instance_animate_to_position, ":scp_instance_005", 1, 1),
(try_end),
(try_end),
]),

("siege_init_ai_and_belfry", [
(assign,"$cur_belfry_pos",50),
(assign,":slot_no_001",10),
(store_current_scene,":cur_scene_002"),
(try_for_range, ":var003", 0, 3),
(scene_prop_get_instance, ":scp_instance_004", "spr_belfry_a", ":var003"),
(try_begin),
(ge,":scp_instance_004",0),
(scene_set_slot,":cur_scene_002",":slot_no_001",":scp_instance_004"),
(val_add, ":slot_no_001", 1),
(try_end),
(try_end),
(try_for_range, ":var003", 0, 3),
(scene_prop_get_instance, ":scp_instance_004", "spr_belfry_platform_a", ":var003"),
(try_begin),
(ge,":scp_instance_004",0),
(scene_set_slot,":cur_scene_002",":slot_no_001",":scp_instance_004"),
(val_add, ":slot_no_001", 1),
(try_end),
(try_end),
(try_for_range, ":var003", 0, 3),
(scene_prop_get_instance, ":scp_instance_004", "spr_belfry_platform_b", ":var003"),
(try_begin),
(ge,":scp_instance_004",0),
(scene_set_slot,":cur_scene_002",":slot_no_001",":scp_instance_004"),
(val_add, ":slot_no_001", 1),
(try_end),
(try_end),
(assign,"$belfry_rotating_objects_begin",":slot_no_001"),
(try_for_range, ":var003", 0, 5),
(scene_prop_get_instance, ":scp_instance_004", "spr_belfry_wheel", ":var003"),
(try_begin),
(ge,":scp_instance_004",0),
(scene_set_slot,":cur_scene_002",":slot_no_001",":scp_instance_004"),
(val_add, ":slot_no_001", 1),
(try_end),
(try_end),
(assign,"$last_belfry_object_pos",":slot_no_001"),
(try_begin),
(eq,1,1),
(scene_prop_get_instance, ":scp_instance_005", "spr_belfry_platform_a", 0),
(try_end),
(entry_point_get_position, pos1, 55),
(entry_point_get_position, pos3, 50),
(try_for_range, ":slot_no_006", 10, ":::last_belfry_object_pos"),
(assign,":var007",64),
(val_add, ":var007", ":slot_no_006"),
(val_sub, ":var007", 10),
(scene_get_slot,":scene_slot_008",":cur_scene_002",":slot_no_006"),
(prop_instance_get_position, pos2, ":scene_slot_008"),
(try_begin),
(eq,":scene_slot_008",":scp_instance_005"),
(position_rotate_x,2,90),
(try_end),
(position_transform_position_to_local, ":var007",1,2),
(position_transform_position_to_parent,4,3,":var007"),
(prop_instance_animate_to_position, ":scene_slot_008", 4, 1),
(try_end),
(assign,"$belfry_positioned",0),
(assign,"$belfry_num_slots_positioned",0),
(assign,"$belfry_num_men_pushing",0),
(set_show_messages,0),
(team_give_order, "$attacker_team", 9, 11),
(team_give_order, "$attacker_team_2", 9, 11),
(set_show_messages,1),
]),

("cf_siege_move_belfry", [
(try_begin),
(neq,":::last_belfry_object_pos",10),
(entry_point_get_position, pos1, 50),
(entry_point_get_position, pos4, 55),
(get_distance_between_positions,":distance_001",4,1),
(store_current_scene,":cur_scene_002"),
(scene_get_slot,":scene_slot_003",":cur_scene_002",10),
(prop_instance_get_position, pos2, ":scene_slot_003"),
(entry_point_get_position, pos1, "$cur_belfry_pos"),
(position_transform_position_to_parent,3,1,64),
(position_transform_position_to_parent,5,4,64),
(get_distance_between_positions,":distance_004",2,3),
(get_distance_between_positions,":distance_005",2,5),
(le,":distance_004",10),
(val_add, ":::cur_belfry_pos", 1),
(entry_point_get_position, pos1, "$cur_belfry_pos"),
(position_transform_position_to_parent,3,1,64),
(get_distance_between_positions,":distance_004",2,3),
(try_end),
(try_begin),
(neq,":::cur_belfry_pos",50),
(assign,":var006",20),
(store_div, ":var___x1", ":distance_001", 60),
(assign,":var007",":var___x1"),
(store_sub, ":var008", ":distance_001", ":distance_005"),
(try_begin),
(lt,":var008",":var007"),
(store_mul, ":var006", ":var008", -60),
(val_div, ":var006", ":var007"),
(val_add, ":var006", 80),
(else_try),
(lt,":distance_005",":var007"),
(store_mul, ":var006", ":distance_005", -60),
(val_div, ":var006", ":var007"),
(val_add, ":var006", 80),
(try_end),
(try_end),
(store_mul, ":var009", ":distance_004", ":var006"),
(try_begin),
(eq,":::belfry_num_men_pushing",0),
(assign,":var009",1000000),
(else_try),
(val_div, ":var009", ":::belfry_num_men_pushing"),
(try_end),
(try_begin),
(le,":::cur_belfry_pos",55),
(init_position,3),
(position_rotate_x,3,":var008"),
(scene_get_slot,":scene_slot_010",":cur_scene_002",10),
(prop_instance_get_position, pos4, ":scene_slot_010"),
(entry_point_get_position, pos1, "$cur_belfry_pos"),
(try_for_range, ":slot_no_011", 10, ":::last_belfry_object_pos"),
(scene_get_slot,":scene_slot_012",":cur_scene_002",":slot_no_011"),
(try_begin),
(ge,":slot_no_011",":::belfry_rotating_objects_begin"),
(prop_instance_get_starting_position, pos5, ":scene_slot_010"),
(prop_instance_get_starting_position, pos6, ":scene_slot_012"),
(position_transform_position_to_local, 7,5,6),
(position_transform_position_to_parent,5,4,7),
(position_transform_position_to_parent,6,5,3),
(prop_instance_set_position, ":scene_slot_012", 6),
(else_try),
(assign,":var013",64),
(val_add, ":var013", ":slot_no_011"),
(val_sub, ":var013", 10),
(position_transform_position_to_parent,2,1,":var013"),
(prop_instance_animate_to_position, ":scene_slot_012", 2, ":var009"),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":::cur_belfry_pos",55),
(assign,"$belfry_positioned",1),
(try_end),
]),

("cf_siege_rotate_belfry_platform", [
(try_begin),
(eq,":::belfry_positioned",1),
(scene_prop_get_instance, ":scp_instance_001", "spr_belfry_platform_a", 0),
(prop_instance_get_position, pos1, ":scp_instance_001"),
(position_rotate_x,1,-90),
(prop_instance_animate_to_position, ":scp_instance_001", 1, 400),
(assign,"$belfry_positioned",2),
(try_end),
]),

("cf_siege_assign_men_to_belfry", [
(try_begin),
(neq,":::last_belfry_object_pos",10),
(try_begin),
(lt,":::belfry_positioned",3),
(get_player_agent_no,":agent_no_002"),
(store_current_scene,":cur_scene_003"),
(scene_get_slot,":scene_slot_004",":cur_scene_003",10),
(prop_instance_get_position, pos2, ":scene_slot_004"),
(assign,":var005",0),
(assign,":var006",0),
(assign,":var007",0),
(assign,":var008",0),
(assign,":var009",0),
(assign,":var010",0),
(assign,"$belfry_num_slots_positioned",0),
(assign,"$belfry_num_men_pushing",0),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(try_begin),
(eq,1,1),
(agent_get_slot,":agent_slot_012",":cur_agent",1),
(try_begin),
(neq,":agent_slot_012",0),
(agent_get_slot,":agent_slot_013",":cur_agent",2),
(eq,":agent_slot_012",-600),
(try_begin),
(eq,":agent_slot_013",0),
(assign,":var005",1),
(else_try),
(eq,":agent_slot_013",-200),
(assign,":var006",1),
(else_try),
(assign,":var007",1),
(try_end),
(try_end),
(try_end),
(else_try),
(try_begin),
(eq,":agent_slot_013",0),
(assign,":var008",1),
(else_try),
(eq,":agent_slot_013",-200),
(assign,":var009",1),
(else_try),
(assign,":var010",1),
(try_end),
(val_add, ":::belfry_num_slots_positioned", 1),
(init_position,1),
(position_move_x,1,":agent_slot_012"),
(position_move_y,1,":agent_slot_013"),
(init_position,3),
(position_move_x,3,":agent_slot_012"),
(position_move_y,3,-1000),
(position_transform_position_to_parent,4,2,1),
(position_transform_position_to_parent,5,2,3),
(agent_get_position,pos6,":cur_agent"),
(get_distance_between_positions,":distance_014",6,4),
(get_distance_between_positions,":distance_015",6,5),
(try_begin),
(this_or_next|ge,":distance_014",":distance_015"),
(lt,":distance_015",600),
(agent_set_scripted_destination,":cur_agent",4,1),
(else_try),
(agent_set_scripted_destination,":cur_agent",5,1),
(try_end),
(le,":distance_014",300),
(val_add, ":::belfry_num_men_pushing", 1),
(try_end),
(try_end),
(lt,":::belfry_num_slots_positioned",6),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_get_team, ":agent_team_no_016", ":cur_agent"),
(try_begin),
(this_or_next|eq,":::attacker_team",":agent_team_no_016"),
(eq,":::attacker_team_2",":agent_team_no_016"),
(neq,":agent_no_002",":cur_agent"),
(agent_get_class ,":agent_class_017", ":cur_agent"),
(this_or_next|eq,":agent_class_017",2),
(eq,":agent_class_017",0),
(agent_get_slot,":agent_slot_012",":cur_agent",1),
(eq,":agent_slot_012",0),
(assign,":agent_slot_013",0),
(try_begin),
(eq,":var005",0),
(assign,":agent_slot_012",-600),
(assign,":agent_slot_013",0),
(val_add, ":var005", 1),
(else_try),
(eq,":var006",0),
(assign,":agent_slot_012",-600),
(assign,":agent_slot_013",-200),
(val_add, ":var006", 1),
(else_try),
(eq,":var007",0),
(assign,":agent_slot_012",-600),
(assign,":agent_slot_013",-400),
(val_add, ":var007", 1),
(else_try),
(eq,":var008",0),
(assign,":agent_slot_012",600),
(assign,":agent_slot_013",0),
(val_add, ":var008", 1),
(else_try),
(eq,":var009",0),
(assign,":agent_slot_012",600),
(assign,":agent_slot_013",-200),
(val_add, ":var009", 1),
(else_try),
(eq,":var010",0),
(assign,":agent_slot_012",600),
(assign,":agent_slot_013",-400),
(val_add, ":var010", 1),
(try_end),
(try_end),
(val_add, ":::belfry_num_slots_positioned", 1),
(agent_set_slot,":cur_agent",1,":agent_slot_012"),
(agent_set_slot,":cur_agent",2,":agent_slot_013"),
(try_end),
(try_end),
(eq,1,1),
(store_mission_timer_a,":m_timer_a_018"),
(try_begin),
(gt,":m_timer_a_018",20),
(lt,":::belfry_num_slots_positioned",6),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_get_team, ":agent_team_no_016", ":cur_agent"),
(this_or_next|eq,":::attacker_team",":agent_team_no_016"),
(eq,":::attacker_team_2",":agent_team_no_016"),
(neq,":agent_no_002",":cur_agent"),
(agent_get_slot,":agent_slot_012",":cur_agent",1),
(eq,":agent_slot_012",0),
(assign,":agent_slot_013",0),
(try_begin),
(eq,":var005",0),
(assign,":agent_slot_012",-600),
(assign,":agent_slot_013",0),
(val_add, ":var005", 1),
(else_try),
(eq,":var006",0),
(assign,":agent_slot_012",-600),
(assign,":agent_slot_013",-200),
(val_add, ":var006", 1),
(else_try),
(eq,":var007",0),
(assign,":agent_slot_012",-600),
(assign,":agent_slot_013",-400),
(val_add, ":var007", 1),
(else_try),
(eq,":var008",0),
(assign,":agent_slot_012",600),
(assign,":agent_slot_013",0),
(val_add, ":var008", 1),
(else_try),
(eq,":var009",0),
(assign,":agent_slot_012",600),
(assign,":agent_slot_013",-200),
(val_add, ":var009", 1),
(else_try),
(eq,":var010",0),
(assign,":agent_slot_012",600),
(assign,":agent_slot_013",-400),
(val_add, ":var010", 1),
(try_end),
(try_end),
(try_end),
(val_add, ":::belfry_num_slots_positioned", 1),
(agent_set_slot,":cur_agent",1,":agent_slot_012"),
(agent_set_slot,":cur_agent",2,":agent_slot_013"),
(try_end),
(try_end),
(else_try),
(assign,0,1), # var001
(try_for_agents, ":cur_agent"),
(agent_clear_scripted_mode,":cur_agent"),
(try_end),
(set_show_messages,0),
(team_give_order, "$attacker_team", 9, 2),
(set_show_messages,1),
]),

("siege_move_archers_to_archer_positions", [
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_slot_eq,":cur_agent",5,0),
(agent_is_defender,":cur_agent"),
(agent_get_class ,":agent_class_002", ":cur_agent"),
(agent_get_troop_id,":troop_id_003", ":cur_agent"),
(try_begin),
(eq,":agent_class_002",1),
(agent_slot_eq,":cur_agent",11,0),
(store_random_in_range,":random_x_004",40,44),
(agent_set_slot,":cur_agent",11,":random_x_004"),
(try_end),
(eq,1,1),
(agent_get_position,pos0,":cur_agent"),
(entry_point_get_position, pos1, ":random_x_004"),
(get_distance_between_positions,":distance_005",0,1),
(try_begin),
(lt,":distance_005",300),
(agent_clear_scripted_mode,":cur_agent"),
(agent_set_slot,":cur_agent",4,0),
(agent_set_slot,":cur_agent",5,1),
(str_store_string,s1,":str_store_troop_name(troop_id_003)"),
(assign,reg0,":cur_agent"),
(else_try),
(agent_get_simple_behavior, ":agent_simple_behavior_006", ":cur_agent"),
(agent_get_combat_state, ":agent_combat_state_007", ":cur_agent"),
(try_begin),
(this_or_next|eq,":agent_simple_behavior_006",5),
(eq,":agent_simple_behavior_006",1),
(eq,":agent_combat_state_007",7),
(try_begin),
(agent_slot_eq,":cur_agent",4,0),
(agent_set_scripted_destination,":cur_agent",1,0),
(agent_set_slot,":cur_agent",4,1),
(str_store_string,s1,":str_store_troop_name(troop_id_003)"),
(assign,reg0,":cur_agent"),
(try_end),
(try_end),
(try_end),
(else_try),
(try_begin),
(agent_slot_eq,":cur_agent",4,1),
(agent_clear_scripted_mode,":cur_agent"),
(agent_set_slot,":cur_agent",4,0),
(str_store_string,s1,":str_store_troop_name(troop_id_003)"),
(assign,reg0,":cur_agent"),
(try_end),
(try_end),
]),

("store_movement_order_name_to_s1", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(team_get_movement_order, ":team_movement_order_003", ":var001", ":var002"),
(try_begin),
(eq,":team_movement_order_003",0),
(str_store_string,s1,":str_store_string("@Holding")"),
(else_try),
(eq,":team_movement_order_003",1),
(str_store_string,s1,":str_store_string("@Following")"),
(else_try),
(eq,":team_movement_order_003",2),
(str_store_string,s1,":str_store_string("@Charging")"),
(else_try),
(eq,":team_movement_order_003",5),
(str_store_string,s1,":str_store_string("@Advancing")"),
(else_try),
(eq,":team_movement_order_003",6),
(str_store_string,s1,":str_store_string("@Falling Back")"),
(else_try),
(eq,":team_movement_order_003",7),
(str_store_string,s1,":str_store_string("@Standing Closer")"),
(else_try),
(eq,":team_movement_order_003",8),
(str_store_string,s1,":str_store_string("@Spreading Out")"),
(else_try),
(eq,":team_movement_order_003",11),
(str_store_string,s1,":str_store_string("@Standing")"),
(else_try),
(str_store_string,s1,":str_store_string("@N/A")"),
(try_end),
]),

("store_riding_order_name_to_s1", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(team_get_riding_order, ":team_riding_order_003", ":var001", ":var002"),
(try_begin),
(eq,":team_riding_order_003",0),
(str_store_string,s1,":str_store_string("@Free")"),
(else_try),
(eq,":team_riding_order_003",1),
(str_store_string,s1,":str_store_string("@Mount")"),
(else_try),
(eq,":team_riding_order_003",2),
(str_store_string,s1,":str_store_string("@Dismount")"),
(else_try),
(str_store_string,s1,":str_store_string("@N/A")"),
(try_end),
]),

("store_weapon_usage_order_name_to_s1", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(team_get_weapon_usage_order, ":team_weapon_usage_order_003", ":var001", ":var002"),
(team_get_hold_fire_order, ":team_hold_fire_order_004", ":var001", ":var002"),
(try_begin),
(eq,":team_weapon_usage_order_003",0),
(eq,":team_hold_fire_order_004",0),
(str_store_string,s1,":str_store_string("@Any Weapon")"),
(else_try),
(eq,":team_weapon_usage_order_003",1),
(eq,":team_hold_fire_order_004",0),
(str_store_string,s1,":str_store_string("@Blunt Weapons")"),
(else_try),
(eq,":team_weapon_usage_order_003",0),
(eq,":team_hold_fire_order_004",1),
(str_store_string,s1,":str_store_string("str_hold_fire")"),
(else_try),
(eq,":team_weapon_usage_order_003",1),
(eq,":team_hold_fire_order_004",1),
(str_store_string,s1,":str_store_string("str_blunt_hold_fire")"),
(else_try),
(str_store_string,s1,":str_store_string("@N/A")"),
(try_end),
]),

("team_give_order_from_order_panel", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(agent_get_team, ":agent_team_no_003", ":var001"),
(set_show_messages,0),
(try_begin),
(eq,":::g_formation_group0_selected",1),
(team_give_order, ":agent_team_no_003", 0, ":var002"),
(try_end),
(try_begin),
(eq,":::g_formation_group1_selected",1),
(team_give_order, ":agent_team_no_003", 1, ":var002"),
(try_end),
(try_begin),
(eq,":::g_formation_group2_selected",1),
(team_give_order, ":agent_team_no_003", 2, ":var002"),
(try_end),
(try_begin),
(eq,":::g_formation_group3_selected",1),
(team_give_order, ":agent_team_no_003", 3, ":var002"),
(try_end),
(try_begin),
(eq,":::g_formation_group4_selected",1),
(team_give_order, ":agent_team_no_003", 4, ":var002"),
(try_end),
(try_begin),
(eq,":::g_formation_group5_selected",1),
(team_give_order, ":agent_team_no_003", 5, ":var002"),
(try_end),
(try_begin),
(eq,":::g_formation_group6_selected",1),
(team_give_order, ":agent_team_no_003", 6, ":var002"),
(try_end),
(try_begin),
(eq,":::g_formation_group7_selected",1),
(team_give_order, ":agent_team_no_003", 7, ":var002"),
(try_end),
(try_begin),
(eq,":::g_formation_group8_selected",1),
(team_give_order, ":agent_team_no_003", 8, ":var002"),
(try_end),
(try_begin),
(eq,":var002",0),
(agent_get_position,pos1,":var001"),
(try_begin),
(eq,":::g_formation_group0_selected",1),
(team_set_order_position, ":agent_team_no_003", 0, 1),
(try_end),
(try_begin),
(eq,":::g_formation_group1_selected",1),
(team_set_order_position, ":agent_team_no_003", 1, 1),
(try_end),
(try_begin),
(eq,":::g_formation_group2_selected",1),
(team_set_order_position, ":agent_team_no_003", 2, 1),
(try_end),
(try_begin),
(eq,":::g_formation_group3_selected",1),
(team_set_order_position, ":agent_team_no_003", 3, 1),
(try_end),
(try_begin),
(eq,":::g_formation_group4_selected",1),
(team_set_order_position, ":agent_team_no_003", 4, 1),
(try_end),
(try_begin),
(eq,":::g_formation_group5_selected",1),
(team_set_order_position, ":agent_team_no_003", 5, 1),
(try_end),
(try_begin),
(eq,":::g_formation_group6_selected",1),
(team_set_order_position, ":agent_team_no_003", 6, 1),
(try_end),
(try_begin),
(eq,":::g_formation_group7_selected",1),
(team_set_order_position, ":agent_team_no_003", 7, 1),
(try_end),
(try_begin),
(eq,":::g_formation_group8_selected",1),
(team_set_order_position, ":agent_team_no_003", 8, 1),
(try_end),
(try_end),
(set_show_messages,1),
]),

("update_order_panel", [
(store_script_param, ":var001", 1),
(set_fixed_point_multiplier, 1000),
(try_begin),
(eq,":::group0_has_troops",1),
(call_script, "script_store_movement_order_name_to_s1", ":var001", 0),
(overlay_set_text, "$g_presentation_but0_movement", 1),
(call_script, "script_store_riding_order_name_to_s1", ":var001", 0),
(overlay_set_text, "$g_presentation_but0_riding", 1),
(call_script, "script_store_weapon_usage_order_name_to_s1", ":var001", 0),
(overlay_set_text, "$g_presentation_but0_weapon_usage", 1),
(try_end),
(try_begin),
(eq,":::group1_has_troops",1),
(call_script, "script_store_movement_order_name_to_s1", ":var001", 1),
(overlay_set_text, "$g_presentation_but1_movement", 1),
(call_script, "script_store_riding_order_name_to_s1", ":var001", 1),
(overlay_set_text, "$g_presentation_but1_riding", 1),
(call_script, "script_store_weapon_usage_order_name_to_s1", ":var001", 1),
(overlay_set_text, "$g_presentation_but1_weapon_usage", 1),
(try_end),
(try_begin),
(eq,":::group2_has_troops",1),
(call_script, "script_store_movement_order_name_to_s1", ":var001", 2),
(overlay_set_text, "$g_presentation_but2_movement", 1),
(call_script, "script_store_riding_order_name_to_s1", ":var001", 2),
(overlay_set_text, "$g_presentation_but2_riding", 1),
(call_script, "script_store_weapon_usage_order_name_to_s1", ":var001", 2),
(overlay_set_text, "$g_presentation_but2_weapon_usage", 1),
(try_end),
(try_begin),
(eq,":::group3_has_troops",1),
(call_script, "script_store_movement_order_name_to_s1", ":var001", 3),
(overlay_set_text, "$g_presentation_but3_movement", 1),
(call_script, "script_store_riding_order_name_to_s1", ":var001", 3),
(overlay_set_text, "$g_presentation_but3_riding", 1),
(call_script, "script_store_weapon_usage_order_name_to_s1", ":var001", 3),
(overlay_set_text, "$g_presentation_but3_weapon_usage", 1),
(try_end),
(try_begin),
(eq,":::group4_has_troops",1),
(call_script, "script_store_movement_order_name_to_s1", ":var001", 4),
(overlay_set_text, "$g_presentation_but4_movement", 1),
(call_script, "script_store_riding_order_name_to_s1", ":var001", 4),
(overlay_set_text, "$g_presentation_but4_riding", 1),
(call_script, "script_store_weapon_usage_order_name_to_s1", ":var001", 4),
(overlay_set_text, "$g_presentation_but4_weapon_usage", 1),
(try_end),
(try_begin),
(eq,":::group5_has_troops",1),
(call_script, "script_store_movement_order_name_to_s1", ":var001", 5),
(overlay_set_text, "$g_presentation_but5_movement", 1),
(call_script, "script_store_riding_order_name_to_s1", ":var001", 5),
(overlay_set_text, "$g_presentation_but5_riding", 1),
(call_script, "script_store_weapon_usage_order_name_to_s1", ":var001", 5),
(overlay_set_text, "$g_presentation_but5_weapon_usage", 1),
(try_end),
(try_begin),
(eq,":::group6_has_troops",1),
(call_script, "script_store_movement_order_name_to_s1", ":var001", 6),
(overlay_set_text, "$g_presentation_but6_movement", 1),
(call_script, "script_store_riding_order_name_to_s1", ":var001", 6),
(overlay_set_text, "$g_presentation_but6_riding", 1),
(call_script, "script_store_weapon_usage_order_name_to_s1", ":var001", 6),
(overlay_set_text, "$g_presentation_but6_weapon_usage", 1),
(try_end),
(try_begin),
(eq,":::group7_has_troops",1),
(call_script, "script_store_movement_order_name_to_s1", ":var001", 7),
(overlay_set_text, "$g_presentation_but7_movement", 1),
(call_script, "script_store_riding_order_name_to_s1", ":var001", 7),
(overlay_set_text, "$g_presentation_but7_riding", 1),
(call_script, "script_store_weapon_usage_order_name_to_s1", ":var001", 7),
(overlay_set_text, "$g_presentation_but7_weapon_usage", 1),
(try_end),
(try_begin),
(eq,":::group8_has_troops",1),
(call_script, "script_store_movement_order_name_to_s1", ":var001", 8),
(overlay_set_text, "$g_presentation_but8_movement", 1),
(call_script, "script_store_riding_order_name_to_s1", ":var001", 8),
(overlay_set_text, "$g_presentation_but8_riding", 1),
(call_script, "script_store_weapon_usage_order_name_to_s1", ":var001", 8),
(overlay_set_text, "$g_presentation_but8_weapon_usage", 1),
(try_end),
(assign,":var002",660),
(try_begin),
(eq,1,1),
(position_set_y,1,":var002"),
(try_begin),
(eq,":::group0_has_troops",1),
(position_set_x,1,270),
(overlay_set_position, "$g_presentation_but0_movement", 1),
(position_set_x,1,410),
(overlay_set_position, "$g_presentation_but0_riding", 1),
(position_set_x,1,550),
(overlay_set_position, "$g_presentation_but0_weapon_usage", 1),
(val_add, ":var002", -40),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(position_set_y,1,":var002"),
(try_begin),
(eq,":::group1_has_troops",1),
(position_set_x,1,270),
(overlay_set_position, "$g_presentation_but1_movement", 1),
(position_set_x,1,410),
(overlay_set_position, "$g_presentation_but1_riding", 1),
(position_set_x,1,550),
(overlay_set_position, "$g_presentation_but1_weapon_usage", 1),
(val_add, ":var002", -40),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(position_set_y,1,":var002"),
(try_begin),
(eq,":::group2_has_troops",1),
(position_set_x,1,270),
(overlay_set_position, "$g_presentation_but2_movement", 1),
(position_set_x,1,410),
(overlay_set_position, "$g_presentation_but2_riding", 1),
(position_set_x,1,550),
(overlay_set_position, "$g_presentation_but2_weapon_usage", 1),
(val_add, ":var002", -40),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(position_set_y,1,":var002"),
(try_begin),
(eq,":::group3_has_troops",1),
(position_set_x,1,270),
(overlay_set_position, "$g_presentation_but3_movement", 1),
(position_set_x,1,410),
(overlay_set_position, "$g_presentation_but3_riding", 1),
(position_set_x,1,550),
(overlay_set_position, "$g_presentation_but3_weapon_usage", 1),
(val_add, ":var002", -40),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(position_set_y,1,":var002"),
(try_begin),
(eq,":::group4_has_troops",1),
(position_set_x,1,270),
(overlay_set_position, "$g_presentation_but4_movement", 1),
(position_set_x,1,410),
(overlay_set_position, "$g_presentation_but4_riding", 1),
(position_set_x,1,550),
(overlay_set_position, "$g_presentation_but4_weapon_usage", 1),
(val_add, ":var002", -40),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(position_set_y,1,":var002"),
(try_begin),
(eq,":::group5_has_troops",1),
(position_set_x,1,270),
(overlay_set_position, "$g_presentation_but5_movement", 1),
(position_set_x,1,410),
(overlay_set_position, "$g_presentation_but5_riding", 1),
(position_set_x,1,550),
(overlay_set_position, "$g_presentation_but5_weapon_usage", 1),
(val_add, ":var002", -40),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(position_set_y,1,":var002"),
(try_begin),
(eq,":::group6_has_troops",1),
(position_set_x,1,270),
(overlay_set_position, "$g_presentation_but6_movement", 1),
(position_set_x,1,410),
(overlay_set_position, "$g_presentation_but6_riding", 1),
(position_set_x,1,550),
(overlay_set_position, "$g_presentation_but6_weapon_usage", 1),
(val_add, ":var002", -40),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(position_set_y,1,":var002"),
(try_begin),
(eq,":::group7_has_troops",1),
(position_set_x,1,270),
(overlay_set_position, "$g_presentation_but7_movement", 1),
(position_set_x,1,410),
(overlay_set_position, "$g_presentation_but7_riding", 1),
(position_set_x,1,550),
(overlay_set_position, "$g_presentation_but7_weapon_usage", 1),
(val_add, ":var002", -40),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(position_set_y,1,":var002"),
(try_begin),
(eq,":::group8_has_troops",1),
(position_set_x,1,270),
(overlay_set_position, "$g_presentation_but8_movement", 1),
(position_set_x,1,410),
(overlay_set_position, "$g_presentation_but8_riding", 1),
(position_set_x,1,550),
(overlay_set_position, "$g_presentation_but8_weapon_usage", 1),
(val_add, ":var002", -40),
(try_end),
(try_end),
]),

("update_agent_position_on_map", [
(store_script_param, ":agent_id_001", 1),
(agent_get_slot,":agent_slot_002",":agent_id_001",10),
(get_player_agent_no,":agent_no_003"),
(try_begin),
(le,":agent_slot_002",0),
(set_fixed_point_multiplier, 1000),
(try_begin),
(eq,":agent_id_001",":agent_no_003"),
(create_mesh_overlay, reg1, "mesh_player_dot"),
(position_set_x,1,500),
(position_set_y,1,500),
(overlay_set_size, reg1, 1),
(else_try),
(create_mesh_overlay, reg1, "mesh_white_dot"),
(position_set_x,1,200),
(position_set_y,1,200),
(overlay_set_size, reg1, 1),
(try_end),
(overlay_set_alpha, reg1, 136),
(agent_set_slot,":agent_id_001",10,reg1),
(assign,":agent_slot_002",reg1),
(try_end),
(try_begin),
(neq,":agent_id_001",":agent_no_003"),
(agent_get_party_id,":party_id_004",":agent_id_001"),
(try_begin),
(eq,":party_id_004","p_main_party"),
(agent_get_division ,":agent_division_005", ":agent_id_001"),
(try_begin),
(eq,":agent_division_005",0),
(overlay_set_color, ":agent_slot_002", 9261600),
(else_try),
(eq,":agent_division_005",1),
(overlay_set_color, ":agent_slot_002", 3458788),
(else_try),
(eq,":agent_division_005",2),
(overlay_set_color, ":agent_slot_002", 5674521),
(else_try),
(eq,":agent_division_005",3),
(overlay_set_color, ":agent_slot_002", 16770304),
(else_try),
(eq,":agent_division_005",4),
(overlay_set_color, ":agent_slot_002", 10027161),
(else_try),
(eq,":agent_division_005",5),
(overlay_set_color, ":agent_slot_002", 10092160),
(else_try),
(eq,":agent_division_005",6),
(overlay_set_color, ":agent_slot_002", 10350590),
(else_try),
(eq,":agent_division_005",7),
(overlay_set_color, ":agent_slot_002", 16698269),
(else_try),
(eq,":agent_division_005",8),
(overlay_set_color, ":agent_slot_002", 11639964),
(try_end),
(else_try),
(agent_is_ally,":agent_id_001"),
(overlay_set_color, ":agent_slot_002", 5592575),
(else_try),
(overlay_set_color, ":agent_slot_002", 16711680),
(try_end),
(try_end),
(try_begin),
(eq,":agent_id_001",":agent_no_003"),
(agent_get_look_position, pos1, ":agent_id_001"),
(position_get_rotation_around_z,":rotation_around_z_006",1),
(init_position,10),
(position_rotate_z,10,":rotation_around_z_006"),
(overlay_set_mesh_rotation, ":agent_slot_002", 10),
(call_script, "script_convert_3d_pos_to_map_pos"),
(else_try),
(agent_get_position,pos1,":agent_id_001"),
(call_script, "script_convert_3d_pos_to_map_pos"),
(try_end),
(overlay_set_position, ":agent_slot_002", 0),
]),

("convert_3d_pos_to_map_pos", [
(set_fixed_point_multiplier, 1000),
(position_transform_position_to_local, 3,2,1),
(position_get_x,":pos_x_001",3),
(position_get_y,":pos_y_002",3),
(val_div, ":pos_x_001", ":::g_battle_map_scale"),
(val_div, ":pos_y_002", ":::g_battle_map_scale"),
(set_fixed_point_multiplier, 1000),
(store_sub, ":var003", 980, "$g_battle_map_width"),
(store_sub, ":var004", 730, "$g_battle_map_height"),
(val_add, ":pos_x_001", ":var003"),
(val_add, ":pos_y_002", ":var004"),
(position_set_x,0,":pos_x_001"),
(position_set_y,0,":pos_y_002"),
]),

("update_order_flags_on_map", [
(set_fixed_point_multiplier, 1000),
(get_player_agent_no,":agent_no_001"),
(agent_get_team, ":agent_team_no_002", ":agent_no_001"),
(str_store_string,s2,":get_scene_boundaries(3)"),
(team_get_movement_order, ":team_movement_order_003", ":agent_team_no_002", 0),
(try_begin),
(eq,":team_movement_order_003",0),
(team_get_order_position, pos1, ":agent_team_no_002", 0),
(call_script, "script_convert_3d_pos_to_map_pos"),
(overlay_set_alpha, "$g_battle_map_infantry_order_flag", 255),
(overlay_set_position, "$g_battle_map_infantry_order_flag", 0),
(else_try),
(overlay_set_alpha, "$g_battle_map_infantry_order_flag", 0),
(try_end),
(team_get_movement_order, ":team_movement_order_003", ":agent_team_no_002", 1),
(try_begin),
(eq,":team_movement_order_003",0),
(team_get_order_position, pos1, ":agent_team_no_002", 1),
(call_script, "script_convert_3d_pos_to_map_pos"),
(overlay_set_alpha, "$g_battle_map_archers_order_flag", 255),
(overlay_set_position, "$g_battle_map_archers_order_flag", 0),
(else_try),
(overlay_set_alpha, "$g_battle_map_archers_order_flag", 0),
(try_end),
(team_get_movement_order, ":team_movement_order_003", ":agent_team_no_002", 2),
(try_begin),
(eq,":team_movement_order_003",0),
(team_get_order_position, pos1, ":agent_team_no_002", 2),
(call_script, "script_convert_3d_pos_to_map_pos"),
(overlay_set_alpha, "$g_battle_map_cavalry_order_flag", 255),
(overlay_set_position, "$g_battle_map_cavalry_order_flag", 0),
(else_try),
(overlay_set_alpha, "$g_battle_map_cavalry_order_flag", 0),
(try_end),
]),

("update_order_panel_checked_classes", [
(get_player_agent_no,":agent_no_001"),
(agent_get_team, ":agent_team_no_002", ":agent_no_001"),
(try_begin),
(eq,":::group0_has_troops",1),
(class_is_listening_order, ":agent_team_no_002", 0),
(overlay_set_val, "$g_presentation_obj_battle_check0", 1),
(assign,"$g_formation_group0_selected",1),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 68),
(else_try),
(eq,":::group0_has_troops",1),
(overlay_set_val, "$g_presentation_obj_battle_check0", 0),
(assign,"$g_formation_group0_selected",0),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
(try_end),
(try_begin),
(eq,":::group1_has_troops",1),
(class_is_listening_order, ":agent_team_no_002", 1),
(overlay_set_val, "$g_presentation_obj_battle_check1", 1),
(assign,"$g_formation_group1_selected",1),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 68),
(else_try),
(eq,":::group1_has_troops",1),
(overlay_set_val, "$g_presentation_obj_battle_check1", 0),
(assign,"$g_formation_group1_selected",0),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
(try_end),
(try_begin),
(eq,":::group2_has_troops",1),
(class_is_listening_order, ":agent_team_no_002", 2),
(overlay_set_val, "$g_presentation_obj_battle_check2", 1),
(assign,"$g_formation_group2_selected",1),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 68),
(else_try),
(eq,":::group2_has_troops",1),
(overlay_set_val, "$g_presentation_obj_battle_check2", 0),
(assign,"$g_formation_group2_selected",0),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
(try_end),
(try_begin),
(eq,":::group3_has_troops",1),
(class_is_listening_order, ":agent_team_no_002", 3),
(overlay_set_val, "$g_presentation_obj_battle_check3", 1),
(assign,"$g_formation_group3_selected",1),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 68),
(else_try),
(eq,":::group3_has_troops",1),
(overlay_set_val, "$g_presentation_obj_battle_check3", 0),
(assign,"$g_formation_group3_selected",0),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
(try_end),
(try_begin),
(eq,":::group4_has_troops",1),
(class_is_listening_order, ":agent_team_no_002", 4),
(overlay_set_val, "$g_presentation_obj_battle_check4", 1),
(assign,"$g_formation_group4_selected",1),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 68),
(else_try),
(eq,":::group4_has_troops",1),
(overlay_set_val, "$g_presentation_obj_battle_check4", 0),
(assign,"$g_formation_group4_selected",0),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
(try_end),
(try_begin),
(eq,":::group5_has_troops",1),
(class_is_listening_order, ":agent_team_no_002", 5),
(overlay_set_val, "$g_presentation_obj_battle_check5", 1),
(assign,"$g_formation_group5_selected",1),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 68),
(else_try),
(eq,":::group5_has_troops",1),
(overlay_set_val, "$g_presentation_obj_battle_check5", 0),
(assign,"$g_formation_group5_selected",0),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
(try_end),
(try_begin),
(eq,":::group6_has_troops",1),
(class_is_listening_order, ":agent_team_no_002", 6),
(overlay_set_val, "$g_presentation_obj_battle_check6", 1),
(assign,"$g_formation_group6_selected",1),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 68),
(else_try),
(eq,":::group6_has_troops",1),
(overlay_set_val, "$g_presentation_obj_battle_check6", 0),
(assign,"$g_formation_group6_selected",0),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
(try_end),
(try_begin),
(eq,":::group7_has_troops",1),
(class_is_listening_order, ":agent_team_no_002", 7),
(overlay_set_val, "$g_presentation_obj_battle_check7", 1),
(assign,"$g_formation_group7_selected",1),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 68),
(else_try),
(eq,":::group7_has_troops",1),
(overlay_set_val, "$g_presentation_obj_battle_check7", 0),
(assign,"$g_formation_group7_selected",0),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
(try_end),
(try_begin),
(eq,":::group8_has_troops",1),
(class_is_listening_order, ":agent_team_no_002", 8),
(overlay_set_val, "$g_presentation_obj_battle_check8", 1),
(assign,"$g_formation_group8_selected",1),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 68),
(else_try),
(eq,":::group8_has_troops",1),
(overlay_set_val, "$g_presentation_obj_battle_check8", 0),
(assign,"$g_formation_group8_selected",0),
(overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
(try_end),
]),

("update_order_panel_statistics_and_map", [
(set_fixed_point_multiplier, 1000),
(assign,":var001",0),
(assign,":var002",0),
(assign,":var003",0),
(assign,":var004",0),
(assign,":var005",0),
(assign,":var006",0),
(assign,":var007",0),
(assign,":var008",0),
(assign,":var009",0),
(assign,":var010",0),
(assign,":var011",0),
(assign,":var012",0),
(assign,":var013",0),
(assign,":var014",0),
(assign,":var015",0),
(assign,":var016",0),
(assign,":var017",0),
(assign,":var018",0),
(assign,":var019",0),
(assign,":var020",0),
(assign,":var021",0),
(str_store_string,s2,":get_scene_boundaries(3)"),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_division ,":agent_division_023", ":cur_agent"),
(agent_get_party_id,":party_id_024",":cur_agent"),
(agent_get_slot,":agent_slot_025",":cur_agent",10),
(try_begin),
(eq,":party_id_024","p_main_party"),
(try_begin),
(agent_is_alive,":cur_agent"),
(call_script, "script_update_agent_position_on_map", ":cur_agent"),
(try_begin),
(eq,":agent_division_023",0),
(val_add, ":var001", 1),
(try_begin),
(eq,":::group0_has_troops",1),
(else_try),
(eq,":agent_division_023",1),
(val_add, ":var002", 1),
(try_begin),
(eq,":::group1_has_troops",1),
(else_try),
(eq,":agent_division_023",2),
(val_add, ":var003", 1),
(try_begin),
(eq,":::group2_has_troops",1),
(else_try),
(eq,":agent_division_023",3),
(val_add, ":var004", 1),
(try_begin),
(eq,":::group3_has_troops",1),
(else_try),
(eq,":agent_division_023",4),
(val_add, ":var005", 1),
(try_begin),
(eq,":::group4_has_troops",1),
(else_try),
(eq,":agent_division_023",5),
(val_add, ":var006", 1),
(try_begin),
(eq,":::group5_has_troops",1),
(else_try),
(eq,":agent_division_023",6),
(val_add, ":var007", 1),
(try_begin),
(eq,":::group6_has_troops",1),
(else_try),
(eq,":agent_division_023",7),
(val_add, ":var008", 1),
(try_begin),
(eq,":::group7_has_troops",1),
(else_try),
(eq,":agent_division_023",8),
(val_add, ":var009", 1),
(try_begin),
(eq,":::group8_has_troops",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(val_add, ":var010", 1),
(else_try),
(overlay_set_alpha, ":agent_slot_025", 0),
(try_begin),
(agent_is_wounded,":cur_agent"),
(val_add, ":var011", 1),
(else_try),
(agent_is_routed,":cur_agent"),
(val_add, ":var012", 1),
(else_try),
(val_add, ":var013", 1),
(try_end),
(try_end),
(else_try),
(agent_is_ally,":cur_agent"),
(try_begin),
(agent_is_alive,":cur_agent"),
(call_script, "script_update_agent_position_on_map", ":cur_agent"),
(val_add, ":var014", 1),
(else_try),
(overlay_set_alpha, ":agent_slot_025", 0),
(try_begin),
(agent_is_wounded,":cur_agent"),
(val_add, ":var015", 1),
(else_try),
(agent_is_routed,":cur_agent"),
(val_add, ":var016", 1),
(else_try),
(val_add, ":var017", 1),
(try_end),
(try_end),
(else_try),
(try_begin),
(agent_is_alive,":cur_agent"),
(call_script, "script_update_agent_position_on_map", ":cur_agent"),
(val_add, ":var018", 1),
(else_try),
(overlay_set_alpha, ":agent_slot_025", 0),
(try_begin),
(agent_is_wounded,":cur_agent"),
(val_add, ":var019", 1),
(else_try),
(agent_is_routed,":cur_agent"),
(val_add, ":var020", 1),
(else_try),
(val_add, ":var021", 1),
(try_end),
(try_end),
(try_end),
(assign,reg1,":var001"),
(assign,reg2,":var002"),
(assign,reg3,":var003"),
(assign,reg4,":var004"),
(assign,reg5,":var005"),
(assign,reg6,":var006"),
(assign,reg7,":var007"),
(assign,reg8,":var008"),
(assign,reg9,":var009"),
(assign,reg10,":var010"),
(assign,reg11,":var011"),
(assign,reg12,":var012"),
(assign,reg13,":var013"),
(assign,reg14,":var014"),
(assign,reg15,":var015"),
(assign,reg16,":var016"),
(assign,reg17,":var017"),
(assign,reg18,":var018"),
(assign,reg19,":var019"),
(assign,reg20,":var020"),
(assign,reg21,":var021"),
(try_begin),
(eq,":::group0_has_troops",1),
(str_store_string,s1,":str_store_class_name(0)"),
(overlay_set_text, "$g_presentation_obj_battle_name0", "str_s1_reg1"),
(try_end),
(try_begin),
(eq,":::group1_has_troops",1),
(str_store_string,s1,":str_store_class_name(1)"),
(overlay_set_text, "$g_presentation_obj_battle_name1", "str_s1_reg2"),
(try_end),
(try_begin),
(eq,":::group2_has_troops",1),
(str_store_string,s1,":str_store_class_name(2)"),
(overlay_set_text, "$g_presentation_obj_battle_name2", "str_s1_reg3"),
(try_end),
(try_begin),
(eq,":::group3_has_troops",1),
(str_store_string,s1,":str_store_class_name(3)"),
(overlay_set_text, "$g_presentation_obj_battle_name3", "str_s1_reg4"),
(try_end),
(try_begin),
(eq,":::group4_has_troops",1),
(str_store_string,s1,":str_store_class_name(4)"),
(overlay_set_text, "$g_presentation_obj_battle_name4", "str_s1_reg5"),
(try_end),
(try_begin),
(eq,":::group5_has_troops",1),
(str_store_string,s1,":str_store_class_name(5)"),
(overlay_set_text, "$g_presentation_obj_battle_name5", "str_s1_reg6"),
(try_end),
(try_begin),
(eq,":::group6_has_troops",1),
(str_store_string,s1,":str_store_class_name(6)"),
(overlay_set_text, "$g_presentation_obj_battle_name6", "str_s1_reg7"),
(try_end),
(try_begin),
(eq,":::group7_has_troops",1),
(str_store_string,s1,":str_store_class_name(7)"),
(overlay_set_text, "$g_presentation_obj_battle_name7", "str_s1_reg8"),
(try_end),
(try_begin),
(eq,":::group8_has_troops",1),
(str_store_string,s1,":str_store_class_name(8)"),
(overlay_set_text, "$g_presentation_obj_battle_name8", "str_s1_reg9"),
(try_end),
(overlay_set_text, "$g_battle_us_ready", "@{!}{reg10}"),
(overlay_set_text, "$g_battle_us_wounded", "@{!}{reg11}"),
(overlay_set_text, "$g_battle_us_routed", "@{!}{reg12}"),
(overlay_set_text, "$g_battle_us_dead", "str_reg13"),
(overlay_set_text, "$g_battle_allies_ready", "str_reg14"),
(overlay_set_text, "$g_battle_allies_wounded", "str_reg15"),
(overlay_set_text, "$g_battle_allies_routed", "str_reg16"),
(overlay_set_text, "$g_battle_allies_dead", "str_reg17"),
(overlay_set_text, "$g_battle_enemies_ready", "str_reg18"),
(overlay_set_text, "$g_battle_enemies_wounded", "str_reg19"),
(overlay_set_text, "$g_battle_enemies_routed", "str_reg20"),
(overlay_set_text, "$g_battle_enemies_dead", "str_reg21"),
(assign,":var026",675),
(assign,":var027",280),
(val_add, ":var026", 70),
(val_add, ":var027", 60),
(position_set_x,1,":var026"),
(position_set_y,1,":var027"),
(overlay_set_position, "$g_battle_us_ready", 1),
(val_add, ":var026", 70),
(position_set_x,1,":var026"),
(overlay_set_position, "$g_battle_us_wounded", 1),
(val_add, ":var026", 70),
(position_set_x,1,":var026"),
(overlay_set_position, "$g_battle_us_routed", 1),
(val_add, ":var026", 70),
(position_set_x,1,":var026"),
(overlay_set_position, "$g_battle_us_dead", 1),
(val_add, ":var026", -210),
(val_add, ":var027", -30),
(position_set_x,1,":var026"),
(position_set_y,1,":var027"),
(overlay_set_position, "$g_battle_allies_ready", 1),
(val_add, ":var026", 70),
(position_set_x,1,":var026"),
(overlay_set_position, "$g_battle_allies_wounded", 1),
(val_add, ":var026", 70),
(position_set_x,1,":var026"),
(overlay_set_position, "$g_battle_allies_routed", 1),
(val_add, ":var026", 70),
(position_set_x,1,":var026"),
(overlay_set_position, "$g_battle_allies_dead", 1),
(val_add, ":var026", -210),
(val_add, ":var027", -30),
(position_set_x,1,":var026"),
(position_set_y,1,":var027"),
(overlay_set_position, "$g_battle_enemies_ready", 1),
(val_add, ":var026", 70),
(position_set_x,1,":var026"),
(overlay_set_position, "$g_battle_enemies_wounded", 1),
(val_add, ":var026", 70),
(position_set_x,1,":var026"),
(overlay_set_position, "$g_battle_enemies_routed", 1),
(val_add, ":var026", 70),
(position_set_x,1,":var026"),
(overlay_set_position, "$g_battle_enemies_dead", 1),
(call_script, "script_update_order_flags_on_map"),
]),

("set_town_picture", [
(try_begin),
(eq,1,1),
(party_get_current_terrain,":party_cur_terrain_001","$current_town"),
(try_begin),
(party_slot_eq,"$current_town",0,3),
(try_begin),
(this_or_next|eq,":party_cur_terrain_001",13),
(this_or_next|eq,":party_cur_terrain_001",5),
(this_or_next|eq,":party_cur_terrain_001",10),
(eq,":party_cur_terrain_001",2),
(set_background_mesh, "mesh_pic_towndes"),
(else_try),
(this_or_next|eq,":party_cur_terrain_001",12),
(eq,":party_cur_terrain_001",4),
(set_background_mesh, "mesh_pic_townsnow"),
(else_try),
(set_background_mesh, "mesh_pic_town1"),
(try_end),
(try_end),
(else_try),
(try_begin),
(this_or_next|eq,":party_cur_terrain_001",13),
(this_or_next|eq,":party_cur_terrain_001",5),
(this_or_next|eq,":party_cur_terrain_001",10),
(eq,":party_cur_terrain_001",2),
(set_background_mesh, "mesh_pic_castledes"),
(else_try),
(this_or_next|eq,":party_cur_terrain_001",12),
(eq,":party_cur_terrain_001",4),
(set_background_mesh, "mesh_pic_castlesnow"),
(else_try),
(set_background_mesh, "mesh_pic_castle1"),
(try_end),
(try_end),
]),

("consume_food", [
(store_script_param, ":var001", 1),
(troop_get_inventory_capacity,":troop_inv_capacity_002","trp_player"),
(try_for_range, ":inventory_slot_no_003", 0, ":troop_inv_capacity_002"),
(troop_get_inventory_slot,":troop_inv_slot_004","trp_player",":inventory_slot_no_003"),
(try_begin),
(is_between,":troop_inv_slot_004","itm_smoked_fish","itm_siege_supply"),
(troop_get_inventory_slot_modifier,":troop_inv_slot_modifier_005","trp_player",":inventory_slot_no_003"),
(neq,":troop_inv_slot_modifier_005",41),
(item_slot_eq,":troop_inv_slot_004",0,0),
(item_set_slot,":troop_inv_slot_004",0,1),
(val_sub, ":var001", 1),
(lt,":var001",0),
(assign,":troop_inv_capacity_002",0),
(troop_inventory_slot_get_item_amount,":troop_inv_slot_item_amount_006","trp_player",":inventory_slot_no_003"),
(val_sub, ":troop_inv_slot_item_amount_006", 1),
(troop_inventory_slot_set_item_amount,"trp_player",":inventory_slot_no_003",":troop_inv_slot_item_amount_006"),
(try_end),
(try_end),
]),

("calculate_troop_score_for_center", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",1),
(try_for_range, ":p_004", ":p.town_1", ":p.salt_mine"),
(assign,":var005",0),
(try_begin),
(eq,":troop_id_001","trp_player"),
(party_slot_eq,":p_004",7,-2),
(assign,":var005",1),
(try_end),
(try_begin),
(this_or_next|party_slot_eq,":p_004",7,":troop_id_001"),
(eq,":var005",1),
(try_begin),
(party_slot_eq,":p_004",0,3),
(val_add, ":var003", 4),
(else_try),
(party_slot_eq,":p_004",0,2),
(val_add, ":var003", 2),
(else_try),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_end),
(troop_get_slot,":troop_slot_006",":troop_id_001",7),
(store_add, ":var007", 500, ":troop_slot_006"),
(val_div, ":var007", ":var003"),
(store_random_in_range,":random_x_008",50,100),
(val_mul, ":var007", ":random_x_008"),
(try_begin),
(party_slot_eq,":var002",28,":troop_id_001"),
(val_mul, ":var007", 3),
(val_div, ":var007", 2),
(try_end),
(try_begin),
(eq,":troop_id_001","trp_player"),
(faction_get_slot,":faction_slot_009","$players_kingdom",0),
(call_script, "script_troop_get_player_relation", ":faction_slot_009"),
(assign,":var010",reg0),
(val_mul, ":var010", 2),
(val_add, ":var007", ":var010"),
(try_end),
(assign,reg0,":var007"),
]),

("assign_lords_to_empty_centers", [
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_assigning_lords_to_empty_centers"),
(str_store_string,s65,":str_store_string("str_assign_lords_to_empty_centers_just_happened")"),
(call_script, "script_add_notification_menu", "mnu_debug_alert_from_s65", 0, 0),
(try_end),
(try_for_range, ":fac_001", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_set_slot,":fac_001",12,0),
(try_end),
(try_for_range, ":troop_id_002", 0, ":trp.knight_1_1_wife"),
(troop_set_slot,":troop_id_002",46,0),
(try_end),
(try_for_range, ":p_003", ":p.town_1", ":p.salt_mine"),
(party_get_slot,":party_slot_004",":p_003",7),
(try_begin),
(this_or_next|eq,":party_slot_004",-3),
(eq,":party_slot_004",-1),
(store_faction_of_party, ":party_faction_005", ":p_003"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_party_name(p_003)"),
(str_store_string,s5,":str_store_faction_name(party_faction_005)"),
(display_message, "str_s4_of_the_s5_is_unassigned"),
(try_end),
(faction_get_slot,":faction_slot_006",":party_faction_005",12),
(val_add, ":faction_slot_006", 1),
(faction_set_slot,":party_faction_005",12,":faction_slot_006"),
(else_try),
(eq,":party_slot_004",-2),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_party_name(p_003)"),
(str_store_string,s5,":str_store_faction_name(party_faction_005)"),
(display_message, "str_s4_of_the_s5_is_reserved_for_player"),
(try_end),
(else_try),
(ge,":party_slot_004",0),
(troop_set_slot,":party_slot_004",46,1),
(try_end),
(try_end),
(try_for_range, ":troop_id_002", 0, ":trp.knight_1_1_wife"),
(troop_slot_eq,":troop_id_002",2,2),
(this_or_next|gt,":troop_id_002","trp_player"),
(eq,":::player_has_homage",1),
(troop_slot_eq,":troop_id_002",46,0),
(store_troop_faction,":troop_faction_007",":troop_id_002"),
(try_begin),
(is_between,":troop_faction_007","fac_kingdom_1","fac_kingdoms_end"),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_id_002)"),
(str_store_string,s5,":str_store_faction_name(troop_faction_007)"),
(display_message, "str_s4_of_the_s5_has_no_fiefs"),
(try_end),
(faction_get_slot,":faction_slot_006",":troop_faction_007",12),
(val_add, ":faction_slot_006", 1),
(faction_set_slot,":troop_faction_007",12,":faction_slot_006"),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(try_for_range, ":fac_001", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_get_slot,reg4,":fac_001",12),
(str_store_string,s4,":str_store_faction_name(fac_001)"),
(display_message, "str_s4_unassigned_centers_plus_landless_lords_=_reg4"),
(try_end),
(try_end),
(try_for_range, ":p_003", ":p.town_1", ":p.salt_mine"),
(party_get_slot,":party_slot_004",":p_003",7),
(try_begin),
(this_or_next|eq,":party_slot_004",-3),
(eq,":party_slot_004",-1),
(store_faction_of_party, ":party_faction_005", ":p_003"),
(try_begin),
(is_between,":party_faction_005","fac_player_supporters_faction","fac_kingdoms_end"),
(neg|faction_slot_eq,":party_faction_005",11,"trp_player"),
(eq,":::cheat_mode",1),
(str_store_string,s5,":str_store_party_name(p_003)"),
(neg|faction_slot_ge,":party_faction_005",12,2),
(str_store_string,s4,":str_store_faction_name(party_faction_005)"),
(display_message, "str_s4_holds_s5_in_reserve"),
(try_end),
(try_end),
(faction_slot_ge,":party_faction_005",12,2),
(assign,":troop_id_008",-1),
(assign,":var009",-1),
(try_begin),
(eq,":party_slot_004",-1),
(eq,":::players_kingdom",":party_faction_005"),
(eq,":::player_has_homage",1),
(assign,":troop_id_008",-2),
(call_script, "script_calculate_troop_score_for_center", "trp_player", ":p_003"),
(assign,":var009",reg0),
(try_end),
(try_end),
(try_for_range, ":trp_010", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_010",2,2),
(store_troop_faction,":troop_faction_011",":trp_010"),
(eq,":troop_faction_011",":party_faction_005"),
(call_script, "script_calculate_troop_score_for_center", ":trp_010", ":p_003"),
(assign,":var012",reg0),
(troop_slot_eq,":trp_010",46,0),
(is_between,":p_003","p_village_1","p_salt_mine"),
(val_mul, ":var012", 10),
(try_end),
(gt,":var012",":var009"),
(assign,":var009",":var012"),
(assign,":troop_id_008",":trp_010"),
(try_end),
(this_or_next|ge,":troop_id_008",0),
(eq,":troop_id_008",-2),
(faction_get_slot,":faction_slot_013",":party_faction_005",12),
(val_sub, ":faction_slot_013", 1),
(try_begin),
(eq,":troop_id_008",-2),
(troop_slot_eq,"trp_player",46,0),
(troop_set_slot,"trp_player",46,1),
(val_sub, ":faction_slot_013", 1),
(else_try),
(troop_slot_eq,":troop_id_008",46,0),
(troop_set_slot,":troop_id_008",46,1),
(val_sub, ":faction_slot_013", 1),
(try_end),
(faction_set_slot,":party_faction_005",12,":faction_slot_013"),
(try_end),
(try_begin),
(ge,":troop_id_008",0),
(call_script, "script_give_center_to_lord", ":p_003", ":troop_id_008", 1),
(else_try),
(eq,":troop_id_008",-2),
(party_set_slot,":p_003",7,-2),
(try_begin),
(party_slot_eq,":p_003",0,2),
(try_for_range, ":p_014", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_014",120,":p_003"),
(party_slot_eq,":p_014",7,-1),
(party_set_slot,":p_014",7,-2),
(try_end),
(try_end),
(try_end),
]),

("create_village_farmer_party", [
(store_script_param, ":party_id_001", 1),
(party_get_slot,":party_slot_002",":party_id_001",121),
(store_faction_of_party, ":party_faction_003", ":party_slot_002"),
(try_begin),
(is_between,":party_slot_002","p_town_1","p_castle_1"),
(set_spawn_radius,0),
(spawn_around_party,":party_id_001","pt_village_farmers"),
(assign,":party_id_004",reg0),
(party_set_faction,":party_id_004",":party_faction_003"),
(party_set_slot,":party_id_004",123,":party_id_001"),
(party_set_slot,":party_id_004",126,":party_id_001"),
(party_set_slot,":party_id_004",0,15),
(party_set_slot,":party_id_004",4,13),
(party_set_slot,":party_id_004",5,":party_slot_002"),
(party_set_ai_behavior,":party_id_004",1),
(party_set_ai_object,":party_id_004",":party_id_004"),
(party_set_flags, ":party_id_004", 65536, 0),
(store_sub, ":var005", 250, ":itm.spice"),
(try_for_range, ":itm_006", ":itm.spice", ":itm.siege_supply"),
(store_add, ":slot_no_007", ":itm_006", ":var005"),
(party_get_slot,":party_slot_008",":party_id_001",":slot_no_007"),
(party_set_slot,":party_id_004",":slot_no_007",":party_slot_008"),
(try_end),
(assign,reg0,":party_id_004"),
(try_end),
]),

("do_party_center_trade", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":party_id_002", 2),
(store_script_param, ":var003", 3),
(try_begin),
(eq,":::cheat_mode",3),
(str_store_string,s1,":str_store_party_name(party_id_002)"),
(display_message, "@@{!}DEBUG : {s1} is trading with villagers"),
(try_end),
(party_get_slot,":party_slot_004",":party_id_001",126),
(party_set_slot,":party_id_001",126,":party_id_002"),
(assign,":var005",0),
(store_sub, ":var006", 250, ":itm.spice"),
(try_for_range, ":itm_007", ":itm.spice", ":itm.siege_supply"),
(store_add, ":slot_no_008", ":itm_007", ":var006"),
(party_get_slot,":party_slot_009",":party_id_001",":slot_no_008"),
(party_get_slot,":party_slot_010",":party_id_002",":slot_no_008"),
(store_sub, ":var011", ":party_slot_009", ":party_slot_010"),
(assign,":var012",":var011"),
(val_abs,":var012"),
(val_add, ":var005", ":var012"),
(val_mul, ":var012", ":var003"),
(val_div, ":var012", 100),
(try_begin),
(lt,":var011",0),
(val_mul, ":var012", -1),
(try_end),
(assign,":var013",":party_slot_010"),
(party_set_slot,":party_id_001",":slot_no_008",":party_slot_010"),
(val_add, ":party_slot_010", ":var012"),
(party_set_slot,":party_id_002",":slot_no_008",":party_slot_010"),
(try_begin),
(eq,":::cheat_mode",3),
(str_store_string,s3,":str_store_party_name(party_slot_004)"),
(str_store_string,s4,":str_store_party_name(party_id_002)"),
(str_store_string,s5,":str_store_item_name(itm_007)"),
(assign,reg4,":var013"),
(assign,reg5,":party_slot_010"),
(display_log_message,"@{!}DEBUG -- Trade of {s5} from {s3} to {s4} brings price from {reg4} to {reg5}"),
(try_end),
(try_end),
(assign,reg0,":var005"),
]),

("player_join_faction", [
(store_script_param, ":var001", 1),
(assign,"$players_kingdom",":var001"),
(faction_set_slot,"fac_player_supporters_faction",4,0),
(assign,"$players_oath_renounced_against_kingdom",0),
(assign,"$players_oath_renounced_given_center",0),
(assign,"$players_oath_renounced_begin_time",0),
(try_for_range, ":fac_002", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_slot_eq,":fac_002",21,0),
(neq,":fac_002","fac_player_supporters_faction"),
(try_begin),
(neq,":fac_002",":var001"),
(store_relation,":faction_relation_003",":fac_002",":var001"),
(else_try),
(store_relation,":faction_relation_003","fac_player_supporters_faction",":fac_002"),
(val_max,":faction_relation_003",12),
(try_end),
(call_script, "script_set_player_relation_with_faction", ":fac_002", ":faction_relation_003"),
(try_end),
(try_for_range, ":p_004", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_004",7,"trp_player"),
(call_script, "script_give_center_to_faction_while_maintaining_lord", ":p_004", ":var001"),
(else_try),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(try_begin),
(eq,":party_faction_005","fac_player_supporters_faction"),
(call_script, "script_give_center_to_faction_while_maintaining_lord", ":p_004", ":var001"),
(try_end),
(try_end),
(try_for_range, ":qst_006", ":qst.deliver_message", ":qst.follow_army"),
(check_quest_active,":qst_006"),
(quest_get_slot,":quest_slot_007",":qst_006",6),
(store_troop_faction,":troop_faction_008",":quest_slot_007"),
(store_relation,":faction_relation_009","fac_player_supporters_faction",":troop_faction_008"),
(lt,":faction_relation_009",0),
(call_script, "script_abort_quest", ":qst_006", 0),
(try_end),
(try_end),
(try_for_range, ":qst_006", ":qst.destroy_bandit_lair", ":qst.blank_quest_2"),
(check_quest_active,":qst_006"),
(quest_get_slot,":quest_slot_007",":qst_006",6),
(store_troop_faction,":troop_faction_008",":quest_slot_007"),
(store_relation,":faction_relation_009","fac_player_supporters_faction",":troop_faction_008"),
(lt,":faction_relation_009",0),
(call_script, "script_abort_quest", ":qst_006", 0),
(try_end),
(try_end),
(try_begin),
(neq,":var001","fac_player_supporters_faction"),
(faction_set_slot,"fac_player_supporters_faction",21,2),
(faction_set_slot,"fac_player_supporters_faction",11,"trp_player"),
(try_end),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_010","trp_player",30),
(try_begin),
(is_between,":troop_slot_010","trp_knight_1_1_wife","trp_heroes_end"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_slot_010)"),
(display_message, "@@{!}DEBUG - {s4} faction changed by marriage - case 1"),
(try_end),
(try_end),
(troop_set_faction,":troop_slot_010","$players_kingdom"),
(try_end),
(try_for_range, ":p_011", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_012", ":var001"),
(try_begin),
(neq,":party_faction_012",":::players_kingdom"),
(party_slot_eq,":p_011",7,-2),
(try_end),
(try_end),
(troop_set_slot,"trp_player",154,-1),
(try_for_parties, ":cur_party"),
(store_faction_of_party, ":party_faction_014", ":cur_party"),
(try_begin),
(eq,":party_faction_014",":var001"),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_015",":cur_party"),
(try_for_range, ":var016", 0, ":party_num_prisoners_stacks_015"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_017",":cur_party",":var016"),
(store_troop_faction,":troop_faction_018",":party_prisoner_troop_id_017"),
(try_begin),
(this_or_next|eq,":troop_faction_018","fac_player_supporters_faction"),
(this_or_next|eq,":troop_faction_018",":var001"),
(is_between,":party_prisoner_troop_id_017","trp_npc1","trp_kingdom_1_lord"),
(troop_is_hero,":party_prisoner_troop_id_017"),
(call_script, "script_remove_troop_from_prison", ":party_prisoner_troop_id_017"),
(try_end),
(try_end),
(party_get_prisoner_stack_size, ":party_prisoner_stack_size_019",":cur_party",":var016"),
(party_remove_members,":cur_party",":party_prisoner_troop_id_017",":party_prisoner_stack_size_019"),
(is_between,":party_prisoner_troop_id_017","trp_npc1","trp_kingdom_1_lord"),
(try_begin),
(is_between,":cur_party","p_town_1","p_castle_1"),
(troop_set_slot,":party_prisoner_troop_id_017",12,":cur_party"),
(else_try),
(store_random_in_range,":random_x_020","p_town_1","p_castle_1"),
(troop_set_slot,":party_prisoner_troop_id_017",12,":random_x_020"),
(try_end),
(try_end),
(try_end),
(call_script, "script_update_all_notes"),
(assign,"$g_recalculate_ais",1),
]),

("player_leave_faction", [
(store_script_param, ":var001", 1),
(call_script, "script_check_and_finish_active_army_quests_for_faction", "$players_kingdom"),
(assign,":faction_id_002","$players_kingdom"),
(assign,":var003","$player_has_homage"),
(assign,"$players_kingdom",0),
(assign,"$player_has_homage",0),
(try_begin),
(neq,":var001",0),
(try_for_range, ":p_004", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_004",7,"trp_player"),
(call_script, "script_give_center_to_faction", ":p_004", ":faction_id_002"),
(party_set_slot,":p_004",7,-1),
(try_end),
(else_try),
(try_for_range, ":p_004", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_004",7,"trp_player"),
(call_script, "script_give_center_to_faction", ":p_004", "fac_player_supporters_faction"),
(party_set_slot,":p_004",7,"trp_player"),
(troop_get_slot,":troop_slot_005","trp_player",13),
(try_begin),
(gt,":troop_slot_005",0),
(assign,":troop_slot_005 -","spr_banner_a"),
(val_add, ":troop_slot_005", 1297036692682702894),
(party_set_banner_icon, ":p_004", ":troop_slot_005"),
(try_end),
(try_end),
(try_for_range, ":p_004", ":p.village_1", ":p.salt_mine"),
(party_get_slot,":party_slot_006",":p_004",120),
(try_begin),
(party_slot_eq,":p_004",7,"trp_player"),
(neg|party_slot_eq,":party_slot_006",7,"trp_player"),
(call_script, "script_give_center_to_faction", ":p_004", ":faction_id_002"),
(try_end),
(try_end),
(try_begin),
(is_between,":faction_id_002","fac_player_supporters_faction","fac_kingdoms_end"),
(neq,":faction_id_002","fac_player_supporters_faction"),
(store_relation,":faction_relation_007","fac_player_supporters_faction",":faction_id_002"),
(assign,":var008",":-40 - faction_relation_007"),
(call_script, "script_change_player_relation_with_faction", ":faction_id_002", ":var008"),
(try_end),
(try_end),
(try_begin),
(eq,":var003",1),
(faction_get_slot,":faction_slot_009",":faction_id_002",11),
(call_script, "script_change_player_relation_with_troop", ":faction_slot_009", -20),
(try_end),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_010","trp_player",30),
(try_begin),
(is_between,":troop_slot_010","trp_knight_1_1_wife","trp_heroes_end"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_slot_010)"),
(display_message, "@@{!}DEBUG - {s4} faction changed by marriage - case 3"),
(try_end),
(try_end),
(troop_set_faction,":troop_slot_010","fac_player_supporters_faction"),
(try_end),
(try_for_range, ":fac_011", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(neq,":fac_011","fac_player_supporters_faction"),
(store_relation,":faction_relation_012",":faction_id_002",":fac_011"),
(store_relation,":faction_relation_013","fac_player_faction",":fac_011"),
(try_begin),
(eq,":faction_id_002",":fac_011"),
(val_min,":faction_relation_013",0),
(else_try),
(lt,":faction_relation_012",0),
(val_max,":faction_relation_013",0),
(try_end),
(set_relation,"fac_player_faction","fac_player_faction",":faction_relation_013"),
(set_relation,"fac_player_supporters_faction","fac_player_supporters_faction",":faction_relation_013"),
(try_end),
(call_script, "script_update_all_notes"),
(assign,"$g_recalculate_ais",1),
]),

("deactivate_player_faction", [
(faction_set_slot,"fac_player_supporters_faction",21,2),
(faction_set_slot,"fac_player_supporters_faction",11,"trp_player"),
(assign,"$players_kingdom",0),
(assign,"$players_oath_renounced_against_kingdom",0),
(assign,"$players_oath_renounced_given_center",0),
(assign,"$players_oath_renounced_begin_time",0),
(call_script, "script_update_all_notes"),
(try_begin),
(is_between,"$g_player_minister","trp_npc1","trp_kingdom_1_lord"),
(assign,"$npc_to_rejoin_party","$g_player_minister"),
(try_end),
(assign,"$g_player_minister",-1),
(call_script, "script_add_notification_menu", "mnu_notification_player_faction_deactive", 0, 0),
]),

("activate_player_faction", [
(store_script_param, ":var001", 1),
(try_begin),
(faction_slot_eq,"fac_player_supporters_faction",21,2),
(neg|is_between,":var001","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(call_script, "script_add_notification_menu", "mnu_notification_player_faction_active", 0, 0),
(try_end),
(faction_set_slot,"fac_player_supporters_faction",21,0),
(faction_set_slot,"fac_player_supporters_faction",11,":var001"),
(assign,":faction_id_002","$players_kingdom"),
(try_begin),
(is_between,":faction_id_002","fac_kingdom_1","fac_kingdoms_end"),
(call_script, "script_player_leave_faction", 0),
(try_end),
(try_begin),
(is_between,":var001","trp_npc1","trp_knight_1_1_wife"),
(store_troop_faction,":troop_faction_003",":"),
(try_begin),
(is_between,":troop_faction_003","fac_kingdom_1","fac_kingdoms_end"),
(faction_get_slot,":faction_slot_004",":troop_faction_003",22),
(str_store_string,s1,":str_store_string(faction_slot_004)"),
(faction_set_name, "fac_player_supporters_faction", "@{s1} Rebels"),
(else_try),
(str_store_string,s2,":str_store_troop_name(var001)"),
(str_store_string,s1,":str_store_string("str_s2s_rebellion")"),
(try_end),
(try_end),
(faction_set_color, "fac_player_supporters_faction", 16711680),
(assign,"$players_kingdom","fac_player_supporters_faction"),
(assign,"$g_player_banner_granted",1),
(try_begin),
(is_between,":faction_id_002","fac_kingdom_1","fac_kingdoms_end"),
(faction_get_slot,":faction_slot_005",":faction_id_002",11),
(call_script, "script_add_log_entry", 23, "trp_player", -1, ":faction_slot_005", "$players_kingdom"),
(assign,"$players_oath_renounced_against_kingdom",":faction_id_002"),
(assign,"$players_oath_renounced_given_center",0),
(store_current_hours,"$players_oath_renounced_begin_time"),
(try_for_range, ":p_006", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_007", ":p_006"),
(party_set_slot,":p_006",159,":party_faction_007"),
(try_end),
(party_set_slot,"$g_center_to_give_to_player",159,"$players_oath_renounced_against_kingdom"),
(store_relation,":faction_relation_008",":faction_id_002","fac_player_supporters_faction"),
(try_begin),
(ge,":faction_relation_008",0),
(call_script, "script_diplomacy_start_war_between_kingdoms", ":faction_id_002", "fac_player_supporters_faction", 1),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_009","trp_player",30),
(try_begin),
(is_between,":troop_slot_009","trp_knight_1_1_wife","trp_heroes_end"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_slot_009)"),
(display_message, "@@{!}DEBUG - {s4} faction changed by marriage - case 2"),
(try_end),
(try_end),
(troop_set_faction,":troop_slot_009","fac_player_supporters_faction"),
(try_end),
(call_script, "script_update_all_notes"),
(assign,"$g_recalculate_ais",1),
]),

("agent_reassign_team", [
(store_script_param, ":var001", 1),
(get_player_agent_no,":agent_no_002"),
(try_begin),
(ge,":agent_no_002",0),
(agent_is_human,":var001"),
(agent_is_ally,":var001"),
(agent_get_party_id,":party_id_003",":var001"),
(try_begin),
(neq,":party_id_003","p_main_party"),
(assign,":var004",1),
(store_faction_of_party, ":party_faction_005", ":party_id_003"),
(try_begin),
(eq,":party_faction_005",":::players_kingdom"),
(is_between,"$players_kingdom","fac_player_supporters_faction","fac_kingdoms_end"),
(faction_slot_eq,"$players_kingdom",8,"trp_player"),
(assign,":var004",0),
(else_try),
(party_stack_get_troop_id,      ":troop_id_006",":party_id_003",0),
(try_begin),
(neg|is_between,":troop_id_006","trp_npc1","trp_knight_1_1_wife"),
(assign,":var004",0),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var004",1),
(agent_get_team, ":agent_team_no_007", ":agent_no_002"),
(val_add, ":agent_team_no_007", 2),
(agent_set_team, ":var001", ":agent_team_no_007"),
(try_end),
(try_end),
]),

("start_quest", [
(store_script_param, ":quest_id_001", 1),
(store_script_param, ":var002", 2),
(quest_set_slot,":quest_id_001",6,":var002"),
(try_begin),
(eq,":var002",-1),
(str_store_string,s63,":str_store_string("str_political_suggestion")"),
(else_try),
(is_between,":var002","trp_npc1","trp_knight_1_1_wife"),
(str_store_string,s62,":str_store_troop_name_link(var002)"),
(str_store_string,s63,":str_store_string("@Given by: {s62}")"),
(else_try),
(str_store_string,s62,":str_store_troop_name(var002)"),
(str_store_string,s63,":str_store_string("@Given by: {s62}")"),
(try_end),
(store_current_hours,":cur_hours_003"),
(str_store_string,s60,":str_store_date(cur_hours_003)"),
(str_store_string,s60,":str_store_string("@Given on: {s60}")"),
(add_quest_note_from_sreg,":quest_id_001",0,60, 0),
(add_quest_note_from_sreg,":quest_id_001",1,63, 0),
(add_quest_note_from_sreg,":quest_id_001",2,2, 0),
(try_begin),
(quest_slot_ge,":quest_id_001",23,1),
(quest_get_slot,reg0,":quest_id_001",23),
(try_end),
(try_begin),
(quest_slot_ge,":quest_id_001",24,1),
(quest_get_slot,":quest_slot_004",":quest_id_001",24),
(quest_set_slot,":quest_id_001",25,":quest_slot_004"),
(try_end),
(call_script, "script_start_quest", ":quest_id_001", ":var002"),
(try_begin),
(eq,":quest_id_001","qst_report_to_army"),
(assign,"$number_of_report_to_army_quest_notes",8),
(faction_get_slot,":faction_slot_005","$players_kingdom",4),
(call_script, "script_update_report_to_army_quest_note", "$players_kingdom", ":faction_slot_005", -1),
(try_end),
(display_message, "str_quest_log_updated"),
]),

("conclude_quest", [
(store_script_param, ":quest_id_001", 1),
(call_script, "script_conclude_quest", ":quest_id_001"),
(quest_get_slot,":quest_slot_002",":quest_id_001",6),
(str_store_string,s59,":str_store_troop_name(quest_slot_002)"),
]),

("succeed_quest", [
(store_script_param, ":quest_id_001", 1),
(call_script, "script_succeed_quest", ":quest_id_001"),
(quest_get_slot,":quest_slot_002",":quest_id_001",6),
(str_store_string,s59,":str_store_troop_name(quest_slot_002)"),
]),

("fail_quest", [
(store_script_param, ":quest_id_001", 1),
(call_script, "script_fail_quest", ":quest_id_001"),
(quest_get_slot,":quest_slot_002",":quest_id_001",6),
(str_store_string,s59,":str_store_troop_name(quest_slot_002)"),
]),

("report_quest_troop_positions", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(call_script, "script_get_information_about_troops_position", ":var002", 1),
(str_store_string,s5,":str_store_string("@At the time quest was given:^{s1}")"),
(add_quest_note_from_sreg,":var001",":var003",5, 1),
(call_script, "script_update_troop_location_notes", ":var002", 1),
]),

("end_quest", [
(store_script_param, ":quest_id_001", 1),
(str_clear, 1),
(add_quest_note_from_sreg,":quest_id_001",0,1, 0),
(add_quest_note_from_sreg,":quest_id_001",1,1, 0),
(add_quest_note_from_sreg,":quest_id_001",2,1, 0),
(add_quest_note_from_sreg,":quest_id_001",3,1, 0),
(add_quest_note_from_sreg,":quest_id_001",4,1, 0),
(add_quest_note_from_sreg,":quest_id_001",5,1, 0),
(add_quest_note_from_sreg,":quest_id_001",6,1, 0),
(add_quest_note_from_sreg,":quest_id_001",7,1, 0),
(try_begin),
(neg|check_quest_failed,":quest_id_001"),
(val_add, ":::g_total_quests_completed", 1),
(try_end),
(try_begin),
(eq,":quest_id_001","qst_consult_with_minister"),
(assign,"$g_minister_notification_quest",0),
(try_end),
(complete_quest,":quest_id_001"),
(try_begin),
(is_between,":quest_id_001","qst_move_cattle_herd","qst_deliver_grain"),
(assign,"$merchant_quest_last_offerer",-1),
(assign,"$merchant_offered_quest",-1),
(try_end),
]),

("cancel_quest", [
(store_script_param, ":quest_id_001", 1),
(str_clear, 1),
(add_quest_note_from_sreg,":quest_id_001",0,1, 0),
(add_quest_note_from_sreg,":quest_id_001",1,1, 0),
(add_quest_note_from_sreg,":quest_id_001",2,1, 0),
(add_quest_note_from_sreg,":quest_id_001",3,1, 0),
(add_quest_note_from_sreg,":quest_id_001",4,1, 0),
(add_quest_note_from_sreg,":quest_id_001",5,1, 0),
(add_quest_note_from_sreg,":quest_id_001",6,1, 0),
(add_quest_note_from_sreg,":quest_id_001",7,1, 0),
(call_script, "script_cancel_quest", ":quest_id_001"),
(try_begin),
(is_between,":quest_id_001","qst_move_cattle_herd","qst_deliver_grain"),
(assign,"$merchant_quest_last_offerer",-1),
(assign,"$merchant_offered_quest",-1),
(try_end),
]),

("update_village_market_towns", [
(try_for_range, ":p_001", ":p.village_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_002", ":p_001"),
(assign,":var003",999999),
(assign,":var004",-1),
(try_for_range, ":p_005", ":p.town_1", ":p.castle_1"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(try_begin),
(eq,":party_faction_006",":party_faction_002"),
(store_distance_to_party_from_party,":distance_parties_007",":p_001",":p_001"),
(lt,":distance_parties_007",":var003"),
(assign,":var003",":distance_parties_007"),
(assign,":var004",":p_005"),
(try_end),
(try_end),
(try_begin),
(gt,":var004",-1),
(party_set_slot,":p_001",121,":var004"),
(else_try),
(assign,":var003",999999),
(assign,":var004",-1),
(try_for_range, ":p_005", ":p.town_1", ":p.castle_1"),
(store_faction_of_party, ":party_faction_006", ":p_005"),
(store_relation,":faction_relation_008",":party_faction_006",":party_faction_002"),
(try_begin),
(ge,":faction_relation_008",0),
(store_distance_to_party_from_party,":distance_parties_007",":p_001",":p_001"),
(try_begin),
(lt,":distance_parties_007",":var003"),
(assign,":var003",":distance_parties_007"),
(assign,":var004",":p_005"),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var004",-1),
(party_set_slot,":p_001",121,":var004"),
(try_end),
(try_end),
(try_end),
]),

("update_mercenary_units_of_towns", [
(try_for_range, ":p_001", ":p.town_1", ":p.castle_1"),
(store_random_in_range,":random_x_002","trp_watchman","trp_mercenaries_end"),
(party_set_slot,":p_001",90,":random_x_002"),
(store_random_in_range,":random_x_003",3,8),
(party_set_slot,":p_001",91,":random_x_003"),
(try_end),
]),

("update_volunteer_troops_in_village", [
(store_script_param, ":party_id_001", 1),
(party_get_slot,":party_slot_002",":party_id_001",26),
(party_get_slot,":party_slot_003",":party_id_001",19),
(faction_get_slot,":faction_slot_004",":party_slot_003",41),
(assign,":var005",1),
(store_div, ":var___x1", ":party_slot_002", 10),
(assign,":var006",":var___x1"),
(try_for_range, ":var007", 0, ":var006"),
(store_random_in_range,":random_x_008",0,100),
(try_begin),
(lt,":random_x_008",10),
(store_random_in_range,":random_x_008",0,2),
(troop_get_upgrade_troop,":troop_upgrade_troop_id_009",":faction_slot_004",":random_x_008"),
(le,":troop_upgrade_troop_id_009",0),
(troop_get_upgrade_troop,":troop_upgrade_troop_id_009",":faction_slot_004",0),
(try_end),
(gt,":troop_upgrade_troop_id_009",0),
(val_add, ":var005", 1),
(assign,":faction_slot_004",":troop_upgrade_troop_id_009"),
(try_end),
(assign,":var010",8),
(try_begin),
(ge,":party_slot_002",4),
(assign,":var010",":party_slot_002"),
(val_div, ":var010", 2),
(val_add, ":var010", 6),
(else_try),
(lt,":party_slot_002",0),
(assign,":var010",0),
(try_end),
(val_mul, ":var010", 3),
(store_add, ":var011", 2, ":var005"),
(val_div, ":var010", ":var011"),
(store_random_in_range,":random_x_012",0,":var010"),
(party_set_slot,":party_id_001",92,":faction_slot_004"),
(party_set_slot,":party_id_001",93,":random_x_012"),
]),

("update_npc_volunteer_troops_in_village", [
(store_script_param, ":party_id_001", 1),
(party_get_slot,":party_slot_002",":party_id_001",19),
(faction_get_slot,":faction_slot_003",":party_slot_002",41),
(assign,":var004",1),
(try_for_range, ":var005", 0, 5),
(store_random_in_range,":random_x_006",0,100),
(try_begin),
(lt,":random_x_006",10),
(store_random_in_range,":random_x_006",0,2),
(troop_get_upgrade_troop,":troop_upgrade_troop_id_007",":faction_slot_003",":random_x_006"),
(le,":troop_upgrade_troop_id_007",0),
(troop_get_upgrade_troop,":troop_upgrade_troop_id_007",":faction_slot_003",0),
(try_end),
(gt,":troop_upgrade_troop_id_007",0),
(val_add, ":var004", 1),
(assign,":faction_slot_003",":troop_upgrade_troop_id_007"),
(try_end),
(assign,":var008",12),
(store_add, ":var009", 2, ":var004"),
(val_div, ":var008", ":var009"),
(store_random_in_range,":random_x_010",0,":var008"),
(party_set_slot,":party_id_001",90,":faction_slot_003"),
(party_set_slot,":party_id_001",91,":random_x_010"),
]),

("update_companion_candidates_in_taverns", [
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_shuffling_companion_locations"),
(try_end),
(try_for_range, ":trp_001", ":trp.npc1", ":trp.kingdom_1_lord"),
(troop_set_slot,":trp_001",12,-1),
(try_begin),
(troop_slot_eq,":trp_001",150,0),
(troop_slot_eq,":trp_001",2,0),
(neg|troop_slot_ge,":trp_001",8,0),
(store_random_in_range,":random_x_002","p_town_1","p_castle_1"),
(neg|troop_slot_eq,":trp_001",60,":random_x_002"),
(neg|troop_slot_eq,":trp_001",59,":random_x_002"),
(troop_set_slot,":trp_001",12,":random_x_002"),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_001)"),
(str_store_string,s5,":str_store_party_name(random_x_002)"),
(display_message, "@@{!}{s4} is in {s5}"),
(try_end),
(try_end),
]),

("update_ransom_brokers", [
(try_for_range, ":p_001", ":p.town_1", ":p.castle_1"),
(party_set_slot,":p_001",95,0),
(try_end),
(try_for_range, ":trp_002", ":trp.ransom_broker_1", ":trp.tavern_traveler_1"),
(store_random_in_range,":p_001","p_town_1","p_castle_1"),
(party_set_slot,":p_001",95,":trp_002"),
(try_end),
(party_set_slot,"p_town_2",95,"trp_ramun_the_slave_trader"),
]),

("update_tavern_travellers", [
(try_for_range, ":p_001", ":p.town_1", ":p.castle_1"),
(party_set_slot,":p_001",96,0),
(try_end),
(try_for_range, ":trp_002", ":trp.tavern_traveler_1", ":trp.tavern_bookseller_1"),
(store_random_in_range,":p_001","p_town_1","p_castle_1"),
(party_set_slot,":p_001",96,":trp_002"),
(assign,":var003",15),
(try_for_range, ":var004", 0, ":var003"),
(store_random_in_range,":random_x_005","fac_player_supporters_faction","fac_kingdoms_end"),
(faction_slot_eq,":random_x_005",21,0),
(neq,":random_x_005",":::players_kingdom"),
(neq,":random_x_005","fac_player_supporters_faction"),
(party_set_slot,":p_001",97,":random_x_005"),
(assign,":var003",0),
(try_end),
(try_end),
(troop_set_slot,"trp_belligerent_drunk",12,"p_town_1"),
]),

("update_villages_infested_by_bandits", [
(try_for_range, ":p_001", ":p.village_1", ":p.salt_mine"),
(check_quest_active,"qst_eliminate_bandits_infesting_village"),
(quest_slot_eq,"qst_eliminate_bandits_infesting_village",1,":p_001"),
(quest_get_slot,":quest_slot_002","qst_eliminate_bandits_infesting_village",11),
(val_add, ":quest_slot_002", 1),
(try_begin),
(lt,":quest_slot_002",3),
(quest_set_slot,"qst_eliminate_bandits_infesting_village",11,":quest_slot_002"),
(else_try),
(party_set_slot,":p_001",39,0),
(call_script, "script_abort_quest", "qst_eliminate_bandits_infesting_village", 2),
(try_end),
(else_try),
(check_quest_active,"qst_deal_with_bandits_at_lords_village"),
(quest_slot_eq,"qst_deal_with_bandits_at_lords_village",1,":p_001"),
(quest_get_slot,":quest_slot_002","qst_deal_with_bandits_at_lords_village",11),
(val_add, ":quest_slot_002", 1),
(try_begin),
(lt,":quest_slot_002",3),
(quest_set_slot,"qst_deal_with_bandits_at_lords_village",11,":quest_slot_002"),
(else_try),
(party_set_slot,":p_001",39,0),
(call_script, "script_abort_quest", "qst_deal_with_bandits_at_lords_village", 2),
(try_end),
(else_try),
(party_set_slot,":p_001",39,0),
(store_random_in_range,":random_x_003",0,100),
(assign,":var004",1),
(try_begin),
(check_quest_active,"qst_collect_taxes"),
(quest_slot_eq,"qst_collect_taxes",1,":p_001"),
(assign,":var004",0),
(else_try),
(check_quest_active,"qst_train_peasants_against_bandits"),
(quest_slot_eq,"qst_train_peasants_against_bandits",1,":p_001"),
(assign,":var004",0),
(try_end),
(try_begin),
(eq,":var004",1),
(lt,":random_x_003",3),
(store_random_in_range,":random_x_003",0,3),
(try_begin),
(eq,":random_x_003",0),
(assign,":var005","trp_bandit"),
(else_try),
(eq,":random_x_003",1),
(assign,":var005","trp_mountain_bandit"),
(else_try),
(assign,":var005","trp_forest_bandit"),
(try_end),
(try_end),
(party_set_slot,":p_001",39,":var005"),
(call_script, "script_change_center_prosperity", ":p_001", -1),
(val_add, ":::newglob_total_prosperity_from_bandits", -1),
(try_begin),
(eq,":::cheat_mode",2),
(str_store_string,s1,":str_store_party_name(p_001)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_end),
]),

("update_booksellers", [
(try_for_range, ":p_001", ":p.town_1", ":p.castle_1"),
(party_set_slot,":p_001",98,0),
(try_end),
(try_for_range, ":trp_002", ":trp.tavern_bookseller_1", ":trp.tavern_minstrel_1"),
(store_random_in_range,":p_001","p_town_1","p_castle_1"),
(party_set_slot,":p_001",98,":trp_002"),
(try_end),
]),

("update_tavern_minstrels", [
(try_for_range, ":p_001", ":p.town_1", ":p.castle_1"),
(party_set_slot,":p_001",99,0),
(try_end),
(try_for_range, ":trp_002", ":trp.tavern_minstrel_1", ":trp.kingdom_heroes_including_player_begin"),
(store_random_in_range,":p_001","p_town_1","p_castle_1"),
(party_set_slot,":p_001",99,":trp_002"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_002)"),
(str_store_string,s5,":str_store_party_name(p_001)"),
(display_message, "str_s4_is_at_s5"),
(try_end),
(try_end),
]),

("update_other_taverngoers", [
(store_random_in_range,":random_x_001","p_town_1","p_castle_1"),
(troop_set_slot,"trp_fight_promoter",12,":random_x_001"),
(store_random_in_range,":random_x_002","p_town_1","p_castle_1"),
(troop_set_slot,"trp_belligerent_drunk",12,":random_x_002"),
]),

("update_faction_notes", [
(store_script_param, ":var001", 1),
(try_begin),
(this_or_next|faction_slot_eq,":var001",21,2),
(eq,":var001","fac_player_faction"),
(faction_set_note_available, ":var001", 0),
(else_try),
(faction_set_note_available, ":var001", 1),
(try_end),
]),

("update_faction_political_notes", [
(store_script_param, ":var001", 1),
(call_script, "script_evaluate_realm_stability", ":var001"),
(add_faction_note_from_sreg,":var001",2,"str_instability_reg0_of_lords_are_disgruntled_reg1_are_restless", 0),
]),

("update_faction_traveler_notes", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_for_parties, ":cur_party"),
(store_faction_of_party, ":party_faction_004", ":cur_party"),
(try_begin),
(eq,":party_faction_004",":var001"),
(party_get_num_companions,":party_num_companions_005",":cur_party"),
(val_add, ":var002", ":party_num_companions_005"),
(try_end),
(try_end),
(str_store_string,s5,":str_store_faction_name(var001)"),
(assign,reg1,":var002"),
]),

("update_troop_notes", [
]),

("update_troop_location_notes", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(eq,1,1),
(call_script, "script_get_information_about_troops_position", ":troop_id_001", 1),
(try_begin),
(neq,reg0,0),
(call_script, "script_search_troop_prisoner_of_party", ":troop_id_001"),
(eq,reg0,-1),
(troop_get_type,reg1,":troop_id_001"),
(try_end),
(try_end),
]),

("update_troop_location_notes_prisoned", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(troop_get_type,reg1,":troop_id_001"),
(str_store_string,s1,":str_store_faction_name_link(var002)"),
(add_troop_note_from_sreg,":troop_id_001",2,"str_reg1shehe_is_prisoner_of_s1", 1),
]),

("update_troop_political_notes", [
(store_script_param, ":troop_id_001", 1),
(try_begin),
(eq,1,1),
(str_clear, 47),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(faction_get_slot,":faction_slot_003",":troop_faction_002",11),
(str_clear, 40),
(assign,":var004",0),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.knight_1_1_wife"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":trp_005"),
(try_begin),
(lt,reg0,-10),
(str_store_string,s39,":str_store_troop_name_link(trp_005)"),
(try_begin),
(eq,":var004",0),
(str_store_string,s40,":str_store_string("str_s39_rival")"),
(assign,":var004",1),
(else_try),
(str_store_string,s41,":str_store_string("str_s40")"),
(str_store_string,s40,":str_store_string("str_s41_s39_rival")"),
(try_end),
(try_end),
(try_end),
(str_clear, 46),
(ge,":::cheat_mode",1),
(try_begin),
(troop_slot_eq,":troop_id_001",52,1),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_martial_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,5),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_debauched_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,3),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_pitiless_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,4),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_calculating_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,2),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_quarrelsome_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,6),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_goodnatured_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,7),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_upstanding_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,21),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_conventional_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,22),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_adventurous_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,23),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_romantic_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,25),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_moralist_")"),
(else_try),
(troop_slot_eq,":troop_id_001",52,24),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_ambitious_")"),
(else_try),
(troop_get_slot,reg11,":troop_id_001",52),
(str_store_string,s46,":str_store_string("str_reputation_cheat_mode_only_reg11_")"),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(try_for_range, ":slot_no_006", 35, 38),
(troop_get_slot,":troop_slot_007",":troop_id_001",":slot_no_006"),
(try_begin),
(is_between,":troop_slot_007","trp_knight_1_1_wife","trp_heroes_end"),
(str_store_string,s39,":str_store_troop_name_link(troop_slot_007)"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":troop_slot_007"),
(str_store_string,s2,":str_store_string("str_love_interest")"),
(try_begin),
(troop_slot_eq,":troop_id_001",34,":troop_slot_007"),
(str_store_string,s2,":str_store_string("str_betrothed")"),
(try_end),
(try_end),
(str_store_string,s40,":str_store_string("str_s40_s39_s2_reg0")"),
(try_end),
(try_end),
(try_end),
(str_store_string,s45,":str_store_string("str_other_relations_s40_")"),
(str_clear, 44),
(try_begin),
(neq,":troop_id_001",":faction_slot_003"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":faction_slot_003"),
(str_store_string,s44,":str_store_string("str_relation_with_liege_reg0_")"),
(try_end),
(str_clear, 48),
(try_begin),
(eq,":::cheat_mode",1),
(store_current_hours,":cur_hours_008"),
(try_begin),
(gt,":cur_hours_008",0),
(call_script, "script_calculate_troop_political_factors_for_liege", ":troop_id_001", ":faction_slot_003"),
(str_store_string,s48,":str_store_string("str_sense_of_security_military_reg1_court_position_reg3_")"),
(try_end),
(try_end),
(str_store_string,s47,":str_store_string("str_s46s45s44s48")"),
(add_troop_note_from_sreg,":troop_id_001",3,"str_political_details_s47_", 1),
]),

("update_center_notes", [
]),

("update_center_recon_notes", [
(store_script_param, ":party_id_001", 1),
(try_begin),
(this_or_next|is_between,":party_id_001","p_town_1","p_castle_1"),
(is_between,":party_id_001","p_castle_1","p_village_1"),
(party_get_slot,":party_slot_002",":party_id_001",53),
(call_script, "script_center_get_food_consumption", ":party_id_001"),
(assign,":var003",reg0),
(store_div, ":var___x1", ":party_slot_002", ":var003"),
(assign,reg6,":var___x1"),
(party_collect_attachments_to_party, ":party_id_001", "p_collective_ally"),
(party_get_num_companions,reg5,"p_collective_ally"),
(try_end),
]),

("update_all_notes", [
(call_script, "script_update_troop_notes", "trp_player"),
(try_for_range, ":trp_001", ":trp.npc1", ":trp.knight_1_1_wife"),
(this_or_next|troop_slot_eq,":trp_001",2,2),
(this_or_next|troop_slot_eq,":trp_001",2,6),
(troop_slot_eq,":trp_001",2,9),
(call_script, "script_update_troop_notes", ":trp_001"),
(try_end),
(try_for_range, ":p_002", ":p.town_1", ":p.salt_mine"),
(call_script, "script_update_center_notes", ":p_002"),
(try_end),
(try_for_range, ":fac_003", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(call_script, "script_update_faction_notes", ":fac_003"),
(try_end),
]),

("agent_troop_get_banner_mesh", [
(store_script_param, ":var001", 1),
(store_script_param, ":troop_id_002", 2),
(assign,":troop_id_003",-1),
(assign,":faction_slot_004","mesh_banners_default_b"),
(try_begin),
(lt,":var001",0),
(try_begin),
(ge,":troop_id_002",0),
(this_or_next|troop_slot_ge,":troop_id_002",13,1),
(eq,":troop_id_002","trp_player"),
(assign,":troop_id_003",":troop_id_002"),
(else_try),
(is_between,":troop_id_002","trp_npc1","trp_kingdom_1_lord"),
(assign,":troop_id_003","trp_player"),
(else_try),
(assign,":faction_slot_004","mesh_banners_default_a"),
(try_end),
(else_try),
(eq,":::g_is_quick_battle",1),
(agent_get_team, ":agent_team_no_005", ":var001"),
(try_begin),
(eq,":agent_team_no_005",0),
(assign,":faction_slot_004","$g_quick_battle_team_0_banner"),
(else_try),
(assign,":faction_slot_004","$g_quick_battle_team_1_banner"),
(try_end),
(else_try),
(game_in_multiplayer_mode),
(agent_get_group, ":agent_group_006", ":var001"),
(try_begin),
(neg|player_is_active, ":agent_group_006"),
(agent_get_player_id,":agent_group_006",":var001"),
(try_end),
(try_begin),
(eq,":::g_multiplayer_allow_player_banners",1),
(player_is_active, ":agent_group_006"),
(player_get_banner_id, ":bannder_id_007", ":agent_group_006"),
(try_begin),
(ge,":bannder_id_007",0),
(store_add, ":faction_slot_004", ":bannder_id_007", ":mesh.arms_a01"),
(assign,":var008",0),
(try_for_range, ":fac_009", ":fac.kingdom_1", ":fac.kingdoms_end"),
(faction_slot_eq,":fac_009",15,":faction_slot_004"),
(assign,":var008",1),
(try_end),
(try_end),
(try_begin),
(neg|is_between,":faction_slot_004","mesh_arms_a01","mesh_arms_f21"),
(assign,":var008",1),
(try_end),
(try_begin),
(eq,":var008",0),
(else_try),
(agent_get_team, ":agent_team_no_005", ":var001"),
(team_get_faction, ":team_faction_010", ":agent_team_no_005"),
(try_begin),
(agent_is_human,":var001"),
(try_begin),
(this_or_next|eq,":team_faction_010","fac_ccoop_all_stars"),
(eq,":team_faction_010","fac_outlaws"),
(agent_get_troop_id,":troop_id_002", ":var001"),
(store_troop_faction,":team_faction_010",":troop_id_002"),
(try_end),
(faction_get_slot,":faction_slot_004",":team_faction_010",15),
(else_try),
(agent_get_rider,":agent_rider_011",":var001"),
(try_begin),
(ge,":agent_rider_011",0),
(agent_is_active,":agent_rider_011"),
(agent_get_team, ":agent_team_no_012", ":agent_rider_011"),
(team_get_faction, ":team_faction_013", ":agent_team_no_012"),
(faction_get_slot,":faction_slot_004",":team_faction_013",15),
(else_try),
(assign,":faction_slot_004","mesh_banners_default_c"),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":::talk_context",14),
(neq,":troop_id_002","trp_player"),
(assign,":faction_slot_004","mesh_banners_default_d"),
(else_try),
(neq,":troop_id_002","trp_player"),
(is_between,"$g_encountered_party","p_town_1","p_village_1"),
(party_get_slot,":party_slot_017","$g_encountered_party",7),
(try_begin),
(ge,":party_slot_017",0),
(assign,":troop_id_003",":party_slot_017"),
(try_end),
(else_try),
(agent_get_troop_id,":troop_id_014", ":var001"),
(try_begin),
(this_or_next|troop_slot_ge,":troop_id_014",13,1),
(eq,":troop_id_002","trp_player"),
(assign,":troop_id_003",":troop_id_014"),
(else_try),
(agent_get_party_id,":party_id_015",":var001"),
(try_begin),
(lt,":party_id_015",0),
(is_between,":troop_id_014","trp_npc1","trp_kingdom_1_lord"),
(main_party_has_troop,":troop_id_014"),
(assign,":party_id_015","p_main_party"),
(try_end),
(try_end),
(try_begin),
(ge,":party_id_015",0),
(party_get_template_id,":party_template_id_016",":party_id_015"),
(try_begin),
(eq,":party_template_id_016","pt_deserters"),
(assign,":faction_slot_004","mesh_banners_default_c"),
(else_try),
(is_between,":party_id_015","p_town_1","p_salt_mine"),
(is_between,":troop_id_014","trp_npc1","trp_kingdom_1_lord"),
(neq,":::talk_context",14),
(assign,":troop_id_003","trp_player"),
(else_try),
(is_between,":party_id_015","p_town_1","p_salt_mine"),
(party_get_slot,":party_slot_017","$g_encountered_party",7),
(try_begin),
(ge,":party_slot_017",0),
(assign,":troop_id_003",":party_slot_017"),
(else_try),
(this_or_next|party_slot_eq,":party_id_015",0,13),
(eq,":party_id_015","p_main_party"),
(party_get_num_companion_stacks,":party_num_companions_stacks_018",":party_id_015"),
(try_begin),
(gt,":party_num_companions_stacks_018",0),
(party_stack_get_troop_id,      ":troop_id_019",":party_id_015",0),
(try_begin),
(this_or_next|troop_slot_ge,":troop_id_019",13,1),
(eq,":troop_id_019","trp_player"),
(assign,":troop_id_003",":troop_id_019"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(ge,":troop_id_003",0),
(try_begin),
(neg|troop_slot_ge,":troop_id_003",13,1),
(assign,":faction_slot_004","mesh_banners_default_b"),
(else_try),
(troop_get_slot,":troop_slot_020",":troop_id_003",13),
(assign,":var021","spr_banner_f21"),
(val_add, ":var021", 1),
(try_begin),
(is_between,":troop_slot_020","spr_banner_a",":var021"),
(assign,":troop_slot_020 -","spr_banner_a"),
(store_add, ":faction_slot_004", ":troop_slot_020", ":mesh.arms_a01"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":faction_slot_004"),
]),

("shield_item_set_banner", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(call_script, "script_agent_troop_get_banner_mesh", ":var002", ":var003"),
(cur_item_set_tableu_material, ":var001", reg0),
]),

("troop_agent_set_banner", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(call_script, "script_agent_troop_get_banner_mesh", ":var002", ":var003"),
(cur_agent_set_banner_tableau_material, ":var001"),
]),

("add_troop_to_cur_tableau", [
(store_script_param, ":troop_id_001", 1),
(set_fixed_point_multiplier, 100),
(assign,":var002",-1),
(troop_get_slot,":troop_slot_003",":troop_id_001",13),
(assign,":var004","spr_banner_f21"),
(val_add, ":var004", 1),
(try_begin),
(is_between,":troop_slot_003","spr_banner_a",":var004"),
(assign,":troop_slot_003 -","spr_banner_a"),
(store_add, ":var002", ":troop_slot_003", ":mesh.banner_a01"),
(try_end),
(cur_tableau_clear_override_items),
(cur_tableau_set_override_flags, 31),
(init_position,2),
(cur_tableau_set_camera_parameters, 1, 6, 6, 10, 10000),
(init_position,5),
(store_mul, ":var006", ":troop_id_001", 87323),
(assign,":var006",139),
(store_mul, ":var007", ":troop_id_001", 124337),
(val_mod, ":var007", 50),
(val_add, ":var007", -25),
(store_mul, ":var008", ":troop_id_001", 98123),
(val_mod, ":var008", 20),
(val_add, ":var008", -14),
(assign,":var009","anim_stand_man"),
(position_set_z,5,162), # var005
(position_rotate_x,5,-90),
(position_rotate_z,5,180),
(position_rotate_y,5,":var007"),
(position_rotate_x,5,":var008"),
(position_move_z,5,":var006",0),
(position_move_x,5,5,0),
(try_begin),
(ge,":var002",0),
(init_position,1),
(position_set_z,1,-1500),
(position_set_x,1,265),
(position_set_y,1,400),
(position_transform_position_to_parent,3,5,1),
(cur_tableau_add_mesh, ":var002", 3, 400, 400),
(try_end),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var009", 0),
(cur_tableau_set_camera_position, 5),
(copy_position,8,5),
(position_rotate_x,8,-90),
(position_rotate_z,8,30),
(position_rotate_x,8,-60),
(cur_tableau_add_sun_light, 0, 8, 175, 150, 125),
]),

("add_troop_to_cur_tableau_for_character", [
(store_script_param, ":troop_id_001", 1),
(set_fixed_point_multiplier, 100),
(cur_tableau_clear_override_items),
(cur_tableau_set_override_flags, 512),
(init_position,2),
(cur_tableau_set_camera_parameters, 1, 4, 8, 10, 10000),
(init_position,5),
(assign,":var006",1),
(position_set_z,5,150), # var002
(position_rotate_x,5,-90),
(position_rotate_z,5,180),
(position_rotate_y,5,-15), # var004
(position_rotate_x,5,-18), # var005
(position_move_z,5,360,0), # var003
(position_move_x,5,5,0),
(try_begin),
(troop_is_hero,":troop_id_001"),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var006", -1),
(else_try),
(store_mul, ":var007", ":troop_id_001", 126233),
(val_mod, ":var007", 1000),
(val_add, ":var007", 1),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var006", ":var007"),
(try_end),
(cur_tableau_set_camera_position, 5),
(copy_position,8,5),
(position_rotate_x,8,-90),
(position_rotate_z,8,30),
(position_rotate_x,8,-60),
(cur_tableau_add_sun_light, 0, 8, 175, 150, 125),
]),

("add_troop_to_cur_tableau_for_inventory", [
(store_script_param, ":troop_id_001", 1),
(store_mod,":var002",":troop_id_001",4),
(val_div, ":troop_id_001", 4),
(val_mul, ":var002", 90),
(set_fixed_point_multiplier, 100),
(cur_tableau_clear_override_items),
(init_position,2),
(position_rotate_z,2,":var002"),
(cur_tableau_set_camera_parameters, 1, 4, 6, 10, 10000),
(init_position,5),
(assign,":var007",1),
(position_set_z,5,105), # var003
(position_rotate_x,5,-90),
(position_rotate_z,5,180),
(position_rotate_y,5,-15), # var005
(position_rotate_x,5,-18), # var006
(position_move_z,5,380,0), # var004
(position_move_x,5,5,0),
(try_begin),
(troop_is_hero,":troop_id_001"),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var007", -1),
(else_try),
(store_mul, ":var008", ":troop_id_001", 126233),
(val_mod, ":var008", 1000),
(val_add, ":var008", 1),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var007", ":var008"),
(try_end),
(cur_tableau_set_camera_position, 5),
(copy_position,8,5),
(position_rotate_x,8,-90),
(position_rotate_z,8,30),
(position_rotate_x,8,-60),
(cur_tableau_add_sun_light, 0, 8, 175, 150, 125),
]),

("add_troop_to_cur_tableau_for_profile", [
(store_script_param, ":troop_id_001", 1),
(set_fixed_point_multiplier, 100),
(cur_tableau_clear_override_items),
(cur_tableau_set_camera_parameters, 1, 4, 6, 10, 10000),
(init_position,5),
(assign,":var006",1),
(position_set_z,5,105), # var002
(position_rotate_x,5,-90),
(position_rotate_z,5,180),
(position_rotate_y,5,-15), # var004
(position_rotate_x,5,-18), # var005
(position_move_z,5,380,0), # var003
(position_move_x,5,5,0),
(profile_get_banner_id, ":var007"),
(try_begin),
(ge,":var007",0),
(init_position,2),
(assign,":var007 +","mesh_banner_a01"),
(position_set_x,2,-175),
(position_set_y,2,-300),
(position_set_z,2,180),
(position_rotate_x,2,90),
(position_rotate_y,2,-15),
(cur_tableau_add_mesh, ":var007", 2, 0, 0),
(try_end),
(init_position,2),
(try_begin),
(troop_is_hero,":troop_id_001"),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var006", -1),
(else_try),
(store_mul, ":var008", ":troop_id_001", 126233),
(val_mod, ":var008", 1000),
(val_add, ":var008", 1),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var006", ":var008"),
(try_end),
(cur_tableau_set_camera_position, 5),
(copy_position,8,5),
(position_rotate_x,8,-90),
(position_rotate_z,8,30),
(position_rotate_x,8,-60),
(cur_tableau_add_sun_light, 0, 8, 175, 150, 125),
]),

("add_troop_to_cur_tableau_for_retirement", [
(store_script_param, ":var001", 1),
(cur_tableau_set_override_flags, 511),
(try_begin),
(eq,":var001",0),
(cur_tableau_add_override_item, "itm_pilgrim_hood"),
(cur_tableau_add_override_item, "itm_pilgrim_disguise"),
(cur_tableau_add_override_item, "itm_wrapping_boots"),
(assign,":var002","anim_pose_1"),
(else_try),
(eq,":var001",1),
(cur_tableau_add_override_item, "itm_pilgrim_hood"),
(cur_tableau_add_override_item, "itm_red_tunic"),
(cur_tableau_add_override_item, "itm_wrapping_boots"),
(cur_tableau_add_override_item, "itm_dagger"),
(assign,":var002","anim_pose_1"),
(else_try),
(eq,":var001",2),
(cur_tableau_add_override_item, "itm_linen_tunic"),
(cur_tableau_add_override_item, "itm_wrapping_boots"),
(assign,":var002","anim_pose_2"),
(else_try),
(eq,":var001",3),
(cur_tableau_add_override_item, "itm_nomad_vest"),
(cur_tableau_add_override_item, "itm_nomad_boots"),
(assign,":var002","anim_pose_2"),
(else_try),
(eq,":var001",4),
(cur_tableau_add_override_item, "itm_leather_apron"),
(cur_tableau_add_override_item, "itm_leather_boots"),
(assign,":var002","anim_pose_3"),
(else_try),
(eq,":var001",5),
(cur_tableau_add_override_item, "itm_red_shirt"),
(cur_tableau_add_override_item, "itm_woolen_hose"),
(cur_tableau_add_override_item, "itm_fur_hat"),
(assign,":var002","anim_pose_3"),
(else_try),
(eq,":var001",6),
(cur_tableau_add_override_item, "itm_red_gambeson"),
(cur_tableau_add_override_item, "itm_leather_boots"),
(cur_tableau_add_override_item, "itm_sword_medieval_c"),
(assign,":var002","anim_pose_4"),
(else_try),
(eq,":var001",7),
(cur_tableau_add_override_item, "itm_nobleman_outfit"),
(cur_tableau_add_override_item, "itm_blue_hose"),
(cur_tableau_add_override_item, "itm_sword_medieval_c"),
(assign,":var002","anim_pose_4"),
(else_try),
(eq,":var001",8),
(cur_tableau_add_override_item, "itm_courtly_outfit"),
(cur_tableau_add_override_item, "itm_woolen_hose"),
(cur_tableau_add_override_item, "itm_sword_medieval_c"),
(assign,":var002","anim_pose_4"),
(else_try),
(cur_tableau_add_override_item, "itm_heraldic_mail_with_surcoat_for_tableau"),
(cur_tableau_add_override_item, "itm_mail_boots_for_tableau"),
(cur_tableau_add_override_item, "itm_sword_medieval_c"),
(assign,":var002","anim_pose_5"),
(try_end),
(set_fixed_point_multiplier, 100),
(cur_tableau_set_camera_parameters, 1, 6, 6, 10, 10000),
(init_position,5),
(position_set_z,5,155), # var003
(position_rotate_x,5,-90),
(position_rotate_z,5,180),
(position_rotate_y,5,-5), # var005
(position_rotate_x,5,10), # var006
(position_move_z,5,575,0), # var004
(position_move_x,5,60,0),
(init_position,2),
(cur_tableau_add_troop, "trp_player", 2, ":var002", 0),
(cur_tableau_set_camera_position, 5),
(copy_position,8,5),
(position_rotate_x,8,-90),
(position_rotate_z,8,30),
(position_rotate_x,8,-60),
(cur_tableau_add_sun_light, 0, 8, 175, 150, 125),
]),

("add_troop_to_cur_tableau_for_party", [
(store_script_param, ":troop_id_001", 1),
(store_mod,":var002",":troop_id_001",2),
(val_div, ":troop_id_001", 2),
(set_fixed_point_multiplier, 100),
(cur_tableau_clear_override_items),
(try_begin),
(eq,":var002",1),
(cur_tableau_set_override_flags, 543),
(try_end),
(init_position,2),
(cur_tableau_set_camera_parameters, 1, 6, 6, 10, 10000),
(init_position,5),
(assign,":var003",105),
(assign,":var004",450),
(assign,":var005",15),
(assign,":var007",1),
(troop_get_inventory_slot,":troop_inv_slot_008",":troop_id_001",8),
(try_begin),
(gt,":troop_inv_slot_008",0),
(eq,":var002",0),
(cur_tableau_add_horse, ":troop_inv_slot_008", 2, "anim_horse_stand"),
(assign,":var007","anim_ride_0"),
(assign,":var005",23),
(assign,":var003",150),
(assign,":var004",550),
(try_end),
(position_set_z,5,":var003"),
(position_rotate_x,5,-90),
(position_rotate_z,5,180),
(position_rotate_y,5,":var005"),
(position_rotate_x,5,-18), # var006
(position_move_z,5,":var004",0),
(position_move_x,5,5,0),
(try_begin),
(troop_is_hero,":troop_id_001"),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var007", -1),
(else_try),
(store_mul, ":var009", ":troop_id_001", 126233),
(val_mod, ":var009", 1000),
(val_add, ":var009", 1),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var007", ":var009"),
(try_end),
(cur_tableau_set_camera_position, 5),
(copy_position,8,5),
(position_rotate_x,8,-90),
(position_rotate_z,8,30),
(position_rotate_x,8,-60),
(cur_tableau_add_sun_light, 0, 8, 175, 150, 125),
]),

("get_prosperity_text_to_s50", [
(store_script_param, ":party_id_001", 1),
(party_get_slot,":party_slot_002",":party_id_001",50),
(val_div, ":party_slot_002", 20),
(try_begin),
(eq,":party_slot_002",0),
(str_store_string,s50,":str_store_string("@Very Poor")"),
(else_try),
(eq,":party_slot_002",1),
(str_store_string,s50,":str_store_string("@Poor")"),
(else_try),
(eq,":party_slot_002",2),
(str_store_string,s50,":str_store_string("@Average")"),
(else_try),
(eq,":party_slot_002",3),
(str_store_string,s50,":str_store_string("@Rich")"),
(else_try),
(str_store_string,s50,":str_store_string("@Very Rich")"),
(try_end),
]),

("spawn_bandits", [
(set_spawn_radius,1),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "@@{!}DEBUG : Doing spawn bandit script"),
(try_end),
(party_template_set_slot,"pt_steppe_bandits",3,"pt_steppe_bandit_lair"),
(party_template_set_slot,"pt_taiga_bandits",3,"pt_taiga_bandit_lair"),
(party_template_set_slot,"pt_mountain_bandits",3,"pt_mountain_bandit_lair"),
(party_template_set_slot,"pt_forest_bandits",3,"pt_forest_bandit_lair"),
(party_template_set_slot,"pt_sea_raiders",3,"pt_sea_raider_lair"),
(party_template_set_slot,"pt_desert_bandits",3,"pt_desert_bandit_lair"),
(party_template_set_slot,"pt_steppe_bandits",5,"p_steppe_bandit_spawn_point"),
(party_template_set_slot,"pt_taiga_bandits",5,"p_taiga_bandit_spawn_point"),
(party_template_set_slot,"pt_mountain_bandits",5,"p_mountain_bandit_spawn_point"),
(party_template_set_slot,"pt_forest_bandits",5,"p_forest_bandit_spawn_point"),
(party_template_set_slot,"pt_sea_raiders",5,"p_sea_raider_spawn_point_1"),
(party_template_set_slot,"pt_desert_bandits",5,"p_desert_bandit_spawn_point"),
(try_begin),
(eq,1,1),
(store_num_parties_of_template,":num_parties_of_template_001","pt_mountain_bandits"),
(try_begin),
(lt,":num_parties_of_template_001",16),
deprecated, 1,
(assign,":random_x_002 +","p_mountain_bandit_spawn_point"),
(set_spawn_radius,25),
(spawn_around_party,":random_x_002","pt_mountain_bandits"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_num_parties_of_template,":num_parties_of_template_001","pt_forest_bandits"),
(try_begin),
(lt,":num_parties_of_template_001",16),
deprecated, 1,
(assign,":random_x_002 +","p_forest_bandit_spawn_point"),
(set_spawn_radius,25),
(spawn_around_party,":random_x_002","pt_forest_bandits"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_num_parties_of_template,":num_parties_of_template_001","pt_sea_raiders"),
(try_begin),
(lt,":num_parties_of_template_001",16),
deprecated, 2,
(assign,":random_x_002 +","p_sea_raider_spawn_point_1"),
(set_spawn_radius,25),
(spawn_around_party,":random_x_002","pt_sea_raiders"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_num_parties_of_template,":num_parties_of_template_001","pt_steppe_bandits"),
(try_begin),
(lt,":num_parties_of_template_001",16),
deprecated, 1,
(assign,":random_x_002 +","p_steppe_bandit_spawn_point"),
(set_spawn_radius,25),
(spawn_around_party,":random_x_002","pt_steppe_bandits"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_num_parties_of_template,":num_parties_of_template_001","pt_taiga_bandits"),
(try_begin),
(lt,":num_parties_of_template_001",16),
deprecated, 1,
(assign,":random_x_002 +","p_taiga_bandit_spawn_point"),
(set_spawn_radius,25),
(spawn_around_party,":random_x_002","pt_taiga_bandits"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_num_parties_of_template,":num_parties_of_template_001","pt_desert_bandits"),
(try_begin),
(lt,":num_parties_of_template_001",16),
deprecated, 1,
(assign,":random_x_002 +","p_desert_bandit_spawn_point"),
(set_spawn_radius,25),
(spawn_around_party,":random_x_002","pt_desert_bandits"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_num_parties_of_template,":num_parties_of_template_001","pt_looters"),
(try_begin),
(lt,":num_parties_of_template_001",42),
(store_random_in_range,":random_x_002","p_village_1","p_salt_mine"),
(set_spawn_radius,25),
(spawn_around_party,":random_x_002","pt_looters"),
(assign,":party_id_003",reg0),
(try_begin),
(check_quest_active,"qst_deal_with_looters"),
(party_set_flags, ":party_id_003", 262144, 1),
(else_try),
(party_set_flags, ":party_id_003", 262144, 0),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_num_parties_of_template,":num_parties_of_template_001","pt_deserters"),
(try_begin),
(lt,":num_parties_of_template_001",15),
(set_spawn_radius,4),
(try_for_range, ":trp_004", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_004",2,2),
(store_random_in_range,":random_x_005",0,100),
(lt,":random_x_005",5),
(troop_get_slot,":troop_slot_006",":trp_004",10),
(store_troop_faction,":troop_faction_007",":trp_004"),
(neq,":troop_faction_007","fac_player_supporters_faction"),
(gt,":troop_slot_006",0),
(neg|party_is_in_any_town,":troop_slot_006"),
(spawn_around_party,":troop_slot_006","pt_deserters"),
(assign,":var008",reg0),
(store_troop_faction,":troop_faction_009",":trp_004"),
(faction_get_slot,":faction_slot_010",":troop_faction_009",41),
(store_character_level,":character_lvl_011","trp_player"),
(store_mul, ":var012", ":character_lvl_011", 2),
(val_add, ":var012", 11),
(store_random_in_range,":random_x_013",10,":var012"),
(party_add_members,":var008",":faction_slot_010",":random_x_013"),
(store_random_in_range,":random_x_005",1,4),
(try_for_range, ":var014", 0, ":random_x_005"),
(party_upgrade_with_xp, ":var008", 1000000, 0),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_for_range, ":pt_015", ":pt.steppe_bandits", ":pt.deserters"),
(party_template_get_slot,":party_template_slot_016",":pt_015",4),
(try_begin),
(le,":party_template_slot_016",1),
(party_template_get_slot,":party_template_slot_017",":pt_015",3),
(party_template_get_slot,":party_template_slot_018",":pt_015",5),
(set_spawn_radius,20),
(spawn_around_party,":party_template_slot_018",":party_template_slot_017"),
(assign,":party_id_019",reg0),
(party_set_slot,":party_id_019",0,18),
(str_store_string,s4,":str_store_party_name(party_id_019)"),
(party_get_position,pos4,":party_id_019"),
(party_get_current_terrain,":party_cur_terrain_020",":party_id_019"),
(position_get_z,":pos_z_021",4),
(position_get_y,":pos_y_022",4),
(assign,":var023",0),
(try_for_range, ":p_024", ":p.town_1", ":p.salt_mine"),
(eq,":var023",0),
(store_distance_to_party_from_party,":distance_parties_025",":party_id_019",":party_id_019"),
(lt,":distance_parties_025",3),
(assign,":var023",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var023",1),
(party_is_active,":party_id_019"),
(remove_party,":party_id_019"),
(party_template_set_slot,":pt_015",4,0),
(else_try),
(eq,":pt_015","pt_sea_raiders"),
(eq,":party_cur_terrain_020",3),
(map_get_water_position_around_position,5,4,4),
(party_template_set_slot,":pt_015",4,":party_id_019"),
(party_set_flags, ":party_id_019", 256, 1),
(else_try),
(eq,":pt_015","pt_mountain_bandits"),
(eq,":party_cur_terrain_020",3),
(gt,":pos_z_021",250),
(party_template_set_slot,":pt_015",4,":party_id_019"),
(party_set_flags, ":party_id_019", 256, 1),
(else_try),
(eq,":pt_015","pt_desert_bandits"),
(eq,":party_cur_terrain_020",5),
(gt,":pos_y_022",-9000),
(gt,":pos_z_021",125),
(party_template_set_slot,":pt_015",4,":party_id_019"),
(party_set_flags, ":party_id_019", 256, 1),
(else_try),
(eq,":pt_015","pt_steppe_bandits"),
(this_or_next|eq,":party_cur_terrain_020",2),
(eq,":party_cur_terrain_020",10),
(this_or_next|eq,":party_cur_terrain_020",10),
(gt,":pos_z_021",200),
(party_template_set_slot,":pt_015",4,":party_id_019"),
(party_set_flags, ":party_id_019", 256, 1),
(else_try),
(eq,":pt_015","pt_taiga_bandits"),
(eq,":party_cur_terrain_020",12),
(party_template_set_slot,":pt_015",4,":party_id_019"),
(party_set_flags, ":party_id_019", 256, 1),
(else_try),
(eq,":pt_015","pt_forest_bandits"),
(eq,":party_cur_terrain_020",11),
(party_template_set_slot,":pt_015",4,":party_id_019"),
(party_set_flags, ":party_id_019", 256, 1),
(else_try),
(party_is_active,":party_id_019"),
(str_store_string,s4,":str_store_party_name(party_id_019)"),
(remove_party,":party_id_019"),
(party_template_set_slot,":pt_015",4,0),
(else_try),
(try_end),
(try_end),
]),

("count_mission_casualties_from_agents", [
(party_clear,"p_player_casualties"),
(party_clear,"p_enemy_casualties"),
(party_clear,"p_ally_casualties"),
(assign,"$any_allies_at_the_last_battle",0),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_party_id,":party_id_002",":cur_agent"),
(agent_get_troop_id,":troop_id_003", ":cur_agent"),
(troop_set_slot,":troop_id_003",146,0),
(troop_set_slot,":troop_id_003",147,0),
(troop_set_slot,":troop_id_003",148,0),
(try_end),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_party_id,":party_id_002",":cur_agent"),
(try_begin),
(neq,":party_id_002","p_main_party"),
(agent_is_ally,":cur_agent"),
(assign,"$any_allies_at_the_last_battle",1),
(try_end),
(try_begin),
(agent_is_routed,":cur_agent"),
(agent_get_slot,":agent_slot_004",":cur_agent",15),
(try_begin),
(eq,":agent_slot_004",1),
(try_begin),
(eq,1,1),
(agent_get_troop_id,":troop_id_005", ":cur_agent"),
(agent_get_party_id,":party_id_006",":cur_agent"),
(store_faction_of_party, ":party_faction_007", ":party_id_006"),
(try_begin),
(eq,":party_id_002","p_main_party"),
(val_add, ":::num_routed_us", 1),
(else_try),
(agent_is_ally,":cur_agent"),
(val_add, ":::num_routed_allies", 1),
(else_try),
(val_add, ":::num_routed_enemies", 1),
(faction_get_slot,":faction_slot_008",":party_faction_007",90),
(val_add, ":faction_slot_008", 1),
(faction_set_slot,":party_faction_007",90,":faction_slot_008"),
(party_add_members,"p_routed_enemies",":troop_id_005",1),
(try_end),
(try_end),
(try_end),
(agent_get_troop_id,":troop_id_003", ":cur_agent"),
(try_begin),
(eq,":party_id_002","p_main_party"),
(troop_get_slot,":troop_slot_009",":troop_id_003",146),
(val_add, ":troop_slot_009", 1),
(troop_set_slot,":troop_id_003",146,":troop_slot_009"),
(else_try),
(agent_is_ally,":cur_agent"),
(troop_get_slot,":troop_slot_010",":troop_id_003",147),
(val_add, ":troop_slot_010", 1),
(troop_set_slot,":troop_id_003",147,":troop_slot_010"),
(else_try),
(troop_get_slot,":troop_slot_011",":troop_id_003",148),
(val_add, ":troop_slot_011", 1),
(troop_set_slot,":troop_id_003",148,":troop_slot_011"),
(try_end),
(try_end),
(neg|agent_is_alive,":cur_agent"),
(agent_get_troop_id,":troop_id_003", ":cur_agent"),
(try_begin),
(eq,":party_id_002","p_main_party"),
(party_add_members,"p_player_casualties",":troop_id_003",1),
(agent_is_wounded,":cur_agent"),
(party_wound_members,"p_player_casualties",":troop_id_003",1),
(try_end),
(else_try),
(agent_is_ally,":cur_agent"),
(party_add_members,"p_ally_casualties",":troop_id_003",1),
(try_begin),
(agent_is_wounded,":cur_agent"),
(party_wound_members,"p_ally_casualties",":troop_id_003",1),
(try_end),
(else_try),
(party_add_members,"p_enemy_casualties",":troop_id_003",1),
(try_begin),
(agent_is_wounded,":cur_agent"),
(party_wound_members,"p_enemy_casualties",":troop_id_003",1),
(try_end),
(try_end),
]),

("get_max_skill_of_player_party", [
(store_script_param, ":skill_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002","p_main_party"),
(store_skill_level,":skill_lvl_003",":skill_001","trp_player"),
(assign,":var004","trp_player"),
(try_for_range, ":stack_no_005", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_006","p_main_party",":stack_no_005"),
(try_begin),
(troop_is_hero,":troop_id_006"),
(neg|troop_is_wounded,":troop_id_006"),
(store_skill_level,":skill_lvl_007",":skill_001",":troop_id_006"),
(gt,":skill_lvl_007",":skill_lvl_003"),
(assign,":skill_lvl_003",":skill_lvl_007"),
(assign,":var004",":troop_id_006"),
(try_end),
(try_end),
(party_get_skill_level, reg0, "p_main_party", ":skill_001"),
(assign,reg1,":var004"),
]),

("upgrade_hero_party", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(party_upgrade_with_xp, ":var001", ":var002", 0),
]),

("get_improvement_details", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,":var001",130),
(str_store_string,s0,":str_store_string("@Manor")"),
(str_store_string,s1,":str_store_string()"),
(assign,reg0,8000),
(else_try),
(eq,":var001",131),
(str_store_string,s0,":str_store_string("@Mill")"),
(str_store_string,s1,":str_store_string()"),
(assign,reg0,6000),
(else_try),
(eq,":var001",132),
(str_store_string,s0,":str_store_string("@Watch Tower")"),
(str_store_string,s1,":str_store_string()"),
(assign,reg0,5000),
(else_try),
(eq,":var001",133),
(str_store_string,s0,":str_store_string("@School")"),
(str_store_string,s1,":str_store_string()"),
(assign,reg0,9000),
(else_try),
(eq,":var001",134),
(str_store_string,s0,":str_store_string("@Messenger Post")"),
(str_store_string,s1,":str_store_string()"),
(assign,reg0,4000),
(else_try),
(eq,":var001",135),
(str_store_string,s0,":str_store_string("@Prison Tower")"),
(str_store_string,s1,":str_store_string()"),
(assign,reg0,7000),
(try_end),
]),

("cf_troop_agent_is_alive", [
(store_script_param, ":var001", 1),
(try_for_agents, ":cur_agent"),
(agent_get_troop_id,":troop_id_004", ":cur_agent"),
(try_begin),
(eq,":var001",":troop_id_004"),
(agent_is_alive,":cur_agent"),
(val_add, 0, 1), # var002
(try_end),
(try_end),
]),

("cf_village_recruit_volunteers_cond", [
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_checking_volunteer_availability_script"),
(try_end),
(try_begin),
(neg|party_slot_eq,"$current_town",35,2),
(neg|party_slot_eq,"$current_town",35,1),
(neg|party_slot_ge,"$current_town",39,1),
(store_faction_of_party, ":party_faction_001", "$current_town"),
(party_get_slot,":party_slot_002","$current_town",26),
(store_relation,":faction_relation_003",":party_faction_001","fac_player_faction"),
(try_begin),
(ge,":party_slot_002",0),
(eq,":::cheat_mode",1),
(display_message, "str_center_relation_at_least_zero"),
(try_end),
(try_end),
(try_begin),
(this_or_next|ge,":party_slot_002",5),
(this_or_next|eq,":party_faction_001",":::players_kingdom"),
(this_or_next|ge,":faction_relation_003",0),
(this_or_next|eq,":party_faction_001",":::supported_pretender_old_faction"),
(eq,":::players_kingdom",0),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_relationfaction_conditions_met"),
(try_end),
(try_end),
(try_begin),
(party_slot_ge,"$current_town",93,0),
(party_slot_ge,"$current_town",92,1),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_troops_available"),
(try_end),
(try_end),
(party_get_free_companions_capacity,":party_free_companions_capacity_004","p_main_party"),
(try_begin),
(ge,":party_free_companions_capacity_004",1),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_party_has_capacity"),
(try_end),
(try_end),
]),

("village_recruit_volunteers_recruit", [
(party_get_slot,":party_slot_001","$current_town",92),
(party_get_slot,":party_slot_002","$current_town",93),
(party_get_free_companions_capacity,":party_free_companions_capacity_003","p_main_party"),
(val_min,":party_slot_002",":party_free_companions_capacity_003"),
(store_troop_gold,":troop_gold_004","trp_player"),
(store_div, ":var___x1", ":troop_gold_004", 10),
(assign,":var005",":var___x1"),
(val_min,":party_slot_002",":var005"),
(party_add_members,"p_main_party",":party_slot_001",":party_slot_002"),
(party_set_slot,"$current_town",93,-1),
(store_mul, ":gold_006", ":party_slot_002", 10),
(troop_remove_gold,"trp_player",":gold_006"),
]),

("get_troop_item_amount", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(troop_get_inventory_capacity,":troop_inv_capacity_003",":troop_id_001"),
(assign,":var004",0),
(try_for_range, ":inventory_slot_no_005", 0, ":troop_inv_capacity_003"),
(troop_get_inventory_slot,":troop_inv_slot_006",":troop_id_001",":inventory_slot_no_005"),
(try_begin),
(eq,":troop_inv_slot_006",":var002"),
(val_add, ":var004", 1),
(try_end),
(try_end),
(assign,reg0,":var004"),
]),

("get_name_from_dna_to_s50", [
(store_script_param, ":var001", 1),
(assign,":var002","str_surname_1"),
(assign,":var002 -","str_name_1"),
(assign,":var003","str_surnames_end"),
(assign,":var003 -","str_surname_1"),
(assign,":var004",":var001"),
(val_mod, ":var004", ":var002"),
(assign,":var005",":var001"),
(val_div, ":var005", ":var002"),
(val_mod, ":var005", ":var003"),
(assign,":var004 +","str_name_1"),
(assign,":var005 +","str_surname_1"),
(str_store_string,s50,":str_store_string(var004)"),
(str_store_string,s50,":str_store_string(var005)"),
]),

("change_center_prosperity", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_get_slot,":party_slot_003",":party_id_001",50),
(store_add, ":var004", ":party_slot_003", ":var002"),
(val_clamp,":var004",0, 100),
(store_div, ":var___x1", ":party_slot_003", 20),
(assign,":var005",":var___x1"),
(store_div, ":var___x1", ":var004", 20),
(assign,":var006",":var___x1"),
(try_begin),
(neq,":var005",":var006"),
(neg|is_between,":party_id_001","p_castle_1","p_village_1"),
(str_store_string,s2,":str_store_party_name_link(party_id_001)"),
(call_script, "script_get_prosperity_text_to_s50", ":party_id_001"),
(str_store_string,s3,":str_store_string(50)"),
(party_set_slot,":party_id_001",50,":var004"),
(call_script, "script_get_prosperity_text_to_s50", ":party_id_001"),
(str_store_string,s4,":str_store_string(50)"),
(try_begin),
(party_slot_eq,":party_id_001",7,"trp_player"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(call_script, "script_update_center_notes", ":party_id_001"),
(else_try),
(party_set_slot,":party_id_001",50,":var004"),
(try_end),
(try_begin),
(eq,1,1),
(store_current_hours,":cur_hours_007"),
(try_begin),
(gt,":cur_hours_007",1),
(store_sub, ":var008", ":var004", ":party_slot_003"),
(try_begin),
(lt,":var008",0),
(val_add, ":::newglob_total_prosperity_losses", ":var008"),
(else_try),
(gt,":var008",0),
(val_add, ":::newglob_total_prosperity_gains", ":var008"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":::cheat_mode",3),
(assign,reg4,"$newglob_total_prosperity_from_bandits"),
(assign,reg5,"$newglob_total_prosperity_from_caravan_trade"),
(assign,reg7,"$newglob_total_prosperity_from_villageloot"),
(assign,reg8,"$newglob_total_prosperity_from_townloot"),
(assign,reg9,"$newglob_total_prosperity_from_village_trade"),
(assign,reg10,"$newglob_total_prosperity_from_convergence"),
(assign,reg11,"$newglob_total_prosperity_losses"),
(assign,reg12,"$newglob_total_prosperity_gains"),
(display_message, "@@{!}DEBUG: Total prosperity actual losses: {reg11}"),
(display_message, "@@{!}DEBUG: Total prosperity actual gains: {reg12}"),
(display_message, "@@{!}DEBUG: Prosperity changes from random bandits: {reg4}"),
(display_message, "@@{!}DEBUG: Prosperity changes from caravan trades: {reg5}"),
(display_message, "@@{!}DEBUG: Prosperity changes from farmer trades: {reg9}"),
(display_message, "@@{!}DEBUG: Prosperity changes from looted villages: {reg7}"),
(display_message, "@@{!}DEBUG: Prosperity changes from sieges: {reg8}"),
(display_message, "@@{!}DEBUG: Theoretical prosperity changes from convergence: {reg10}"),
(try_end),
]),

("get_center_ideal_prosperity", [
(store_script_param, ":var001", 1),
(assign,":var002",65),
(call_script, "script_center_get_goods_availability", ":var001"),
(store_mul, ":var003", reg0, 2),
(val_sub, ":var002", ":var003"),
(try_begin),
(is_between,":var001","p_village_1","p_salt_mine"),
(party_slot_eq,":var001",131,1),
(val_add, ":var002", 5),
(try_end),
(val_max,":var002",0),
(assign,reg0,":var002"),
]),

("good_price_affects_good_production", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(store_script_param, ":var004", 4),
(assign,reg4,":var003"),
(try_begin),
(gt,":var003",0),
(store_sub, ":slot_no_005", ":var002", ":itm.spice"),
(val_add, ":slot_no_005", 250),
(party_get_slot,":party_slot_006",":party_id_001",":slot_no_005"),
(try_begin),
(is_between,":party_id_001","p_town_1","p_castle_1"),
(val_mul, ":party_slot_006", 4),
(assign,":var007",4),
(try_for_range, ":p_008", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_008",120,":party_id_001"),
(party_get_slot,":party_slot_009",":p_008",":slot_no_005"),
(val_add, ":party_slot_006", ":party_slot_009"),
(val_add, ":var007", 1),
(try_end),
(val_div, ":party_slot_006", ":var007"),
(try_end),
(try_begin),
(lt,":party_slot_006",1000),
(val_mul, ":var004", 2),
(try_end),
(try_begin),
(gt,":var004",1),
(val_sub, ":party_slot_006", 1000),
(val_div, ":party_slot_006", ":var004"),
(val_add, ":party_slot_006", 1000),
(try_end),
(val_mul, ":var003", 1000),
(val_div, ":var003", ":party_slot_006"),
(try_end),
(assign,reg0,":var003"),
]),

("get_poorest_village_of_faction", [
(store_script_param, ":var001", 1),
(assign,":var002",-1),
(assign,":var003",101),
(try_for_range, ":p_004", ":p.village_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_005", ":p_004"),
(try_begin),
(eq,":party_faction_005",":var001"),
(party_get_slot,":party_slot_006",":p_004",50),
(lt,":party_slot_006",":var003"),
(assign,":var003",":party_slot_006"),
(assign,":var002",":p_004"),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("troop_add_gold", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":gold_002", 2),
(call_script, "script_troop_add_gold", ":troop_id_001", ":gold_002"),
(try_begin),
(eq,":troop_id_001","trp_player"),
(play_sound,"snd_money_received"),
(try_end),
]),

("initialize_npcs", [
(troop_set_slot,"trp_npc1",62,2),
(troop_set_slot,"trp_npc1",63,4),
(troop_set_slot,"trp_npc1",64,1),
(troop_set_slot,"trp_npc1",66,-1),
(troop_set_slot,"trp_npc1",71,"trp_npc7"),
(troop_set_slot,"trp_npc1",73,"trp_npc16"),
(troop_set_slot,"trp_npc1",75,"trp_npc2"),
(troop_set_slot,"trp_npc1",60,"p_village_25"),
(troop_set_slot,"trp_npc1",141,300),
(troop_set_slot,"trp_npc1",143,2),
(troop_set_slot,"trp_npc1",144,"trp_npc14"),
(troop_set_slot,"trp_npc1",67,"p_town_17"),
(troop_set_slot,"trp_npc1",14,0),
(troop_set_slot,"trp_npc1",52,8),
(troop_set_slot,"trp_npc2",62,3),
(troop_set_slot,"trp_npc2",63,2),
(troop_set_slot,"trp_npc2",64,4),
(troop_set_slot,"trp_npc2",66,1),
(troop_set_slot,"trp_npc2",71,"trp_npc5"),
(troop_set_slot,"trp_npc2",73,"trp_npc9"),
(troop_set_slot,"trp_npc2",75,"trp_npc1"),
(troop_set_slot,"trp_npc2",60,"p_town_1"),
(troop_set_slot,"trp_npc2",141,0),
(troop_set_slot,"trp_npc2",143,4),
(troop_set_slot,"trp_npc2",144,"trp_npc16"),
(troop_set_slot,"trp_npc2",67,"p_town_1"),
(troop_set_slot,"trp_npc2",14,0),
(troop_set_slot,"trp_npc2",52,10),
(troop_set_slot,"trp_npc3",62,3),
(troop_set_slot,"trp_npc3",63,4),
(troop_set_slot,"trp_npc3",64,1),
(troop_set_slot,"trp_npc3",66,-1),
(troop_set_slot,"trp_npc3",71,"trp_npc14"),
(troop_set_slot,"trp_npc3",73,"trp_npc8"),
(troop_set_slot,"trp_npc3",75,"trp_npc9"),
(troop_set_slot,"trp_npc3",60,"p_town_3"),
(troop_set_slot,"trp_npc3",141,0),
(troop_set_slot,"trp_npc3",143,5),
(troop_set_slot,"trp_npc3",144,"trp_npc5"),
(troop_set_slot,"trp_npc3",67,"p_town_15"),
(troop_set_slot,"trp_npc3",14,0),
(troop_set_slot,"trp_npc3",52,9),
(troop_set_slot,"trp_npc4",62,1),
(troop_set_slot,"trp_npc4",63,4),
(troop_set_slot,"trp_npc4",64,4),
(troop_set_slot,"trp_npc4",66,-1),
(troop_set_slot,"trp_npc4",71,"trp_npc10"),
(troop_set_slot,"trp_npc4",73,"trp_npc7"),
(troop_set_slot,"trp_npc4",75,"trp_npc5"),
(troop_set_slot,"trp_npc4",60,"p_village_34"),
(troop_set_slot,"trp_npc4",141,300),
(troop_set_slot,"trp_npc4",143,1),
(troop_set_slot,"trp_npc4",144,"trp_npc6"),
(troop_set_slot,"trp_npc4",67,"p_town_3"),
(troop_set_slot,"trp_npc4",14,0),
(troop_set_slot,"trp_npc4",52,4),
(troop_set_slot,"trp_npc5",62,2),
(troop_set_slot,"trp_npc5",63,3),
(troop_set_slot,"trp_npc5",64,-1),
(troop_set_slot,"trp_npc5",66,0),
(troop_set_slot,"trp_npc5",71,"trp_npc2"),
(troop_set_slot,"trp_npc5",73,"trp_npc11"),
(troop_set_slot,"trp_npc5",75,"trp_npc4"),
(troop_set_slot,"trp_npc5",60,"p_town_14"),
(troop_set_slot,"trp_npc5",141,400),
(troop_set_slot,"trp_npc5",143,2),
(troop_set_slot,"trp_npc5",144,"trp_npc9"),
(troop_set_slot,"trp_npc5",67,"p_town_10"),
(troop_set_slot,"trp_npc5",14,"fac_kingdom_3"),
(troop_set_slot,"trp_npc5",52,4),
(troop_set_slot,"trp_npc6",62,3),
(troop_set_slot,"trp_npc6",63,2),
(troop_set_slot,"trp_npc6",64,4),
(troop_set_slot,"trp_npc6",66,1),
(troop_set_slot,"trp_npc6",71,"trp_npc11"),
(troop_set_slot,"trp_npc6",73,"trp_npc13"),
(troop_set_slot,"trp_npc6",75,"trp_npc12"),
(troop_set_slot,"trp_npc6",60,"p_town_4"),
(troop_set_slot,"trp_npc6",141,0),
(troop_set_slot,"trp_npc6",143,4),
(troop_set_slot,"trp_npc6",144,"trp_npc8"),
(troop_set_slot,"trp_npc6",67,"p_town_7"),
(troop_set_slot,"trp_npc6",14,"fac_kingdom_1"),
(troop_set_slot,"trp_npc6",52,7),
(troop_set_slot,"trp_npc7",62,2),
(troop_set_slot,"trp_npc7",63,3),
(troop_set_slot,"trp_npc7",64,-1),
(troop_set_slot,"trp_npc7",66,0),
(troop_set_slot,"trp_npc7",71,"trp_npc1"),
(troop_set_slot,"trp_npc7",73,"trp_npc4"),
(troop_set_slot,"trp_npc7",75,"trp_npc16"),
(troop_set_slot,"trp_npc7",60,"p_village_5"),
(troop_set_slot,"trp_npc7",143,4),
(troop_set_slot,"trp_npc7",144,"trp_npc3"),
(troop_set_slot,"trp_npc7",67,"p_town_2"),
(troop_set_slot,"trp_npc7",14,0),
(troop_set_slot,"trp_npc7",52,10),
(troop_set_slot,"trp_npc8",62,1),
(troop_set_slot,"trp_npc8",63,3),
(troop_set_slot,"trp_npc8",64,-1),
(troop_set_slot,"trp_npc8",66,0),
(troop_set_slot,"trp_npc8",71,"trp_npc12"),
(troop_set_slot,"trp_npc8",73,"trp_npc3"),
(troop_set_slot,"trp_npc8",75,"trp_npc13"),
(troop_set_slot,"trp_npc8",60,"p_sea_raider_spawn_point_2"),
(troop_set_slot,"trp_npc8",141,500),
(troop_set_slot,"trp_npc8",143,5),
(troop_set_slot,"trp_npc8",144,"trp_npc2"),
(troop_set_slot,"trp_npc8",67,"p_town_12"),
(troop_set_slot,"trp_npc8",14,"fac_kingdom_4"),
(troop_set_slot,"trp_npc8",52,1),
(troop_set_slot,"trp_npc9",62,1),
(troop_set_slot,"trp_npc9",63,2),
(troop_set_slot,"trp_npc9",64,4),
(troop_set_slot,"trp_npc9",66,1),
(troop_set_slot,"trp_npc9",71,"trp_npc13"),
(troop_set_slot,"trp_npc9",73,"trp_npc2"),
(troop_set_slot,"trp_npc9",75,"trp_npc3"),
(troop_set_slot,"trp_npc9",60,"p_town_13"),
(troop_set_slot,"trp_npc9",141,300),
(troop_set_slot,"trp_npc9",143,5),
(troop_set_slot,"trp_npc9",144,"trp_npc1"),
(troop_set_slot,"trp_npc9",67,"p_town_8"),
(troop_set_slot,"trp_npc9",14,"fac_kingdom_2"),
(troop_set_slot,"trp_npc9",52,1),
(troop_set_slot,"trp_npc10",62,3),
(troop_set_slot,"trp_npc10",63,2),
(troop_set_slot,"trp_npc10",64,2),
(troop_set_slot,"trp_npc10",66,1),
(troop_set_slot,"trp_npc10",71,"trp_npc4"),
(troop_set_slot,"trp_npc10",73,"trp_npc14"),
(troop_set_slot,"trp_npc10",75,"trp_npc11"),
(troop_set_slot,"trp_npc10",60,"p_castle_28"),
(troop_set_slot,"trp_npc10",141,200),
(troop_set_slot,"trp_npc10",143,2),
(troop_set_slot,"trp_npc10",144,"trp_npc7"),
(troop_set_slot,"trp_npc10",67,"p_town_5"),
(troop_set_slot,"trp_npc10",14,"fac_kingdom_5"),
(troop_set_slot,"trp_npc10",52,9),
(troop_set_slot,"trp_npc11",62,2),
(troop_set_slot,"trp_npc11",63,3),
(troop_set_slot,"trp_npc11",64,-1),
(troop_set_slot,"trp_npc11",66,0),
(troop_set_slot,"trp_npc11",71,"trp_npc6"),
(troop_set_slot,"trp_npc11",73,"trp_npc5"),
(troop_set_slot,"trp_npc11",75,"trp_npc10"),
(troop_set_slot,"trp_npc11",60,"p_town_6"),
(troop_set_slot,"trp_npc11",141,100),
(troop_set_slot,"trp_npc11",143,1),
(troop_set_slot,"trp_npc11",144,"trp_npc15"),
(troop_set_slot,"trp_npc11",67,"p_town_6"),
(troop_set_slot,"trp_npc11",14,0),
(troop_set_slot,"trp_npc11",52,10),
(troop_set_slot,"trp_npc12",62,3),
(troop_set_slot,"trp_npc12",63,3),
(troop_set_slot,"trp_npc12",64,-1),
(troop_set_slot,"trp_npc12",66,0),
(troop_set_slot,"trp_npc12",71,"trp_npc8"),
(troop_set_slot,"trp_npc12",73,"trp_npc15"),
(troop_set_slot,"trp_npc12",75,"trp_npc6"),
(troop_set_slot,"trp_npc12",60,"p_castle_16"),
(troop_set_slot,"trp_npc12",141,0),
(troop_set_slot,"trp_npc12",143,1),
(troop_set_slot,"trp_npc12",144,"trp_npc13"),
(troop_set_slot,"trp_npc12",67,"p_town_14"),
(troop_set_slot,"trp_npc12",14,0),
(troop_set_slot,"trp_npc12",52,9),
(troop_set_slot,"trp_npc13",62,1),
(troop_set_slot,"trp_npc13",63,3),
(troop_set_slot,"trp_npc13",64,-1),
(troop_set_slot,"trp_npc13",66,0),
(troop_set_slot,"trp_npc13",71,"trp_npc9"),
(troop_set_slot,"trp_npc13",73,"trp_npc6"),
(troop_set_slot,"trp_npc13",75,"trp_npc8"),
(troop_set_slot,"trp_npc13",60,"p_castle_15"),
(troop_set_slot,"trp_npc13",141,300),
(troop_set_slot,"trp_npc13",143,1),
(troop_set_slot,"trp_npc13",144,"trp_npc10"),
(troop_set_slot,"trp_npc13",67,"p_town_4"),
(troop_set_slot,"trp_npc13",14,0),
(troop_set_slot,"trp_npc13",52,8),
(troop_set_slot,"trp_npc14",62,1),
(troop_set_slot,"trp_npc14",63,4),
(troop_set_slot,"trp_npc14",64,2),
(troop_set_slot,"trp_npc14",66,-1),
(troop_set_slot,"trp_npc14",71,"trp_npc3"),
(troop_set_slot,"trp_npc14",73,"trp_npc10"),
(troop_set_slot,"trp_npc14",75,"trp_npc15"),
(troop_set_slot,"trp_npc14",60,"p_castle_18"),
(troop_set_slot,"trp_npc14",141,400),
(troop_set_slot,"trp_npc14",143,4),
(troop_set_slot,"trp_npc14",144,"trp_npc11"),
(troop_set_slot,"trp_npc14",67,"p_town_16"),
(troop_set_slot,"trp_npc14",14,0),
(troop_set_slot,"trp_npc14",52,3),
(troop_set_slot,"trp_npc15",62,2),
(troop_set_slot,"trp_npc15",63,2),
(troop_set_slot,"trp_npc15",64,4),
(troop_set_slot,"trp_npc15",66,1),
(troop_set_slot,"trp_npc15",71,"trp_npc16"),
(troop_set_slot,"trp_npc15",73,"trp_npc12"),
(troop_set_slot,"trp_npc15",75,"trp_npc14"),
(troop_set_slot,"trp_npc15",60,"p_castle_1"),
(troop_set_slot,"trp_npc15",141,300),
(troop_set_slot,"trp_npc15",143,2),
(troop_set_slot,"trp_npc15",144,"trp_npc4"),
(troop_set_slot,"trp_npc15",67,"p_town_18"),
(troop_set_slot,"trp_npc15",52,10),
(troop_set_slot,"trp_npc16",62,1),
(troop_set_slot,"trp_npc16",63,4),
(troop_set_slot,"trp_npc16",64,3),
(troop_set_slot,"trp_npc16",66,-1),
(troop_set_slot,"trp_npc16",71,"trp_npc15"),
(troop_set_slot,"trp_npc16",73,"trp_npc1"),
(troop_set_slot,"trp_npc16",75,"trp_npc7"),
(troop_set_slot,"trp_npc16",60,"p_village_20"),
(troop_set_slot,"trp_npc16",141,200),
(troop_set_slot,"trp_npc16",143,5),
(troop_set_slot,"trp_npc16",144,"trp_npc12"),
(troop_set_slot,"trp_npc16",67,"p_town_9"),
(troop_set_slot,"trp_npc16",52,8),
(store_sub, "$number_of_npc_slots", 141, 101),
(try_for_range, ":trp_001", ":trp.npc1", ":trp.kingdom_1_lord"),
(try_for_range, ":var002", 0, ":::number_of_npc_slots"),
(store_add, ":slot_no_003", ":var002", 101),
(store_mul, ":var004", ":var002", 16),
(assign,":var005","str_npc1_intro"),
(val_add, ":var005", ":var004"),
(val_add, ":var005", ":trp_001"),
(assign,":var005 -","trp_npc1"),
(troop_set_slot,":trp_001",":slot_no_003",":var005"),
(try_end),
(try_end),
(call_script, "script_add_log_entry", 45, "trp_player", -1, -1, -1),
(troop_set_slot,"trp_kingdom_1_pretender",14,"fac_kingdom_1"),
(troop_set_slot,"trp_kingdom_2_pretender",14,"fac_kingdom_2"),
(troop_set_slot,"trp_kingdom_3_pretender",14,"fac_kingdom_3"),
(troop_set_slot,"trp_kingdom_4_pretender",14,"fac_kingdom_4"),
(troop_set_slot,"trp_kingdom_5_pretender",14,"fac_kingdom_5"),
(troop_set_slot,"trp_kingdom_6_pretender",14,"fac_kingdom_6"),
(try_for_range, ":trp_006", ":trp.kingdom_1_pretender", ":trp.knight_1_1_wife"),
(troop_set_slot,":trp_006",52,0),
(try_end),
]),

("objectionable_action", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",-2),
(try_for_range, ":trp_004", ":trp.npc1", ":trp.kingdom_1_lord"),
(main_party_has_troop,":trp_004"),
(try_begin),
(troop_slot_eq,":trp_004",62,":var001"),
(troop_get_slot,":troop_slot_005",":trp_004",63),
(try_begin),
(troop_slot_eq,":trp_004",61,1),
(troop_get_slot,":troop_slot_006",":trp_004",69),
(val_mul, ":troop_slot_005", 2),
(val_add, ":troop_slot_006", ":troop_slot_005"),
(troop_set_slot,":trp_004",69,":troop_slot_006"),
(else_try),
(this_or_next|troop_slot_eq,":trp_004",61,2),
(eq,":::disable_npc_complaints",1),
(troop_get_slot,":troop_slot_006",":trp_004",69),
(val_add, ":troop_slot_006", ":troop_slot_005"),
(troop_set_slot,":trp_004",69,":troop_slot_006"),
(else_try),
(troop_slot_eq,":trp_004",61,0),
(gt,":troop_slot_005",":var003"),
(assign,"$npc_with_grievance",":trp_004"),
(assign,"$npc_grievance_string",":var002"),
(assign,"$npc_grievance_slot",61),
(assign,":var003",":troop_slot_005"),
(assign,"$npc_praise_not_complaint",0),
(try_begin),
(lt,":troop_slot_005",0),
(assign,"$npc_praise_not_complaint",1),
(try_end),
(try_end),
(try_end),
(else_try),
(troop_slot_eq,":trp_004",64,":var001"),
(troop_get_slot,":troop_slot_005",":trp_004",66),
(try_begin),
(troop_slot_eq,":trp_004",65,1),
(troop_get_slot,":troop_slot_006",":trp_004",69),
(val_mul, ":troop_slot_005", 2),
(val_add, ":troop_slot_006", ":troop_slot_005"),
(troop_set_slot,":trp_004",69,":troop_slot_006"),
(else_try),
(this_or_next|troop_slot_eq,":trp_004",65,2),
(eq,":::disable_npc_complaints",1),
(troop_get_slot,":troop_slot_006",":trp_004",69),
(val_add, ":troop_slot_006", ":troop_slot_005"),
(troop_set_slot,":trp_004",69,":troop_slot_006"),
(else_try),
(troop_slot_eq,":trp_004",65,0),
(gt,":troop_slot_005",":var003"),
(assign,"$npc_with_grievance",":trp_004"),
(assign,"$npc_grievance_string",":var002"),
(assign,"$npc_grievance_slot",65),
(assign,":var003",":troop_slot_005"),
(assign,"$npc_praise_not_complaint",0),
(try_begin),
(lt,":troop_slot_005",0),
(assign,"$npc_praise_not_complaint",1),
(try_end),
(try_end),
(try_begin),
(gt,":::npc_with_grievance",0),
(neg|eq,":::npc_praise_not_complaint",0),
(str_store_string,s4,":str_store_troop_name(_npc_with_grievance)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
(try_end),
]),

("post_battle_personality_clash_check", [
(try_for_range, ":trp_001", ":trp.npc1", ":trp.kingdom_1_lord"),
(eq,":::disable_npc_complaints",0),
(main_party_has_troop,":trp_001"),
(neg|troop_is_wounded,":trp_001"),
(troop_get_slot,":troop_slot_002",":trp_001",73),
(main_party_has_troop,":troop_slot_002"),
(neg|troop_is_wounded,":troop_slot_002"),
(troop_slot_eq,":trp_001",74,0),
(eq,1,1),
(assign,"$npc_with_personality_clash_2",":trp_001"),
(try_end),
(try_end),
(try_for_range, ":trp_001", ":trp.npc1", ":trp.kingdom_1_lord"),
(troop_slot_eq,":trp_001",76,0),
(eq,":::disable_npc_complaints",0),
(main_party_has_troop,":trp_001"),
(neg|troop_is_wounded,":trp_001"),
(troop_get_slot,":troop_slot_002",":trp_001",75),
(main_party_has_troop,":troop_slot_002"),
(neg|troop_is_wounded,":troop_slot_002"),
(assign,"$npc_with_personality_match",":trp_001"),
(try_end),
(try_end),
(try_begin),
(gt,":::npc_with_personality_clash_2",0),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_personality_clash_conversation_begins"),
(try_end),
(try_begin),
(main_party_has_troop,"$npc_with_personality_clash_2"),
(assign,"$npc_map_talk_context",74),
(start_map_conversation,"$npc_with_personality_clash_2"),
(else_try),
(assign,"$npc_with_personality_clash_2",0),
(try_end),
(else_try),
(gt,":::npc_with_personality_match",0),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_personality_match_conversation_begins"),
(try_end),
(try_begin),
(main_party_has_troop,"$npc_with_personality_match"),
(assign,"$npc_map_talk_context",76),
(start_map_conversation,"$npc_with_personality_match"),
(else_try),
(assign,"$npc_with_personality_match",0),
(try_end),
(try_end),
]),

("event_player_defeated_enemy_party", [
(try_begin),
(check_quest_active,"qst_raid_caravan_to_start_war"),
(neg|check_quest_concluded,"qst_raid_caravan_to_start_war"),
(party_slot_eq,"$g_enemy_party",0,11),
(store_faction_of_party, ":party_faction_001", "$g_enemy_party"),
(try_begin),
(quest_slot_eq,"qst_raid_caravan_to_start_war",3,":party_faction_001"),
(quest_get_slot,":quest_slot_002","qst_raid_caravan_to_start_war",11),
(quest_get_slot,":quest_slot_003","qst_raid_caravan_to_start_war",10),
(val_add, ":quest_slot_002", 1),
(quest_set_slot,"qst_raid_caravan_to_start_war",11,":quest_slot_002"),
(ge,":quest_slot_002",":quest_slot_003"),
(quest_get_slot,":quest_slot_004","qst_raid_caravan_to_start_war",3),
(quest_get_slot,":quest_slot_005","qst_raid_caravan_to_start_war",6),
(store_troop_faction,":troop_faction_006",":quest_slot_005"),
(call_script, "script_diplomacy_start_war_between_kingdoms", ":quest_slot_004", ":troop_faction_006", 1),
(call_script, "script_succeed_quest", "qst_raid_caravan_to_start_war"),
(try_end),
(try_end),
]),

("event_player_captured_as_prisoner", [
(try_begin),
(check_quest_active,"qst_raid_caravan_to_start_war"),
(neg|check_quest_concluded,"qst_raid_caravan_to_start_war"),
(quest_get_slot,":quest_slot_001","qst_raid_caravan_to_start_war",3),
(store_faction_of_party, ":party_faction_002", "$capturer_party"),
(try_begin),
(eq,":quest_slot_001",":party_faction_002"),
(call_script, "script_fail_quest", "qst_raid_caravan_to_start_war"),
(try_end),
(try_end),
(try_for_range, ":trp_003", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_003",2,2),
(troop_get_slot,":troop_slot_004",":trp_003",10),
(gt,":troop_slot_004",0),
(party_is_active,":troop_slot_004"),
(party_slot_eq,":troop_slot_004",4,11),
(party_slot_eq,":troop_slot_004",5,"p_main_party"),
(call_script, "script_party_set_ai_state", ":troop_slot_004", -1, -1),
(assign,"$g_recalculate_ais",1),
(try_end),
(try_end),
]),

("npc_morale", [
(store_script_param, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_002",":troop_id_001",69),
(troop_get_slot,":troop_slot_003",":troop_id_001",77),
(party_get_morale, ":party_morale_004","p_main_party"),
(store_sub, ":var005", ":party_morale_004", ":troop_slot_002"),
(val_sub, ":var005", ":troop_slot_003"),
(val_add, ":var005", 50),
(assign,reg8,":var005"),
(val_mul, ":var005", 3),
(val_div, ":var005", 4),
(val_clamp,":var005",0, 100),
(assign,reg5,":party_morale_004"),
(assign,reg6,":troop_slot_002"),
(assign,reg7,":troop_slot_003"),
(assign,reg9,":var005"),
(try_begin),
(lt,":troop_slot_002",3),
(str_store_string,s7,":str_store_string("str_happy")"),
(else_try),
(lt,":troop_slot_002",15),
(str_store_string,s7,":str_store_string("str_content")"),
(else_try),
(lt,":troop_slot_002",30),
(str_store_string,s7,":str_store_string("str_concerned")"),
(else_try),
(lt,":troop_slot_002",45),
(str_store_string,s7,":str_store_string("str_not_happy")"),
(else_try),
(str_store_string,s7,":str_store_string("str_miserable")"),
(try_end),
(try_begin),
(lt,":troop_slot_003",3),
(str_store_string,s6,":str_store_string("str_happy")"),
(else_try),
(lt,":troop_slot_003",15),
(str_store_string,s6,":str_store_string("str_content")"),
(else_try),
(lt,":troop_slot_003",30),
(str_store_string,s6,":str_store_string("str_concerned")"),
(else_try),
(lt,":troop_slot_003",45),
(str_store_string,s6,":str_store_string("str_not_happy")"),
(else_try),
(str_store_string,s6,":str_store_string("str_miserable")"),
(try_end),
(try_begin),
(gt,":var005",80),
(str_store_string,s8,":str_store_string("str_happy")"),
(str_store_string,s63,":str_store_string("str_bar_enthusiastic")"),
(else_try),
(gt,":var005",60),
(str_store_string,s8,":str_store_string("str_content")"),
(str_store_string,s63,":str_store_string("str_bar_content")"),
(else_try),
(gt,":var005",40),
(str_store_string,s8,":str_store_string("str_concerned")"),
(str_store_string,s63,":str_store_string("str_bar_weary")"),
(else_try),
(gt,":var005",20),
(str_store_string,s8,":str_store_string("str_not_happy")"),
(str_store_string,s63,":str_store_string("str_bar_disgruntled")"),
(else_try),
(str_store_string,s8,":str_store_string("str_miserable")"),
(str_store_string,s63,":str_store_string("str_bar_miserable")"),
(try_end),
(str_store_string,s21,":str_store_string("str_npc_morale_report")"),
(assign,reg0,":var005"),
]),

("retire_companion", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(remove_member_from_party,":troop_id_001","p_main_party"),
(troop_set_slot,":troop_id_001",77,0),
(troop_set_slot,":troop_id_001",69,0),
(troop_get_slot,":troop_slot_003","trp_player",7),
(store_add, ":var004", ":troop_slot_003", ":var002"),
(troop_set_slot,":troop_id_001",2,11),
(troop_set_slot,":troop_id_001",84,":var004"),
]),

("reduce_companion_morale_for_clash", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(store_script_param, ":slot_no_003", 3),
(troop_get_slot,":troop_slot_004",":troop_id_001",":slot_no_003"),
(troop_get_slot,":troop_slot_005",":troop_id_001",77),
(troop_get_slot,":troop_slot_006",":troop_id_002",77),
(try_begin),
(eq,":troop_slot_004",1),
(val_add, ":troop_slot_005", 5),
(else_try),
(eq,":troop_slot_004",2),
(val_add, ":troop_slot_006", 5),
(else_try),
(eq,":troop_slot_004",3),
(val_add, ":troop_slot_005", 3),
(val_add, ":troop_slot_006", 3),
(try_end),
(troop_set_slot,":troop_id_001",77,":troop_slot_005"),
(troop_set_slot,":troop_id_002",77,":troop_slot_006"),
]),

("calculate_ransom_amount_for_troop", [
(store_script_param, ":troop_id_001", 1),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(assign,":var003",400),
(assign,":var004",-9),
(try_begin),
(faction_slot_eq,":troop_faction_002",11,":troop_id_001"),
(val_add, ":var003", 4000),
(else_try),
(troop_slot_eq,":troop_id_001",2,6),
(val_add, ":var003", 2500),
(call_script, "script_get_kingdom_lady_social_determinants", ":troop_id_001"),
(assign,":var004",reg0),
(try_end),
(assign,":var005",0),
(try_for_range, ":p_006", ":p.town_1", ":p.salt_mine"),
(this_or_next|party_slot_eq,":p_006",7,":troop_id_001"),
(party_slot_eq,":p_006",7,":var004"),
(try_begin),
(party_slot_eq,":p_006",0,3),
(val_add, ":var005", 4),
(else_try),
(party_slot_eq,":p_006",0,2),
(val_add, ":var005", 2),
(else_try),
(val_add, ":var005", 1),
(try_end),
(try_end),
(val_mul, ":var005", 500),
(val_add, ":var003", ":var005"),
(troop_get_slot,":troop_slot_007",":troop_id_001",7),
(val_mul, ":troop_slot_007", 2),
(val_add, ":var003", ":troop_slot_007"),
(store_mul, ":var008", ":var003", 3),
(val_div, ":var008", 2),
(store_random_in_range,":random_x_009",":var003",":var008"),
(val_div, ":random_x_009", 100),
(val_mul, ":random_x_009", 100),
(assign,reg0,":random_x_009"),
]),

("offer_ransom_amount_to_player_for_prisoners_in_party", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_003",":var001"),
(try_for_range, ":var004", 0, ":party_num_prisoners_stacks_003"),
(eq,":var002",0),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_005",":var001",":var004"),
(troop_is_hero,":party_prisoner_troop_id_005"),
(this_or_next|troop_slot_eq,":party_prisoner_troop_id_005",2,2),
(troop_slot_eq,":party_prisoner_troop_id_005",2,6),
(store_troop_faction,":troop_faction_006",":party_prisoner_troop_id_005"),
(store_random_in_range,":random_x_007",0,100),
(faction_slot_eq,":troop_faction_006",21,0),
(le,":random_x_007",5),
(neq,":::g_ransom_offer_rejected",1),
(assign,":party_num_prisoners_stacks_003",0),
(assign,":var002",1),
(assign,"$g_ransom_offer_troop",":party_prisoner_troop_id_005"),
(assign,"$g_ransom_offer_party",":var001"),
(jump_to_menu,"mnu_enemy_offer_ransom_for_prisoner"),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("event_hero_taken_prisoner_by_player", [
(store_script_param, ":var001", 1),
(try_begin),
(check_quest_active,"qst_persuade_lords_to_make_peace"),
(try_begin),
(quest_slot_eq,"qst_persuade_lords_to_make_peace",2,":var001"),
(val_mul, ":var001", -1),
(quest_set_slot,"qst_persuade_lords_to_make_peace",2,":var001"),
(val_mul, ":var001", -1),
(else_try),
(quest_slot_eq,"qst_persuade_lords_to_make_peace",4,":var001"),
(val_mul, ":var001", -1),
(quest_set_slot,"qst_persuade_lords_to_make_peace",4,":var001"),
(val_mul, ":var001", -1),
(try_end),
(try_begin),
(neg|check_quest_concluded,"qst_persuade_lords_to_make_peace"),
(neg|quest_slot_ge,"qst_persuade_lords_to_make_peace",2,0),
(neg|quest_slot_ge,"qst_persuade_lords_to_make_peace",4,0),
(call_script, "script_succeed_quest", "qst_persuade_lords_to_make_peace"),
(try_end),
(try_end),
(call_script, "script_update_troop_location_notes", ":var001", 0),
]),

("cf_check_hero_can_escape_from_player", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_begin),
(check_quest_active,"qst_persuade_lords_to_make_peace"),
(this_or_next|quest_slot_eq,"qst_persuade_lords_to_make_peace",2,":var001"),
(quest_slot_eq,"qst_persuade_lords_to_make_peace",4,":var001"),
(assign,":var002",1),
(else_try),
(ge,":var001","trp_sea_raider_leader"),
(lt,":var001","trp_bandit_leaders_end"),
(try_begin),
(check_quest_active,"qst_learn_where_merchant_brother_is"),
(assign,":var002",1),
(else_try),
(assign,":var002",-1),
(try_end),
(try_end),
(assign,":var003",0),
(try_begin),
(eq,":var002",0),
(store_random_in_range,":random_x_004",0,100),
(try_begin),
(lt,":random_x_004",70),
(assign,":var003",1),
(else_try),
(eq,":var002",-1),
(assign,":var003",1),
(try_end),
(try_end),
]),

("cf_party_remove_random_regular_troop", [
(store_script_param, ":party_id_001", 1),
(party_get_num_companion_stacks,":party_num_companions_stacks_002",":party_id_001"),
(assign,":var003",0),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_001",":stack_no_004"),
(try_begin),
(neg|troop_is_hero,":troop_id_005"),
(party_stack_get_size,          ":party_stack_size_006",":party_id_001",":stack_no_004"),
(val_add, ":var003", ":party_stack_size_006"),
(try_end),
(try_end),
(try_begin),
(gt,":var003",0),
(store_random_in_range,":random_x_007",0,":var003"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_002"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_001",":stack_no_004"),
(neg|troop_is_hero,":troop_id_005"),
(party_stack_get_size,          ":party_stack_size_006",":party_id_001",":stack_no_004"),
(val_sub, ":random_x_007", ":party_stack_size_006"),
(lt,":random_x_007",0),
(assign,":party_num_companions_stacks_002",0),
(party_remove_members,":party_id_001",":troop_id_005",1),
(assign,-1,":troop_id_005"), # reg0
(try_end),
(try_end),
]),

("place_player_banner_near_inventory", [
(troop_get_slot,":troop_slot_001","trp_player",13),
(try_begin),
(gt,":troop_slot_001",0),
(scene_prop_get_instance, ":scp_instance_002", ":troop_slot_001", 0),
(try_begin),
(ge,":scp_instance_002",0),
(get_player_agent_no,":agent_no_003"),
(agent_get_look_position, pos1, ":agent_no_003"),
(position_move_y,1,-500),
(position_rotate_z,1,180),
(position_set_z_to_ground_level, 1),
(position_move_z,1,300),
(prop_instance_set_position, ":scp_instance_002", 1),
(try_end),
(scene_prop_get_instance, ":scp_instance_004", "spr_banner_pole", 0),
(try_begin),
(ge,":scp_instance_004",0),
(position_move_z,1,-320),
(prop_instance_set_position, ":scp_instance_004", 1),
(try_end),
(else_try),
(init_position,1),
(position_move_z,1,-1000000),
(scene_prop_get_instance, ":scp_instance_002", "spr_banner_a", 0),
(try_begin),
(ge,":scp_instance_002",0),
(prop_instance_set_position, ":scp_instance_002", 1),
(try_end),
(scene_prop_get_instance, ":scp_instance_004", "spr_banner_pole", 0),
(try_begin),
(ge,":scp_instance_004",0),
(prop_instance_set_position, ":scp_instance_004", 1),
(try_end),
(try_end),
]),

("place_player_banner_near_inventory_bms", [
(troop_get_slot,":troop_slot_001","trp_player",13),
(try_begin),
(gt,":troop_slot_001",0),
(replace_scene_props, "spr_banner_a",":troop_slot_001"),
(try_end),
]),

("stay_captive_for_hours", [
(store_script_param, ":var001", 1),
(store_current_hours,":cur_hours_002"),
(val_add, ":cur_hours_002", ":var001"),
(val_max,"$g_check_autos_at_hour",":cur_hours_002"),
(val_add, ":var001", 1),
(rest_for_hours,":var001",0,0),
]),

("set_parties_around_player_ignore_player", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(try_for_parties, ":cur_party"),
(party_is_active,":cur_party"),
(store_distance_to_party_from_party,":distance_parties_004","p_main_party","p_main_party"),
(lt,":distance_parties_004",":var001"),
(party_ignore_player, ":cur_party",":var002"),
(try_end),
(try_end),
]),

("randomly_make_prisoner_heroes_escape_from_party", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":quest_slot_003",-1),
(assign,":quest_slot_004",-1),
(try_begin),
(check_quest_active,"qst_rescue_lord_by_replace"),
(quest_get_slot,":quest_slot_003","qst_rescue_lord_by_replace",2),
(try_end),
(try_begin),
(check_quest_active,"qst_deliver_message_to_prisoner_lord"),
(quest_get_slot,":quest_slot_004","qst_deliver_message_to_prisoner_lord",2),
(try_end),
(party_get_num_prisoner_stacks, ":party_num_prisoners_stacks_005",":var001"),
(try_for_range, ":var006", 0, ":party_num_prisoners_stacks_005"),
(party_get_prisoner_stack_troop,":party_prisoner_troop_id_007",":var001",":var006"),
(try_begin),
(troop_is_hero,":party_prisoner_troop_id_007"),
(neq,":party_prisoner_troop_id_007",":quest_slot_003"),
(neq,":party_prisoner_troop_id_007",":quest_slot_004"),
(troop_slot_eq,":party_prisoner_troop_id_007",2,2),
(store_random_in_range,":random_x_008",0,1000),
(try_begin),
(lt,":random_x_008",":var002"),
(party_remove_members,":var001",":party_prisoner_troop_id_007",1),
(call_script, "script_remove_troop_from_prison", ":party_prisoner_troop_id_007"),
(str_store_string,s1,":str_store_troop_name_link(party_prisoner_troop_id_007)"),
(try_begin),
(eq,":var001","p_main_party"),
(str_store_string,s2,":str_store_string("@your party")"),
(else_try),
(str_store_string,s2,":str_store_party_name(var001)"),
(try_end),
(try_end),
(try_end),
(assign,reg0,0),
(this_or_next|eq,":var001","p_main_party"),
(party_slot_eq,":var001",7,"trp_player"),
(assign,reg0,1),
(try_end),
(store_troop_faction,":troop_faction_009",":party_prisoner_troop_id_007"),
(str_store_string,s3,":str_store_faction_name_link(troop_faction_009)"),
(assign, reg0, ":"@{reg0?One of your prisoners"),
(assign, reg1, "::}{s1} of {s3} has escaped from captivity!""),
(display_message, "@{reg0} {reg1}"),
]),

("fill_tournament_participants_troop", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":slot_no_003",0),
(try_begin),
(eq,":var002",1),
(party_get_num_companion_stacks,":party_num_companions_stacks_004","p_main_party"),
(try_for_range, ":stack_no_005", 0, ":party_num_companions_stacks_004"),
(party_stack_get_troop_id,      ":troop_id_006","p_main_party",":stack_no_005"),
(troop_is_hero,":troop_id_006"),
(neq,":troop_id_006","trp_kidnapped_girl"),
(troop_set_slot,"trp_tournament_participants",":slot_no_003",":troop_id_006"),
(val_add, ":slot_no_003", 1),
(try_end),
(try_end),
(party_collect_attachments_to_party, ":var001", "p_temp_party"),
(party_get_num_companion_stacks,":party_num_companions_stacks_004","p_temp_party"),
(try_for_range, ":stack_no_005", 0, ":party_num_companions_stacks_004"),
(party_stack_get_troop_id,      ":troop_id_006","p_temp_party",":stack_no_005"),
(try_begin),
(troop_is_hero,":troop_id_006"),
(troop_set_slot,"trp_tournament_participants",":slot_no_003",":troop_id_006"),
(val_add, ":slot_no_003", 1),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_007",0,100),
(try_begin),
(lt,":random_x_007",50),
(troop_set_slot,"trp_tournament_participants",":slot_no_003","trp_xerina"),
(val_add, ":slot_no_003", 1),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_007",0,100),
(try_begin),
(lt,":random_x_007",50),
(troop_set_slot,"trp_tournament_participants",":slot_no_003","trp_dranton"),
(val_add, ":slot_no_003", 1),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_007",0,100),
(try_begin),
(lt,":random_x_007",50),
(troop_set_slot,"trp_tournament_participants",":slot_no_003","trp_kradus"),
(val_add, ":slot_no_003", 1),
(try_end),
(try_end),
(assign,":var008",":slot_no_003"),
(try_for_range, ":slot_no_003", ":var008", 64),
(store_random_in_range,":random_x_007",0,6),
(try_begin),
(eq,":random_x_007",0),
(troop_set_slot,"trp_tournament_participants",":slot_no_003","trp_regular_fighter"),
(else_try),
(eq,":random_x_007",1),
(troop_set_slot,"trp_tournament_participants",":slot_no_003","trp_veteran_fighter"),
(else_try),
(eq,":random_x_007",2),
(troop_set_slot,"trp_tournament_participants",":slot_no_003","trp_champion_fighter"),
(else_try),
(eq,":random_x_007",3),
(troop_set_slot,"trp_tournament_participants",":slot_no_003","trp_sword_sister"),
(else_try),
(eq,":random_x_007",4),
(troop_set_slot,"trp_tournament_participants",":slot_no_003","trp_hired_blade"),
(else_try),
(troop_set_slot,"trp_tournament_participants",":slot_no_003","trp_mercenary_swordsman"),
(try_end),
(try_end),
]),

("get_num_tournament_participants", [
(assign,":var001",0),
(try_for_range, ":var002", 0, 64),
(troop_slot_ge,"trp_tournament_participants",":var002",0),
(val_add, ":var001", 1),
(try_end),
(assign,reg0,":var001"),
]),

("get_random_tournament_participant", [
(call_script, "script_get_num_tournament_participants"),
(assign,":var001",reg0),
(store_random_in_range,":random_x_002",0,":var001"),
(assign,":var003",1),
(try_for_range, ":slot_no_004", 0, 64),
(eq,":var003",1),
(troop_slot_ge,"trp_tournament_participants",":slot_no_004",0),
(val_sub, ":random_x_002", 1),
(lt,":random_x_002",0),
(assign,":var003",0),
(troop_get_slot,":troop_slot_005","trp_tournament_participants",":slot_no_004"),
(troop_set_slot,"trp_tournament_participants",":slot_no_004",-1),
(try_end),
(try_end),
(assign,reg0,":troop_slot_005"),
]),

("add_tournament_participant", [
(store_script_param, ":var001", 1),
(assign,":var002",1),
(try_for_range, ":slot_no_003", 0, 64),
(eq,":var002",1),
(troop_slot_eq,"trp_tournament_participants",":slot_no_003",-1),
(troop_set_slot,"trp_tournament_participants",":slot_no_003",":var001"),
(assign,":var002",0),
(try_end),
]),

("get_random_tournament_team_amount_and_size", [
(call_script, "script_get_num_tournament_participants"),
(assign,":var001",reg0),
(party_get_slot,":party_slot_002","$current_town",157),
(val_add, ":party_slot_002", 1),
(party_get_slot,":party_slot_003","$current_town",158),
(val_add, ":party_slot_003", 1),
(assign,":var004",":var001"),
(val_min,":var004",":party_slot_002"),
(assign,":var005",":var001"),
(val_min,":var005",":party_slot_003"),
(assign,":var006",1),
(try_begin),
(ge,":var001",32),
(assign,":var006",2),
(val_min,":var006",":party_slot_003"),
(try_end),
(assign,":var007",500),
(try_for_range, ":var008", 0, ":var007"),
(store_random_in_range,":random_x_009",2,":var004"),
(store_random_in_range,":random_x_010",":var006",":var005"),
(store_mul, ":var011", ":random_x_009", ":random_x_010"),
(try_begin),
(le,":var011",":var001"),
(store_sub, ":var012", ":var001", ":var011"),
(neq,":var012",1),
(assign,":var007",0),
(try_end),
(try_end),
(try_begin),
(gt,":var007",0),
(assign,":random_x_009",2),
(assign,":random_x_010",1),
(try_end),
(assign,reg0,":random_x_009"),
(assign,reg1,":random_x_010"),
]),

("get_troop_priority_point_for_tournament", [
(store_script_param, ":troop_id_001", 1),
(assign,":var002",0),
(try_begin),
(ge,":troop_id_001",0),
(val_add, ":var002", 40000),
(try_begin),
(eq,":troop_id_001","trp_player"),
(val_add, ":var002", 80000),
(try_end),
(try_begin),
(troop_is_hero,":troop_id_001"),
(val_add, ":var002", 20000),
(try_end),
(try_begin),
(troop_slot_eq,":troop_id_001",2,5),
(val_add, ":var002", 10000),
(else_try),
(troop_slot_eq,":troop_id_001",2,2),
(troop_get_slot,":troop_slot_003",":troop_id_001",7),
(val_add, ":var002", ":troop_slot_003"),
(val_add, ":var002", 1000),
(else_try),
(store_character_level,":character_lvl_004",":troop_id_001"),
(val_add, ":var002", ":character_lvl_004"),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("sort_tournament_participant_troops", [
(try_for_range, ":slot_no_001", 0, 63),
(store_add, ":var002", ":slot_no_001", 1),
(try_for_range, ":slot_no_003", ":var002", 64),
(troop_get_slot,":troop_slot_004","trp_tournament_participants",":slot_no_001"),
(troop_get_slot,":troop_slot_005","trp_tournament_participants",":slot_no_003"),
(call_script, "script_get_troop_priority_point_for_tournament", ":troop_slot_004"),
(assign,":var006",reg0),
(call_script, "script_get_troop_priority_point_for_tournament", ":troop_slot_005"),
(assign,":var007",reg0),
(gt,":var007",":var006"),
(troop_set_slot,"trp_tournament_participants",":slot_no_001",":troop_slot_005"),
(troop_set_slot,"trp_tournament_participants",":slot_no_003",":troop_slot_004"),
(try_end),
(try_end),
]),

("remove_tournament_participants_randomly", [
(store_script_param, ":var001", 1),
(try_for_range, ":var002", 0, ":var001"),
(assign,":var003",0),
(try_for_range, ":slot_no_004", 0, 64),
(troop_get_slot,":troop_slot_005","trp_tournament_participants",":slot_no_004"),
(try_begin),
(ge,":troop_slot_005",0),
(store_character_level,":character_lvl_006",":troop_slot_005"),
(val_min,":character_lvl_006",38),
(store_sub, ":var007", 40, ":character_lvl_006"),
(val_add, ":var003", ":var007"),
(try_end),
(try_end),
(store_random_in_range,":random_x_008",0,":var003"),
(assign,":var009",1),
(try_for_range, ":slot_no_004", 0, 64),
(eq,":var009",1),
(troop_get_slot,":troop_slot_005","trp_tournament_participants",":slot_no_004"),
(ge,":troop_slot_005",0),
(store_character_level,":character_lvl_006",":troop_slot_005"),
(val_min,":character_lvl_006",38),
(store_sub, ":var007", 40, ":character_lvl_006"),
(val_sub, ":random_x_008", ":var007"),
(lt,":random_x_008",0),
(troop_set_slot,"trp_tournament_participants",":slot_no_004",-1),
(assign,":var009",0),
(try_end),
(try_end),
(try_end),
]),

("end_tournament_fight", [
(store_script_param, ":var001", 1),
(call_script, "script_get_num_tournament_participants"),
(assign,":var002",reg0),
(store_div, ":var___x1", ":var002", 2),
(assign,":var003",":var___x1"),
(call_script, "script_remove_tournament_participants_randomly", ":var003"),
(assign,":var004","$g_tournament_num_participants_for_fight"),
(val_div, ":var004", 2),
(get_player_agent_no,":agent_no_005"),
(agent_get_team, ":agent_team_no_006", ":agent_no_005"),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_troop_id,":troop_id_008", ":cur_agent"),
(try_begin),
(neg|is_between,":troop_id_008","trp_town_1_arena_master","trp_town_1_armorer"),
(agent_get_team, ":agent_team_no_009", ":cur_agent"),
(assign,":var010",0),
(eq,":var001",1),
(eq,":agent_team_no_009",":agent_team_no_006"),
(val_add, ":var010", 5000000),
(try_end),
(agent_get_kill_count,":agent_kill_count_011",":cur_agent",1),
(store_mul, ":var012", ":agent_kill_count_011", 160000),
(val_add, ":var010", ":var012"),
(call_script, "script_get_troop_priority_point_for_tournament", ":troop_id_008"),
(val_add, ":var010", reg0),
(eq,":cur_agent",":agent_no_005"),
(eq,":var001",0),
(assign,":var013",1),
(try_begin),
(ge,":agent_kill_count_011",2),
(assign,":var013",0),
(else_try),
(eq,":agent_kill_count_011",1),
(le,":::g_tournament_cur_tier",1),
(assign,":var013",0),
(try_end),
(try_begin),
(eq,":var013",1),
(assign,":var010",0),
(try_end),
(try_end),
(agent_set_slot,":cur_agent",6,":var010"),
(try_for_range, ":var014", 0, ":var004"),
(assign,":var015",0),
(assign,":agent_id_016",-1),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_slot,":agent_slot_017",":cur_agent",6),
(gt,":agent_slot_017",":var015"),
(assign,":agent_id_016",":cur_agent"),
(assign,":var015",":agent_slot_017"),
(try_end),
(try_end),
(agent_set_slot,":agent_id_016",6,0),
(agent_get_troop_id,":troop_id_008", ":agent_id_016"),
(call_script, "script_add_tournament_participant", ":troop_id_008"),
(try_end),
(assign,"$g_tournament_player_team_won",":var001"),
(jump_to_menu,"mnu_town_tournament"),
]),

("get_win_amount_for_tournament_bet", [
(party_get_slot,":party_slot_001","$current_town",51),
(try_begin),
(eq,":::g_tournament_cur_tier",0),
(assign,":var002",120),
(else_try),
(eq,":::g_tournament_cur_tier",1),
(assign,":var002",90),
(else_try),
(eq,":::g_tournament_cur_tier",2),
(assign,":var002",60),
(else_try),
(eq,":::g_tournament_cur_tier",3),
(assign,":var002",40),
(else_try),
(eq,":::g_tournament_cur_tier",4),
(assign,":var002",20),
(else_try),
(assign,":var002",8),
(try_end),
(val_mul, ":var002", ":party_slot_001"),
(val_div, ":var002", 100),
(val_add, ":var002", 100),
(assign,reg0,":var002"),
]),

("tournament_place_bet", [
(store_script_param, ":gold_001", 1),
(call_script, "script_get_win_amount_for_tournament_bet"),
(assign,":var002",reg0),
(val_mul, ":var002", ":gold_001"),
(val_div, ":var002", 100),
(val_sub, ":var002", ":gold_001"),
(val_add, ":::g_tournament_bet_placed", ":gold_001"),
(val_add, ":::g_tournament_bet_win_amount", ":var002"),
(troop_remove_gold,"trp_player",":gold_001"),
(assign,"$g_tournament_last_bet_tier","$g_tournament_cur_tier"),
]),

("calculate_amount_of_cattle_can_be_stolen", [
(store_script_param, ":party_id_001", 1),
(call_script, "script_get_max_skill_of_player_party", "skl_looting"),
(assign,":var002",reg0),
(store_mul, ":var003", ":var002", 2),
(call_script, "script_party_count_fit_for_battle", "p_main_party"),
(store_add, ":var004", reg0, 10),
(val_div, ":var004", 10),
(val_add, ":var003", ":var004"),
(party_get_slot,":party_slot_005",":party_id_001",205),
(val_min,":var003",":party_slot_005"),
(assign,reg0,":var003"),
]),

("draw_banner_to_region", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(store_script_param, ":var004", 4),
(store_script_param, ":var005", 5),
(store_script_param, ":var006", 6),
(store_script_param, ":var007", 7),
(store_script_param, ":var008", 8),
(store_script_param, ":var009", 9),
(store_script_param, ":var010", 10),
(troop_get_slot,":troop_slot_011",":troop_id_001",91),
(assign,":troop_slot_011 +","mesh_custom_banner_bg"),
(troop_get_slot,":troop_slot_012",":troop_id_001",85),
(troop_get_slot,":troop_slot_013",":troop_id_001",86),
(troop_get_slot,":troop_slot_014",":troop_id_001",97),
(troop_get_slot,":troop_slot_015",":troop_id_001",98),
(call_script, "script_get_troop_custom_banner_num_positionings", ":troop_id_001"),
(assign,":var016",reg0),
(val_mod, ":troop_slot_015", ":var016"),
(init_position,2),
(position_set_x,2,":var004"),
(position_set_y,2,":var005"),
(assign,":var017",1),
(convert_to_fixed_point, ":var017"),
(position_set_z,2,":var017"),
(init_position,1),
(position_set_x,1,":var002"),
(position_set_y,1,":var003"),
(position_move_z,1,-20),
(init_position,3),
(position_set_x,3,":var008"),
(position_set_y,3,":var008"),
(position_set_z,3,":var017"),
(try_begin),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg17"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg16"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg13"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg12"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg11"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg10"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg09"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg08"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg03"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg02"),
(this_or_next|eq,":troop_slot_011","mesh_custom_banner_fg01"),
(eq,":troop_slot_011","mesh_custom_banner_bg"),
(cur_tableau_add_mesh_with_scale_and_vertex_color, ":troop_slot_011", 1, 1, 0, ":troop_slot_012"),
(else_try),
(cur_tableau_add_mesh_with_scale_and_vertex_color, ":troop_slot_011", 1, 1, 0, ":troop_slot_012"),
(try_end),
(position_move_z,1,-20),
(position_move_x,2,":var004"),
(position_move_y,2,":var005"),
(cur_tableau_add_mesh_with_scale_and_vertex_color, "mesh_custom_banner_bg", 1, 1, 0, ":troop_slot_013"),
(assign,":var018",":var006"),
(val_min,":var018",":var007"),
(val_min,":var018",":var009"),
(call_script, "script_get_custom_banner_charge_type_position_scale_color", "trp_player", ":troop_slot_015"),
(try_begin),
(this_or_next|eq,":var010",3),
(eq,":var010",2),
(assign,":var019",0),
(try_begin),
(eq,":troop_slot_014",1),
(assign,":var019",1),
(else_try),
(eq,":troop_slot_014",2),
(eq,":troop_slot_015",1),
(assign,":var019",1),
(else_try),
(eq,":troop_slot_014",3),
(eq,":troop_slot_015",1),
(assign,":var019",1),
(try_end),
(try_begin),
(eq,":var019",1),
(val_add, ":var003", 30),
(try_end),
(try_end),
(try_begin),
(ge,":troop_slot_014",1),
(val_mul, reg1, ":var018"),
(val_div, reg1, 10000),
(position_get_x,":pos_x_020",0),
(position_get_y,":pos_y_021",0),
(val_mul, ":pos_x_020", ":var006"),
(val_mul, ":pos_y_021", ":var007"),
(val_div, ":pos_x_020", 10000),
(val_div, ":pos_y_021", 10000),
(val_add, ":pos_x_020", ":var002"),
(val_add, ":pos_y_021", ":var003"),
(position_set_x,0,":pos_x_020"),
(position_set_y,0,":pos_y_021"),
(assign,":var022",reg1),
(convert_to_fixed_point, ":var022"),
(store_mul, ":var023", ":var022", -1),
(init_position,4),
(position_set_x,4,":var022"),
(position_set_y,4,":var022"),
(position_set_z,4,":var022"),
(store_div, ":var___x1", reg0, 256),
(assign,":var024",":var___x1"),
(try_begin),
(this_or_next|eq,":var024",3),
(eq,":var024",1),
(position_set_x,4,":var023"),
(try_end),
(try_begin),
(this_or_next|eq,":var024",3),
(eq,":var024",1),
(position_set_y,4,":var023"),
(try_end),
(val_mod, reg0, 256),
(cur_tableau_add_mesh_with_scale_and_vertex_color, reg0, 0, 0, 0, reg2),
(try_end),
(try_begin),
(ge,":troop_slot_014",2),
(val_mul, reg4, ":var018"),
(val_div, reg4, 10000),
(position_get_x,":pos_x_020",1),
(position_get_y,":pos_y_021",1),
(val_mul, ":pos_x_020", ":var006"),
(val_mul, ":pos_y_021", ":var007"),
(val_div, ":pos_x_020", 10000),
(val_div, ":pos_y_021", 10000),
(val_add, ":pos_x_020", ":var002"),
(val_add, ":pos_y_021", ":var003"),
(position_set_x,1,":pos_x_020"),
(position_set_y,1,":pos_y_021"),
(assign,":var022",reg4),
(convert_to_fixed_point, ":var022"),
(store_mul, ":var023", ":var022", -1),
(init_position,4),
(position_set_x,4,":var022"),
(position_set_y,4,":var022"),
(position_set_z,4,":var022"),
(store_div, ":var___x1", reg3, 256),
(assign,":var024",":var___x1"),
(try_begin),
(this_or_next|eq,":var024",3),
(eq,":var024",1),
(position_set_x,4,":var023"),
(try_end),
(try_begin),
(this_or_next|eq,":var024",3),
(eq,":var024",1),
(position_set_y,4,":var023"),
(try_end),
(val_mod, reg3, 256),
(cur_tableau_add_mesh_with_scale_and_vertex_color, reg3, 1, 1, 0, reg5),
(try_end),
(try_begin),
(ge,":troop_slot_014",3),
(val_mul, reg7, ":var018"),
(val_div, reg7, 10000),
(position_get_x,":pos_x_020",2),
(position_get_y,":pos_y_021",2),
(val_mul, ":pos_x_020", ":var006"),
(val_mul, ":pos_y_021", ":var007"),
(val_div, ":pos_x_020", 10000),
(val_div, ":pos_y_021", 10000),
(val_add, ":pos_x_020", ":var002"),
(val_add, ":pos_y_021", ":var003"),
(position_set_x,2,":pos_x_020"),
(position_set_y,2,":pos_y_021"),
(assign,":var022",reg7),
(convert_to_fixed_point, ":var022"),
(store_mul, ":var023", ":var022", -1),
(init_position,4),
(position_set_x,4,":var022"),
(position_set_y,4,":var022"),
(position_set_z,4,":var022"),
(store_div, ":var___x1", reg6, 256),
(assign,":var024",":var___x1"),
(try_begin),
(this_or_next|eq,":var024",3),
(eq,":var024",1),
(position_set_x,4,":var023"),
(try_end),
(try_begin),
(this_or_next|eq,":var024",3),
(eq,":var024",1),
(position_set_y,4,":var023"),
(try_end),
(val_mod, reg6, 256),
(cur_tableau_add_mesh_with_scale_and_vertex_color, reg6, 2, 2, 0, reg8),
(try_end),
(try_begin),
(ge,":troop_slot_014",4),
(val_mul, reg10, ":var018"),
(val_div, reg10, 10000),
(position_get_x,":pos_x_020",3),
(position_get_y,":pos_y_021",3),
(val_mul, ":pos_x_020", ":var006"),
(val_mul, ":pos_y_021", ":var007"),
(val_div, ":pos_x_020", 10000),
(val_div, ":pos_y_021", 10000),
(val_add, ":pos_x_020", ":var002"),
(val_add, ":pos_y_021", ":var003"),
(position_set_x,3,":pos_x_020"),
(position_set_y,3,":pos_y_021"),
(assign,":var022",reg10),
(convert_to_fixed_point, ":var022"),
(store_mul, ":var023", ":var022", -1),
(init_position,4),
(position_set_x,4,":var022"),
(position_set_y,4,":var022"),
(position_set_z,4,":var022"),
(store_div, ":var___x1", reg9, 256),
(assign,":var024",":var___x1"),
(try_begin),
(this_or_next|eq,":var024",3),
(eq,":var024",1),
(position_set_x,4,":var023"),
(try_end),
(try_begin),
(this_or_next|eq,":var024",3),
(eq,":var024",1),
(position_set_y,4,":var023"),
(try_end),
(val_mod, reg9, 256),
(cur_tableau_add_mesh_with_scale_and_vertex_color, reg9, 3, 3, 0, reg11),
(try_end),
]),

("get_troop_custom_banner_num_positionings", [
(store_script_param, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_002",":troop_id_001",97),
(try_begin),
(eq,":troop_slot_002",1),
(assign,":var003",2),
(else_try),
(eq,":troop_slot_002",2),
(assign,":var003",4),
(else_try),
(eq,":troop_slot_002",3),
(assign,":var003",6),
(else_try),
(assign,":var003",2),
(try_end),
(assign,reg0,":var003"),
]),

("get_custom_banner_charge_type_position_scale_color", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_001",97),
(init_position,0),
(init_position,1),
(init_position,2),
(init_position,3),
(troop_get_slot,reg0,":troop_id_001",92),
(assign,":reg0 +","mesh_custom_banner_charge_01"),
(troop_get_slot,reg2,":troop_id_001",87),
(troop_get_slot,reg3,":troop_id_001",93),
(assign,":reg3 +","mesh_custom_banner_charge_01"),
(troop_get_slot,reg5,":troop_id_001",88),
(troop_get_slot,reg6,":troop_id_001",94),
(assign,":reg6 +","mesh_custom_banner_charge_01"),
(troop_get_slot,reg8,":troop_id_001",89),
(troop_get_slot,reg9,":troop_id_001",95),
(assign,":reg9 +","mesh_custom_banner_charge_01"),
(troop_get_slot,reg11,":troop_id_001",90),
(try_begin),
(eq,":troop_slot_003",1),
(try_begin),
(eq,":var002",0),
(assign,reg1,100),
(else_try),
(assign,reg1,50),
(try_end),
(else_try),
(eq,":troop_slot_003",2),
(try_begin),
(eq,":var002",0),
(position_set_y,0,25),
(position_set_y,1,-25),
(assign,reg1,40),
(assign,reg4,40),
(else_try),
(eq,":var002",1),
(position_set_x,0,-25),
(position_set_x,1,25),
(assign,reg1,40),
(assign,reg4,40),
(else_try),
(eq,":var002",2),
(position_set_x,0,-25),
(position_set_y,0,25),
(position_set_x,1,25),
(position_set_y,1,-25),
(assign,reg1,50),
(assign,reg4,50),
(else_try),
(position_set_x,0,-25),
(position_set_y,0,-25),
(position_set_x,1,25),
(position_set_y,1,25),
(assign,reg1,50),
(assign,reg4,50),
(try_end),
(else_try),
(eq,":troop_slot_003",3),
(try_begin),
(eq,":var002",0),
(position_set_y,0,33),
(position_set_y,2,-33),
(assign,reg1,30),
(assign,reg4,30),
(assign,reg7,30),
(else_try),
(eq,":var002",1),
(position_set_x,0,-33),
(position_set_x,2,33),
(assign,reg1,30),
(assign,reg4,30),
(assign,reg7,30),
(else_try),
(eq,":var002",2),
(position_set_x,0,-30),
(position_set_y,0,30),
(position_set_x,2,30),
(position_set_y,2,-30),
(assign,reg1,35),
(assign,reg4,35),
(assign,reg7,35),
(else_try),
(eq,":var002",3),
(position_set_x,0,-30),
(position_set_y,0,-30),
(position_set_x,2,30),
(position_set_y,2,30),
(assign,reg1,35),
(assign,reg4,35),
(assign,reg7,35),
(else_try),
(eq,":var002",4),
(position_set_x,0,-25),
(position_set_y,0,-25),
(position_set_y,1,25),
(position_set_x,2,25),
(position_set_y,2,-25),
(assign,reg1,50),
(assign,reg4,50),
(assign,reg7,50),
(else_try),
(position_set_x,0,-25),
(position_set_y,0,25),
(position_set_y,1,-25),
(position_set_x,2,25),
(position_set_y,2,25),
(assign,reg1,50),
(assign,reg4,50),
(assign,reg7,50),
(try_end),
(else_try),
(try_begin),
(eq,":var002",0),
(position_set_x,0,-25),
(position_set_y,0,25),
(position_set_x,1,25),
(position_set_y,1,25),
(position_set_x,2,-25),
(position_set_y,2,-25),
(position_set_x,3,25),
(position_set_y,3,-25),
(assign,reg1,50),
(assign,reg4,50),
(assign,reg7,50),
(else_try),
(position_set_y,0,30),
(position_set_x,1,-30),
(position_set_x,2,30),
(position_set_y,3,-30),
(assign,reg1,35),
(assign,reg4,35),
(assign,reg7,35),
(assign,50,35), # reg10
(try_end),
(try_end),
]),

("get_random_custom_banner", [
(store_script_param, ":troop_id_001", 1),
(store_random_in_range,":random_x_002",1,5),
(troop_set_slot,":troop_id_001",97,":random_x_002"),
(store_random_in_range,":random_x_003",0,42),
(call_script, "script_get_custom_banner_color_from_index", ":random_x_003"),
(assign,":var004",reg0),
(troop_set_slot,":troop_id_001",85,":var004"),
(assign,":var005",1),
(try_for_range, ":var006", 0, ":var005"),
(store_random_in_range,":random_x_003",0,42),
(call_script, "script_get_custom_banner_color_from_index", ":random_x_003"),
(assign,":var007",reg0),
(try_begin),
(call_script, "script_cf_check_color_visibility", ":var004", ":var007"),
(troop_set_slot,":troop_id_001",86,":var007"),
(else_try),
(val_add, ":var005", 1),
(try_end),
(try_end),
(assign,":var005",4),
(assign,":var008",0),
(try_for_range, ":var006", 0, ":var005"),
(store_random_in_range,":random_x_003",0,42),
(call_script, "script_get_custom_banner_color_from_index", ":random_x_003"),
(assign,":var009",reg0),
(try_begin),
(call_script, "script_cf_check_color_visibility", ":var009", ":var004"),
(call_script, "script_cf_check_color_visibility", ":var009", ":var007"),
(store_add, ":slot_no_010", ":var008", 87),
(troop_set_slot,":troop_id_001",":slot_no_010",":var009"),
(store_random_in_range,":random_x_011","mesh_custom_banner_charge_01","mesh_tableau_mesh_custom_banner"),
(assign,":random_x_011 -","mesh_custom_banner_charge_01"),
(store_add, ":slot_no_010", ":var008", 92),
(troop_set_slot,":troop_id_001",":slot_no_010",":random_x_011"),
(val_add, ":var008", 1),
(else_try),
(val_add, ":var005", 1),
(try_end),
(try_end),
(store_random_in_range,":random_x_012","mesh_custom_banner_bg","mesh_custom_banner_charge_01"),
(assign,":random_x_012 -","mesh_custom_banner_bg"),
(troop_set_slot,":troop_id_001",91,":random_x_012"),
(store_random_in_range,":random_x_013","mesh_custom_banner_01","mesh_custom_banner_bg"),
(assign,":random_x_013 -","mesh_custom_banner_01"),
(troop_set_slot,":troop_id_001",96,":random_x_013"),
(store_random_in_range,":random_x_014",0,4),
(troop_set_slot,":troop_id_001",98,":random_x_014"),
]),

("get_custom_banner_color_from_index", [
(store_script_param, ":var001", 1),
(assign,":var002",4278190080),
(assign,":var003",0),
(assign,":var004",0),
(assign,":var005",0),
(store_mod,":var006",":var001",7),
(try_begin),
(eq,":var006",0),
(assign,":var005",255),
(else_try),
(eq,":var006",1),
(assign,":var003",238),
(else_try),
(eq,":var006",2),
(assign,":var003",251),
(assign,":var004",172),
(else_try),
(eq,":var006",3),
(assign,":var003",95),
(assign,":var005",255),
(else_try),
(eq,":var006",4),
(assign,":var003",5),
(assign,":var004",68),
(else_try),
(eq,":var006",5),
(assign,":var003",238),
(assign,":var004",238),
(assign,":var005",238),
(else_try),
(assign,":var003",34),
(assign,":var004",34),
(assign,":var005",34),
(try_end),
(store_div, ":var___x1", ":var001", 7),
(assign,":var007",":var___x1"),
(store_sub, ":var007", 8, ":var007"),
(val_mul, ":var003", ":var007"),
(val_div, ":var003", 8),
(val_mul, ":var004", ":var007"),
(val_div, ":var004", 8),
(val_mul, ":var005", ":var007"),
(val_div, ":var005", 8),
(val_mul, ":var004", 256),
(val_mul, ":var003", 65536),
(val_add, ":var002", ":var005"),
(val_add, ":var002", ":var004"),
(val_add, ":var002", ":var003"),
(assign,reg0,":var002"),
]),

("cf_check_color_visibility", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_mod,":var003",":var001",256),
(store_div, ":var___x1", ":var001", 256),
(assign,":var004",":var___x1"),
(val_mod, ":var004", 256),
(store_div, ":var___x1", ":var001", 65536),
(assign,":var005",":var___x1"),
(val_mod, ":var005", 256),
(store_mod,":var006",":var002",256),
(store_div, ":var___x1", ":var002", 256),
(assign,":var007",":var___x1"),
(val_mod, ":var007", 256),
(store_div, ":var___x1", ":var002", 65536),
(assign,":var008",":var___x1"),
(val_mod, ":var008", 256),
(store_sub, ":var009", ":var005", ":var008"),
(val_abs,":var009"),
(store_sub, ":var010", ":var004", ":var007"),
(val_abs,":var010"),
(store_sub, ":var011", ":var003", ":var006"),
(val_abs,":var011"),
(assign,":var012",0),
(val_max,":var012",":var009"),
(val_max,":var012",":var010"),
(val_max,":var012",":var011"),
]),

("get_next_active_kingdom", [
(store_script_param, ":var001", 1),
(assign,":var002","fac_kingdoms_end"),
(try_for_range, ":var003", ":fac.player_supporters_faction", ":var002"),
(val_add, ":var001", 1),
(try_begin),
(ge,":var001","fac_kingdoms_end"),
(assign,":var001","fac_player_supporters_faction"),
(try_end),
(try_begin),
(faction_slot_eq,":var001",21,0),
(neq,":var001","fac_player_supporters_faction"),
(assign,":var002",0),
(try_end),
(try_end),
(assign,reg0,":var001"),
]),

("remove_cattles_if_herd_is_close_to_party", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",":var002"),
(try_for_parties, ":cur_party"),
(gt,":var003",0),
(party_slot_eq,":cur_party",0,17),
(store_distance_to_party_from_party,":distance_parties_005",":cur_party",":cur_party"),
(try_begin),
(lt,":distance_parties_005",3),
(assign,":var006",1),
(check_quest_active,"qst_move_cattle_herd"),
(quest_slot_eq,"qst_move_cattle_herd",8,":cur_party"),
(assign,":var006",0),
(try_end),
(eq,":var006",1),
(party_count_companions_of_type,":party_companions_of_type_007",":cur_party","trp_cattle"),
(try_begin),
(le,":party_companions_of_type_007",":var003"),
(assign,":var008",":party_companions_of_type_007"),
(remove_party,":cur_party"),
(else_try),
(assign,":var008",":var003"),
(party_remove_members,":cur_party","trp_cattle",":var003"),
(try_end),
(try_end),
(val_sub, ":var003", ":var008"),
(try_begin),
(party_slot_eq,":party_id_001",0,4),
(party_get_slot,":party_slot_009",":party_id_001",205),
(val_add, ":party_slot_009", ":var008"),
(party_set_slot,":party_id_001",205,":party_slot_009"),
(try_end),
(assign,reg3,":var008"),
(str_store_string,s1,":str_store_party_name_link(party_id_001)"),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_begin),
(gt,":::cheat_mode",0),
(assign,reg4,":party_slot_009"),
(display_message, "@@{!}Village now has {reg4}"),
(try_end),
(store_sub, reg0, ":var002", ":var003"),
]),

("get_rumor_to_s61", [
(store_script_param, ":var001", 1),
(store_current_hours,":cur_hours_002"),
(store_div, ":var___x1", ":cur_hours_002", 24),
(assign,":var003",":var___x1"),
(assign,":var004",0),
(assign,":var005",3),
(try_for_range, ":var006", 0, ":var005"),
(store_mul, ":var007", ":var006", 6781),
(val_add, ":var007", ":var001"),
(store_mod,":var008",":var007",7),
(val_add, ":var007", ":cur_hours_002"),
(try_begin),
(eq,":var008",0),
(try_begin),
(eq,1,1),
(assign,":var009","p_castle_1"),
(assign,":var009 -","p_town_1"),
(store_mod,":party_id_010",":var007",":var009"),
(assign,":party_id_010 +","p_town_1"),
(party_slot_ge,":party_id_010",156,1),
(neq,":party_id_010",":::current_town"),
(str_store_string,s62,":str_store_party_name(party_id_010)"),
(str_store_string,s61,":str_store_string()"),
(assign,":var004",1),
(try_end),
(else_try),
(eq,":var008",1),
(try_begin),
(eq,1,1),
(assign,":var009","trp_knight_1_1_wife"),
(assign,":var009 -","trp_kingdom_1_lord"),
(store_mod,":troop_id_011",":var007",":var009"),
(assign,":troop_id_011 +","trp_kingdom_1_lord"),
(try_begin),
(is_between,":troop_id_011","trp_npc1","trp_knight_1_1_wife"),
(troop_get_slot,":troop_slot_012",":troop_id_011",52),
(try_begin),
(gt,":troop_slot_012",0),
(store_add, ":var013", ":troop_slot_012", ":gstr.gossip_about_character_default"),
(str_store_string,s6,":str_store_troop_name(troop_id_011)"),
(str_store_string,s61,":str_store_string(var013)"),
(assign,":var004",1),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var008",2),
(try_begin),
(eq,1,1),
(assign,":var009","itm_siege_supply"),
(assign,":var009 -","itm_spice"),
(store_add, ":var014", ":var007", ":var003"),
(store_mod,":var014",":var014",":var009"),
(store_add, ":slot_no_015", ":var014", 250),
(assign,":var014 +","itm_spice"),
(store_mul, ":var016", 1000, 3),
(val_div, ":var016", 4),
(assign,":var017",-1),
(try_for_range, ":var018", 0, 10),
(assign,":var009","p_castle_1"),
(assign,":var009 -","p_town_1"),
(store_add, ":var019", ":var007", ":var018"),
(store_mod,":party_id_010",":var019",":var009"),
(assign,":party_id_010 +","p_town_1"),
(try_begin),
(neq,":party_id_010",":::g_encountered_party"),
(party_get_slot,":party_slot_020",":party_id_010",":slot_no_015"),
(try_begin),
(lt,":party_slot_020",":var016"),
(assign,":var016",":party_slot_020"),
(assign,":var017",":party_id_010"),
(try_end),
(try_end),
(try_end),
(try_begin),
(ge,":var017",0),
(str_store_string,s62,":str_store_item_name(var014)"),
(str_store_string,s63,":str_store_party_name(var017)"),
(str_store_string,s61,":str_store_string()"),
(assign,":var004",1),
(try_end),
(try_end),
(else_try),
(eq,":var008",3),
(try_begin),
(eq,1,1),
(assign,":var009","itm_siege_supply"),
(assign,":var009 -","itm_spice"),
(store_add, ":var014", ":var007", ":var003"),
(store_mod,":var014",":var014",":var009"),
(store_add, ":slot_no_015", ":var014", 250),
(assign,":var014 +","itm_spice"),
(store_mul, ":var021", 1000, 5),
(val_div, ":var021", 4),
(assign,":var022",-1),
(try_for_range, ":var018", 0, 10),
(assign,":var009","p_castle_1"),
(assign,":var009 -","p_town_1"),
(store_add, ":var019", ":var007", ":var018"),
(store_mod,":party_id_010",":var019",":var009"),
(assign,":party_id_010 +","p_town_1"),
(try_begin),
(neq,":party_id_010",":::g_encountered_party"),
(party_get_slot,":party_slot_020",":party_id_010",":slot_no_015"),
(try_begin),
(gt,":party_slot_020",":var021"),
(assign,":var021",":party_slot_020"),
(assign,":var022",":party_id_010"),
(try_end),
(try_end),
(try_end),
(try_begin),
(ge,":var022",0),
(str_store_string,s62,":str_store_item_name(var014)"),
(str_store_string,s63,":str_store_party_name(var022)"),
(str_store_string,s61,":str_store_string()"),
(assign,":var004",1),
(try_end),
(try_end),
(try_end),
(gt,":var004",0),
(assign,":var005",0),
(try_end),
(assign,reg0,":var004"),
]),

("lord_comment_to_s43", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_001",52),
(try_begin),
(eq,1,1),
(try_begin),
(eq,":troop_slot_003",8),
(assign,":troop_slot_003",6),
(else_try),
(eq,":troop_slot_003",10),
(assign,":troop_slot_003",4),
(else_try),
(eq,":troop_slot_003",9),
(assign,":troop_slot_003",6),
(try_end),
(try_end),
(store_add, ":var004", ":troop_slot_003", ":var002"),
(str_store_string,s43,":str_store_string(var004)"),
(assign,reg0,":var004"),
]),

("add_log_entry", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":party_id_003", 3),
(store_script_param, ":troop_id_004", 4),
(store_script_param, ":var005", 5),
(assign,":party_slot_006",-1),
(assign,":party_faction_007",-1),
(assign,":troop_faction_008",-1),
(try_begin),
(party_is_active,":party_id_003"),
(party_get_slot,":party_slot_006",":party_id_003",7),
(store_faction_of_party, ":party_faction_007", ":party_id_003"),
(else_try),
(assign,":party_slot_006",0),
(assign,":party_faction_007",0),
(try_end),
(try_begin),
(is_between,":troop_id_004",0,"trp_local_merchant"),
(store_troop_faction,":troop_faction_008",":troop_id_004"),
(else_try),
(assign,":troop_faction_008",0),
(try_end),
(val_add, ":::num_log_entries", 1),
(store_current_hours,":cur_hours_009"),
(troop_set_slot,"trp_log_array_entry_type","$num_log_entries",":var001"),
(troop_set_slot,"trp_log_array_entry_time","$num_log_entries",":cur_hours_009"),
(troop_set_slot,"trp_log_array_actor","$num_log_entries",":var002"),
(troop_set_slot,"trp_log_array_center_object","$num_log_entries",":party_id_003"),
(troop_set_slot,"trp_log_array_center_object_lord","$num_log_entries",":party_slot_006"),
(troop_set_slot,"trp_log_array_center_object_faction","$num_log_entries",":party_faction_007"),
(troop_set_slot,"trp_log_array_troop_object","$num_log_entries",":troop_id_004"),
(troop_set_slot,"trp_log_array_troop_object_faction","$num_log_entries",":troop_faction_008"),
(troop_set_slot,"trp_log_array_faction_object","$num_log_entries",":var005"),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg3,"$num_log_entries"),
(assign,reg4,":var001"),
(display_message, "@@{!}Log entry {reg3}: type {reg4}"),
(try_begin),
(gt,":party_id_003",0),
(neq,":var001",3),
(neq,":var001",5),
(party_is_active,":party_id_003"),
(str_store_string,s4,":str_store_party_name(party_id_003)"),
(display_message, "@@{!}Center: {s4}"),
(try_end),
(try_begin),
(gt,":troop_id_004",0),
(neq,":var001",3),
(neq,":var001",5),
(str_store_string,s4,":str_store_troop_name(troop_id_004)"),
(display_message, "@@{!}Troop: {s4}"),
(try_end),
(try_begin),
(gt,":party_slot_006",0),
(neq,":var001",3),
(neq,":var001",5),
(str_store_string,s4,":str_store_troop_name(party_slot_006)"),
(display_message, "@@{!}Lord: {s4}"),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":var001",18),
(this_or_next|eq,":var001",19),
(eq,":var001",11),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "@@{!}Ally party is present"),
(try_end),
(try_for_range, ":trp_010", ":trp.npc1", ":trp.knight_1_1_wife"),
(party_count_companions_of_type,":party_companions_of_type_011","p_collective_friends",":trp_010"),
(gt,":party_companions_of_type_011",0),
(troop_set_slot,":trp_010",9,"$num_log_entries"),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(trp_010)"),
(display_message, "@@{!}{s4} is present at event"),
(try_end),
(try_end),
]),

("get_relevant_comment_for_log_entry", [
(store_script_param, ":slot_no_001", 1),
(troop_get_slot,":troop_slot_002","trp_log_array_entry_type",":slot_no_001"),
(troop_get_slot,":troop_slot_003","trp_log_array_entry_time",":slot_no_001"),
(troop_get_slot,":troop_slot_004","trp_log_array_actor",":slot_no_001"),
(troop_get_slot,":troop_slot_005","trp_log_array_center_object",":slot_no_001"),
(troop_get_slot,":troop_slot_006","trp_log_array_center_object_lord",":slot_no_001"),
(troop_get_slot,":troop_slot_007","trp_log_array_center_object_faction",":slot_no_001"),
(troop_get_slot,":troop_slot_008","trp_log_array_troop_object",":slot_no_001"),
(troop_get_slot,":troop_slot_009","trp_log_array_troop_object_faction",":slot_no_001"),
(troop_get_slot,":troop_slot_010","trp_log_array_faction_object",":slot_no_001"),
(assign,":var011",0),
(assign,":var012",-1),
(assign,":var013",-1),
(assign,":var014",0),
(troop_get_slot,":troop_slot_015","$g_talk_troop",52),
(store_current_hours,":cur_hours_016"),
(store_sub, ":var017", ":cur_hours_016", ":troop_slot_003"),
(assign,":faction_relation_018",0),
(try_begin),
(gt,":::players_kingdom",0),
(store_relation,":faction_relation_018","$players_kingdom",":troop_slot_009"),
(try_end),
(try_begin),
(eq,":::cheat_mode",-1),
(try_begin),
(eq,1,1),
(assign,reg5,":slot_no_001"),
(assign,reg6,":troop_slot_002"),
(assign,reg8,":troop_slot_003"),
(try_begin),
(gt,":::players_kingdom",0),
(try_begin),
(gt,":troop_slot_009",0),
(assign,reg7,":faction_relation_018"),
(display_message, "@@{!}Event"),
(else_try),
(gt,":troop_slot_007",0),
(assign,reg7,":faction_relation_018"),
(display_message, "@@{!}Event"),
(else_try),
(gt,":troop_slot_010",0),
(assign,reg7,":faction_relation_018"),
(display_message, "@@{!}Event"),
(else_try),
(display_message, "@@{!}Event"),
(try_end),
(try_end),
(else_try),
(display_message, "@@{!}Event"),
(try_end),
(try_end),
(try_begin),
(eq,":troop_slot_002",45),
(eq,":::g_talk_troop_met",0),
(is_between,"$g_talk_troop_faction_relation",-5,5),
(is_between,"$g_talk_troop_relation",-5,5),
(assign,":var011",25),
(troop_get_slot,":troop_slot_019","trp_player",7),
(troop_get_slot,":troop_slot_020","trp_player",13),
(store_random_in_range,":random_x_021",100,200),
(try_begin),
(eq,":troop_slot_015",0),
(gt,":::players_kingdom",0),
(assign,":var012","str_comment_intro_liege_affiliated"),
(try_begin),
(faction_slot_eq,"$players_kingdom",11,"trp_player"),
(assign,":var012","str_comment_intro_liege_affiliated_to_player"),
(try_end),
(else_try),
(eq,":::character_gender",1),
(call_script, "script_troop_get_romantic_chemistry_with_troop", "$g_talk_troop", "trp_player"),
(assign,":var022",reg0),
(store_random_in_range,":random_x_023",0,2),
(try_begin),
(this_or_next|eq,":random_x_023",0),
(gt,":var022",10),
(try_begin),
(this_or_next|gt,":troop_slot_019",":random_x_021"),
(eq,":::g_disable_condescending_comments",1),
(assign,":var012","str_comment_intro_female_famous_liege"),
(val_add, ":var012", ":troop_slot_015"),
(else_try),
(ge,":var022",9),
(assign,":var012","str_comment_intro_female_admiring_liege"),
(val_add, ":var012", ":troop_slot_015"),
(else_try),
(gt,":troop_slot_020",0),
(assign,":var012","str_comment_intro_female_noble_liege"),
(val_add, ":var012", ":troop_slot_015"),
(else_try),
(assign,":var012","str_comment_intro_female_common_liege"),
(val_add, ":var012", ":troop_slot_015"),
(try_end),
(try_end),
(try_begin),
(eq,":var012","str_comment_intro_female_common_badtempered"),
(assign,":var013","str_rejoinder_intro_female_common_badtempered"),
(else_try),
(eq,":var012","str_comment_intro_female_noble_pitiless"),
(assign,":var013","str_rejoinder_intro_female_noble_pitiless"),
(else_try),
(eq,":var012","str_comment_intro_female_common_pitiless"),
(assign,":var013","str_rejoinder_intro_female_common_pitiless"),
(else_try),
(eq,":var012","str_comment_intro_female_noble_sadistic"),
(assign,":var013","str_rejoinder_intro_female_noble_sadistic"),
(else_try),
(eq,":var012","str_comment_intro_female_common_sadistic"),
(assign,":var013","str_rejoinder_intro_female_common_sadistic"),
(else_try),
(eq,":var012","str_comment_intro_female_common_upstanding"),
(assign,":var013","str_rejoinder_intro_female_common_upstanding"),
(else_try),
(eq,":var012","str_comment_intro_female_noble_upstanding"),
(assign,":var013","str_rejoinder_intro_female_noble_upstanding"),
(else_try),
(eq,":var012","str_comment_intro_female_common_martial"),
(assign,":var013","str_rejoinder_intro_female_common_martial"),
(else_try),
(eq,":var012","str_comment_intro_female_sadistic_admiring"),
(assign,":var013","str_rejoinder_intro_female_sadistic_admiring"),
(else_try),
(eq,":var012","str_comment_intro_female_badtempered_admiring"),
(assign,":var013","str_rejoinder_intro_female_badtempered_admiring"),
(else_try),
(eq,":var012","str_comment_intro_female_pitiless_admiring"),
(assign,":var013","str_rejoinder_intro_female_pitiless_admiring"),
(try_end),
(else_try),
(try_begin),
(gt,":troop_slot_019",":random_x_021"),
(assign,":var012","str_comment_intro_famous_liege"),
(val_add, ":var012", ":troop_slot_015"),
(else_try),
(gt,":troop_slot_020",0),
(assign,":var012","str_comment_intro_noble_liege"),
(val_add, ":var012", ":troop_slot_015"),
(try_begin),
(eq,":var012","str_comment_intro_noble_sadistic"),
(assign,":var013","str_rejoinder_intro_noble_sadistic"),
(try_end),
(else_try),
(assign,":var012","str_comment_intro_common_liege"),
(val_add, ":var012", ":troop_slot_015"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",1),
(eq,":troop_slot_004","trp_player"),
(try_begin),
(eq,":troop_slot_006",":::g_talk_troop"),
(assign,":var011",200),
(assign,":var014",-1),
(assign,":var012","str_comment_you_raided_my_village_default"),
(try_begin),
(lt,":::g_talk_troop_faction_relation",-5),
(this_or_next|eq,":troop_slot_015",6),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_you_raided_my_village_enemy_benevolent"),
(else_try),
(lt,":::g_talk_troop_faction_relation",-5),
(this_or_next|eq,":troop_slot_015",4),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_raided_my_village_enemy_coldblooded"),
(else_try),
(lt,":::g_talk_troop_faction_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_raided_my_village_enemy_spiteful"),
(else_try),
(lt,":::g_talk_troop_faction_relation",-5),
(assign,":var012","str_comment_you_raided_my_village_enemy"),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_raided_my_village_unfriendly_spiteful"),
(else_try),
(gt,":::g_talk_troop_relation",5),
(assign,":var012","str_comment_you_raided_my_village_friendly"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",2),
(eq,":troop_slot_004","trp_player"),
(try_begin),
(eq,":troop_slot_006",":::g_talk_troop"),
(assign,":var011",30),
(assign,":var014",-1),
(assign,":var012","str_comment_you_robbed_my_village_default"),
(try_begin),
(lt,":::g_talk_troop_faction_relation",-5),
(this_or_next|eq,":troop_slot_015",4),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_robbed_my_village_enemy_coldblooded"),
(else_try),
(lt,":::g_talk_troop_faction_relation",-5),
(assign,":var012","str_comment_you_robbed_my_village_enemy"),
(else_try),
(gt,":::g_talk_troop_relation",5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_robbed_my_village_friendly_spiteful"),
(else_try),
(gt,":::g_talk_troop_relation",5),
(assign,":var012","str_comment_you_robbed_my_village_friendly"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",3),
(eq,":troop_slot_004","trp_player"),
(eq,":troop_slot_010",":::g_talk_troop_faction"),
(eq,":troop_slot_005",-1),
(eq,":troop_slot_008",-1),
(faction_slot_eq,"$g_talk_troop_faction",11,"$g_talk_troop"),
(assign,":var011",30),
(assign,":var014",-1),
(assign,":var012","str_comment_you_accosted_my_caravan_default"),
(try_begin),
(lt,":::g_talk_troop_faction_relation",-5),
(assign,":var012","str_comment_you_accosted_my_caravan_enemy"),
(try_end),
(else_try),
(eq,":troop_slot_002",4),
(eq,":troop_slot_004","trp_player"),
(try_begin),
(eq,":troop_slot_006",":::g_talk_troop"),
(assign,":var011",40),
(assign,":var014",0),
(try_begin),
(this_or_next|eq,":troop_slot_015",7),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_helped_villagers_benevolent"),
(assign,":var014",1),
(else_try),
(gt,":::g_talk_troop_relation",5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_helped_villagers_friendly_cruel"),
(assign,":var014",-1),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_helped_villagers_unfriendly_spiteful"),
(assign,":var014",-1),
(else_try),
(gt,":::g_talk_troop_relation",5),
(assign,":var012","str_comment_you_helped_villagers_friendly"),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_helped_villagers_cruel"),
(assign,":var014",-1),
(else_try),
(assign,":var012","str_comment_you_helped_villagers_default"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",10),
(try_begin),
(eq,":troop_slot_006",":::g_talk_troop"),
(store_faction_of_party, ":party_faction_024", ":troop_slot_005"),
(try_begin),
(eq,":party_faction_024",":::players_kingdom"),
(neq,":::g_talk_troop_faction",":::players_kingdom"),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_captured_my_castle_enemy_spiteful"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_006",":::g_talk_troop"),
(store_faction_of_party, ":party_faction_024", ":troop_slot_005"),
(try_begin),
(eq,":party_faction_024",":::players_kingdom"),
(neq,":::g_talk_troop_faction",":::players_kingdom"),
(this_or_next|eq,":troop_slot_015",1),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_captured_my_castle_enemy_chivalrous"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_006",":::g_talk_troop"),
(store_faction_of_party, ":party_faction_024", ":troop_slot_005"),
(try_begin),
(eq,":party_faction_024",":::players_kingdom"),
(neq,":::g_talk_troop_faction",":::players_kingdom"),
(assign,":var012","str_comment_you_captured_my_castle_enemy"),
(assign,":var011",200),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_captured_a_castle_allied_spiteful"),
(assign,":var011",75),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(gt,":::g_talk_troop_relation",5),
(assign,":var012","str_comment_you_captured_a_castle_allied_friendly"),
(assign,":var011",75),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_captured_a_castle_allied_unfriendly_spiteful"),
(assign,":var011",75),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(lt,":::g_talk_troop_relation",-5),
(assign,":var012","str_comment_you_captured_a_castle_allied_unfriendly"),
(assign,":var011",75),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(assign,":var012","str_comment_you_captured_a_castle_allied"),
(assign,":var011",75),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",24),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(faction_slot_eq,"$g_talk_troop_faction",11,"$g_talk_troop"),
(assign,":var012","str_comment_you_claimed_the_throne_1_player_liege"),
(assign,":var011",500),
(try_begin),
(lt,":::g_talk_troop_relation",-10),
(else_try),
(eq,":troop_slot_002",25),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(faction_slot_eq,"$g_talk_troop_faction",11,"$g_talk_troop"),
(assign,":var012","str_comment_you_claimed_the_throne_2_player_liege"),
(assign,":var011",500),
(try_begin),
(lt,":::g_talk_troop_relation",-10),
(else_try),
(eq,":troop_slot_002",22),
(eq,":troop_slot_004","trp_player"),
(troop_slot_ge,":troop_slot_008",52,8),
(try_begin),
(this_or_next|eq,":troop_slot_015",7),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_enfiefed_a_commoner_nasty"),
(assign,":var011",100),
(assign,":var014",-3),
(else_try),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_you_enfiefed_a_commoner_hesitant"),
(assign,":var011",100),
(assign,":var014",-2),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_enfiefed_a_commoner_derisive"),
(assign,":var011",100),
(assign,":var014",-4),
(try_end),
(try_end),
(try_end),
(else_try),
(this_or_next|eq,":troop_slot_002",11),
(eq,":troop_slot_002",17),
(troop_slot_eq,"$g_talk_troop",9,":slot_no_001"),
(try_begin),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_we_defeated_a_lord_unfriendly_spiteful"),
(assign,":var011",150),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(assign,":var012","str_comment_we_defeated_a_lord_unfriendly"),
(assign,":var011",150),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_we_defeated_a_lord_cruel"),
(assign,":var011",150),
(else_try),
(eq,":troop_slot_015",2),
(assign,":var012","str_comment_we_defeated_a_lord_cruel"),
(assign,":var011",150),
(else_try),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_we_defeated_a_lord_upstanding"),
(assign,":var011",150),
(else_try),
(assign,":var012","str_comment_we_defeated_a_lord_default"),
(assign,":var011",150),
(try_end),
(else_try),
(this_or_next|eq,":troop_slot_002",10),
(eq,":troop_slot_002",18),
(troop_slot_eq,"$g_talk_troop",9,":slot_no_001"),
(try_begin),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_we_fought_in_siege_unfriendly_spiteful"),
(assign,":var011",150),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(assign,":var012","str_comment_we_fought_in_siege_unfriendly"),
(assign,":var011",150),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_we_fought_in_siege_cruel"),
(assign,":var011",150),
(assign,":var014",1),
(else_try),
(eq,":troop_slot_015",2),
(assign,":var012","str_comment_we_fought_in_siege_quarrelsome"),
(assign,":var011",150),
(assign,":var014",1),
(else_try),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_we_fought_in_siege_upstanding"),
(assign,":var011",150),
(assign,":var014",1),
(else_try),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_we_fought_in_siege_default"),
(assign,":var011",150),
(assign,":var014",2),
(else_try),
(faction_slot_eq,"$players_kingdom",11,"$g_talk_troop"),
(assign,":var012","str_comment_we_fought_in_siege_default"),
(assign,":var011",150),
(assign,":var014",1),
(else_try),
(assign,":var012","str_comment_we_fought_in_siege_default"),
(assign,":var011",150),
(assign,":var014",1),
(try_end),
(else_try),
(eq,":troop_slot_002",20),
(try_begin),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_give_castle_in_my_control"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",1),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_give_castle_in_my_control"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(assign,":var012","str_comment_you_give_castle_in_my_control"),
(assign,":var011",200),
(try_end),
(else_try),
(eq,":troop_slot_002",19),
(troop_slot_eq,"$g_talk_troop",9,":slot_no_001"),
(try_begin),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_we_fought_in_major_battle_unfriendly_spiteful"),
(assign,":var011",150),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(assign,":var012","str_comment_we_fought_in_major_battle_unfriendly"),
(assign,":var011",150),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_we_fought_in_major_battle_cruel"),
(assign,":var011",150),
(assign,":var014",1),
(else_try),
(eq,":troop_slot_015",2),
(assign,":var012","str_comment_we_fought_in_major_battle_cruel"),
(assign,":var011",150),
(assign,":var014",1),
(else_try),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_we_fought_in_major_battle_upstanding"),
(assign,":var011",150),
(assign,":var014",1),
(else_try),
(faction_slot_eq,"$players_kingdom",11,"$g_talk_troop"),
(assign,":var012","str_comment_we_fought_in_major_battle_default"),
(assign,":var011",150),
(assign,":var014",1),
(else_try),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_we_fought_in_major_battle_default"),
(assign,":var011",150),
(assign,":var014",2),
(else_try),
(assign,":var012","str_comment_we_fought_in_major_battle_default"),
(assign,":var011",150),
(assign,":var014",1),
(try_end),
(else_try),
(eq,":troop_slot_002",35),
(try_begin),
(eq,":troop_slot_008",":::g_talk_troop"),
(assign,":var012","str_comment_player_suggestion_succeeded"),
(assign,":var011",200),
(assign,":var014",3),
(try_end),
(else_try),
(eq,":troop_slot_002",36),
(try_begin),
(eq,":troop_slot_008",":::g_talk_troop"),
(assign,":var012","str_comment_player_suggestion_failed"),
(assign,":var011",200),
(assign,":var014",-5),
(try_end),
(else_try),
(eq,":troop_slot_002",11),
(try_begin),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",1),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_defeated_me_enemy_chivalrous"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",2),
(assign,":var012","str_comment_you_defeated_me_enemy_spiteful"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(assign,":var012","str_comment_you_defeated_me_enemy"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_009",":::g_talk_troop_faction"),
(this_or_next|eq,":troop_slot_015",7),
(eq,":troop_slot_015",4),
(assign,":var012","str_comment_you_defeated_my_friend_enemy_pragmatic"),
(assign,":var011",85),
(else_try),
(eq,":troop_slot_009",":::g_talk_troop_faction"),
(this_or_next|eq,":troop_slot_015",1),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_defeated_my_friend_enemy_chivalrous"),
(assign,":var011",85),
(else_try),
(eq,":troop_slot_009",":::g_talk_troop_faction"),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_defeated_my_friend_enemy_spiteful"),
(assign,":var011",85),
(else_try),
(eq,":troop_slot_009",":::g_talk_troop_faction"),
(assign,":var012","str_comment_you_defeated_my_friend_enemy"),
(assign,":var011",85),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(faction_slot_eq,"$players_kingdom",11,"$g_talk_troop"),
(assign,":var012","str_comment_you_defeated_a_lord_allied_liege"),
(assign,":var011",150),
(assign,":var014",1),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_defeated_a_lord_allied_unfriendly_spiteful"),
(assign,":var011",65),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_defeated_a_lord_allied_spiteful"),
(assign,":var011",65),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",7),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_you_defeated_a_lord_allied_unfriendly_chivalrous"),
(assign,":var011",65),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(assign,":var012","str_comment_you_defeated_a_lord_allied"),
(assign,":var011",65),
(try_end),
(else_try),
(eq,":troop_slot_002",11),
(try_begin),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",1),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_defeated_me_enemy_chivalrous"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",2),
(assign,":var012","str_comment_you_defeated_me_enemy_spiteful"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(assign,":var012","str_comment_you_defeated_me_enemy"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_009",":::g_talk_troop_faction"),
(this_or_next|eq,":troop_slot_015",7),
(eq,":troop_slot_015",4),
(assign,":var012","str_comment_you_defeated_my_friend_enemy_pragmatic"),
(assign,":var011",85),
(else_try),
(eq,":troop_slot_009",":::g_talk_troop_faction"),
(this_or_next|eq,":troop_slot_015",1),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_defeated_my_friend_enemy_chivalrous"),
(assign,":var011",85),
(else_try),
(eq,":troop_slot_009",":::g_talk_troop_faction"),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_defeated_my_friend_enemy_spiteful"),
(assign,":var011",85),
(else_try),
(eq,":troop_slot_009",":::g_talk_troop_faction"),
(assign,":var012","str_comment_you_defeated_my_friend_enemy"),
(assign,":var011",85),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(faction_slot_eq,"$players_kingdom",11,"$g_talk_troop"),
(assign,":var012","str_comment_you_defeated_a_lord_allied_liege"),
(assign,":var011",70),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_defeated_a_lord_allied_unfriendly_spiteful"),
(assign,":var011",65),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_defeated_a_lord_allied_spiteful"),
(assign,":var011",65),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",7),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_you_defeated_a_lord_allied_unfriendly_chivalrous"),
(assign,":var011",65),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(assign,":var012","str_comment_you_defeated_a_lord_allied"),
(assign,":var011",65),
(try_end),
(else_try),
(eq,":troop_slot_002",17),
(neq,":troop_slot_008",":::g_talk_troop"),
(eq,":troop_slot_009",":::g_talk_troop_faction"),
(try_begin),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",7),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_you_helped_my_ally_unfriendly_chivalrous"),
(assign,":var011",65),
(assign,":var014",2),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(assign,":var012","str_comment_you_helped_my_ally_unfriendly"),
(assign,":var011",0),
(else_try),
(eq,":troop_slot_015",0),
(assign,":var012","str_comment_you_helped_my_ally_liege"),
(assign,":var011",65),
(assign,":var014",3),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_helped_my_ally_unfriendly_spiteful"),
(assign,":var011",65),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_helped_my_ally_spiteful"),
(assign,":var011",65),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_helped_my_ally_chivalrous"),
(assign,":var011",65),
(assign,":var014",2),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(assign,":var012","str_comment_you_helped_my_ally_default"),
(try_end),
(else_try),
(eq,":troop_slot_002",14),
(troop_slot_eq,"$g_talk_troop",9,":slot_no_001"),
(try_begin),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_we_were_defeated_unfriendly_spiteful"),
(assign,":var011",150),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(assign,":var012","str_comment_we_were_defeated_unfriendly"),
(assign,":var011",150),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_we_were_defeated_cruel"),
(assign,":var011",150),
(else_try),
(assign,":var012","str_comment_we_were_defeated_default"),
(assign,":var011",150),
(try_end),
(else_try),
(eq,":troop_slot_002",14),
(try_begin),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_i_defeated_you_enemy_spiteful"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_i_defeated_you_enemy_chivalrous"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",6),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_i_defeated_you_enemy_benevolent"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",3),
(eq,":troop_slot_015",4),
(assign,":var012","str_comment_i_defeated_you_enemy_coldblooded"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(assign,":var012","str_comment_i_defeated_you_enemy"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(assign,":var012","str_comment_i_defeated_you_enemy"),
(assign,":var011",200),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(gt,":::g_talk_troop_relation",5),
(assign,":var012","str_comment_you_were_defeated_allied_friendly_spiteful"),
(assign,":var011",80),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(this_or_next|eq,":troop_slot_015",3),
(eq,":troop_slot_015",5),
(lt,":::g_talk_troop_relation",-5),
(assign,":var012","str_comment_you_were_defeated_allied_unfriendly_cruel"),
(assign,":var011",80),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(le,":::g_talk_troop_relation",5),
(assign,":var012","str_comment_you_were_defeated_allied_spiteful"),
(assign,":var011",80),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_were_defeated_allied_pitiless"),
(assign,":var011",65),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(eq,":troop_slot_015",7),
(lt,":::g_talk_troop_relation",-15),
(assign,":var012","str_comment_you_were_defeated_allied_unfriendly_upstanding"),
(assign,":var011",65),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":::g_talk_troop_relation",-10),
(assign,":var012","str_comment_you_were_defeated_allied_unfriendly"),
(assign,":var011",65),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(assign,":var012","str_comment_you_were_defeated_allied"),
(assign,":var011",65),
(try_end),
(else_try),
(eq,":troop_slot_002",15),
(troop_slot_eq,"$g_talk_troop",9,":slot_no_001"),
(try_begin),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_abandoned_us_unfriendly_spiteful"),
(assign,":var011",150),
(assign,":var014",-5),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_abandoned_us_unfriendly_pitiless"),
(assign,":var011",150),
(assign,":var014",-5),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_abandoned_us_spiteful"),
(assign,":var014",-5),
(else_try),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_you_abandoned_us_chivalrous"),
(assign,":var011",150),
(assign,":var014",-2),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_abandoned_us_benefitofdoubt"),
(assign,":var011",150),
(assign,":var014",-1),
(else_try),
(assign,":var012","str_comment_you_abandoned_us_default"),
(assign,":var011",150),
(assign,":var014",-2),
(try_end),
(else_try),
(this_or_next|eq,":troop_slot_002",15),
(eq,":troop_slot_002",16),
(eq,":troop_slot_008",":::g_talk_troop"),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg7,":var017"),
(display_message, "@@{!}Elapsed hours: {reg7}"),
(try_end),
(try_begin),
(gt,":var017",2),
(try_begin),
(this_or_next|eq,":troop_slot_015",7),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_ran_from_me_enemy_spiteful"),
(assign,":var011",25),
(else_try),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_you_ran_from_me_enemy_chivalrous"),
(assign,":var011",25),
(else_try),
(this_or_next|eq,":troop_slot_015",5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_ran_from_me_enemy_benevolent"),
(assign,":var011",25),
(else_try),
(eq,":troop_slot_015",4),
(assign,":var012","str_comment_you_ran_from_me_enemy_coldblooded"),
(assign,":var011",25),
(else_try),
(assign,":var012","str_comment_you_ran_from_me_enemy"),
(assign,":var011",25),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",16),
(try_begin),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(neq,":troop_slot_008",":::g_talk_troop"),
(lt,":::g_talk_troop_relation",5),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_you_ran_from_foe_allied_chivalrous"),
(assign,":var011",80),
(assign,":var014",-3),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(neq,":troop_slot_008",":::g_talk_troop"),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_you_ran_from_foe_allied_upstanding"),
(assign,":var011",80),
(assign,":var014",-1),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(neq,":troop_slot_008",":::g_talk_troop"),
(lt,":::g_talk_troop_relation",5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_ran_from_foe_allied_spiteful"),
(assign,":var011",80),
(try_end),
(else_try),
(eq,":troop_slot_002",13),
(try_begin),
(eq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_let_me_go_spiteful"),
(assign,":var011",300),
(assign,":var014",-15),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(ge,":::g_talk_troop_faction_relation",0),
(assign,":var012","str_comment_you_let_me_go_default"),
(assign,":var011",300),
(assign,":var014",2),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(lt,":::g_talk_troop_faction_relation",0),
(this_or_next|eq,":troop_slot_015",1),
(eq,":troop_slot_015",7),
(assign,":var014",5),
(assign,":var011",300),
(assign,":var012","str_comment_you_let_me_go_enemy_chivalrous"),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(lt,":::g_talk_troop_faction_relation",0),
(this_or_next|eq,":troop_slot_015",3),
(eq,":troop_slot_015",4),
(assign,":var011",300),
(assign,":var012","str_comment_you_let_me_go_enemy_coldblooded"),
(else_try),
(eq,":troop_slot_008",":::g_talk_troop"),
(lt,":::g_talk_troop_faction_relation",0),
(assign,":var011",300),
(assign,":var012","str_comment_you_let_me_go_enemy"),
(assign,":var014",1),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(neq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",1),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_let_go_a_lord_allied_chivalrous"),
(assign,":var011",80),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(neq,":troop_slot_008",":::g_talk_troop"),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_you_let_go_a_lord_allied_upstanding"),
(assign,":var011",80),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(neq,":troop_slot_008",":::g_talk_troop"),
(this_or_next|eq,":troop_slot_015",4),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_let_go_a_lord_allied_coldblooded"),
(assign,":var011",80),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(neq,":troop_slot_008",":::g_talk_troop"),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_let_go_a_lord_allied_unfriendly_spiteful"),
(assign,":var011",80),
(else_try),
(eq,":::players_kingdom",":::g_talk_troop_faction"),
(lt,":faction_relation_018",0),
(neq,":troop_slot_008",":::g_talk_troop"),
(assign,":var012","str_comment_you_let_go_a_lord_allied"),
(assign,":var011",80),
(try_end),
(else_try),
(eq,":troop_slot_002",21),
(eq,":troop_slot_004","trp_player"),
(try_begin),
(eq,":troop_slot_010",":::g_talk_troop_faction"),
(neq,":troop_slot_008",":::g_talk_troop"),
(eq,":troop_slot_010",":::players_kingdom"),
(assign,":var011",200),
(try_begin),
(lt,":::g_talk_troop_relation",-5),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_pledged_allegiance_allied_martial_unfriendly"),
(else_try),
(eq,":troop_slot_015",1),
(assign,":var012","str_comment_pledged_allegiance_allied_martial"),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(eq,":troop_slot_015",2),
(assign,":var012","str_comment_pledged_allegiance_allied_quarrelsome_unfriendly"),
(else_try),
(eq,":troop_slot_015",2),
(assign,":var012","str_comment_pledged_allegiance_allied_quarrelsome"),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_pledged_allegiance_allied_selfrighteous_unfriendly"),
(else_try),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_pledged_allegiance_allied_selfrighteous"),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(eq,":troop_slot_015",4),
(assign,":var012","str_comment_pledged_allegiance_allied_cunning_unfriendly"),
(else_try),
(eq,":troop_slot_015",4),
(assign,":var012","str_comment_pledged_allegiance_allied_cunning"),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_pledged_allegiance_allied_debauched_unfriendly"),
(else_try),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_pledged_allegiance_allied_debauched"),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_pledged_allegiance_allied_goodnatured_unfriendly"),
(else_try),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_pledged_allegiance_allied_goodnatured"),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_pledged_allegiance_allied_upstanding_unfriendly"),
(else_try),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_pledged_allegiance_allied_upstanding"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",22),
(eq,":troop_slot_008","trp_player"),
(try_begin),
(eq,":troop_slot_010",":::g_talk_troop_faction"),
(neq,":troop_slot_004",":::g_talk_troop"),
(eq,":troop_slot_010",":::players_kingdom"),
(assign,":var011",110),
(try_begin),
(gt,":::g_talk_troop_relation",5),
(this_or_next|eq,":troop_slot_015",3),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_our_king_granted_you_a_fief_allied_friendly_cruel"),
(else_try),
(gt,":::g_talk_troop_relation",5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",4),
(assign,":var012","str_comment_our_king_granted_you_a_fief_allied_friendly_cynical"),
(else_try),
(gt,":::g_talk_troop_relation",5),
(assign,":var012","str_comment_our_king_granted_you_a_fief_allied_friendly"),
(else_try),
(is_between,"$g_talk_troop_relation",-5,5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_our_king_granted_you_a_fief_allied_spiteful"),
(assign,":var014",-2),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_our_king_granted_you_a_fief_allied_unfriendly_upstanding"),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_our_king_granted_you_a_fief_allied_unfriendly_spiteful"),
(else_try),
(assign,":var012","str_comment_our_king_granted_you_a_fief_allied"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",23),
(eq,":troop_slot_004","trp_player"),
(try_begin),
(eq,":troop_slot_010",":::g_talk_troop_faction"),
(neq,":troop_slot_008",":::g_talk_troop"),
(try_begin),
(ge,":::g_talk_troop_faction_relation",0),
(neq,":::g_talk_troop_faction",":::players_kingdom"),
(assign,":var011",180),
(try_begin),
(gt,":::g_talk_troop_relation",5),
(assign,":var012","str_comment_you_renounced_your_alliegance_friendly"),
(else_try),
(ge,":::g_talk_troop_relation",0),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_you_renounced_your_alliegance_friendly"),
(else_try),
(assign,":var012","str_comment_you_renounced_your_alliegance_default"),
(try_end),
(else_try),
(lt,":::g_talk_troop_faction_relation",0),
(assign,":var011",300),
(try_begin),
(ge,":::g_talk_troop_relation",0),
(this_or_next|eq,":troop_slot_015",3),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_renounced_your_alliegance_unfriendly_moralizing"),
(else_try),
(gt,":::g_talk_troop_relation",5),
(this_or_next|eq,":troop_slot_015",6),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_you_renounced_your_alliegance_enemy_friendly"),
(else_try),
(gt,":::g_talk_troop_relation",5),
(assign,":var012","str_comment_you_renounced_your_alliegance_enemy"),
(else_try),
(is_between,"$g_talk_troop_relation",-5,5),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_renounced_your_alliegance_unfriendly_spiteful"),
(assign,":var014",-2),
(else_try),
(lt,":::g_talk_troop_relation",-5),
(this_or_next|eq,":troop_slot_015",2),
(this_or_next|eq,":troop_slot_015",3),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_renounced_your_alliegance_unfriendly_spiteful"),
(else_try),
(assign,":var012","str_comment_you_renounced_your_alliegance_default"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",56),
(eq,":troop_slot_008","trp_player"),
(try_begin),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(lt,":::g_talk_troop_relation",-5),
(assign,":var011",200),
(assign,":var012","str_comment_marriage_normal_nasty"),
(else_try),
(call_script, "script_troop_get_family_relation_to_troop", ":troop_slot_004", "$g_talk_troop"),
(try_begin),
(ge,reg0,5),
(assign,":var012","str_comment_marriage_normal_family"),
(assign,":var011",300),
(assign,":var014",reg0),
(val_div, ":var014", 3),
(else_try),
(store_troop_faction,":troop_faction_025",":troop_slot_004"),
(try_begin),
(eq,":troop_faction_025",":::g_talk_troop_faction"),
(assign,":var012","str_comment_marriage_normal"),
(assign,":var011",100),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",57),
(eq,":troop_slot_008","trp_player"),
(try_begin),
(eq,1,1),
(call_script, "script_troop_get_family_relation_to_troop", ":troop_slot_004", "$g_talk_troop"),
(try_begin),
(ge,reg0,5),
(assign,":var012","str_comment_marriage_elopement_family"),
(assign,":var011",300),
(store_sub, ":var014", 0, reg0),
(val_div, ":var014", 3),
(else_try),
(store_troop_faction,":troop_faction_025",":troop_slot_004"),
(try_begin),
(eq,":troop_faction_025",":::g_talk_troop_faction"),
(faction_slot_eq,":troop_faction_025",11,"$g_talk_troop"),
(assign,":var012","str_comment_marriage_elopement_liege"),
(assign,":var011",300),
(assign,":var014",-10),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_002",31),
(eq,":troop_slot_004",":::g_talk_troop"),
(eq,":troop_slot_005","trp_player"),
(neg|troop_slot_ge,":troop_slot_008",30,"trp_player"),
(str_store_string,s54,":str_store_troop_name(troop_slot_008)"),
(try_begin),
(this_or_next|eq,":troop_slot_015",7),
(eq,":troop_slot_015",6),
(assign,":var012","str_comment_i_quarreled_with_you_over_woman_derisive"),
(assign,":var011",200),
(assign,":var014",-20),
(else_try),
(assign,":var012","str_comment_i_quarreled_with_you_over_woman_default"),
(assign,":var011",200),
(assign,":var014",-20),
(try_end),
(else_try),
(eq,":troop_slot_002",77),
(eq,":troop_slot_004","trp_player"),
(faction_slot_eq,":troop_slot_010",11,"$g_talk_troop"),
(eq,":::players_kingdom",":troop_slot_010"),
(assign,":var014",-10),
(assign,":var012","str_comment_you_broke_truce_as_my_vassal"),
(assign,":var011",300),
(else_try),
(eq,":troop_slot_002",76),
(eq,":troop_slot_004","trp_player"),
(faction_slot_eq,":troop_slot_010",11,"$g_talk_troop"),
(eq,":::players_kingdom",":troop_slot_010"),
(assign,":var014",-3),
(assign,":var012","str_comment_you_attacked_neutral_as_my_vassal"),
(assign,":var011",200),
(else_try),
(eq,":troop_slot_002",27),
(eq,":troop_slot_005",":::g_talk_troop"),
(str_store_string,s50,":str_store_troop_name(troop_slot_004)"),
(str_store_string,s51,":str_store_troop_name(troop_slot_005)"),
(str_store_string,s54,":str_store_troop_name(troop_slot_008)"),
(assign,":var012","str_comment_lord_intervened_against_me"),
(assign,":var011",-1),
(else_try),
(eq,":troop_slot_002",32),
(eq,":troop_slot_004",":::g_talk_troop"),
(str_store_string,s51,":str_store_troop_name(troop_slot_005)"),
(str_store_string,s54,":str_store_troop_name(troop_slot_008)"),
(assign,":var012","str_comment_i_protested_marshall_appointment"),
(assign,":var011",-1),
(else_try),
(eq,":troop_slot_002",33),
(eq,":troop_slot_004",":::g_talk_troop"),
(str_store_string,s51,":str_store_troop_name(troop_slot_005)"),
(str_store_string,s54,":str_store_troop_name(troop_slot_008)"),
(str_store_string,s56,":str_store_troop_name(troop_slot_010)"),
(assign,":var012","str_comment_i_blamed_defeat"),
(assign,":var011",-1),
(else_try),
(eq,":troop_slot_002",26),
(eq,":troop_slot_004",":::g_talk_troop"),
(str_store_string,s51,":str_store_party_name(troop_slot_005)"),
(str_store_string,s54,":str_store_troop_name(troop_slot_008)"),
(str_store_string,s56,":str_store_troop_name(troop_slot_010)"),
(assign,":var012","str_comment_i_was_entitled_to_fief"),
(assign,":var011",-1),
(else_try),
(eq,":troop_slot_002",31),
(eq,":troop_slot_004",":::g_talk_troop"),
(str_store_string,s51,":str_store_troop_name(troop_slot_005)"),
(str_store_string,s54,":str_store_troop_name(troop_slot_008)"),
(assign,":var012","str_comment_i_quarreled_with_troop_over_woman"),
(assign,":var011",-1),
(else_try),
(eq,":troop_slot_002",31),
(eq,":troop_slot_005",":::g_talk_troop"),
(str_store_string,s51,":str_store_troop_name(troop_slot_004)"),
(str_store_string,s54,":str_store_troop_name(troop_slot_008)"),
(assign,":var012","str_comment_i_quarreled_with_troop_over_woman"),
(assign,":var011",-1),
(else_try),
(eq,":troop_slot_002",66),
(eq,":troop_slot_004","trp_player"),
(try_begin),
(eq,":troop_slot_006",":::g_talk_troop"),
(assign,":var011",200),
(assign,":var014",-1),
(assign,":var012","str_comment_you_stole_cattles_from_my_village_default"),
(try_begin),
(lt,":::g_talk_troop_faction_relation",-3),
(this_or_next|eq,":troop_slot_015",6),
(eq,":troop_slot_015",7),
(assign,":var012","str_comment_you_stole_cattles_from_my_village_enemy_benevolent"),
(else_try),
(lt,":::g_talk_troop_faction_relation",-3),
(this_or_next|eq,":troop_slot_015",4),
(eq,":troop_slot_015",3),
(assign,":var012","str_comment_you_stole_cattles_from_my_village_enemy_coldblooded"),
(else_try),
(lt,":::g_talk_troop_faction_relation",-3),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_stole_cattles_from_my_village_enemy_spiteful"),
(else_try),
(lt,":::g_talk_troop_faction_relation",-3),
(assign,":var012","str_comment_you_stole_cattles_from_my_village_enemy"),
(else_try),
(lt,":::g_talk_troop_relation",-3),
(this_or_next|eq,":troop_slot_015",2),
(eq,":troop_slot_015",5),
(assign,":var012","str_comment_you_stole_cattles_from_my_village_unfriendly_spiteful"),
(else_try),
(gt,":::g_talk_troop_relation",6),
(assign,":var012","str_comment_you_stole_cattles_from_my_village_friendly"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var012"),
(assign,reg1,":var011"),
(assign,reg2,":var014"),
(assign,reg3,":var013"),
]),

("get_relevant_comment_to_s42", [
(troop_get_slot,":troop_slot_001","$g_talk_troop",52),
(try_begin),
(eq,":::cheat_mode",1),
(store_add, ":var002", ":troop_slot_001", ":gstr.personality_archetypes"),
(str_store_string,s15,":str_store_string(var002)"),
(display_message, "@@{!}Reputation type: {s15}"),
(try_end),
(assign,":var003",50),
(assign,":var004",-1),
(assign,":var005",-1),
(assign,":var006",0),
(assign,":slot_no_007",-1),
(assign,":var008",0),
(store_current_hours,":cur_hours_009"),
(troop_get_slot,":troop_slot_010","$g_talk_troop",29),
(troop_set_slot,"$g_talk_troop",29,"$num_log_entries"),
(store_add, ":var011", "$num_log_entries", 1),
(try_for_range, ":slot_no_012", 1, ":var011"),
(troop_get_slot,":troop_slot_013","trp_log_array_entry_time",":slot_no_012"),
(store_sub, ":var014", ":cur_hours_009", ":troop_slot_013"),
(try_begin),
(le,":slot_no_012",":troop_slot_010"),
(try_begin),
(eq,":slot_no_012",":troop_slot_010"),
(eq,":::cheat_mode",1),
(assign,reg5,":slot_no_012"),
(display_message, "@@{!}Entries up to"),
(try_end),
(else_try),
(call_script, "script_get_relevant_comment_for_log_entry", ":slot_no_012"),
(try_begin),
(gt,reg1,10),
(assign,":var015",reg1),
(assign,":var016",reg0),
(assign,":var017",reg3),
(store_random_in_range,":random_x_018",70,140),
(val_mul, ":var015", ":random_x_018"),
(store_add, ":var019", ":var014", 500),
(val_mul, ":var015", 1000),
(val_div, ":var015", ":var019"),
(try_begin),
(gt,":var015",":var003"),
(assign,":var003",":var015"),
(assign,":var004",":var016"),
(assign,":var005",":var017"),
(assign,":slot_no_007",":slot_no_012"),
(assign,":var008",reg2),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var004",0),
(assign,":var006",1),
(troop_get_slot,":troop_slot_020","trp_log_array_actor",":slot_no_007"),
(troop_get_slot,":troop_slot_021","trp_log_array_center_object",":slot_no_007"),
(troop_get_slot,":troop_slot_022","trp_log_array_center_object_lord",":slot_no_007"),
(troop_get_slot,":troop_slot_023","trp_log_array_center_object_faction",":slot_no_007"),
(troop_get_slot,":troop_slot_024","trp_log_array_troop_object",":slot_no_007"),
(troop_get_slot,":troop_slot_025","trp_log_array_troop_object_faction",":slot_no_007"),
(troop_get_slot,":troop_slot_026","trp_log_array_faction_object",":slot_no_007"),
(try_begin),
(ge,":troop_slot_020",0),
(str_store_string,s50,":str_store_troop_name(troop_slot_020)"),
(try_end),
(try_begin),
(ge,":troop_slot_021",0),
(str_store_string,s51,":str_store_party_name(troop_slot_021)"),
(try_end),
(try_begin),
(ge,":troop_slot_022",0),
(str_store_string,s52,":str_store_troop_name(troop_slot_022)"),
(try_end),
(try_begin),
(ge,":troop_slot_023",0),
(str_store_string,s53,":str_store_faction_name(troop_slot_023)"),
(try_end),
(try_begin),
(ge,":troop_slot_024",0),
(str_store_string,s54,":str_store_troop_name(troop_slot_024)"),
(try_end),
(try_begin),
(is_between,":troop_slot_025","fac_player_supporters_faction","fac_kingdoms_end"),
(str_store_string,s55,":str_store_faction_name(troop_slot_025)"),
(str_store_string,s55,":str_store_string("str_the_s55")"),
(else_try),
(is_between,":troop_slot_024","trp_bandit","trp_black_khergit_horseman"),
(str_store_string,s55,":str_store_string("str_bandits")"),
(else_try),
(eq,":troop_slot_025","fac_deserters"),
(str_store_string,s55,":str_store_string("str_deserters")"),
(else_try),
(str_store_string,s55,":str_store_string("str_travellers_on_the_road")"),
(try_end),
(try_begin),
(ge,":troop_slot_026",0),
(str_store_string,s56,":str_store_faction_name(troop_slot_026)"),
(try_end),
(assign,"$g_last_comment_copied_to_s42",":var004"),
(assign,"$g_rejoinder_to_last_comment",":var005"),
(str_store_string,s42,":str_store_string(var004)"),
(try_end),
(assign,reg0,":var006"),
(assign,"$log_comment_relation_change",":var008"),
]),

("merchant_road_info_to_s42", [
(store_script_param, ":party_id_001", 1),
(assign,":var002",-1),
(assign,":var003",-1),
(assign,":var004",-1),
(assign,":var005",-1),
(str_clear, 32),
(str_clear, 42),
(str_clear, 47),
(try_for_range, ":p_006", ":p.town_1", ":p.salt_mine"),
(party_set_slot,":p_006",248,0),
(try_end),
(assign,":var007",0),
(assign,":var008",0),
(try_for_range, ":var009", 0, ":::num_log_entries"),
(store_sub, ":slot_no_010", "$num_log_entries", ":var009"),
(try_begin),
(this_or_next|troop_slot_eq,"trp_log_array_entry_type",":slot_no_010",3),
(troop_slot_eq,"trp_log_array_entry_type",":slot_no_010",5),
(troop_get_slot,":troop_slot_011","trp_log_array_center_object",":slot_no_010"),
(troop_get_slot,":troop_slot_012","trp_log_array_troop_object",":slot_no_010"),
(this_or_next|eq,":troop_slot_011",":party_id_001"),
(eq,":troop_slot_012",":party_id_001"),
(troop_get_slot,":troop_slot_013","trp_log_array_entry_time",":slot_no_010"),
(store_current_hours,":cur_hours_014"),
(store_sub, ":var015", ":cur_hours_014", ":troop_slot_013"),
(assign,reg3,":var015"),
(lt,":var015",672),
(eq,":::cheat_mode",1),
(troop_slot_eq,"trp_log_array_entry_type",":slot_no_010",3),
(display_message, "str_attack_on_travellers_found_reg3_hours_ago"),
(else_try),
(eq,":::cheat_mode",1),
(troop_slot_eq,"trp_log_array_entry_type",":slot_no_010",5),
(display_message, "str_trade_event_found_reg3_hours_ago"),
(try_end),
(try_begin),
(lt,":var015",24),
(str_store_string,s46,":str_store_string("str_a_short_while_ago")"),
(else_try),
(lt,":var015",48),
(str_store_string,s46,":str_store_string("str_one_day_ago")"),
(else_try),
(lt,":var015",72),
(str_store_string,s46,":str_store_string("@two days ago")"),
(else_try),
(lt,":var015",154),
(str_store_string,s46,":str_store_string("str_earlier_this_week")"),
(else_try),
(lt,":var015",240),
(str_store_string,s46,":str_store_string("str_about_a_week_ago")"),
(else_try),
(lt,":var015",480),
(str_store_string,s46,":str_store_string("str_about_two_weeks_ago")"),
(else_try),
(str_store_string,s46,":str_store_string("str_several_weeks_ago")"),
(try_end),
(troop_get_slot,":troop_slot_016","trp_log_array_actor",":slot_no_010"),
(troop_get_slot,":troop_slot_017","trp_log_array_faction_object",":slot_no_010"),
(str_store_string,s39,":str_store_string("str_unknown_assailants")"),
(assign,":var018",-1),
(party_is_active,":troop_slot_016"),
(store_faction_of_party, ":party_faction_019", ":troop_slot_016"),
(try_begin),
(eq,":troop_slot_017",":party_faction_019"),
(assign,":var018",":troop_slot_016"),
(str_store_string,s39,":str_store_party_name(var018)"),
(assign,"$g_bandit_party_for_bounty",-1),
(try_begin),
(eq,":troop_slot_017","fac_kingdom_1"),
(str_store_string,s39,":str_store_string("str_swadians")"),
(else_try),
(eq,":troop_slot_017","fac_kingdom_2"),
(str_store_string,s39,":str_store_string("str_vaegirs")"),
(else_try),
(eq,":troop_slot_017","fac_kingdom_3"),
(str_store_string,s39,":str_store_string("str_khergits")"),
(else_try),
(eq,":troop_slot_017","fac_kingdom_4"),
(str_store_string,s39,":str_store_string("str_nords")"),
(else_try),
(eq,":troop_slot_017","fac_kingdom_5"),
(str_store_string,s39,":str_store_string("str_rhodoks")"),
(else_try),
(eq,":troop_slot_017","fac_kingdom_6"),
(str_store_string,s39,":str_store_string("str_sarranids")"),
(else_try),
(eq,":troop_slot_017","fac_player_supporters_faction"),
(str_store_string,s39,":str_store_string("str_your_followers")"),
(else_try),
(assign,":var002",":var018"),
(assign,":var003",":troop_slot_011"),
(assign,":var004",":troop_slot_012"),
(assign,":var005",":var015"),
(try_end),
(try_end),
(try_end),
(eq,":troop_slot_011",":party_id_001"),
(troop_slot_eq,"trp_log_array_entry_type",":slot_no_010",3),
(party_slot_eq,":troop_slot_012",248,0),
(party_set_slot,":troop_slot_012",248,1),
(str_store_string,s40,":str_store_party_name(troop_slot_012)"),
(str_store_string,s44,":str_store_string("str_we_have_heard_that_travellers_heading_to_s40_were_attacked_on_the_road_s46_by_s39")"),
(str_store_string,s43,":str_store_string("str_s42")"),
(str_store_string,s42,":str_store_string("str_s43_s44")"),
(val_add, ":var007", 1),
(else_try),
(eq,":troop_slot_012",":party_id_001"),
(troop_slot_eq,"trp_log_array_entry_type",":slot_no_010",3),
(party_slot_eq,":troop_slot_011",248,0),
(party_set_slot,":troop_slot_011",248,1),
(str_store_string,s40,":str_store_party_name(troop_slot_011)"),
(str_store_string,s44,":str_store_string("str_we_have_heard_that_travellers_coming_from_s40_were_attacked_on_the_road_s46_by_s39")"),
(str_store_string,s43,":str_store_string("str_s42")"),
(str_store_string,s42,":str_store_string("str_s43_s44")"),
(val_add, ":var007", 1),
(else_try),
(eq,":troop_slot_012",":party_id_001"),
(troop_slot_eq,"trp_log_array_entry_type",":slot_no_010",5),
(party_slot_eq,":troop_slot_011",248,0),
(party_set_slot,":troop_slot_011",248,1),
(str_store_string,s40,":str_store_party_name(troop_slot_011)"),
(str_store_string,s44,":str_store_string("str_travellers_coming_from_s40_traded_here_s46")"),
(str_store_string,s43,":str_store_string("str_s42")"),
(str_store_string,s42,":str_store_string("str_s43_s44")"),
(val_add, ":var008", 1),
(try_end),
(try_begin),
(le,":var008",2),
(eq,":var007",0),
(store_current_hours,":cur_hours_020"),
(try_begin),
(lt,":cur_hours_020",168),
(str_store_string,s42,":str_store_string("str_it_is_still_early_in_the_caravan_season_so_we_have_seen_little_tradings42")"),
(else_try),
(eq,":var008",0),
(eq,":var007",0),
(str_store_string,s42,":str_store_string("str_there_has_been_very_little_trading_activity_here_recentlys42")"),
(else_try),
(le,":var008",2),
(eq,":var007",0),
(str_store_string,s42,":str_store_string("str_there_has_some_trading_activity_here_recently_but_not_enoughs42")"),
(else_try),
(le,":var008",2),
(le,":var007",2),
(str_store_string,s42,":str_store_string("str_there_has_some_trading_activity_here_recently_but_the_roads_are_dangerouss42")"),
(else_try),
(ge,":var007",3),
(str_store_string,s42,":str_store_string("str_the_roads_around_here_are_very_dangerouss42")"),
(else_try),
(ge,":var007",1),
(str_store_string,s42,":str_store_string("str_we_have_received_many_traders_in_town_here_although_there_is_some_danger_on_the_roadss42")"),
(else_try),
(str_store_string,s42,":str_store_string("str_we_have_received_many_traders_in_town_heres42")"),
(try_end),
(try_end),
(assign,":var021",0),
(try_for_range, ":slot_no_022", 190, 205),
(party_get_slot,":party_slot_023",":party_id_001",":slot_no_022"),
(try_begin),
(is_between,":party_slot_023","p_town_1","p_salt_mine"),
(party_slot_eq,":party_slot_023",248,0),
(str_store_string,s41,":str_store_party_name(party_slot_023)"),
(try_begin),
(eq,":var021",1),
(str_store_string,s44,":str_store_string("str_s44_s41")"),
(else_try),
(str_store_string,s44,":str_store_string("str_s41")"),
(try_end),
(try_end),
(assign,":var021",1),
(try_end),
(try_begin),
(eq,":var021",1),
(str_store_string,s47,":str_store_string("str_there_is_little_news_about_the_caravan_routes_to_the_towns_of_s44_and_nearby_parts_but_no_news_is_good_news_and_those_are_therefore_considered_safe")"),
(try_end),
(assign,":var024",0),
(try_for_range, ":p_025", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_025",121,":party_id_001"),
(party_slot_eq,":p_025",248,0),
(str_store_string,s41,":str_store_party_name(p_025)"),
(try_begin),
(eq,":var024",1),
(str_store_string,s44,":str_store_string("str_s44_s41")"),
(else_try),
(str_store_string,s44,":str_store_string("str_s41")"),
(try_end),
(assign,":var024",1),
(try_end),
(try_begin),
(eq,":var024",1),
(eq,":var021",1),
(str_store_string,s47,":str_store_string("str_s47_also_the_roads_to_the_villages_of_s44_and_other_outlying_hamlets_are_considered_safe")"),
(else_try),
(eq,":var024",1),
(str_store_string,s47,":str_store_string("str_however_the_roads_to_the_villages_of_s44_and_other_outlying_hamlets_are_considered_safe")"),
(try_end),
(str_store_string,s33,":str_store_string("str_we_have_shortages_of")"),
(assign,":var026",0),
(try_for_range, ":itm_027", ":itm.spice", ":itm.siege_supply"),
(store_sub, ":slot_no_028", ":itm_027", ":itm.spice"),
(val_add, ":slot_no_028", 250),
(party_get_slot,":party_slot_029",":party_id_001",":slot_no_028"),
(try_begin),
(gt,":party_slot_029",1100),
(str_store_string,s34,":str_store_item_name(itm_027)"),
(assign,reg1,":party_slot_029"),
(str_store_string,s33,":str_store_string("str_s33_s34_reg1")"),
(assign,":var026",1),
(try_end),
(try_end),
(try_begin),
(eq,":var026",0),
(str_store_string,s32,":str_store_string("str_we_have_adequate_stores_of_all_commodities")"),
(else_try),
(str_store_string,s32,":str_store_string("str_s33_and_some_other_commodities")"),
(try_end),
(assign,reg0,":var002"),
(assign,reg1,":var003"),
(assign,reg2,":var004"),
(assign,reg3,":var005"),
]),

("get_manhunt_information_to_s15", [
(store_script_param, ":quest_id_001", 1),
(str_store_string,s15,":str_store_string("str_the_roads_are_full_of_brigands_friend_but_that_name_in_particular_does_not_sound_familiar_good_hunting_to_you_nonetheless")"),
(quest_get_slot,":quest_slot_002",":quest_id_001",8),
(try_begin),
(is_between,"$g_talk_troop","trp_npc1","trp_knight_1_1_wife"),
(troop_get_slot,":troop_slot_003","$g_talk_troop",10),
(else_try),
(gt,":::g_encountered_party","p_spawn_points_end"),
(assign,":troop_slot_003","$g_encountered_party"),
(else_try),
(assign,":troop_slot_003",-1),
(try_end),
(try_for_range, ":slot_no_004", 0, ":::num_log_entries"),
(gt,":troop_slot_003",-1),
(troop_get_slot,":troop_slot_005","trp_log_array_actor",":slot_no_004"),
(try_begin),
(eq,":troop_slot_005",":troop_slot_003"),
(troop_get_slot,":troop_slot_006","trp_log_array_troop_object",":slot_no_004"),
(eq,":troop_slot_006",":quest_slot_002"),
(store_current_hours,":cur_hours_007"),
(troop_get_slot,":troop_slot_008","trp_log_array_entry_time",":slot_no_004"),
(val_sub, ":cur_hours_007", ":troop_slot_008"),
(try_begin),
(le,":cur_hours_007",1),
(str_store_string,s16,":str_store_string("str_less_than_an_hour_ago")"),
(else_try),
(le,":cur_hours_007",48),
(assign,reg3,":cur_hours_007"),
(str_store_string,s16,":str_store_string("str_maybe_reg3_hours_ago")"),
(else_try),
(val_div, ":cur_hours_007", 24),
(assign,reg3,":cur_hours_007"),
(str_store_string,s16,":str_store_string("str_reg3_days_ago")"),
(try_end),
(try_end),
(troop_get_slot,":troop_slot_009","trp_log_array_center_object",":slot_no_004"),
(str_store_string,s17,":str_store_party_name(troop_slot_009)"),
(troop_get_slot,":troop_slot_010","trp_log_array_entry_type",":slot_no_004"),
(eq,":troop_slot_010",70),
(str_store_string,s15,":str_store_string("str_youre_in_luck_we_sighted_those_bastards_s16_near_s17_hurry_and_you_might_be_able_to_pick_up_their_trail_while_its_still_hot")"),
(try_end),
]),

("rebellion_arguments", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":troop_id_003", 3),
(assign,":var004",0),
(assign,":var005",0),
(troop_get_slot,":troop_slot_006",":troop_id_001",52),
(store_troop_faction,":troop_faction_007",":troop_id_003"),
(store_troop_faction,":troop_faction_008",":troop_id_003"),
(try_begin),
(eq,":troop_id_003","trp_player"),
(assign,":var009","$player_right_to_rule"),
(else_try),
(is_between,":troop_id_003","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(troop_slot_eq,":troop_id_003",14,":troop_faction_007"),
(assign,":var009",75),
(else_try),
(assign,":var009",60),
(try_end),
(try_begin),
(eq,":var002",1),
(store_sub, ":var005", ":var009", 30),
(else_try),
(eq,":var002",2),
(store_sub, ":var005", "$player_honor", 20),
(else_try),
(eq,":var002",5),
(store_sub, ":var005", "$player_honor", 20),
(else_try),
(eq,":var002",4),
(assign,":var005",0),
(try_for_range, ":p_010", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_011", ":p_010"),
(assign,":var005",-40),
(try_begin),
(eq,":::players_kingdom",":troop_faction_008"),
(this_or_next|eq,":party_faction_011","fac_player_faction"),
(eq,":party_faction_011","fac_player_supporters_faction"),
(val_add, ":var005", 5),
(else_try),
(eq,":party_faction_011",":troop_faction_008"),
(val_add, ":var005", 5),
(try_end),
(try_end),
(else_try),
(eq,":var002",3),
(assign,":var005",20),
(try_for_range, ":trp_012", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_013",":trp_012"),
(try_begin),
(neq,":troop_id_001",":::g_talk_troop"),
(this_or_next|eq,":troop_faction_013","fac_player_supporters_faction"),
(eq,":troop_faction_013",":::players_kingdom"),
(troop_slot_eq,":trp_012",47,1),
(val_sub, ":var005", 20),
(try_end),
(try_end),
(try_end),
(val_clamp,":var005",-40, 41),
(try_begin),
(eq,":troop_slot_006",1),
(try_begin),
(eq,":var002",1),
(assign,":var004",30),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_claims_to_the_throne_good_there_is_nothing_id_rather_do_than_fight_for_a_good_cause")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_claims_to_the_throne_well_there_is_nothing_id_rather_do_than_fight_for_a_good_cause_but_the_claim_you_make_seems_somewhat_weak")"),
(try_end),
(else_try),
(eq,":var002",5),
(assign,":var004",10),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_i_am_pleased_that_you_speak_of_upholding_my_ancient_rights_which_are_sometimes_trod_upon_in_these_sorry_days")"),
(else_try),
(str_store_string,s15,":str_store_string("str_i_am_pleased_that_you_speak_of_upholding_my_ancient_rights_but_sometimes_men_make_pledges_before_they_are_king_which_they_cannot_keep_once_they_take_the_throne")"),
(try_end),
(else_try),
(eq,":var002",2),
(assign,":var004",0),
(try_begin),
(eq,1,1),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_commons_well_i_supposed_thats_good_but_sometimes_the_commons_overstep_their_boundaries_im_more_concerned_that_your_claim_be_legal_so_i_can_swing_my_sword_with_a_good_conscience")"),
(try_end),
(else_try),
(eq,":var002",3),
(assign,":var004",-10),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_good_i_ask_for_no_more_than_my_due")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_unfortunately_you_are_not_wellknown_for_rewarding_those_to_whom_you_have_made_such_offers")"),
(try_end),
(else_try),
(eq,":var002",4),
(assign,":var004",-30),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_well_i_believe_that_well_always_be_fighting__its_important_that_we_fight_for_a_rightful_cause")"),
(try_end),
(else_try),
(eq,":troop_slot_006",2),
(try_begin),
(eq,":var002",1),
(assign,":var004",-20),
(str_store_string,s15,":str_store_string("str_you_talk_of_claims_to_the_throne_but_i_leave_bickering_about_legalities_to_the_lawyers_and_clerks")"),
(else_try),
(eq,":var002",2),
(assign,":var004",-30),
(str_store_string,s15,":str_store_string("str_you_speak_of_ruling_justly_hah_ill_believe_theres_such_a_thing_as_a_just_king_when_i_see_one")"),
(else_try),
(eq,":var002",5),
(assign,":var004",0),
(str_store_string,s15,":str_store_string("str_you_spoke_of_protecting_the_rights_of_the_nobles_if_you_did_youd_be_the_first_king_to_do_so_in_a_very_long_time")"),
(else_try),
(eq,":var002",3),
(assign,":var004",30),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_ay_well_lets_see_if_you_deliver")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_bah_youre_not_known_for_delivering_on_your_pledges")"),
(try_end),
(else_try),
(eq,":var002",4),
(assign,":var004",10),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_well_youve_done_a_good_job_at_making_calradia_bend_its_knee_to_you_so_maybe_thats_not_just_talk")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_id_be_impressed_if_i_thought_you_could_do_it_but_unfortunately_you_dont")"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_006",3),
(try_begin),
(eq,":var002",1),
(assign,":var004",-20),
(str_store_string,s15,":str_store_string("str_you_speak_of_claims_to_the_throne_well_any_peasant_can_claim_to_be_a_kings_bastard")"),
(else_try),
(eq,":var002",2),
(assign,":var004",-30),
(str_store_string,s15,":str_store_string("str_well_its_a_fine_thing_to_court_the_commons_with_promises_but_what_do_you_have_to_offer_me")"),
(else_try),
(eq,":var002",5),
(assign,":var004",0),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_rights_of_lords_that_would_make_a_fine_change_if_my_rights_as_lord_would_be_respected")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_rights_of_lords_that_would_make_a_fine_change_if_my_rights_as_lord_would_be_respected_however_it_is_easy_for_you_to_make_promises_while_you_are_weak_that_you_have_no_intention_of_keeping_when_you_are_strong")"),
(try_end),
(else_try),
(eq,":var002",3),
(assign,":var004",20),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_well_my_family_is_of_ancient_and_noble_lineage_so_you_promise_me_no_more_than_my_due_still_your_gesture_is_appreciated")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_well_you_make_that_pledge_but_i_am_not_impressed")"),
(try_end),
(else_try),
(eq,":var002",4),
(assign,":var004",20),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_well_much_of_this_land_now_bends_its_knee_to_you_so_perhaps_that_is_not_just_talk")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_but_right_now_yours_is_just_one_squabbling_faction_among_many")"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_006",4),
(try_begin),
(eq,":var002",1),
(assign,":var004",-30),
(str_store_string,s15,":str_store_string("str_you_speak_of_claims_well_no_offense_but_a_claim_unsupported_by_might_rarely_prospers")"),
(else_try),
(eq,":var002",2),
(assign,":var004",10),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_commons_well_i_suppose_that_will_make_for_a_more_prosperous_realm_ive_always_tried_to_treat_my_peasants_decently_saves_going_to_bed_worrying_about_whether_youll_wake_up_with_the_roof_on_fire")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_commons_very_well_but_remember_that_peasants_are_more_likely_to_cause_trouble_if_you_make_promises_then_dont_deliver_than_if_you_never_made_the_promise_in_the_first_place")"),
(try_end),
(else_try),
(eq,":var002",5),
(assign,":var004",15),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_rights_of_lords_good_youd_be_well_advised_to_do_that__men_fight_better_for_a_king_wholl_respect_their_rights")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_rights_of_lords_very_well_but_remember__failing_to_keep_promises_which_you_made_while_scrambling_up_the_throne_is_the_quickest_way_to_topple_off_of_it_once_you_get_there")"),
(try_end),
(else_try),
(eq,":var002",3),
(assign,":var004",-20),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_very_good_but_often_i_find_that_when_a_man_makes_too_many_promises_trying_to_get_to_the_top_he_has_trouble_keeping_them_once_he_reaches_it")"),
(else_try),
(eq,":var002",4),
(assign,":var004",20),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_well_many_have_said_that_you_might_very_well_be_the_one_to_do_it")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_well_all_the_kings_say_that_im_not_sure_that_you_will_succeed_while_they_fail")"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_006",5),
(try_begin),
(eq,":var002",1),
(assign,":var004",-20),
(str_store_string,s15,":str_store_string("str_you_speak_of_claims_do_you_think_i_care_for_the_nattering_of_lawyers")"),
(else_try),
(eq,":var002",2),
(assign,":var004",-20),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_commons_how_kind_of_you_i_shall_tell_my_swineherd_all_about_your_sweet_promises_no_doubt_he_will_become_your_most_faithful_vassal")"),
(else_try),
(eq,":var002",5),
(assign,":var004",-10),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecing_the_rights_of_lords_such_sweet_words_but_ill_tell_you_this__the_only_rights_that_are_respected_in_this_world_are_the_rights_to_dominate_whoever_is_weaker_and_to_submit_to_whoever_is_stronger")"),
(else_try),
(eq,":var002",3),
(assign,":var004",20),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_yes_very_good__but_you_had_best_deliver")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_hah_perhaps_all_those_others_to_whom_you_promised_lands_will_simply_step_aside")"),
(try_end),
(else_try),
(eq,":var002",4),
(assign,":var004",10),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_you_may_indeed_humble_the_other_kings_of_this_land_and_in_that_case_i_would_hope_that_you_would_remember_me_as_your_faithful_servant")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_but_you_are_weak_and_i_think_that_you_will_remain_weak")"),
(try_end),
(try_end),
(else_try),
(eq,":troop_slot_006",6),
(try_begin),
(eq,":var002",1),
(assign,":var004",10),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_claims_its_good_for_a_king_to_have_a_strong_claim_although_admittedly_im_more_concerned_that_he_rules_just_ly_than_with_legalities_anyway_your_claim_seems_wellfounded_to_me")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_claims_but_your_claim_seems_a_bit_weak_to_me")"),
(try_end),
(else_try),
(eq,":var002",2),
(assign,":var004",20),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_commons_i_like_that_my_tenants_are_a_happy_lot_i_think_but_i_hear_of_others_in_other_estates_that_arent_so_fortunate")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_commons_im_glad_to_hear_you_say_that_but_do_me_a_favor__dont_promise_the_commons_anything_you_cant_deliver_thats_a_sure_way_to_get_them_to_rebel_and_it_breaks_my_heart_to_have_to_put_them_down")"),
(try_end),
(else_try),
(eq,":var002",5),
(assign,":var004",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_rights_of_lords_well_very_good_i_suppose_but_you_know__we_lords_can_take_of_ourselves_its_the_common_folk_who_need_a_strong_king_to_look_out_for_them_to_my_mind")"),
(else_try),
(eq,":var002",3),
(assign,":var004",-15),
(str_store_string,s15,":str_store_string("str_you_speak_of_giving_me_land_its_kind_of_you_really_though_that_is_not_necessary")"),
(else_try),
(eq,":var002",4),
(assign,":var004",-25),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_well_maybe_you_can_unite_this_land_by_the_sword_but_im_not_sure_that_this_will_make_you_a_good_ruler")"),
(try_end),
(else_try),
(eq,":troop_slot_006",7),
(try_begin),
(eq,":var002",1),
(assign,":var004",10),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_claims_a_king_must_have_a_strong_legal_claim_for_there_not_to_be_chaos_in_the_realm_and_yours_is_wellestablished")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_claims_a_king_must_have_a_strong_legal_claim_for_there_not_to_be_chaos_in_the_realm_but_your_claim_is_not_so_strong")"),
(try_end),
(else_try),
(eq,":var002",5),
(assign,":var004",-5),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_rights_of_lords_it_is_of_course_important_that_a_king_respect_the_rights_of_his_vassals_although_i_worry_that_a_king_who_took_a_throne_without_proper_cause_would_not_rule_with_justice")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_rights_of_lords_it_is_of_course_important_that_a_king_respect_the_rights_of_his_vassals_however_i_would_like_to_know_that_you_would_indeed_deliver_on_your_promises")"),
(try_end),
(else_try),
(eq,":var002",2),
(assign,":var004",5),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_commons_i_would_be_pleased_to_serve_a_king_who_respected_the_rights_of_his_subjects_although_i_worry_that_a_king_who_took_a_throne_without_proper_cause_would_not_rule_with_justice")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_protecting_the_commons_i_would_be_pleased_to_serve_a_king_who_respected_the_rights_of_his_subjects_however_i_would_like_to_know_that_you_would_indeed_deliver_on_your_promises")"),
(try_end),
(else_try),
(eq,":var002",3),
(assign,":var004",-40),
(str_store_string,s15,":str_store_string("str_i_am_not_swayed_by_promises_of_reward")"),
(else_try),
(eq,":var002",4),
(assign,":var004",10),
(try_begin),
(gt,":var005",0),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_it_would_be_good_to_bring_peace_to_the_realm_and_i_believe_that_you_are_strong_enough_to_do_so")"),
(else_try),
(str_store_string,s15,":str_store_string("str_you_speak_of_unifying_calradia_it_would_be_good_to_bring_peace_the_realm_but_with_your_kingdom_in_its_current_state_i_worry_that_you_are_just_bringing_more_discord")"),
(try_end),
(try_end),
(try_end),
(str_store_string,s14,":str_store_string("str_s15")"),
(assign,reg0,":var004"),
(assign,reg1,":var005"),
]),

("get_culture_with_party_faction_for_music", [
(store_script_param, ":party_id_001", 1),
(store_faction_of_party, ":party_faction_002", ":party_id_001"),
(try_begin),
(this_or_next|eq,":party_faction_002","fac_player_supporters_faction"),
(eq,":party_faction_002","fac_player_faction"),
(assign,":party_faction_002","$players_kingdom"),
(try_end),
(try_begin),
(is_between,":party_id_001","p_town_1","p_salt_mine"),
(this_or_next|eq,":party_faction_002","fac_player_supporters_faction"),
(neg|is_between,":party_faction_002","fac_player_supporters_faction","fac_kingdoms_end"),
(party_get_slot,":party_faction_002",":party_id_001",61),
(try_end),
(call_script, "script_get_culture_with_faction_for_music", ":party_faction_002"),
]),

("get_culture_with_faction_for_music", [
(store_script_param, ":var001", 1),
(try_begin),
(eq,":var001","fac_kingdom_1"),
(assign,":var002",1),
(else_try),
(eq,":var001","fac_kingdom_2"),
(assign,":var002",2),
(else_try),
(eq,":var001","fac_kingdom_3"),
(assign,":var002",4),
(else_try),
(eq,":var001","fac_kingdom_4"),
(assign,":var002",8),
(else_try),
(eq,":var001","fac_kingdom_5"),
(assign,":var002",16),
(else_try),
(eq,":var001","fac_kingdom_6"),
(assign,":var002",32),
(else_try),
(this_or_next|eq,":var001","fac_forest_bandits"),
(this_or_next|eq,":var001","fac_mountain_bandits"),
(this_or_next|eq,":var001","fac_deserters"),
(this_or_next|eq,":var001","fac_peasant_rebels"),
(eq,":var001","fac_outlaws"),
(assign,":var002",32),
(else_try),
(assign,":var002",0),
(try_end),
(assign,reg0,":var002"),
]),

("music_set_situation_with_culture", [
(store_script_param, ":var001", 1),
(assign,":var002",0),
(try_begin),
(this_or_next|eq,":var001",2097152),
(this_or_next|eq,":var001",16384),
(this_or_next|eq,":var001",524288),
(this_or_next|eq,":var001",1048576),
(eq,":var001",8192),
(call_script, "script_get_culture_with_party_faction_for_music", "$g_encountered_party"),
(val_or,":var002",reg0),
(else_try),
(this_or_next|eq,":var001",1024),
(eq,":var001",4096),
(call_script, "script_get_culture_with_party_faction_for_music", "$g_encountered_party"),
(val_or,":var002",reg0),
(call_script, "script_get_culture_with_party_faction_for_music", "p_main_party"),
(val_or,":var002",reg0),
(call_script, "script_get_closest_center", "p_main_party"),
(call_script, "script_get_culture_with_party_faction_for_music", reg0),
(val_or,":var002",reg0),
(else_try),
(eq,":var001",2048),
(call_script, "script_get_culture_with_faction_for_music", "$g_multiplayer_team_1_faction"),
(val_or,":var002",reg0),
(call_script, "script_get_culture_with_faction_for_music", "$g_multiplayer_team_2_faction"),
(val_or,":var002",reg0),
(else_try),
(eq,":var001",65536),
(call_script, "script_get_culture_with_party_faction_for_music", "p_main_party"),
(val_or,":var002",reg0),
(call_script, "script_get_closest_center", "p_main_party"),
(call_script, "script_get_culture_with_party_faction_for_music", reg0),
(val_or,":var002",reg0),
(else_try),
(eq,":var001",8388608),
(call_script, "script_get_culture_with_party_faction_for_music", "p_main_party"),
(val_or,":var002",reg0),
(else_try),
(eq,":var001",32768),
(call_script, "script_get_culture_with_party_faction_for_music", "$g_encountered_party"),
(val_or,":var002",reg0),
(try_end),
(try_begin),
(this_or_next|eq,":var001",2097152),
(this_or_next|eq,":var001",16384),
(this_or_next|eq,":var001",524288),
(this_or_next|eq,":var001",1048576),
(eq,":var001",8192),
(try_begin),
(is_currently_night),
(assign,":var001",524288),
(try_end),
(try_end),
(music_set_situation, ":var001"),
(music_set_culture, ":var002"),
]),

("combat_music_set_situation_with_culture", [
(assign,":var001",1024),
(assign,":var002",0),
(assign,":var003",0),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_troop_id,":troop_id_005", ":cur_agent"),
(store_character_level,":character_lvl_006",":troop_id_005"),
(val_add, ":character_lvl_006", 10),
(val_mul, ":character_lvl_006", ":character_lvl_006"),
(try_begin),
(agent_is_ally,":cur_agent"),
(val_add, ":var002", ":character_lvl_006"),
(else_try),
(val_add, ":var003", ":character_lvl_006"),
(try_end),
(try_end),
(val_mul, ":var002", 4),
(val_div, ":var002", 3),
(try_begin),
(lt,":var002",":var003"),
(assign,":var001",4096),
(try_end),
(call_script, "script_music_set_situation_with_culture", ":var001"),
]),

("play_victorious_sound", [
(call_script, "script_music_set_situation_with_culture", 8388608),
]),

("set_items_for_tournament", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(store_script_param, ":var004", 4),
(store_script_param, ":var005", 5),
(store_script_param, ":var006", 6),
(store_script_param, ":var007", 7),
(store_script_param, ":var008", 8),
(store_script_param, ":var009", 9),
(store_script_param, ":var010", 10),
(store_add, ":var011", ":var003", ":var004"),
(val_add, ":var011", ":var008"),
(try_for_range, ":var012", 0, 32),
(mission_tpl_entry_clear_override_items, "mt_arena_melee_fight", ":var012"),
(assign,":var013",0),
(store_div, ":var___x1", ":var012", 8),
(assign,":var014",":var___x1"),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_015",0,100),
(try_begin),
(lt,":random_x_015",":var001"),
(assign,":var013",1),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_horse"),
(try_end),
(try_end),
(try_begin),
(eq,":var013",1),
(store_add, ":var016", ":var011", ":var002"),
(val_add, ":var016", ":var006"),
(val_add, ":var016", ":var007"),
(else_try),
(store_add, ":var016", ":var011", ":var005"),
(try_end),
(store_random_in_range,":random_x_015",0,":var016"),
(assign,":var017","itm_arena_shield_red"),
(val_add, ":var017", ":var014"),
(eq,1,1),
(val_sub, ":random_x_015", ":var003"),
(try_begin),
(lt,":random_x_015",0),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_018",0,100),
(lt,":random_x_018",50),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_sword"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", ":var017"),
(else_try),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_heavy_practice_sword"),
(try_end),
(try_end),
(else_try),
(val_sub, ":random_x_015", ":var004"),
(try_begin),
(lt,":random_x_015",0),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_axe"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", ":var017"),
(else_try),
(val_sub, ":random_x_015", ":var008"),
(try_begin),
(lt,":random_x_015",0),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_sword"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_crossbow"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_bolts"),
(else_try),
(eq,":var013",0),
(val_sub, ":random_x_015", ":var005"),
(try_begin),
(lt,":random_x_015",0),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_bow"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_arrows"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_dagger"),
(else_try),
(eq,":var013",1),
(val_sub, ":random_x_015", ":var002"),
(try_begin),
(lt,":random_x_015",0),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_lance"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", ":var017"),
(else_try),
(eq,":var013",1),
(val_sub, ":random_x_015", ":var006"),
(try_begin),
(lt,":random_x_015",0),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_javelin"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", ":var017"),
(else_try),
(eq,":var013",1),
(val_sub, ":random_x_015", ":var007"),
(try_begin),
(lt,":random_x_015",0),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_bow"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_arrows"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", "itm_practice_dagger"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(ge,":var009",0),
(store_add, ":var019", ":var009", ":var014"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", ":var019"),
(try_end),
(ge,":var010",0),
(store_add, ":var020", ":var010", ":var014"),
(mission_tpl_entry_add_override_item, "mt_arena_melee_fight", ":var012", ":var020"),
(try_end),
]),

("custom_battle_end", [
(assign,"$g_custom_battle_team1_death_count",0),
(assign,"$g_custom_battle_team2_death_count",0),
(get_player_agent_no,":agent_no_001"),
(agent_get_team, ":agent_team_no_002", ":agent_no_001"),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(neg|agent_is_alive,":cur_agent"),
(agent_get_team, ":agent_team_no_004", ":cur_agent"),
(try_begin),
(eq,":agent_team_no_004",":agent_team_no_002"),
(val_add, ":::g_custom_battle_team1_death_count", 1),
(else_try),
(val_add, ":::g_custom_battle_team2_death_count", 1),
(try_end),
(try_end),
]),

("remove_troop_from_prison", [
(store_script_param, ":troop_id_001", 1),
(troop_set_slot,":troop_id_001",8,-1),
(try_begin),
(neg|eq,":::do_not_cancel_quest",0),
(check_quest_active,"qst_rescue_lord_by_replace"),
(quest_slot_eq,"qst_rescue_lord_by_replace",2,":troop_id_001"),
(call_script, "script_cancel_quest", "qst_rescue_lord_by_replace"),
(try_end),
(try_begin),
(neg|eq,":::do_not_cancel_quest",0),
(check_quest_active,"qst_rescue_prisoner"),
(quest_slot_eq,"qst_rescue_prisoner",2,":troop_id_001"),
(call_script, "script_cancel_quest", "qst_rescue_prisoner"),
(try_end),
(try_begin),
(check_quest_active,"qst_deliver_message_to_prisoner_lord"),
(quest_slot_eq,"qst_deliver_message_to_prisoner_lord",2,":troop_id_001"),
(call_script, "script_cancel_quest", "qst_deliver_message_to_prisoner_lord"),
(try_end),
]),

("debug_variables", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
]),

("troop_describes_troop_to_s15", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(str_store_string,s15,":str_store_troop_name(var002)"),
(try_begin),
(eq,":var002","trp_player"),
(str_store_string,s15,":str_store_string("str_you")"),
(else_try),
(eq,":var002",":var001"),
(str_store_string,s15,":str_store_string("str_myself")"),
(else_try),
(call_script, "script_troop_get_family_relation_to_troop", ":var002", ":var001"),
(try_begin),
(gt,reg0,0),
(str_store_string,s15,":str_store_string("str_my_s11_s15")"),
(else_try),
(call_script, "script_troop_get_relation_with_troop", ":var002", ":var001"),
(try_begin),
(ge,reg0,20),
(str_store_string,s15,":str_store_string("str_my_friend_s15")"),
(try_end),
(try_end),
(try_end),
]),

("troop_describes_quarrel_with_troop_to_s14", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(str_store_string,s15,":str_store_troop_name(var001)"),
(str_store_string,s16,":str_store_troop_name(var002)"),
(str_store_string,s14,":str_store_string("str_stop_gap__s15_is_the_rival_of_s16")"),
(try_begin),
(eq,":var001",":::g_talk_troop"),
(call_script, "script_cf_test_lord_incompatibility_to_s17", ":var001", ":var002"),
(str_store_string,s14,":str_store_string(17)"),
(else_try),
(eq,":var002",":::g_talk_troop"),
(call_script, "script_cf_test_lord_incompatibility_to_s17", ":var002", ":var001"),
(str_store_string,s14,":str_store_string(17)"),
(else_try),
(str_store_string,s14,":str_store_string("str_general_quarrel")"),
(try_end),
]),

("cf_test_lord_incompatibility_to_s17", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(assign,":var003",0),
(troop_get_slot,":troop_slot_004",":troop_id_001",52),
(troop_get_slot,":troop_slot_005",":troop_id_002",52),
(troop_get_type,reg15,":troop_id_002"),
(str_store_string,s18,":str_store_troop_name(troop_id_002)"),
(assign,":var006",1),
(call_script, "script_troop_get_family_relation_to_troop", ":troop_id_002", ":troop_id_001"),
(assign,":var007",reg0),
(try_begin),
(gt,":var007",0),
(store_div, ":var___x1", reg0, 5),
(assign,":var008",":var___x1"),
(val_add, ":var006", ":var008"),
(str_store_string,s18,":str_store_string("str_my_s11_s18")"),
(else_try),
(gt,":troop_slot_005",7),
(this_or_next|eq,":troop_slot_004",5),
(eq,":troop_slot_004",3),
(str_store_string,s18,":str_store_string("str_the_socalled_s11_s18")"),
(try_end),
(try_begin),
(eq,":troop_slot_004",1),
(is_between,":var007",1,5),
(assign,":var003",100),
(str_store_string,s17,":str_store_string("str_s18_would_cheat_me_of_my_inheritance_by_heaven_i_know_my_rights_and_im_not_going_to_back_down")"),
(else_try),
(eq,":troop_slot_004",1),
(eq,":troop_slot_005",2),
(str_store_string,s17,":str_store_string("str_s18_once_questioned_my_honour_and_my_bravery_i_long_for_the_day_when_i_can_meet_him_in_battle_and_make_him_retract_his_statement")"),
(assign,":var003",50),
(else_try),
(eq,":troop_slot_004",1),
(eq,":troop_slot_005",7),
(str_store_string,s17,":str_store_string("str_s18_once_questioned_my_judgment_in_battle_by_heaven_would_he_have_us_shirk_our_duty_to_smite_our_sovereigns_foes")"),
(assign,":var003",50),
(else_try),
(eq,":troop_slot_005",1),
(is_between,":var007",1,5),
(assign,":var003",100),
(str_store_string,s17,":str_store_string("str_s18_seems_to_think_he_has_the_right_to_some_of_my_property_well_he_does_not")"),
(else_try),
(eq,":troop_slot_004",2),
(eq,":troop_slot_005",1),
(str_store_string,s17,":str_store_string("str_s18_once_took_something_i_said_amiss_stubborn_bastard_wont_give_it_up_and_keeps_trying_to_get_me_to_recant_my_words")"),
(assign,":var003",50),
(else_try),
(eq,":troop_slot_004",2),
(eq,":troop_slot_005",4),
(str_store_string,s17,":str_store_string("str_s18_is_a_crafty_weasel_and_i_dont_trust_him_one_bit")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",5),
(eq,":troop_slot_005",7),
(str_store_string,s17,":str_store_string("str_s18_i_despite_him_he_puts_on_such_a_nauseating_display_of_virtue_and_thinks_nothing_of_insulting_his_betters")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",5),
(eq,":troop_slot_005",3),
(str_store_string,s17,":str_store_string("str_s18_entered_into_a_little_deal_with_me_and_is_now_trying_to_wriggle_out_of_it")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",3),
(eq,":troop_slot_005",5),
(str_store_string,s17,":str_store_string("str_s18_once_ran_an_errand_for_me_and_now_thinks_i_owe_him_something_i_owe_his_ilk_nothing")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",3),
(eq,":troop_slot_005",6),
(str_store_string,s17,":str_store_string("str_s18_is_soft_and_weak_and_not_fit_to_govern_a_fief_and_i_have_always_detested_him")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",4),
(eq,":troop_slot_005",2),
(str_store_string,s17,":str_store_string("str_s18_is_a_quarrelsome_oaf_and_a_liability_in_my_opinion_and_ive_let_him_know_as_much")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",4),
(eq,":troop_slot_005",6),
(str_store_string,s17,":str_store_string("str_s18_i_am_sorry_to_say_is_far_too_softhearted_a_man_to_be_given_any_kind_of_responsibility_his_chivalry_will_allow_the_enemy_to_flee_to_fight_another_day_and_will_cost_the_lives_of_my_own_faithful_men")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",6),
(eq,":troop_slot_005",4),
(str_store_string,s17,":str_store_string("str_s18_seems_to_have_something_against_me_for_some_reason_i_dont_like_to_talk_ill_of_people_but_i_think_hes_can_be_a_bit_of_a_cad_sometimes")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",6),
(eq,":troop_slot_005",3),
(str_store_string,s17,":str_store_string("str_s18_has_always_treated_me_contemptuously_although_i_have_done_him_no_wrong")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",7),
(eq,":troop_slot_005",5),
(str_store_string,s17,":str_store_string("str_s18_is_thoroughly_dishonorable_and_a_compulsive_spinner_of_intrigues_which_i_fear_will_drag_us_into_wars_or_incite_rebellions")"),
(assign,":var003",50),
(else_try),
(eq,":troop_slot_004",7),
(eq,":troop_slot_005",1),
(str_store_string,s17,":str_store_string("str_s18_disappoints_me_i_once_scolded_for_his_rashness_in_battle_and_he_took_offense_i_do_not_care_to_apologize_for_my_efforts_to_save_his_life_and_the_lives_of_his_men")"),
(assign,":var003",50),
(else_try),
(this_or_next|eq,":troop_slot_004",7),
(this_or_next|eq,":troop_slot_004",1),
(eq,":troop_slot_004",3),
(eq,":troop_slot_005",8),
(str_store_string,s17,":str_store_string("str_s18_squanders_money_and_carouses_in_a_way_most_unbefitting_a_noble_by_doing_so_he_disgraces_us_all")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",8),
(this_or_next|eq,":troop_slot_005",7),
(this_or_next|eq,":troop_slot_005",1),
(eq,":troop_slot_005",3),
(str_store_string,s17,":str_store_string("str_s18_has_been_speaking_ill_of_me_behind_my_back_or_so_they_say")"),
(assign,":var003",100),
(else_try),
(this_or_next|eq,":troop_slot_004",2),
(this_or_next|eq,":troop_slot_004",1),
(eq,":troop_slot_004",3),
(eq,":troop_slot_005",10),
(str_store_string,s17,":str_store_string("str_s18_is_a_disgrace_reg3shehe_consorts_with_merchants_lends_money_at_interest_uses_coarse_language_and_shows_no_attempt_to_uphold_the_dignity_of_the_honor_bestowed_upon_reg3herhim")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",10),
(this_or_next|eq,":troop_slot_005",2),
(this_or_next|eq,":troop_slot_005",1),
(eq,":troop_slot_005",3),
(str_store_string,s17,":str_store_string("str_s18_has_condemned_me_for_engaging_in_commerce_what_could_possibly_be_wrong_with_that")"),
(assign,":var003",100),
(else_try),
(this_or_next|eq,":troop_slot_004",5),
(this_or_next|eq,":troop_slot_004",1),
(eq,":troop_slot_004",3),
(eq,":troop_slot_005",9),
(str_store_string,s17,":str_store_string("str_s18_i_have_heard_has_been_encouraging_seditious_ideas_among_the_peasantry__a_foolish_move_which_endangers_us_all")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",9),
(this_or_next|eq,":troop_slot_005",5),
(this_or_next|eq,":troop_slot_005",1),
(eq,":troop_slot_005",3),
(str_store_string,s17,":str_store_string("str_s18_has_called_me_out_for_the_way_i_deal_with_my_tenants_well_so_be_it_if_i_teach_them_that_they_are_the_equal_of_anyone_with_socalled_gentle_blood_what_is_it_to_reg3herhim")"),
(assign,":var003",100),
(else_try),
(eq,":troop_slot_004",21),
(this_or_next|eq,":troop_slot_005",1),
(eq,":troop_slot_005",3),
(str_store_string,s17,":str_store_string("str_a_most_gallant_gentleman_who_knows_how_to_treat_a_lady")"),
(assign,":var003",-50),
(else_try),
(eq,":troop_slot_004",21),
(eq,":troop_slot_005",2),
(str_store_string,s17,":str_store_string("str_a_base_cad")"),
(assign,":var003",50),
(else_try),
(eq,":troop_slot_004",22),
(eq,":troop_slot_005",4),
(str_store_string,s17,":str_store_string("str_a_man_who_treats_me_as_his_equal_which_is_rare")"),
(assign,":var003",-50),
(else_try),
(eq,":troop_slot_004",22),
(this_or_next|eq,":troop_slot_005",1),
(eq,":troop_slot_005",5),
(str_store_string,s17,":str_store_string("str_appears_to_value_me_with_his_estate_and_his_horse_as_prizes_worth_having")"),
(assign,":var003",50),
(else_try),
(eq,":troop_slot_004",22),
(neq,":troop_slot_005",6),
(str_store_string,s17,":str_store_string("str_a_bit_dull_but_what_can_you_expect")"),
(assign,":var003",10),
(else_try),
(eq,":troop_slot_004",23),
(call_script, "script_troop_get_romantic_chemistry_with_troop", ":troop_id_001", ":troop_id_002"),
(try_begin),
(ge,reg0,10),
(str_store_string,s17,":str_store_string("str_the_man_whom_destiny_intends_for_me")"),
(assign,":var003",-50),
(else_try),
(eq,":troop_slot_004",23),
(lt,reg0,0),
(str_store_string,s17,":str_store_string("str_is_not_right_for_me__i_cannot_say_why_but_he_makes_my_skin_crawl")"),
(assign,":var003",50),
(else_try),
(eq,":troop_slot_004",24),
(this_or_next|eq,":troop_slot_005",3),
(eq,":troop_slot_005",4),
(str_store_string,s17,":str_store_string("str_is_a_man_who_clearly_intends_to_make_his_mark_in_the_world")"),
(assign,":var003",-20),
(else_try),
(eq,":troop_slot_004",24),
(eq,":troop_slot_005",6),
(str_store_string,s17,":str_store_string("str_is_a_layabout_a_naif_prey_for_others_who_are_cleverer_than_he")"),
(assign,":var003",30),
(else_try),
(eq,":troop_slot_004",25),
(eq,":troop_slot_005",7),
(str_store_string,s17,":str_store_string("str_is_a_man_of_stalwart_character")"),
(assign,":var003",-50),
(else_try),
(eq,":troop_slot_004",25),
(this_or_next|eq,":troop_slot_005",5),
(eq,":troop_slot_005",4),
(str_store_string,s17,":str_store_string("str_appears_to_be_a_man_of_low_morals")"),
(assign,":var003",50),
(else_try),
(eq,":troop_slot_004",25),
(eq,":troop_slot_005",2),
(str_store_string,s17,":str_store_string("str_appears_to_be_a_man_who_lacks_selfdiscipline")"),
(assign,":var003",50),
(else_try),
(try_end),
(try_end),
(val_div, ":var003", ":var006"),
(assign,reg0,":var003"),
]),

("troop_get_romantic_chemistry_with_troop", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_add, ":var003", ":var001", ":var002"),
(val_add, ":var003", ":::romantic_attraction_seed"),
(store_mod,":var004",":var003",5),
(val_mul, ":var004", ":var004"),
(val_mul, ":var004", 3),
(store_attribute_level,":attribute_lvl_005",":var002",3),
(val_sub, ":attribute_lvl_005", ":var004"),
(val_mul, ":attribute_lvl_005", 2),
(assign,reg0,":attribute_lvl_005"),
]),

("cf_troop_get_romantic_attraction_to_troop", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(assign,":var003",0),
(troop_get_type,":troop_type_004",":troop_id_001"),
(try_begin),
(eq,":troop_type_004",1),
(troop_get_type,":troop_type_005",":troop_id_002"),
(try_begin),
(eq,":troop_type_005",0),
(call_script, "script_troop_get_romantic_chemistry_with_troop", ":troop_id_001", ":troop_id_002"),
(assign,":var006",reg0),
(troop_get_slot,":troop_slot_007",":troop_id_002",7),
(val_div, ":troop_slot_007", 5),
(val_sub, ":troop_slot_007", 60), # var008
(val_min,":troop_slot_007",60),
(eq,1,1),
(assign,":var009",0),
(call_script, "script_cf_test_lord_incompatibility_to_s17", ":troop_id_001", ":troop_id_002"),
(store_sub, ":var009", 0, reg0),
(try_end),
(try_end),
(troop_get_slot,":troop_slot_010",":troop_id_001",52),
(try_begin),
(eq,":troop_slot_010",24),
(val_mul, ":troop_slot_007", 2),
(val_div, ":var006", 2),
(else_try),
(eq,":troop_slot_010",23),
(val_div, ":troop_slot_007", 2),
(val_mul, ":var006", 2),
(else_try),
(eq,":troop_slot_010",22),
(val_div, ":troop_slot_007", 2),
(else_try),
(eq,":troop_slot_010",25),
(val_div, ":troop_slot_007", 2),
(val_div, ":var006", 2),
(try_end),
(val_add, ":var003", ":var006"),
(val_add, ":var003", ":var009"),
(val_add, ":var003", ":troop_slot_007"),
(assign,reg0,":var003"),
]),

("cf_random_political_event", [
(store_random_in_range,":random_x_001","trp_npc1","trp_knight_1_1_wife"),
(store_random_in_range,":random_x_002","trp_npc1","trp_knight_1_1_wife"),
(try_begin),
(troop_slot_eq,":random_x_001",2,2),
(troop_slot_eq,":random_x_002",2,2),
(neq,":random_x_001",":random_x_002"),
(val_add, ":::total_political_events", 1),
(store_troop_faction,":troop_faction_003",":random_x_001"),
(store_troop_faction,":troop_faction_004",":random_x_002"),
(assign,reg8,"$total_political_events"),
(faction_get_slot,":faction_slot_005",":troop_faction_003",11),
(faction_get_slot,":faction_slot_006",":troop_faction_004",11),
(try_begin),
(this_or_next|eq,":troop_faction_003",":troop_faction_004"),
(this_or_next|eq,":random_x_001",":faction_slot_005"),
(eq,":random_x_002",":faction_slot_006"),
(call_script, "script_troop_get_relation_with_troop", ":random_x_001", ":random_x_002"),
(assign,":var007",reg0),
(store_random_in_range,":random_x_008",0,100),
(try_begin),
(eq,":troop_faction_003",":troop_faction_004"),
(neq,":faction_slot_005","trp_player"),
(le,":var007",-10),
(call_script, "script_troop_get_relation_with_troop", ":random_x_001", ":faction_slot_005"),
(gt,reg0,0),
(assign,":var009",reg0),
(call_script, "script_troop_get_relation_with_troop", ":random_x_002", ":faction_slot_005"),
(gt,reg0,0),
(store_mul, ":var010", ":var009", reg0),
(val_div, ":var010", 4),
(le,":random_x_008",":var010"),
(str_store_string,s4,":str_store_troop_name(faction_slot_005)"),
(str_store_string,s5,":str_store_troop_name(random_x_001)"),
(str_store_string,s6,":str_store_troop_name(random_x_002)"),
(eq,":::cheat_mode",1),
(display_message, "str_check_reg8_s4_reconciles_s5_and_s6_"),
(try_end),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":random_x_001", ":random_x_002", 20),
(val_add, ":::total_random_quarrel_changes", 20),
(else_try),
(eq,":troop_faction_003",":troop_faction_004"),
(le,":var007",-10),
(try_begin),
(eq,":faction_slot_005","trp_player"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_diagnostic__player_should_receive_consultation_quest_here_if_not_already_active"),
(try_end),
(try_begin),
(neg|check_quest_active,"qst_consult_with_minister"),
(neg|check_quest_active,"qst_resolve_dispute"),
(neg|eq,":::g_minister_notification_quest",0),
(assign,"$g_minister_notification_quest","qst_resolve_dispute"),
(quest_set_slot,"qst_resolve_dispute",2,":random_x_001"),
(quest_set_slot,"qst_resolve_dispute",4,":random_x_002"),
(call_script, "script_add_notification_menu", "mnu_notification_player_should_consult", 0, 0),
(else_try),
(call_script, "script_troop_get_relation_with_troop", ":random_x_001", ":faction_slot_005"),
(assign,":var011",reg0),
(call_script, "script_troop_get_relation_with_troop", ":random_x_002", ":faction_slot_005"),
(assign,":var012",reg0),
(store_random_in_range,":random_x_013",-5,5),
(val_add, ":var011", ":random_x_013"),
(try_begin),
(ge,":var011",":var012"),
(assign,":var014",":random_x_001"),
(assign,":var015",":random_x_002"),
(else_try),
(assign,":var015",":random_x_001"),
(assign,":var014",":random_x_002"),
(try_end),
(try_end),
(str_store_string,s4,":str_store_troop_name(faction_slot_005)"),
(str_store_string,s5,":str_store_troop_name(var014)"),
(str_store_string,s6,":str_store_troop_name(var015)"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_check_reg8_s4_rules_in_s5s_favor_in_quarrel_with_s6_"),
(try_end),
(call_script, "script_add_log_entry", 27, ":faction_slot_005", ":var015", ":var014", ":troop_faction_003"),
(call_script, "script_troop_change_relation_with_troop", ":var014", ":faction_slot_005", 10),
(call_script, "script_troop_change_relation_with_troop", ":var015", ":faction_slot_005", -20),
(val_add, ":::total_random_quarrel_changes", -10),
(try_end),
(else_try),
(is_between,":random_x_001","trp_npc1","trp_kingdom_1_lord"),
(is_between,":random_x_002","trp_npc1","trp_kingdom_1_lord"),
(ge,":var007",-10),
(this_or_next|troop_slot_eq,":random_x_001",71,":random_x_002"),
(troop_slot_eq,":random_x_001",73,":random_x_002"),
(str_store_string,s5,":str_store_troop_name(random_x_001)"),
(str_store_string,s6,":str_store_troop_name(random_x_002)"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_check_reg8_new_rivalry_generated_between_s5_and_s6"),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":random_x_001", ":random_x_002", -30),
(val_add, ":::total_random_quarrel_changes", -30),
(else_try),
(eq,":troop_faction_003",":troop_faction_004"),
(ge,":var007",-10),
(call_script, "script_cf_test_lord_incompatibility_to_s17", ":random_x_001", ":random_x_002"),
(assign,":var016",reg0),
(try_begin),
(gt,":var016",0),
(lt,":random_x_008",":var016"),
(str_store_string,s5,":str_store_troop_name(random_x_001)"),
(str_store_string,s6,":str_store_troop_name(random_x_002)"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_check_reg8_new_rivalry_generated_between_s5_and_s6"),
(try_end),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":random_x_001", ":random_x_002", -30),
(val_add, ":::total_random_quarrel_changes", -30),
(else_try),
(store_current_hours,":cur_hours_017"),
(try_begin),
(ge,":cur_hours_017",24),
(neq,":troop_faction_003",":troop_faction_004"),
(is_between,":troop_faction_003","fac_player_supporters_faction","fac_kingdoms_end"),
(call_script, "script_cf_troop_can_intrigue", ":random_x_002", 0),
(neq,":random_x_002",":faction_slot_006"),
(neq,":random_x_002",":faction_slot_005"),
(str_store_string,s5,":str_store_troop_name(faction_slot_005)"),
(str_store_string,s6,":str_store_troop_name(random_x_002)"),
(try_begin),
(ge,":::cheat_mode",1),
(display_message, "str_check_reg8_s5_attempts_to_win_over_s6"),
(try_end),
(try_end),
(call_script, "script_calculate_troop_political_factors_for_liege", ":random_x_002", ":faction_slot_005"),
(assign,":var018",reg0),
(call_script, "script_calculate_troop_political_factors_for_liege", ":random_x_002", ":faction_slot_006"),
(assign,":var019",reg0),
(try_begin),
(gt,":var018",":var019"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(random_x_002)"),
(display_message, "@@{!}DEBUG - {s4} faction changed in subornment"),
(try_end),
(call_script, "script_change_troop_faction", ":random_x_002", ":troop_faction_003"),
(try_end),
(try_end),
]),

("evaluate_realm_stability", [
(store_script_param, ":faction_id_001", 1),
(assign,":var002",0),
(assign,":var003",0),
(assign,":var004",0),
(faction_get_slot,":faction_slot_005",":faction_id_001",11),
(try_for_range, ":trp_006", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_006",2,2),
(store_troop_faction,":troop_faction_007",":trp_006"),
(eq,":troop_faction_007",":faction_id_001"),
(val_add, ":var002", 1),
(call_script, "script_calculate_troop_political_factors_for_liege", ":trp_006", ":faction_slot_005"),
(try_begin),
(le,reg3,-10),
(val_add, ":var004", 1),
(else_try),
(le,reg3,10),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var002",0),
(store_mul, ":var008", ":var004", 100),
(val_div, ":var008", ":var002"),
(store_mul, ":var009", ":var003", 100),
(val_div, ":var009", ":var002"),
(store_mul, ":var010", ":var008", 2),
(val_add, ":var010", ":var009"),
(faction_set_slot,":faction_id_001",61,":var010"),
(assign,reg0,":var008"),
(assign,reg1,":var009"),
(assign,reg1,":var009"),
(else_try),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s1,":str_store_faction_name(faction_id_001)"),
(display_message, "str_s1_has_no_lords"),
(try_end),
(assign,reg1,0),
(try_end),
]),

("battle_political_consequences", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":party_id_002", 2),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_party_name(party_id_002)"),
(str_store_string,s5,":str_store_party_name(party_id_001)"),
(display_message, "str_do_political_consequences_for_s4_victory_over_s5"),
(try_end),
(store_faction_of_party, ":party_faction_003", ":party_id_002"),
(try_begin),
(eq,":party_id_002","p_main_party"),
(assign,":party_faction_003","$players_kingdom"),
(try_end),
(party_get_template_id,":party_template_id_004",":party_id_001"),
(try_begin),
(this_or_next|eq,":party_template_id_004","pt_kingdom_caravan_party"),
(eq,":party_template_id_004","pt_village_farmers"),
(party_get_slot,":party_slot_005",":party_id_001",5),
(party_get_slot,":party_slot_006",":party_id_001",126),
(call_script, "script_add_log_entry", 3, ":party_id_002", ":party_slot_006", ":party_slot_005", ":party_faction_003"),
(try_begin),
(eq,":::cheat_mode",2),
(neg|is_between,":party_faction_003","fac_player_supporters_faction","fac_kingdoms_end"),
(str_store_string,s65,":str_store_string("str_bandits_attacked_a_party_on_the_roads_so_a_bounty_is_probably_available")"),
(call_script, "script_add_notification_menu", "mnu_debug_alert_from_s65", 0, 0),
(str_store_string,s15,":str_store_party_name(party_slot_006)"),
(str_store_string,s16,":str_store_party_name(party_slot_005)"),
(display_message, "str_travellers_attacked_on_road_from_s15_to_s16"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(party_get_template_id,":party_template_id_007",":party_id_002"),
(try_begin),
(eq,":party_template_id_007","pt_kingdom_hero_party"),
(neq,":party_id_002","p_main_party"),
(party_stack_get_troop_id,      ":troop_id_008",":party_id_002",0),
(try_begin),
(is_between,":troop_id_008","trp_npc1","trp_knight_1_1_wife"),
(store_faction_of_party, ":party_faction_003", ":party_id_002"),
(party_collect_attachments_to_party, ":party_id_002", "p_temp_party_2"),
(party_get_num_companion_stacks,":party_num_companions_stacks_009","p_temp_party_2"),
(try_for_range, ":stack_no_010", 0, ":party_num_companions_stacks_009"),
(party_stack_get_troop_id,      ":troop_id_011","p_temp_party_2",":stack_no_010"),
(is_between,":troop_id_011","trp_npc1","trp_knight_1_1_wife"),
(eq,1,1),
(troop_get_slot,":troop_slot_012",":troop_id_011",10),
(party_is_active,":troop_slot_012"),
(call_script, "script_cf_party_under_player_suggestion", ":troop_slot_012"),
(call_script, "script_add_log_entry", 35, "trp_player", -1, ":troop_id_011", -1),
(try_end),
(try_end),
(store_troop_faction,":troop_faction_013",":troop_id_011"),
(eq,":troop_faction_013",":party_faction_003"),
(neq,":troop_id_011",":troop_id_008"),
(try_begin),
(eq,":::cheat_mode",4),
(str_store_string,s15,":str_store_troop_name(troop_id_011)"),
(str_store_string,s16,":str_store_troop_name(troop_id_008)"),
(display_message, "str_s15_shares_joy_of_victory_with_s16"),
(try_end),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_011", ":troop_id_008", 3),
(val_add, ":::total_battle_ally_changes", 3),
(party_clear,"p_temp_party_2"),
(try_end),
(try_begin),
(eq,1,1),
(party_collect_attachments_to_party, ":party_id_001", "p_temp_party_2"),
(party_get_num_companion_stacks,":party_num_companions_stacks_009","p_temp_party_2"),
(try_begin),
(gt,":::marshall_defeated_in_battle",0),
(str_store_string,s15,":str_store_troop_name(_marshall_defeated_in_battle)"),
(store_troop_faction,":troop_faction_014","$marshall_defeated_in_battle"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_faction_marshall_s15_involved_in_defeat"),
(try_end),
(else_try),
(eq,":::marshall_defeated_in_battle","trp_player"),
(eq,":party_id_001","p_main_party"),
(faction_slot_eq,"fac_player_supporters_faction",21,0),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_player_faction_marshall_involved_in_defeat"),
(try_end),
(else_try),
(assign,"$marshall_defeated_in_battle",-1),
(try_end),
(try_for_range, ":stack_no_010", 0, ":party_num_companions_stacks_009"),
(party_stack_get_troop_id,      ":troop_id_011","p_temp_party_2",":stack_no_010"),
(try_begin),
(troop_slot_eq,":troop_id_011",2,2),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_015",":troop_id_011",10),
(party_is_active,":troop_slot_015"),
(call_script, "script_cf_party_under_player_suggestion", ":troop_slot_015"),
(call_script, "script_add_log_entry", 36, "trp_player", -1, ":troop_id_011", -1),
(try_end),
(try_end),
(store_troop_faction,":troop_faction_013",":troop_id_011"),
(faction_get_slot,":faction_slot_016",":troop_faction_013",11),
(neq,":troop_id_011",":faction_slot_016"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s14,":str_store_troop_name(troop_id_011)"),
(str_store_string,s15,":str_store_faction_name(troop_faction_013)"),
(display_message, "str_s14_of_s15_defeated_in_battle_loses_one_point_relation_with_liege"),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":faction_slot_016","trp_player"),
(eq,":::players_kingdom",":troop_faction_013"),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_011", ":faction_slot_016", -1),
(val_add, ":::total_battle_ally_changes", -1),
(try_end),
(call_script, "script_faction_inflict_war_damage_on_faction", ":party_faction_003", ":troop_faction_013", 10),
(try_begin),
(this_or_next|is_between,":troop_id_008","trp_npc1","trp_knight_1_1_wife"),
(eq,":troop_id_008","trp_player"),
(this_or_next|eq,":troop_id_008","trp_player"),
(eq,":party_id_002","p_main_party"),
(this_or_next|troop_slot_eq,":troop_id_011",52,2),
(this_or_next|troop_slot_eq,":troop_id_011",52,3),
(troop_slot_eq,":troop_id_011",52,5),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_011", ":troop_id_008", -1),
(val_add, ":::total_battle_enemy_changes", -1),
(eq,":::cheat_mode",1),
(str_store_string,s14,":str_store_troop_name(troop_id_011)"),
(str_store_string,s15,":str_store_troop_name(troop_id_008)"),
(display_message, "str_s14_defeated_in_battle_by_s15_loses_one_point_relation"),
(try_end),
(gt,":::marshall_defeated_in_battle",-1),
(eq,":troop_faction_013",":troop_faction_014"),
(str_store_string,s14,":str_store_troop_name(troop_id_011)"),
(call_script, "script_cf_test_lord_incompatibility_to_s17", ":troop_id_011", "$marshall_defeated_in_battle"),
(eq,":::cheat_mode",1),
(display_message, "str_s14_blames_s15_for_defeat"),
(try_end),
(call_script, "script_add_log_entry", 33, ":troop_id_011", "$marshall_defeated_in_battle", ":faction_slot_016", ":party_faction_003"),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_011", ":faction_slot_016", -15),
(val_add, ":::total_battle_ally_changes", -15),
(neq,":::marshall_defeated_in_battle",":faction_slot_016"),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_011", "$marshall_defeated_in_battle", -15),
(val_add, ":::total_battle_ally_changes", -15),
(try_end),
(party_clear,"p_temp_party_2"),
(try_end),
]),

("faction_inflict_war_damage_on_faction", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":faction_id_002", 2),
(store_script_param, ":var003", 3),
(store_add, ":slot_no_004", ":faction_id_002", 140),
(assign,":slot_no_004 -","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_005",":faction_id_001",":slot_no_004"),
(val_add, ":faction_slot_005", ":var003"),
(faction_set_slot,":faction_id_001",":slot_no_004",":faction_slot_005"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_faction_name(faction_id_001)"),
(str_store_string,s5,":str_store_faction_name(faction_id_002)"),
(assign,reg3,":faction_slot_005"),
(assign,reg4,":var003"),
(assign, reg0, ":"@{!}{s4} inflicts {reg4} damage on {s5}"),
(assign, reg1, ":raising total inflicted to {reg3}""),
(display_message, "@{reg0} {reg1}"),
(try_end),
(faction_get_slot,":faction_slot_006",":faction_id_002",8),
(try_begin),
(ge,":faction_slot_006",0),
(gt,":var003",0),
(troop_get_slot,":troop_slot_007",":faction_slot_006",150),
(val_add, ":troop_slot_007", ":var003"),
(val_min,":troop_slot_007",100),
(troop_set_slot,":faction_slot_006",150,":troop_slot_007"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(faction_slot_006)"),
(assign,reg4,":var003"),
(assign,reg5,":troop_slot_007"),
(display_message, "@@{!}War damage raises {s4}'s controversy by {reg4} to {reg5}"),
(try_end),
(try_end),
(faction_get_slot,":faction_slot_006",":faction_id_001",8),
(try_begin),
(ge,":faction_slot_006",0),
(val_div, ":var003", 3),
(try_begin),
(gt,":var003",0),
(troop_get_slot,":troop_slot_007",":faction_slot_006",150),
(val_sub, ":troop_slot_007", ":var003"),
(val_max,":troop_slot_007",0),
(troop_set_slot,":faction_slot_006",150,":troop_slot_007"),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(faction_slot_006)"),
(assign,reg4,":var003"),
(assign,reg5,":troop_slot_007"),
(display_message, "@@{!}War damage lowers {s4}'s controversy by {reg4} to {reg5}"),
(try_end),
(try_end),
]),

("calculate_troop_political_factors_for_liege", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_001",52),
(store_troop_faction,":troop_faction_004",":troop_id_002"),
(try_begin),
(eq,":troop_faction_004","fac_player_faction"),
(assign,":troop_faction_004","fac_player_supporters_faction"),
(try_end),
(assign,":var005",0),
(try_begin),
(neg|faction_slot_eq,":troop_faction_004",11,":troop_id_002"),
(assign,":var005",1),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s32,":str_store_troop_name(troop_id_002)"),
(display_message, "str_s32_is_undeclared_rebel"),
(try_end),
(try_end),
(assign,":var006",0),
(assign,":var007",0),
(assign,":var008",0),
(assign,":var009",-1),
(try_begin),
(is_between,":troop_id_001","trp_npc1","trp_knight_1_1_wife"),
(try_for_range, ":p_010", ":p.town_1", ":p.salt_mine"),
(eq,":var009",-1),
(party_slot_eq,":p_010",7,":troop_id_001"),
(assign,":var009",":p_010"),
(try_end),
(try_end),
(assign,":var011",0),
(try_for_range, ":p_010", ":p.town_1", ":p.salt_mine"),
(neq,":p_010",":var009"),
(gt,":var009",0),
(try_begin),
(is_between,":p_010","p_town_1","p_castle_1"),
(assign,":var012",9000),
(else_try),
(is_between,":p_010","p_castle_1","p_village_1"),
(assign,":var012",6000),
(else_try),
(assign,":var012",1000),
(try_end),
(store_distance_to_party_from_party,":distance_parties_013",":var009",":var009"),
(val_add, ":distance_parties_013", 10),
(val_div, ":var012", ":distance_parties_013"),
(val_div, ":var012", ":distance_parties_013"),
(store_faction_of_party, ":party_faction_014", ":p_010"),
(try_begin),
(eq,":party_faction_014",":troop_faction_004"),
(assign,":var011",1),
(val_add, ":var008", ":var012"),
(else_try),
(neq,":party_faction_014",":troop_faction_004"),
(store_relation,":faction_relation_015",":party_faction_014",":troop_faction_004"),
(try_begin),
(this_or_next|eq,":var005",1),
(lt,":faction_relation_015",0),
(val_div, ":var012", 2),
(else_try),
(val_div, ":var012", 4),
(try_end),
(val_sub, ":var008", ":var012"),
(try_end),
(try_end),
(try_begin),
(eq,":var011",0),
(val_add, ":var008", 20),
(try_begin),
(eq,":::cheat_mode",2),
(display_message, "str_small_bonus_for_no_base"),
(try_end),
(try_end),
(val_clamp,":var008",-100, 100),
(assign,":var016",":var008"),
(try_begin),
(eq,":troop_slot_003",4),
(val_mul, ":var016", 2),
(else_try),
(eq,":troop_slot_003",1),
(val_div, ":var016", 2),
(try_end),
(assign,":var017",0),
(try_for_range, ":trp_018", ":trp.kingdom_heroes_including_player_begin", ":trp.knight_1_1_wife"),
(assign,":troop_id_019",":trp_018"),
(try_begin),
(this_or_next|troop_slot_eq,":troop_id_019",2,2),
(this_or_next|eq,":troop_id_019","trp_kingdom_heroes_including_player_begin"),
(is_between,":troop_id_019","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(store_troop_faction,":troop_faction_020",":troop_id_019"),
(try_begin),
(eq,":trp_018","trp_kingdom_heroes_including_player_begin"),
(assign,":troop_id_019","trp_player"),
(assign,":troop_faction_020","$players_kingdom"),
(eq,":::g_talk_troop",":troop_id_001"),
(store_troop_faction,":troop_faction_021",":troop_id_001"),
(eq,":troop_faction_021",":troop_faction_004"),
(assign,":troop_faction_020",0),
(try_end),
(try_end),
(eq,":troop_faction_020",":troop_faction_004"),
(neg|faction_slot_eq,":troop_faction_020",11,":troop_id_019"),
(neq,":var005",1),
(neg|is_between,":troop_id_019","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":troop_id_019"),
(assign,":var022",reg0),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_019", ":troop_id_002"),
(assign,":var023",reg0),
(store_mul, ":var024", ":var022", ":var023"),
(val_div, ":var024", 100),
(try_begin),
(eq,":::cheat_mode",2),
(eq,":::g_talk_troop",":troop_id_001"),
(str_store_string,s20,":str_store_faction_name(troop_faction_020)"),
(str_store_string,s15,":str_store_troop_name(troop_id_019)"),
(assign,reg15,":var024"),
(display_message, "str_s15_considered_member_of_faction_s20_weight_of_reg15"),
(try_end),
(try_end),
(val_add, ":var017", ":var024"),
(val_clamp,":var017",-100, 101),
(try_begin),
(eq,1,1),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":troop_id_002"),
(assign,":var025",reg0),
(val_add, ":var017", ":var025"),
(try_end),
(val_div, ":var017", 2),
(val_clamp,":var017",-100, 101),
(assign,":var026",":var017"),
(try_begin),
(this_or_next|eq,":troop_slot_003",2),
(eq,":troop_slot_003",6),
(val_mul, ":var026", 2),
(try_end),
(assign,":var006",0),
(assign,":var027",":var006"),
(try_begin),
(eq,1,0),
(neq,":troop_id_002","trp_player"),
(neq,":troop_id_002",":::supported_pretender"),
(assign,":var028",0),
(assign,":var029",0),
(assign,":var030",0),
(else_try),
(troop_get_slot,":troop_slot_031",":troop_id_001",53),
(call_script, "script_rebellion_arguments", ":troop_id_001", ":troop_slot_031", ":troop_id_002"),
(assign,":var029",reg0),
(assign,":var028",reg1),
(store_add, ":var030", ":var029", ":var028"),
(store_skill_level,":skill_lvl_032","skl_persuasion","trp_player"),
(try_begin),
(gt,":var030",0),
(store_add, ":var033", ":skill_lvl_032", 5),
(val_mul, ":var033", 2),
(val_div, ":var033", 3),
(val_mul, ":var030", ":var033"),
(val_div, ":var030", 10),
(else_try),
(lt,":var030",0),
(store_sub, ":var034", 10, ":skill_lvl_032"),
(val_mul, ":var030", ":var034"),
(val_div, ":var030", 10),
(try_end),
(try_begin),
(neq,":troop_id_002","trp_player"),
(neq,":troop_id_002",":::supported_pretender"),
(val_div, ":var028", 2),
(val_div, ":var029", 2),
(val_div, ":var030", 2),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_troop_faction,":troop_faction_021",":troop_id_001"),
(try_begin),
(eq,":troop_faction_021",":troop_faction_004"),
(assign,":var007",0),
(else_try),
(eq,":troop_id_002","trp_player"),
(store_sub, ":var007", 60, "$player_right_to_rule"),
(else_try),
(troop_get_slot,":troop_slot_035",":troop_id_001",14),
(troop_get_slot,":troop_slot_036",":troop_id_002",14),
(try_begin),
(eq,":troop_slot_035",":troop_slot_036"),
(assign,":var007",10),
(else_try),
(assign,":var007",50),
(try_end),
(try_end),
(try_end),
(val_clamp,":var007",0, 101),
(assign,":var037",":var007"),
(try_begin),
(eq,":troop_slot_003",5),
(val_div, ":var037", 2),
(else_try),
(eq,":troop_slot_003",7),
(val_mul, ":var037", 2),
(try_end),
(assign,reg1,":var008"),
(assign,reg2,":var016"),
(assign,reg3,":var017"),
(assign,reg4,":var026"),
(assign,reg5,":var006"),
(assign,reg6,":var027"),
(assign,reg7,":var028"),
(assign,reg17,":var029"),
(assign,reg8,":var030"),
(assign,reg9,":var007"),
(assign,reg10,":var037"),
(try_begin),
(eq,":::cheat_mode",1),
(eq,":::g_talk_troop",":troop_id_001"),
(str_store_string,s20,":str_store_troop_name(troop_id_001)"),
(str_store_string,s21,":str_store_faction_name(troop_faction_004)"),
(str_store_string,s22,":str_store_troop_name(troop_id_002)"),
(display_message, "@@{!}G talk troop {s20} evaluates being vassal to {s22} of {s21}"),
(display_message, "str_base_result_for_security_reg1"),
(display_message, "str_result_for_security_weighted_by_personality_reg2"),
(display_message, "str_base_result_for_political_connections_reg3"),
(display_message, "str_result_for_political_connections_weighted_by_personality_reg4"),
(try_begin),
(this_or_next|eq,":troop_id_002",":::supported_pretender"),
(eq,":troop_id_002","trp_player"),
(display_message, "str_result_for_argument_strength_reg7"),
(display_message, "str_result_for_argument_appeal_reg17"),
(display_message, "str_combined_result_for_argument_modified_by_persuasion_reg8"),
(try_end),
(display_message, "str_base_changing_sides_penalty_reg9"),
(display_message, "str_changing_sides_penalty_weighted_by_personality_reg10"),
(try_end),
(store_add, ":var038", ":var016", ":var026"),
(val_add, ":var038", ":var027"),
(val_add, ":var038", ":var030"),
(val_sub, ":var038", ":var037"),
(assign,reg0,":var038"),
(try_begin),
(eq,":::cheat_mode",2),
(display_message, "@@{!}DEBUG -- Analyzing lord allegiances - combined bonuses and penalties = {reg0}"),
(try_end),
]),

("cf_troop_can_intrigue", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_001",10),
(try_begin),
(party_is_active,":troop_slot_003"),
(try_begin),
(eq,":::cheat_mode",1),
(eq,":troop_id_001",":::g_talk_troop"),
(display_message, "str_intrigue_test_troop_party_is_active"),
(try_end),
(try_end),
(party_get_battle_opponent, ":party_battle_opponent_004", ":troop_slot_003"),
(try_begin),
(le,":party_battle_opponent_004",0),
(try_begin),
(eq,":::cheat_mode",1),
(eq,":troop_id_001",":::g_talk_troop"),
(display_message, "str_intrigue_test_troop_party_is_not_in_battle"),
(try_end),
(try_end),
(try_begin),
(troop_slot_eq,":troop_id_001",8,-1),
(try_begin),
(eq,":::cheat_mode",1),
(eq,":troop_id_001",":::g_talk_troop"),
(display_message, "str_intrigue_test_troop_is_not_prisoner"),
(try_end),
(try_end),
(party_get_attached_to, ":party_attached_005", ":troop_slot_003"),
(store_faction_of_party, ":party_faction_006", ":troop_slot_003"),
(assign,":var007",0),
(try_for_range, ":trp_008", ":trp.npc1", ":trp.knight_1_1_wife"),
(neq,":troop_id_001",":trp_008"),
(eq,":var007",0),
(troop_slot_eq,":trp_008",2,2),
(troop_get_slot,":troop_slot_009",":trp_008",10),
(party_is_active,":troop_slot_009"),
(neq,":troop_slot_003",":troop_slot_009"),
(store_faction_of_party, ":party_faction_010", ":troop_slot_009"),
(eq,":party_faction_006",":party_faction_010"),
(eq,":party_attached_005",-1),
(store_distance_to_party_from_party,":distance_parties_011",":troop_slot_003",":troop_slot_003"),
(try_begin),
(lt,":distance_parties_011",3),
(assign,":var007",1),
(else_try),
(is_between,":party_attached_005","p_town_1","p_village_1"),
(party_get_attached_to, ":party_attached_012", ":troop_slot_009"),
(try_begin),
(eq,":party_attached_005",":party_attached_012"),
(assign,":var007",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(eq,":troop_id_001",":::g_talk_troop"),
(display_message, "str_intrigue_test_troop_is_nearby"),
(try_end),
(try_begin),
(eq,":var002",0),
(try_end),
]),

("troop_change_relation_with_troop", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(store_script_param, ":var003", 3),
(try_begin),
(eq,":troop_id_001","trp_player"),
(call_script, "script_change_player_relation_with_troop", ":troop_id_002", ":var003"),
(else_try),
(eq,":troop_id_002","trp_player"),
(call_script, "script_change_player_relation_with_troop", ":troop_id_001", ":var003"),
(else_try),
(eq,":troop_id_001",":troop_id_002"),
(else_try),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":troop_id_002"),
(store_add, ":var004", reg0, ":var003"),
(val_clamp,":var004",-100, 101),
(try_begin),
(eq,":var004",0),
(assign,":var004",1),
(try_end),
(store_add, ":slot_no_005", ":troop_id_002", 0),
(troop_set_slot,":troop_id_001",":slot_no_005",":var004"),
(store_add, ":slot_no_006", ":troop_id_001", 0),
(troop_set_slot,":troop_id_002",":slot_no_006",":var004"),
(try_end),
(try_begin),
(lt,":var003",-5),
(try_begin),
(eq,":troop_id_001","trp_player"),
(assign,":troop_faction_007","$players_kingdom"),
(else_try),
(store_troop_faction,":troop_faction_007",":troop_id_001"),
(try_end),
(try_begin),
(eq,":troop_id_002","trp_player"),
(assign,":troop_faction_008","$players_kingdom"),
(else_try),
(store_troop_faction,":troop_faction_008",":troop_id_002"),
(try_end),
(try_begin),
(eq,":troop_faction_007",":troop_faction_008"),
(is_between,":troop_faction_007","fac_player_supporters_faction","fac_kingdoms_end"),
(store_mul, ":var009", ":var003", -1),
(troop_get_slot,":troop_slot_010",":troop_id_001",150),
(val_add, ":troop_slot_010", ":var009"),
(val_min,":troop_slot_010",100),
(troop_set_slot,":troop_id_001",150,":troop_slot_010"),
(troop_get_slot,":troop_slot_011",":troop_id_002",150),
(val_add, ":troop_slot_011", ":var009"),
(val_min,":troop_slot_011",100),
(troop_set_slot,":troop_id_002",150,":troop_slot_011"),
(try_end),
(try_end),
(try_begin),
(is_between,":troop_id_001","trp_npc1","trp_knight_1_1_wife"),
(is_between,":troop_id_002","trp_npc1","trp_knight_1_1_wife"),
(neq,":troop_id_001",":troop_id_002"),
(try_begin),
(gt,":var003",0),
(val_add, ":::total_relation_adds", ":var003"),
(else_try),
(val_sub, ":::total_relation_subs", ":var003"),
(try_end),
(try_end),
(try_begin),
(eq,":::cheat_mode",4),
(is_between,":troop_id_001","trp_npc1","trp_knight_1_1_wife"),
(is_between,":troop_id_002","trp_npc1","trp_knight_1_1_wife"),
(neq,":troop_id_001",":troop_id_002"),
(str_store_string,s20,":str_store_troop_name(troop_id_001)"),
(str_store_string,s15,":str_store_troop_name(troop_id_002)"),
(assign,reg4,":var003"),
(assign,reg14,":var004"),
(display_message, "str_s20_relation_with_s15_changed_by_reg4_to_reg14"),
(assign,reg4,"$total_relation_adds"),
(display_message, "str_total_additions_reg4"),
(assign,reg4,"$total_relation_subs"),
(display_message, "str_total_subtractions_reg4"),
(assign,reg4,"$total_courtship_quarrel_changes"),
(display_message, "@@{!}DEBUG -- Total courtship quarrel changes: {reg4}"),
(assign,reg4,"$total_random_quarrel_changes"),
(display_message, "@@{!}DEBUG -- Total random quarrel changes: {reg4}"),
(assign,reg4,"$total_battle_ally_changes"),
(display_message, "@@{!}DEBUG -- Total battle changes for allies: {reg4}"),
(assign,reg4,"$total_battle_enemy_changes"),
(display_message, "@@{!}DEBUG -- Total battle changes for enemies: {reg4}"),
(assign,reg4,"$total_promotion_changes"),
(display_message, "@@{!}DEBUG -- Total promotion changes: {reg4}"),
(assign,reg4,"$total_feast_changes"),
(display_message, "@@{!}DEBUG -- Total feast changes: {reg4}"),
(assign,reg4,"$total_policy_dispute_changes"),
(assign,reg5,"$number_of_controversial_policy_decisions"),
(display_message, "@@{!}DEBUG -- Total policy dispute changes: {reg4} from {reg5} decisions"),
(assign,reg4,"$total_indictment_changes"),
(display_message, "@@{!}DEBUG -- Total faction switch changes: {reg4}"),
(assign,reg4,"$total_no_fief_changes"),
(display_message, "@@{!}DEBUG -- Total no fief changes: {reg4}"),
(assign,reg4,"$total_relation_changes_through_convergence"),
(display_message, "@@{!}DEBUG -- Total changes through convergence: {reg4}"),
(assign,reg4,"$total_vassal_days_responding_to_campaign"),
(display_message, "@@{!}DEBUG -- Total vassal responses to campaign: {reg4}"),
(assign,reg4,"$total_vassal_days_on_campaign"),
(display_message, "@@{!}DEBUG -- Total vassal campaign days: {reg4}"),
(val_max,"$total_vassal_days_on_campaign",1),
(store_mul, ":var012", "$total_vassal_days_responding_to_campaign", 100),
(val_div, ":var012", ":::total_vassal_days_on_campaign"),
(assign,reg4,":var012"),
(display_message, "@@{!}DEBUG -- Vassal response rate: {reg4}"),
(try_end),
]),

("troop_get_relation_with_troop", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(assign,":troop_slot_003",0),
(try_begin),
(this_or_next|eq,":troop_id_001",-1),
(eq,":var002",-1),
(assign,":troop_slot_003",0),
(else_try),
(eq,":troop_id_001","trp_player"),
(call_script, "script_troop_get_player_relation", ":var002"),
(assign,":troop_slot_003",reg0),
(else_try),
(eq,":var002","trp_player"),
(call_script, "script_troop_get_player_relation", ":troop_id_001"),
(assign,":troop_slot_003",reg0),
(else_try),
(store_add, ":slot_no_004", ":var002", 0),
(troop_get_slot,":troop_slot_003",":troop_id_001",":slot_no_004"),
(try_end),
(val_clamp,":troop_slot_003",-100, 101),
(assign,reg0,":troop_slot_003"),
]),

("appoint_faction_marshall", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(faction_get_slot,":faction_slot_003",":faction_id_001",11),
(faction_get_slot,":faction_slot_004",":faction_id_001",8),
(faction_set_slot,":faction_id_001",8,":troop_id_002"),
(try_begin),
(ge,":faction_slot_004",0),
(troop_get_slot,":troop_slot_005",":faction_slot_004",10),
(try_begin),
(party_is_active,":troop_slot_005"),
(party_set_marshal, ":troop_slot_005", 0),
(try_end),
(try_end),
(try_begin),
(ge,":troop_id_002",0),
(troop_get_slot,":troop_slot_006",":troop_id_002",10),
(try_begin),
(party_is_active,":troop_slot_006"),
(party_set_marshal, ":troop_slot_006", 1),
(try_end),
(try_end),
(try_begin),
(neq,":troop_id_002",":faction_slot_003"),
(neq,":troop_id_002",":faction_slot_004"),
(this_or_next|eq,":troop_id_002","trp_player"),
(is_between,":troop_id_002","trp_npc1","trp_knight_1_1_wife"),
(this_or_next|eq,":faction_id_001","fac_player_supporters_faction"),
(neg|check_quest_active,"qst_rebel_against_kingdom"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s15,":str_store_faction_name(faction_id_001)"),
(display_message, "str_checking_lord_reactions_in_s15"),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_002", ":faction_slot_003", 5),
(val_add, ":::total_promotion_changes", 5),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_007",2,2),
(store_troop_faction,":troop_faction_008",":trp_007"),
(try_begin),
(eq,":troop_faction_008",":faction_id_001"),
(neq,":trp_007",":troop_id_002"),
(neq,":trp_007",":faction_slot_003"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_002", ":trp_007"),
(store_sub, ":var009", reg0, 10),
(val_div, ":var009", 15),
(neq,":var009",0),
(troop_slot_eq,":trp_007",154,":troop_id_002"),
(val_add, ":var009", 1),
(val_max,":var009",0),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":faction_slot_003", ":trp_007", ":var009"),
(val_add, ":::total_promotion_changes", ":var009"),
(lt,":var009",-2),
(store_random_in_range,":random_x_010",1,10),
(val_add, ":var009", ":random_x_010"),
(try_begin),
(lt,":var009",0),
(str_store_string,s14,":str_store_troop_name(trp_007)"),
(str_store_string,s15,":str_store_troop_name(troop_id_002)"),
(eq,":::cheat_mode",1),
(display_message, "str_s14_protests_the_appointment_of_s15_as_marshall"),
(try_end),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":faction_slot_003", ":trp_007", -10),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_002", ":trp_007", -5),
(val_add, ":::total_promotion_changes", -15),
(call_script, "script_add_log_entry", 32, ":trp_007", ":troop_id_002", ":faction_slot_003", "$g_encountered_party_faction"),
(try_end),
]),

("center_get_item_consumption", [
]),

("locate_player_minister", [
(assign,":var001",0),
(try_for_range, ":p_002", ":p.town_1", ":p.village_1"),
(lt,":var001","p_town_1"),
(store_faction_of_party, ":party_faction_003", ":p_002"),
(eq,":party_faction_003","fac_player_supporters_faction"),
(neg|party_slot_ge,":p_002",7,"trp_npc1"),
(assign,":var001",":p_002"),
(try_end),
(try_end),
(troop_get_slot,":troop_slot_004","$g_player_minister",12),
(troop_set_slot,"$g_player_minister",12,":var001"),
(try_begin),
(neq,":troop_slot_004",":p_002"),
(str_store_string,s10,":str_store_party_name(p_002)"),
(str_store_string,s11,":str_store_troop_name(_g_player_minister)"),
(display_message, "str_s11_relocates_to_s10"),
(try_end),
]),

("lord_get_home_center", [
(store_script_param, ":troop_id_001", 1),
(assign,":var002",-1),
(try_for_range, ":p_003", ":p.town_1", ":p.village_1"),
(eq,":var002",-1),
(party_slot_eq,":p_003",7,":troop_id_001"),
(assign,":var002",":p_003"),
(try_end),
(try_begin),
(eq,":var002",-1),
(try_for_range, ":p_003", ":p.town_1", ":p.salt_mine"),
(eq,":var002",-1),
(party_slot_eq,":p_003",7,":troop_id_001"),
(neg|is_between,":p_003","p_town_1","p_village_1"),
(party_get_slot,":party_slot_004",":p_003",120),
(assign,":var002",":party_slot_004"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var002",-1),
(store_troop_faction,":troop_faction_005",":troop_id_001"),
(try_begin),
(eq,":troop_faction_005","fac_player_supporters_faction"),
(is_between,"$g_player_court","p_town_1","p_village_1"),
(store_faction_of_party, ":party_faction_006", "$g_player_court"),
(eq,":party_faction_006","fac_player_supporters_faction"),
(assign,":var002","$g_player_court"),
(try_end),
(try_end),
(try_begin),
(eq,":var002",-1),
(store_troop_faction,":troop_faction_005",":troop_id_001"),
(faction_get_slot,":faction_slot_007",":troop_faction_005",11),
(try_begin),
(neq,":troop_id_001",":faction_slot_007"),
(call_script, "script_lord_get_home_center", ":faction_slot_007"),
(gt,reg0,-1),
(assign,":var002",reg0),
(try_end),
(try_end),
(try_begin),
(eq,":var002",-1),
(store_troop_faction,":troop_faction_005",":troop_id_001"),
(try_for_range, ":p_008", ":p.town_1", ":p.village_1"),
(eq,":var002",-1),
(store_faction_of_party, ":party_faction_009", ":p_008"),
(eq,":troop_faction_005",":party_faction_009"),
(assign,":var002",":p_008"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("get_kingdom_lady_social_determinants", [
(store_script_param, ":troop_id_001", 1),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(assign,":var003",-1),
(assign,":troop_slot_004",-1),
(assign,":var005",0),
(try_begin),
(troop_slot_ge,":troop_id_001",30,0),
(troop_get_slot,":troop_slot_004",":troop_id_001",30),
(else_try),
(troop_slot_ge,":troop_id_001",31,0),
(troop_get_slot,":troop_slot_004",":troop_id_001",31),
(else_try),
(troop_slot_ge,":troop_id_001",33,0),
(troop_get_slot,":troop_slot_004",":troop_id_001",33),
(try_end),
(try_begin),
(faction_slot_eq,":troop_faction_002",4,6),
(faction_get_slot,":faction_slot_006",":troop_faction_002",5),
(try_begin),
(gt,":troop_slot_004",-1),
(troop_get_slot,":troop_slot_007",":troop_slot_004",10),
(party_is_active,":troop_slot_007"),
(party_get_attached_to, ":party_attached_008", ":troop_slot_007"),
(try_begin),
(eq,":party_attached_008",":faction_slot_006"),
(is_between,":faction_slot_006","p_town_1","p_village_1"),
(assign,":var003",":faction_slot_006"),
(else_try),
(troop_slot_eq,"trp_player",30,":troop_id_001"),
(is_between,"$g_player_court","p_town_1","p_village_1"),
(assign,":var003","$g_player_court"),
(else_try),
(try_for_range, ":p_009", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_010", ":p_009"),
(try_begin),
(this_or_next|eq,":troop_faction_002",":party_faction_010"),
(neg|is_between,":troop_faction_002","fac_player_supporters_faction","fac_kingdoms_end"),
(party_get_slot,":party_slot_011",":p_009",7),
(try_begin),
(gt,":party_slot_011",-1),
(call_script, "script_troop_get_family_relation_to_troop", ":troop_id_001", ":party_slot_011"),
(try_begin),
(this_or_next|is_between,":troop_faction_002","fac_player_supporters_faction","fac_kingdoms_end"),
(troop_slot_eq,"trp_player",30,":troop_id_001"),
(faction_slot_eq,":troop_faction_002",11,":party_slot_011"),
(val_max,reg0,1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(eq,":::cheat_mode",2),
(str_store_string,s3,":str_store_troop_name(troop_id_001)"),
(str_store_string,s4,":str_store_troop_name(party_slot_011)"),
(str_store_string,s5,":str_store_party_name(p_009)"),
(display_message, "str_checking_s3_at_s5_with_s11_relationship_with_s4_score_reg0"),
(str_clear, 11),
(try_end),
(gt,reg0,":var005"),
(assign,":var005",reg0),
(assign,":var003",":p_009"),
(try_end),
(try_end),
(assign,reg0,":troop_slot_004"),
(assign,reg1,":var003"),
]),

("age_troop_one_year", [
(store_script_param, ":troop_id_001", 1),
(troop_get_type,":troop_type_002",":troop_id_001"),
(troop_get_slot,":troop_slot_003",":troop_id_001",18),
(troop_get_slot,":troop_slot_004",":troop_id_001",19),
(val_add, ":troop_slot_003", 1),
(store_random_in_range,":random_x_005",1,5),
(try_begin),
(eq,":troop_type_002",1),
(try_end),
(val_add, ":troop_slot_004", ":random_x_005"),
(try_begin),
(gt,":troop_slot_003",45),
(store_attribute_level,":attribute_lvl_006",":troop_id_001",0),
(store_attribute_level,":attribute_lvl_007",":troop_id_001",1),
(store_random_in_range,":random_x_008",0,50),
(try_begin),
(lt,":random_x_008",":attribute_lvl_006"),
(troop_raise_attribute,":troop_id_001",0,-1),
(try_end),
(try_begin),
(lt,":random_x_008",":attribute_lvl_007"),
(troop_raise_attribute,":troop_id_001",1,-1),
(try_end),
(try_end),
(val_clamp,":troop_slot_004",1, 100),
(troop_set_slot,":troop_id_001",18,":troop_slot_003"),
(troop_set_slot,":troop_id_001",19,":troop_slot_004"),
(troop_set_age, ":troop_id_001", ":troop_slot_004"),
]),

("add_lady_items", [
(store_script_param, ":troop_id_001", 1),
(troop_equip_items,":troop_id_001"),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(store_random_in_range,":random_x_003",0,6),
(try_begin),
(this_or_next|troop_slot_eq,":troop_id_001",52,22),
(troop_slot_eq,":troop_id_001",52,24),
(this_or_next|troop_slot_eq,":troop_id_001",52,22),
(lt,":random_x_003",2),
(neg|troop_slot_ge,":troop_id_001",18,40),
(try_begin),
(eq,":troop_faction_002","fac_kingdom_2"),
(lt,":random_x_003",4),
(troop_add_item,":troop_id_001","itm_fur_coat",0),
(else_try),
(eq,":troop_faction_002","fac_kingdom_3"),
(lt,":random_x_003",3),
(troop_add_item,":troop_id_001","itm_nomad_robe",0),
(else_try),
(troop_add_item,":troop_id_001","itm_nomad_vest",0),
(try_end),
(else_try),
(eq,":troop_faction_002","fac_kingdom_1"),
(try_begin),
(lt,":random_x_003",2),
(troop_add_item,":troop_id_001","itm_lady_dress_ruby",0),
(else_try),
(lt,":random_x_003",4),
(troop_add_item,":troop_id_001","itm_lady_dress_green",0),
(else_try),
(troop_add_item,":troop_id_001","itm_lady_dress_blue",0),
(try_end),
(else_try),
(eq,":troop_faction_002","fac_kingdom_2"),
(try_begin),
(eq,":random_x_003",0),
(troop_add_item,":troop_id_001","itm_blue_dress",0),
(else_try),
(eq,":random_x_003",1),
(troop_add_item,":troop_id_001","itm_lady_dress_green",0),
(else_try),
(eq,":random_x_003",2),
(troop_add_item,":troop_id_001","itm_lady_dress_blue",0),
(else_try),
(lt,":random_x_003",5),
(neg|troop_slot_eq,":troop_id_001",52,21),
(neg|troop_slot_eq,":troop_id_001",52,24),
(troop_add_item,":troop_id_001","itm_peasant_dress",0),
(else_try),
(lt,":random_x_003",5),
(troop_add_item,":troop_id_001","itm_lady_dress_ruby",0),
(else_try),
(troop_add_item,":troop_id_001","itm_court_dress",0),
(try_end),
(else_try),
(eq,":troop_faction_002","fac_kingdom_3"),
(troop_add_item,":troop_id_001","itm_khergit_lady_dress",0),
(else_try),
(eq,":troop_faction_002","fac_kingdom_4"),
(else_try),
(eq,":troop_faction_002","fac_kingdom_5"),
(try_end),
(troop_equip_items,":troop_id_001"),
(try_begin),
(this_or_next|troop_has_item_equipped,":troop_id_001","itm_nomad_vest"),
(this_or_next|troop_has_item_equipped,":troop_id_001","itm_fur_coat"),
(troop_has_item_equipped,":troop_id_001","itm_nomad_robe"),
(else_try),
(this_or_next|troop_slot_eq,":troop_id_001",52,25),
(this_or_next|troop_slot_eq,":troop_id_001",52,21),
(lt,":random_x_003",2),
(try_begin),
(troop_has_item_equipped,":troop_id_001","itm_khergit_lady_dress"),
(troop_add_item,":troop_id_001","itm_khergit_lady_hat",0),
(else_try),
(troop_has_item_equipped,":troop_id_001","itm_lady_dress_ruby"),
(troop_add_item,":troop_id_001","itm_turret_hat_ruby",0),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(else_try),
(troop_has_item_equipped,":troop_id_001","itm_lady_dress_blue"),
(troop_add_item,":troop_id_001","itm_turret_hat_blue",0),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(else_try),
(troop_has_item_equipped,":troop_id_001","itm_lady_dress_green"),
(troop_add_item,":troop_id_001","itm_turret_hat_green",0),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(else_try),
(troop_has_item_equipped,":troop_id_001","itm_green_dress"),
(troop_add_item,":troop_id_001","itm_wimple_with_veil",0),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(else_try),
(neq,":troop_faction_002","fac_kingdom_3"),
(neq,":troop_faction_002","fac_kingdom_6"),
(troop_add_item,":troop_id_001","itm_wimple_a",0),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(else_try),
(eq,":troop_faction_002","fac_kingdom_6"),
(try_begin),
(troop_has_item_equipped,":troop_id_001","itm_sarranid_lady_dress"),
(troop_add_item,":troop_id_001","itm_sarranid_head_cloth",0),
(else_try),
(troop_add_item,":troop_id_001","itm_sarranid_head_cloth_b",0),
(try_end),
(try_end),
(try_end),
(troop_equip_items,":troop_id_001"),
]),

("init_troop_age", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(try_begin),
(gt,":var002",20),
(troop_set_slot,":troop_id_001",18,20),
(else_try),
(troop_set_slot,":troop_id_001",18,":var002"),
(try_end),
(store_sub, ":var003", ":var002", 20),
(troop_set_age, ":troop_id_001", 0),
(try_begin),
(gt,":var003",0),
(try_for_range, ":var004", 0, ":var003"),
(call_script, "script_age_troop_one_year", ":troop_id_001"),
(try_end),
(try_end),
]),

("assign_troop_love_interests", [
(store_script_param, ":troop_id_001", 1),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(try_for_range, ":var003", 0, 50),
(store_random_in_range,":random_x_004","trp_knight_1_1_wife","trp_heroes_end"),
(try_begin),
(troop_slot_eq,":random_x_004",30,-1),
(store_troop_faction,":troop_faction_005",":random_x_004"),
(eq,":troop_faction_002",":troop_faction_005"),
(call_script, "script_troop_get_family_relation_to_troop", ":troop_id_001", ":random_x_004"),
(eq,reg0,0),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":random_x_004"),
(eq,reg0,0),
(neg|troop_slot_eq,":troop_id_001",35,":random_x_004"),
(neg|troop_slot_eq,":troop_id_001",36,":random_x_004"),
(neg|troop_slot_eq,":troop_id_001",37,":random_x_004"),
(try_begin),
(troop_slot_eq,":troop_id_001",35,0),
(troop_set_slot,":troop_id_001",35,":random_x_004"),
(else_try),
(troop_slot_eq,":troop_id_001",36,0),
(troop_set_slot,":troop_id_001",36,":random_x_004"),
(else_try),
(troop_slot_eq,":troop_id_001",37,0),
(troop_set_slot,":troop_id_001",37,":random_x_004"),
(try_end),
(try_end),
(try_end),
]),

("faction_conclude_feast", [
(store_script_param, ":var001", 1),
(store_script_param, ":party_id_002", 2),
(str_store_string,s3,":str_store_faction_name(var001)"),
(str_store_string,s4,":str_store_party_name(party_id_002)"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_s3_feast_concludes_at_s4"),
(try_end),
(try_begin),
(eq,":var001","fac_player_faction"),
(assign,":var001","$players_kingdom"),
(try_end),
(party_set_slot,":party_id_002",156,0),
(assign,":var003",0),
(assign,":var004",0),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.heroes_end"),
(store_troop_faction,":troop_faction_006",":trp_005"),
(try_begin),
(eq,":var001",":troop_faction_006"),
(val_add, ":var003", 1),
(troop_slot_eq,":trp_005",12,":party_id_002"),
(val_add, ":var004", 1),
(troop_slot_eq,":trp_005",2,6),
(troop_get_slot,":troop_slot_007",":trp_005",34),
(gt,":troop_slot_007",0),
(troop_get_slot,":troop_slot_008",":troop_slot_007",10),
(party_is_active,":troop_slot_008"),
(party_get_attached_to, ":party_attached_009", ":troop_slot_008"),
(eq,":party_attached_009",":party_id_002"),
(store_troop_faction,":troop_faction_010",":trp_005"),
(store_troop_faction,":troop_faction_011",":troop_slot_007"),
(eq,":troop_faction_011",":troop_faction_010"),
(eq,":troop_faction_010",":var001"),
(store_current_hours,":cur_hours_012"),
(troop_get_slot,":troop_slot_013",":trp_005",39),
(val_sub, ":cur_hours_012", ":troop_slot_013"),
(ge,":cur_hours_012",144),
(call_script, "script_get_kingdom_lady_social_determinants", ":trp_005"),
(assign,":var014",reg1),
(eq,":party_id_002",":var014"),
(neq,":trp_005","trp_player"),
(neq,":troop_slot_007","trp_player"),
(call_script, "script_courtship_event_bride_marry_groom", ":trp_005", ":troop_slot_007", 0),
(try_end),
(try_end),
(party_get_slot,":party_slot_015",":party_id_002",7),
(assign,":var016",0),
(try_begin),
(check_quest_active,"qst_organize_feast"),
(quest_slot_eq,"qst_organize_feast",1,":party_id_002"),
(assign,":party_slot_015","trp_player"),
(call_script, "script_succeed_quest", "qst_organize_feast"),
(call_script, "script_end_quest", "qst_organize_feast"),
(call_script, "script_internal_politics_rate_feast_to_s9", "trp_household_possessions", 400, "$players_kingdom", 1), # var017
(assign,":var016",reg0),
(else_try),
(assign,":var016",60),
(try_end),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(party_slot_015)"),
(assign,reg4,":var016"),
(display_message, "@@{!}DEBUG - {s4}'s feast has rating of {reg4}"),
(try_end),
(try_begin),
(ge,":party_slot_015",0),
(store_div, ":var___x1", ":var016", 3),
(assign,":var018",":var___x1"),
(call_script, "script_change_troop_renown", ":party_slot_015", ":var018"),
(try_for_range, ":trp_005", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_005",2,2),
(troop_get_slot,":troop_slot_019",":trp_005",10),
(try_begin),
(party_is_active,":troop_slot_019"),
(party_get_attached_to, ":party_attached_020", ":troop_slot_019"),
(eq,":party_attached_020",":party_id_002"),
(assign,":var021",":var016"),
(val_div, ":var021", 20),
(eq,":party_slot_015","trp_player"),
(val_sub, ":var021", 1),
(val_max,":var021",0),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":party_slot_015", ":trp_005", ":var021"),
(val_add, ":::total_feast_changes", ":var021"),
(try_end),
(try_end),
(assign,reg3,":var004"),
(assign,reg4,":var003"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_attendance_reg3_nobles_out_of_reg4"),
(try_end),
]),

("lady_evaluate_troop_as_suitor", [
(store_script_param, ":var001", 1),
(store_script_param, ":troop_id_002", 2),
(call_script, "script_troop_get_romantic_chemistry_with_troop", ":var001", ":troop_id_002"),
(assign,":var003",reg0),
(try_begin),
(call_script,"script_cf_test_lord_incompatibility_to_s17"),
(try_end),
(store_sub, ":var004", 0, reg0),
(assign,reg2,":var004"),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_005",":troop_id_002",7),
(val_div, ":troop_slot_005", 20),
(try_begin),
(this_or_next|troop_slot_eq,":var001",52,21),
(troop_slot_eq,":var001",52,24),
(val_mul, ":troop_slot_005", 2),
(val_sub, ":troop_slot_005", 15),
(try_end),
(try_end),
(store_add, ":var006", ":troop_slot_005", ":var004"),
(val_add, ":var006", ":var003"),
(assign,reg0,":var006"),
]),

("courtship_event_troop_court_lady", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_002",38),
(troop_set_slot,":troop_id_002",38,":troop_id_001"),
(try_begin),
(eq,":troop_slot_003","trp_player"),
(troop_slot_ge,":troop_id_002",5,2),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", "trp_player"),
(assign,":var004",reg0),
(try_begin),
(this_or_next|troop_slot_eq,":troop_id_001",52,3),
(this_or_next|troop_slot_eq,":troop_id_001",52,2),
(troop_slot_eq,":troop_id_001",52,5),
(gt,":var004",-20),
(call_script, "script_add_log_entry", 31, ":troop_id_001", "trp_player", ":troop_id_002", 0),
(else_try),
(is_between,":var004",-5,-25),
(call_script, "script_add_log_entry", 31, ":troop_id_001", "trp_player", ":troop_id_002", 0),
(try_end),
(else_try),
(neq,":troop_slot_003","trp_player"),
(neq,":troop_id_001",":troop_slot_003"),
(ge,":troop_slot_003","trp_npc1"),
(call_script, "script_cf_test_lord_incompatibility_to_s17", ":troop_id_001", ":troop_slot_003"),
(call_script, "script_add_log_entry", 31, ":troop_id_001", ":troop_slot_003", ":troop_id_002", 0),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":troop_slot_003"),
(try_begin),
(ge,reg0,0),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_001", ":troop_slot_003", -20),
(val_add, ":::total_courtship_quarrel_changes", -20),
(else_try),
(troop_slot_eq,":troop_id_001",52,2),
(neq,":troop_id_001",":troop_slot_003"),
(ge,":troop_slot_003","trp_npc1"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":troop_slot_003"),
(try_begin),
(lt,reg0,10),
(call_script, "script_add_log_entry", 31, ":troop_id_001", ":troop_slot_003", ":troop_id_002", 0),
(try_begin),
(ge,reg0,0),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_001", ":troop_slot_003", -20),
(val_add, ":::total_courtship_quarrel_changes", -20),
(try_end),
(try_end),
(try_end),
(try_end),
(call_script, "script_lady_evaluate_troop_as_suitor", ":troop_id_002", ":troop_id_001"),
(store_random_in_range,":random_x_005",5,16),
(store_div, ":var___x1", reg0, ":random_x_005"),
(assign,":var006",":var___x1"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_002", ":troop_id_001"),
(assign,":var007",reg0),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_002", ":troop_id_001", ":var006"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_002", ":troop_id_001"),
(assign,":var008",reg0),
(try_begin),
(ge,":var008",10),
(lt,":var007",10),
(call_script, "script_add_log_entry", 51, ":troop_id_002", 0, ":troop_id_001", 0),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_note__favor_event_logged"),
(try_end),
(else_try),
(this_or_next|ge,":var008",-20),
(ge,":var008",20),
(call_script, "script_get_kingdom_lady_social_determinants", ":troop_id_002"),
(assign,":var009",reg0),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":var009"),
(assign,":var010",reg0),
(assign,":var011",-1),
(assign,":var012",-1),
(assign,":var013",":var010"),
(assign,":var014",-1),
(try_for_range, ":trp_015", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(neq,":trp_015",":troop_id_001"),
(this_or_next|troop_slot_eq,":trp_015",35,":troop_id_002"),
(this_or_next|troop_slot_eq,":trp_015",36,":troop_id_002"),
(troop_slot_eq,":trp_015",37,":troop_id_002"),
(try_begin),
(eq,1,1),
(call_script, "script_troop_get_relation_with_troop", ":trp_015", ":troop_id_002"),
(try_begin),
(gt,reg0,":var011"),
(assign,":var012",":trp_015"),
(assign,":var011",reg0),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(call_script, "script_troop_get_relation_with_troop", ":trp_015", ":var009"),
(try_begin),
(gt,reg0,":var013"),
(assign,":var014",":trp_015"),
(assign,":var013",reg0),
(try_end),
(try_end),
(try_end),
(try_begin),
(lt,":var008",-20),
(this_or_next|troop_slot_eq,":var009",52,3),
(this_or_next|troop_slot_eq,":var009",52,5),
(troop_slot_eq,":var009",52,2),
(eq,":var014",-1),
(this_or_next|troop_slot_eq,":troop_id_001",52,3),
(this_or_next|troop_slot_eq,":troop_id_001",52,5),
(troop_slot_eq,":troop_id_001",52,2),
(troop_slot_eq,":troop_id_001",34,-1),
(troop_slot_eq,":troop_id_002",34,-1),
(call_script, "script_add_log_entry", 53, ":troop_id_002", 0, ":troop_id_001", 0),
(troop_set_slot,":troop_id_001",34,":troop_id_002"),
(troop_set_slot,":troop_id_002",34,":troop_id_001"),
(store_current_hours,":cur_hours_016"),
(troop_set_slot,":troop_id_002",39,":cur_hours_016"),
(troop_set_slot,":troop_id_001",39,":cur_hours_016"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_result_lady_forced_to_agree_to_engagement"),
(try_end),
(else_try),
(lt,":var008",-20),
(call_script, "script_add_log_entry", 54, ":troop_id_002", 0, ":troop_id_001", 0),
(call_script, "script_courtship_event_lady_break_relation_with_suitor", ":troop_id_002", ":troop_id_001"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_result_lady_rejects_suitor"),
(try_end),
(else_try),
(gt,":var008",20),
(gt,":var010",0),
(eq,":var012",-1),
(troop_slot_eq,":troop_id_001",34,-1),
(troop_slot_eq,":troop_id_002",34,-1),
(call_script, "script_add_log_entry", 52, ":troop_id_002", 0, ":troop_id_001", 0),
(troop_set_slot,":troop_id_001",34,":troop_id_002"),
(troop_set_slot,":troop_id_002",34,":troop_id_001"),
(store_current_hours,":cur_hours_016"),
(troop_set_slot,":troop_id_002",39,":cur_hours_016"),
(troop_set_slot,":troop_id_001",39,":cur_hours_016"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_id_002)"),
(str_store_string,s5,":str_store_troop_name(troop_id_001)"),
(display_message, "str_result_happy_engagement_between_s4_and_s5"),
(try_end),
(else_try),
(gt,":var008",20),
(eq,":var012",-1),
(this_or_next|troop_slot_eq,":var009",52,22),
(troop_slot_eq,":var009",52,24),
(troop_slot_eq,":troop_id_001",34,-1),
(troop_slot_eq,":troop_id_002",34,-1),
(call_script, "script_courtship_event_bride_marry_groom", ":troop_id_002", ":troop_id_001", 1),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_id_002)"),
(str_store_string,s5,":str_store_troop_name(troop_id_001)"),
(display_message, "str_result_s4_elopes_with_s5"),
(try_end),
(else_try),
(troop_slot_eq,":troop_id_002",52,21),
(eq,":var014",-1),
(gt,":var010",4),
(store_random_in_range,":random_x_005",0,5),
(try_begin),
(eq,":random_x_005",0),
(troop_slot_eq,":troop_id_001",34,-1),
(troop_slot_eq,":troop_id_002",34,-1),
(call_script, "script_add_log_entry", 59, ":troop_id_002", 0, ":troop_id_001", 0),
(troop_set_slot,":troop_id_001",34,":troop_id_002"),
(troop_set_slot,":troop_id_002",34,":troop_id_001"),
(store_current_hours,":cur_hours_016"),
(troop_set_slot,":troop_id_002",39,":cur_hours_016"),
(troop_set_slot,":troop_id_001",39,":cur_hours_016"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_id_002)"),
(str_store_string,s5,":str_store_troop_name(troop_id_001)"),
(display_message, "str_result_s4_reluctantly_agrees_to_engagement_with_s5"),
(try_end),
(try_end),
(else_try),
(gt,":var008",20),
(store_random_in_range,reg3,0,3),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_result_stalemate_patience_roll_=_reg3"),
(try_end),
(try_begin),
(eq,reg3,0),
(call_script, "script_add_log_entry", 58, ":troop_id_002", 0, ":troop_id_001", 0),
(call_script, "script_courtship_event_lady_break_relation_with_suitor", ":troop_id_002", ":troop_id_001"),
(try_end),
(try_end),
(try_end),
]),

("courtship_event_lady_break_relation_with_suitor", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(try_for_range, ":slot_no_003", 35, 38),
(troop_slot_eq,":troop_id_002",":slot_no_003",":troop_id_001"),
(troop_set_slot,":troop_id_002",":slot_no_003",0),
(try_end),
(call_script, "script_assign_troop_love_interests", ":troop_id_002"),
(try_begin),
(troop_slot_eq,":troop_id_001",34,":troop_id_002"),
(troop_set_slot,":troop_id_001",34,-1),
(troop_set_slot,":troop_id_002",34,-1),
(try_end),
]),

("courtship_event_bride_marry_groom", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(store_script_param, ":var003", 3),
(try_begin),
(eq,":troop_id_001","trp_player"),
(assign,":troop_slot_004","$g_encountered_party"),
(else_try),
(troop_get_slot,":troop_slot_004",":troop_id_001",12),
(try_end),
(store_troop_faction,":troop_faction_005",":troop_id_002"),
(try_begin),
(eq,":var003",0),
(call_script, "script_add_log_entry", 61, ":troop_id_001", ":troop_slot_004", ":troop_id_002", 0),
(else_try),
(call_script, "script_add_log_entry", 57, ":troop_id_001", ":troop_slot_004", ":troop_id_002", 0),
(try_end),
(str_store_string,s3,":str_store_troop_name(troop_id_001)"),
(str_store_string,s4,":str_store_troop_name(troop_id_002)"),
(str_store_string,s5,":str_store_party_name(troop_slot_004)"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "str_s3_marries_s4_at_s5"),
(try_end),
(troop_set_slot,":troop_id_001",30,":troop_id_002"),
(troop_set_slot,":troop_id_002",30,":troop_id_001"),
(try_for_range, ":slot_no_006", 35, 38),
(troop_set_slot,":troop_id_002",":slot_no_006",0),
(try_end),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(try_for_range, ":slot_no_006", 35, 38),
(troop_slot_eq,":trp_007",":slot_no_006",":troop_id_001"),
(call_script, "script_courtship_event_lady_break_relation_with_suitor", ":troop_id_001", ":trp_007"),
(try_end),
(try_end),
(troop_set_slot,":troop_id_001",34,-1),
(troop_set_slot,":troop_id_002",34,-1),
(try_for_range, ":trp_008", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(call_script, "script_troop_get_family_relation_to_troop", ":troop_id_001", ":trp_008"),
(try_begin),
(gt,reg0,0),
(store_div, ":var___x1", reg0, 3),
(assign,":var009",":var___x1"),
(try_begin),
(eq,":var003",1),
(val_mul, ":var009", -2),
(try_end),
(try_end),
(call_script, "script_troop_change_relation_with_troop", ":troop_id_002", ":troop_id_001", ":var009"),
(val_add, ":::total_courtship_quarrel_changes", ":var009"),
(try_end),
(try_begin),
(this_or_next|eq,":troop_id_002","trp_player"),
(eq,":troop_id_001","trp_player"),
(call_script, "script_change_player_right_to_rule", "trp_player", 15),
(try_end),
(try_begin),
(eq,":troop_id_002","trp_player"),
(check_quest_active,"qst_wed_betrothed"),
(call_script, "script_succeed_quest", "qst_wed_betrothed"),
(call_script, "script_end_quest", "qst_wed_betrothed"),
(try_end),
(try_begin),
(check_quest_active,"qst_visit_lady"),
(quest_slot_eq,"qst_visit_lady",6,":troop_id_001"),
(call_script, "script_abort_quest", "qst_visit_lady", 0),
(try_end),
(try_begin),
(eq,":troop_id_002","trp_player"),
(check_quest_active,"qst_visit_lady"),
(call_script, "script_abort_quest", "qst_visit_lady", 0),
(try_end),
(try_begin),
(eq,":troop_id_002","trp_player"),
(check_quest_active,"qst_duel_courtship_rival"),
(call_script, "script_abort_quest", "qst_duel_courtship_rival", 0),
(try_end),
(try_begin),
(eq,":troop_id_001","trp_player"),
(call_script, "script_player_join_faction", ":troop_faction_005"),
(assign,"$player_has_homage",1),
(else_try),
(eq,":troop_id_002","trp_player"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(display_message, "@@{!} DEBUG - {s4} faction change in marriage case 5"),
(try_end),
(troop_set_faction,":troop_id_001","$players_kingdom"),
(else_try),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(display_message, "@@{!}DEBUG - {s4} faction changed by marriage - case 6"),
(try_end),
(troop_set_faction,":troop_id_001",":troop_faction_005"),
(try_end),
(try_begin),
(this_or_next|eq,":troop_id_002","trp_player"),
(eq,":troop_id_001","trp_player"),
(unlock_achievement, 39),
(try_begin),
(eq,":var003",1),
(unlock_achievement, 40),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":troop_id_002","trp_player"),
(eq,":troop_id_001","trp_player"),
(call_script, "script_start_wedding_cutscene", ":troop_id_002", ":troop_id_001"),
(try_end),
]),

("npc_decision_checklist_party_ai", [
(store_script_param, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_002",":troop_id_001",10),
(try_begin),
(eq,":::cheat_mode",1),
(assign,"$g_talk_troop",":troop_id_001"),
(try_end),
(store_troop_faction,":troop_faction_003",":troop_id_001"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s15,":str_store_string("str__i_must_attend_to_this_matter_before_i_worry_about_the_affairs_of_the_realm")"),
(try_end),
(party_get_attached_to, ":party_attached_004", ":troop_slot_002"),
(try_begin),
(lt,":party_attached_004",0),
(party_get_cur_town, ":party_attached_004", ":troop_slot_002"),
(try_end),
(assign,":party_slot_005",-1),
(try_begin),
(neg|is_between,":party_attached_004","p_town_1","p_salt_mine"),
(assign,":party_attached_004",-1),
(else_try),
(party_get_slot,":party_slot_005",":party_attached_004",54),
(try_begin),
(neg|party_is_active,":party_slot_005"),
(assign,":party_slot_005",-1),
(try_end),
(try_end),
(call_script, "script_party_count_fit_for_battle", ":troop_slot_002"),
(assign,":var006",reg0),
(call_script, "script_party_get_ideal_size", ":troop_slot_002"),
(assign,":var007",reg0),
(store_mul, ":var008", ":var006", 100),
(val_div, ":var008", ":var007"),
(try_begin),
(faction_slot_eq,":troop_faction_003",82,0),
(faction_slot_eq,":troop_faction_003",81,0),
(assign,":var009",0),
(else_try),
(party_get_num_prisoners,":party_num_prisioners_010",":troop_slot_002"),
(val_max,":var006",1),
(store_div, ":var___x1", ":party_num_prisioners_010", ":var006"),
(assign,":var009",":var___x1"),
(try_end),
(assign,":var011",0),
(try_for_range, ":fac_012", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_slot_eq,":fac_012",21,0),
(store_relation,":faction_relation_013",":troop_faction_003",":fac_012"),
(lt,":faction_relation_013",0),
(assign,":var011",1),
(try_end),
(try_end),
(assign,":var014",0),
(try_begin),
(this_or_next|party_slot_eq,":troop_slot_002",4,5),
(party_slot_eq,":troop_slot_002",4,1),
(party_get_slot,":party_slot_015",":troop_slot_002",5),
(try_begin),
(is_between,":party_slot_015","p_town_1","p_salt_mine"),
(store_faction_of_party, ":party_faction_016", ":party_slot_015"),
(store_relation,":faction_relation_013",":troop_faction_003",":party_faction_016"),
(lt,":faction_relation_013",0),
(store_distance_to_party_from_party,":distance_parties_017",":troop_slot_002",":troop_slot_002"),
(lt,":distance_parties_017",10),
(this_or_next|party_slot_eq,":party_slot_015",35,5),
(this_or_next|party_slot_eq,":party_slot_015",35,0),
(party_slot_eq,":party_slot_015",35,1),
(assign,":var014",1),
(try_end),
(try_end),
(troop_get_slot,":troop_slot_018",":troop_id_001",52),
(party_get_slot,":party_slot_019",":troop_slot_002",4),
(party_get_slot,":party_slot_020",":troop_slot_002",5),
(party_get_slot,":party_slot_021",":troop_slot_002",56),
(store_current_hours,":cur_hours_022"),
(party_get_slot,":party_slot_023",":troop_slot_002",71),
(val_sub, ":cur_hours_022", ":party_slot_023"),
(store_current_hours,":cur_hours_024"),
(party_get_slot,":party_slot_025",":troop_slot_002",69),
(val_sub, ":cur_hours_024", ":party_slot_025"),
(store_current_hours,":cur_hours_026"),
(party_get_slot,":party_slot_027",":troop_slot_002",68),
(val_sub, ":cur_hours_026", ":party_slot_027"),
(store_current_hours,":cur_hours_028"),
(party_get_slot,":party_slot_029",":troop_slot_002",70),
(val_sub, ":cur_hours_028", ":party_slot_029"),
(troop_get_slot,":troop_slot_030",":troop_id_001",49),
(store_mod,":var031",":troop_slot_030",73),
(try_begin),
(eq,":troop_slot_018",1),
(val_add, ":var031", 27),
(else_try),
(neq,":troop_slot_018",5),
(neq,":troop_slot_018",2),
(val_add, ":var031", 14),
(try_end),
(try_begin),
(gt,":var031",":cur_hours_026"),
(val_add, ":var031", ":cur_hours_026"),
(val_div, ":var031", 2),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(assign,reg3,":cur_hours_022"),
(assign,reg4,":cur_hours_028"),
(assign,reg5,":cur_hours_026"),
(assign,reg6,":cur_hours_024"),
(assign,reg7,":var031"),
(try_end),
(str_store_string,s17,":str_store_string("str_the_other_matter_took_precedence")"),
(assign,":var032",0),
(try_begin),
(ge,":party_attached_004",0),
(this_or_next|gt,":var006",10),
(le,":var008",30),
(assign,":party_slot_033",7),
(assign,":party_id_034",":party_attached_004"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_need_to_raise_some_men_before_attempting_anything_else")"),
(str_store_string,s16,":str_store_string("str_i_need_to_raise_some_men_before_attempting_anything_else")"),
(try_end),
(else_try),
(gt,":party_slot_005",-1),
(assign,":party_slot_033",7),
(assign,":party_id_034",":party_attached_004"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_cannot_leave_this_fortress_now_as_it_is_under_siege")"),
(str_store_string,s16,":str_store_string("str_after_all_we_are_under_siege")"),
(try_end),
(else_try),
(eq,":party_slot_019",14),
(neg|party_is_in_any_town,":troop_slot_002"),
(ge,":party_slot_020",0),
(party_is_active,":party_slot_020"),
(store_faction_of_party, ":party_faction_035", ":party_slot_020"),
(try_begin),
(eq,":troop_faction_003",":party_faction_035"),
(assign,":party_slot_033",14),
(assign,":party_id_034",":party_slot_020"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_we_are_not_strong_enough_to_face_the_enemy_out_in_the_open")"),
(str_store_string,s16,":str_store_string("str_i_should_probably_seek_shelter_behind_some_stout_walls")"),
(try_end),
(try_end),
(else_try),
(is_between,":party_attached_004","p_town_1","p_village_1"),
(party_get_slot,":party_slot_036",":party_attached_004",67),
(party_get_slot,":party_slot_036",":party_attached_004",67),
(try_begin),
(ge,":party_slot_036",50),
(assign,":party_slot_033",7),
(assign,":party_id_034",":party_attached_004"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_enemies_are_reported_to_be_nearby_and_we_should_stand_ready_to_either_man_the_walls_or_sortie_out_to_do_battle")"),
(str_store_string,s16,":str_store_string("str_the_enemy_is_nearby")"),
(try_end),
(try_end),
(else_try),
(faction_slot_eq,":troop_faction_003",8,":troop_id_001"),
(str_clear, 15),
(try_begin),
(faction_slot_eq,":troop_faction_003",4,1),
(party_set_ai_initiative,":troop_slot_002",10),
(party_get_slot,":party_slot_020",":troop_slot_002",5),
(assign,":var037",":party_slot_020"),
(call_script, "script_find_center_to_defend", ":troop_id_001"),
(assign,":var038",reg0),
(assign,":var039",0),
(try_begin),
(lt,":party_slot_020",0),
(store_random_in_range,":random_x_040",0,8),
(try_begin),
(this_or_next|eq,":::g_gathering_new_started",1),
(eq,":random_x_040",0),
(assign,":var041",0),
(assign,":var042",0),
(try_for_range, ":trp_043", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_044",":trp_043"),
(try_begin),
(eq,":troop_faction_044",":troop_faction_003"),
(troop_get_slot,":troop_slot_045",":trp_043",10),
(try_begin),
(party_is_active,":troop_slot_045"),
(val_add, ":var042", 1),
(try_begin),
(party_slot_eq,":troop_slot_045",4,11),
(party_slot_eq,":troop_slot_045",5,":troop_slot_002"),
(party_is_active,":troop_slot_002"),
(store_distance_to_party_from_party,":distance_parties_046",":troop_slot_045",":troop_slot_045"),
(try_begin),
(lt,":distance_parties_046",15),
(val_add, ":var041", 1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(assign,":var047",-1),
(try_begin),
(gt,":var042",0),
(store_mul, ":var047", ":var041", 100),
(val_div, ":var047", ":var042"),
(try_end),
(try_begin),
(le,":var047",35),
(assign,":var048",":var038"),
(try_begin),
(eq,":::g_gathering_new_started",1),
(assign,":var049",100000),
(try_for_range, ":p_050", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_051", ":p_050"),
(try_begin),
(eq,":party_faction_051",":troop_faction_003"),
(try_begin),
(neq,":p_050",":var038"),
(store_distance_to_party_from_party,":distance_parties_052",":troop_slot_002",":troop_slot_002"),
(try_begin),
(lt,":distance_parties_052",":var049"),
(assign,":var049",":distance_parties_052"),
(assign,":var048",":p_050"),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(assign,":var053",150),
(try_begin),
(ge,":var047",15),
(store_sub, ":var053", 35, ":var047"),
(val_add, ":var053", 5),
(val_mul, ":var053", 6),
(try_end),
(try_begin),
(ge,":var038",0),
(store_distance_to_party_from_party,reg12,":troop_slot_002",":troop_slot_002"),
(else_try),
(assign,reg12,0),
(try_end),
(assign,":var054",0),
(try_for_range, ":p_050", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_051", ":p_050"),
(try_begin),
(eq,":party_faction_051",":troop_faction_003"),
(try_begin),
(eq,1,1),
(store_distance_to_party_from_party,":distance_parties_052",":troop_slot_002",":troop_slot_002"),
(try_begin),
(ge,":var038",0),
(store_distance_to_party_from_party,reg13,":p_050",":p_050"),
(else_try),
(assign,reg13,0),
(try_end),
(try_end),
(store_sub, reg11, reg13, reg12),
(try_begin),
(this_or_next|ge,reg11,40),
(this_or_next|ge,":distance_parties_052",":var053"),
(eq,":p_050",":var038"),
(else_try),
(val_add, ":var054", 1),
(try_end),
(try_end),
(try_end),
(try_begin),
(ge,":var054",0),
(store_random_in_range,":random_x_055",0,":var054"),
(val_add, ":random_x_055", 1),
(assign,":var054",0),
(try_for_range, ":p_050", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_051", ":p_050"),
(try_begin),
(eq,":party_faction_051",":troop_faction_003"),
(try_begin),
(neq,":p_050",":var038"),
(store_distance_to_party_from_party,":distance_parties_052",":troop_slot_002",":troop_slot_002"),
(try_begin),
(lt,":distance_parties_052",":var053"),
(try_begin),
(ge,":var038",0),
(store_distance_to_party_from_party,reg13,":p_050",":p_050"),
(else_try),
(assign,reg13,0),
(try_end),
(try_end),
(try_end),
(store_sub, reg11, reg13, reg12),
(try_begin),
(lt,reg11,40),
(val_sub, ":random_x_055", 1),
(try_begin),
(eq,":random_x_055",0),
(assign,":var048",":p_050"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(assign,":var037",":var048"),
(assign,":var039",1),
(try_end),
(else_try),
(is_between,":party_slot_020","p_town_1","p_salt_mine"),
(party_get_position,pos1,":troop_slot_002"),
(party_get_position,pos2,":party_slot_020"),
(get_distance_between_positions,":distance_parties_052",1,2),
(try_begin),
(le,":distance_parties_052",3),
(assign,":var037",-1),
(try_end),
(try_end),
(try_begin),
(eq,":var037",-1),
(assign,":party_slot_033",-1),
(else_try),
(assign,":party_slot_033",16),
(try_end),
(assign,":party_id_034",":var037"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(try_begin),
(eq,":var037",-1),
(str_store_string,s14,":str_store_string("str_as_the_marshall_i_am_assembling_the_army_of_the_realm")"),
(else_try),
(try_begin),
(eq,":troop_faction_003",":::players_kingdom"),
(eq,":var039",1),
(neg|le,":::number_of_report_to_army_quest_notes",13),
(check_quest_active,"qst_report_to_army"),
(str_store_string,s10,":str_store_party_name_link(var037)"),
(faction_get_slot,":faction_slot_056",":troop_faction_003",8),
(str_store_string,s11,":str_store_troop_name_link(faction_slot_056)"),
(store_current_hours,":cur_hours_057"),
(call_script, "script_game_get_date_text", 0, ":cur_hours_057"),
(str_store_string,s14,":str_store_string("str_as_the_marshall_i_am_assembling_the_army_of_the_realm_and_travel_to_lands_near_s10_to_inform_more_vassals")"),
(str_store_string,s14,":str_store_string("@({s1}) {s11}: {s14}")"),
(add_quest_note_from_sreg,"qst_report_to_army","$number_of_report_to_army_quest_notes",14, 0),
(val_add, ":::number_of_report_to_army_quest_notes", 1),
(try_end),
(assign,reg0,":var037"),
(str_store_string,s10,":str_store_party_name(var037)"),
(str_store_string,s14,":str_store_string("str_as_the_marshall_i_am_assembling_the_army_of_the_realm_and_travel_to_lands_near_s10_to_inform_more_vassals")"),
(try_end),
(str_store_string,s16,":str_store_string("str_i_intend_to_assemble_the_army_of_the_realm")"),
(try_end),
(else_try),
(faction_slot_eq,":troop_faction_003",8,":troop_id_001"),
(faction_slot_eq,":troop_faction_003",4,2),
(faction_get_slot,":faction_slot_058",":troop_faction_003",5),
(assign,":party_slot_033",1),
(assign,":party_id_034",":faction_slot_058"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_as_the_marshall_i_am_leading_the_siege")"),
(str_store_string,s16,":str_store_string("str_i_intend_to_begin_the_siege")"),
(try_end),
(else_try),
(faction_slot_eq,":troop_faction_003",8,":troop_id_001"),
(faction_slot_eq,":troop_faction_003",4,3),
(faction_get_slot,":faction_slot_058",":troop_faction_003",5),
(assign,":party_slot_033",5),
(assign,":party_id_034",":faction_slot_058"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_as_the_marshall_i_am_leading_our_raid")"),
(str_store_string,s16,":str_store_string("str_i_intend_to_start_our_raid")"),
(try_end),
(else_try),
(faction_slot_eq,":troop_faction_003",8,":troop_id_001"),
(faction_slot_eq,":troop_faction_003",4,5),
(faction_get_slot,":faction_slot_058",":troop_faction_003",5),
(try_begin),
(party_is_active,":faction_slot_058"),
(party_get_battle_opponent, ":party_slot_005", ":faction_slot_058"),
(try_begin),
(gt,":party_slot_005",0),
(party_is_active,":party_slot_005"),
(assign,":party_slot_033",10),
(assign,":party_id_034",":party_slot_005"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_as_the_marshall_i_am_leading_our_forces_to_engage_the_enemy_in_battle")"),
(str_store_string,s16,":str_store_string("str_i_intend_to_lead_our_forces_out_to_engage_the_enemy")"),
(try_end),
(try_end),
(else_try),
(assign,":party_slot_033",4),
(assign,":party_id_034",":faction_slot_058"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_as_the_marshall_i_am_leading_our_forces_in_search_of_the_enemy")"),
(str_store_string,s16,":str_store_string("str_i_intend_to_lead_our_forces_out_to_find_the_enemy")"),
(try_end),
(try_end),
(else_try),
(faction_slot_eq,":troop_faction_003",8,":troop_id_001"),
(faction_slot_eq,":troop_faction_003",4,4),
(faction_get_slot,":faction_slot_058",":troop_faction_003",5),
(try_begin),
(party_is_active,":faction_slot_058"),
(assign,":party_slot_033",10),
(assign,":party_id_034",":faction_slot_058"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_as_the_marshall_i_am_leading_our_forces_to_engage_the_enemy_in_battle")"),
(str_store_string,s16,":str_store_string("str_i_intend_to_lead_our_forces_out_to_engage_the_enemy")"),
(try_end),
(try_end),
(else_try),
(eq,1,0),
(assign,":var059",30),
(call_script, "script_lord_get_home_center", ":troop_id_001"),
(assign,":var060",reg0),
(try_begin),
(gt,":var060",-1),
(party_slot_eq,":var060",7,":troop_id_001"),
(assign,":var061",0),
(party_get_position,pos0,":var060"),
(party_get_position,pos1,":troop_slot_002"),
(get_distance_between_positions,":distance_parties_052",0,1),
(try_begin),
(le,":distance_parties_052",9000),
(store_div, ":var___x1", ":distance_parties_052", 600),
(assign,":var061",":var___x1"),
(store_sub, ":var061", 15, ":var061"),
(else_try),
(assign,":var061",0),
(try_end),
(try_end),
(val_add, ":var059", ":var061"),
(assign,":var062",35),
(try_begin),
(this_or_next|faction_slot_eq,":troop_faction_003",4,4),
(this_or_next|faction_slot_eq,":troop_faction_003",4,5),
(this_or_next|faction_slot_eq,":troop_faction_003",4,3),
(this_or_next|faction_slot_eq,":troop_faction_003",4,2),
(faction_slot_eq,":troop_faction_003",4,1),
(assign,":var062",0),
(try_begin),
(faction_slot_eq,":troop_faction_003",8,"trp_player"),
(game_get_reduce_campaign_ai, ":campaign_ai"),
(try_begin),
(eq,":campaign_ai",0),
(assign,":var062",0),
(else_try),
(eq,":campaign_ai",1),
(assign,":var062",-10),
(else_try),
(eq,":campaign_ai",2),
(assign,":var062",-15),
(try_end),
(try_end),
(try_end),
(val_add, ":var059", ":var062"),
(val_max,":var059",25),
(try_begin),
(lt,":var008",":var059"),
(try_begin),
(eq,1,1),
(store_div, ":var___x1", ":var059", 3),
(assign,":var064",":var___x1"),
(try_begin),
(ge,":var008",":var064"),
(troop_get_slot,":troop_slot_065",":troop_id_001",11),
(try_begin),
(le,":troop_slot_065",1800),
(assign,":var032",1),
(try_end),
(try_end),
(try_end),
(try_end),
(assign,":party_slot_033",7),
(assign,":party_id_034",":var060"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_dont_have_enough_troops_and_i_need_to_get_some_more")"),
(str_store_string,s16,":str_store_string("str_i_am_running_low_on_troops")"),
(try_end),
(try_begin),
(eq,":var032",0),
(else_try),
(eq,":var032",0),
(party_slot_ge,":troop_slot_002",244,"trp_kingdom_heroes_including_player_begin"),
(party_get_slot,":party_slot_066",":troop_slot_002",245),
(party_get_slot,":party_slot_067",":troop_slot_002",246),
(party_get_slot,":party_slot_068",":troop_slot_002",247),
(try_begin),
(ge,":party_slot_067",0),
(store_current_hours,":cur_hours_069"),
(val_sub, ":cur_hours_069", ":party_slot_068"),
(try_begin),
(party_is_active,":party_slot_067"),
(party_get_slot,":party_slot_070",":party_slot_067",35),
(store_faction_of_party, ":party_faction_071", ":party_slot_067"),
(store_relation,":faction_relation_072",":troop_faction_003",":party_faction_071"),
(assign,":var073",1),
(try_begin),
(gt,":cur_hours_069",48),
(assign,":var073",0),
(else_try),
(eq,":party_slot_066",5),
(this_or_next|ge,":faction_relation_072",0),
(ge,":party_slot_070",2),
(assign,":var073",0),
(else_try),
(eq,":party_slot_066",1),
(ge,":faction_relation_072",0),
(assign,":var073",0),
(else_try),
(this_or_next|eq,":party_slot_066",7),
(this_or_next|eq,":party_slot_066",14),
(this_or_next|eq,":party_slot_066",11),
(eq,":party_slot_066",16),
(le,":faction_relation_072",0),
(assign,":var073",0),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var073",1),
(assign,":party_slot_033",":party_slot_066"),
(assign,":party_id_034",":party_slot_067"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_we_are_following_your_direction")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var014",0),
(check_quest_active,"qst_wed_betrothed"),
(quest_slot_eq,"qst_wed_betrothed",6,":troop_id_001"),
(quest_get_slot,":quest_slot_074","qst_wed_betrothed",2),
(call_script, "script_get_kingdom_lady_social_determinants", ":quest_slot_074"),
(assign,":var075",reg1),
(assign,":party_slot_033",7),
(assign,":party_id_034",":var075"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_need_to_make_preparations_for_your_wedding")"),
(str_store_string,s16,":str_store_string("str_after_all_i_need_to_make_preparations_for_your_wedding")"),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var014",0),
(check_quest_active,"qst_wed_betrothed_female"),
(quest_slot_eq,"qst_wed_betrothed_female",6,":troop_id_001"),
(faction_slot_eq,":troop_faction_003",4,6),
(faction_get_slot,":faction_slot_076",":troop_faction_003",5),
(assign,":party_slot_033",7),
(assign,":party_id_034",":faction_slot_076"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_am_heading_to_the_site_of_our_wedding")"),
(str_store_string,s16,":str_store_string("str_after_all_we_are_soon_to_be_wed")"),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var014",0),
(faction_slot_eq,":troop_faction_003",4,6),
(faction_get_slot,":faction_slot_076",":troop_faction_003",5),
(try_begin),
(party_slot_eq,":faction_slot_076",7,":troop_id_001"),
(assign,":party_slot_033",7),
(assign,":party_id_034",":faction_slot_076"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_am_hosting_a_feast_there")"),
(str_store_string,s16,":str_store_string("str_i_have_a_feast_to_host")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var014",0),
(faction_slot_eq,":troop_faction_003",4,6),
(troop_get_slot,":troop_slot_077",":troop_id_001",34),
(try_begin),
(is_between,":troop_slot_077","trp_knight_1_1_wife","trp_heroes_end"),
(faction_get_slot,":faction_slot_076",":troop_faction_003",5),
(assign,":party_slot_033",7),
(assign,":party_id_034",":faction_slot_076"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_am_to_be_the_bridegroom_there")"),
(str_store_string,s16,":str_store_string("str_my_wedding_day_draws_near")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(gt,":var009",35),
(eq,":var014",0),
(call_script, "script_lord_get_home_center", ":troop_id_001"),
(assign,":var060",reg0),
(try_begin),
(gt,":var060",-1),
(assign,":party_slot_033",7),
(assign,":party_id_034",":var060"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_have_too_much_loot_and_too_many_prisoners_and_need_to_secure_them")"),
(str_store_string,s16,":str_store_string("str_i_should_think_of_dropping_off_some_of_my_prisoners")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(assign,":var078",-1),
(assign,":var079",100),
(try_begin),
(eq,":var014",0),
(try_for_range, ":p_080", ":p.town_1", ":p.village_1"),
(party_slot_eq,":p_080",7,":troop_id_001"),
(party_get_slot,":party_slot_081",":p_080",56),
(try_begin),
(lt,":party_slot_081",":var079"),
(assign,":var078",":p_080"),
(assign,":var079",":party_slot_081"),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var078",-1),
(assign,":party_slot_033",7),
(assign,":party_id_034",":var078"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_need_to_reinforce_it_as_it_is_poorly_garrisoned")"),
(str_store_string,s16,":str_store_string("str_there_is_a_hole_in_our_defenses")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":party_slot_019",12),
(faction_get_slot,":faction_slot_056",":troop_faction_003",8),
(try_begin),
(ge,":faction_slot_056",0),
(troop_get_slot,":troop_slot_082",":faction_slot_056",10),
(try_begin),
(party_is_active,":troop_slot_082"),
(call_script, "script_npc_decision_checklist_troop_follow_or_not", ":troop_id_001"),
(try_begin),
(eq,reg0,1),
(assign,":party_slot_033",12),
(assign,":party_id_034",":troop_slot_082"),
(try_begin),
(eq,":::g_talk_troop",":troop_id_001"),
(str_store_string,s14,":str_store_string("str_i_am_following_the_marshals_orders")"),
(str_store_string,s16,":str_store_string("str_the_marshal_has_given_me_this_command")"),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(faction_slot_eq,":troop_faction_003",4,5),
(is_between,":faction_slot_058","p_village_1","p_salt_mine"),
(call_script, "script_npc_decision_checklist_troop_follow_or_not", ":troop_id_001"),
(try_begin),
(eq,reg0,1),
(faction_get_slot,":faction_slot_058",":troop_faction_003",5),
(party_get_slot,":party_slot_083",":faction_slot_058",34),
(try_begin),
(party_is_active,":party_slot_083"),
(party_get_slot,":party_slot_084",":faction_slot_058",67),
(try_begin),
(lt,":party_slot_084",4000),
(assign,":party_slot_033",10),
(assign,":party_id_034",":party_slot_083"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_our_realm_needs_my_support_there_is_enemy_raiding_one_of_our_villages_which_is_not_to_far_from_here_i_am_going_there")"),
(str_store_string,s16,":str_store_string("str_the_marshal_has_issued_a_summons")"),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(call_script, "script_npc_decision_checklist_troop_follow_or_not", ":troop_id_001"),
(try_begin),
(eq,reg0,1),
(faction_get_slot,":faction_slot_056",":troop_faction_003",8),
(try_begin),
(ge,":faction_slot_056",0),
(troop_get_slot,":troop_slot_082",":faction_slot_056",10),
(assign,":party_slot_033",11),
(assign,":party_id_034",":troop_slot_082"),
(try_begin),
(eq,":::g_talk_troop",":troop_id_001"),
(str_store_string,s14,":str_store_string("str_i_am_answering_the_marshals_summons")"),
(str_store_string,s16,":str_store_string("str_the_marshal_has_issued_a_summons")"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var011",1),
(assign,":var085",-1),
(try_for_range, ":trp_086", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_086",2,2),
(store_troop_faction,":troop_faction_087",":trp_086"),
(try_begin),
(eq,":troop_faction_087",":troop_faction_003"),
(neq,":trp_086",":troop_id_001"),
(troop_get_slot,":troop_slot_088",":trp_086",10),
(try_begin),
(gt,":troop_slot_088",1),
(party_is_active,":troop_slot_088"),
(this_or_next|party_slot_eq,":troop_slot_088",4,5),
(party_slot_eq,":troop_slot_088",4,1),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":trp_086"),
(try_begin),
(gt,reg0,4),
(troop_get_slot,":troop_slot_089",":troop_id_001",7),
(troop_get_slot,":troop_slot_090",":trp_086",7),
(try_begin),
(le,":troop_slot_089",":troop_slot_090"),
(store_distance_to_party_from_party,":distance_parties_017",":troop_slot_002",":troop_slot_002"),
(try_begin),
(lt,":distance_parties_017",5),
(assign,":var085",":troop_slot_088"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var085",0),
(assign,":party_slot_033",11),
(assign,":party_id_034",":var085"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(party_stack_get_troop_id,      ":troop_id_091",":party_id_034",0),
(str_store_string,s10,":str_store_troop_name(troop_id_091)"),
(call_script, "script_troop_get_family_relation_to_troop", ":troop_id_091", "$g_talk_troop"),
(try_begin),
(eq,reg0,0),
(str_store_string,s11,":str_store_string("str_comradeinarms")"),
(try_end),
(try_end),
(str_store_string,s14,":str_store_string("str_i_am_supporting_my_s11_s10")"),
(str_store_string,s16,":str_store_string("str_i_believe_that_one_of_my_comrades_is_in_need")"),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var011",1),
(eq,":var014",0),
(assign,":var092",-1),
(assign,":var093",50),
(try_for_range, ":p_080", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_094", ":p_080"),
(store_relation,":faction_relation_013",":troop_faction_003",":party_faction_094"),
(try_begin),
(lt,":faction_relation_013",0),
(party_get_slot,":party_slot_095",":p_080",56),
(val_mul, ":party_slot_095", 3),
(val_mul, ":party_slot_095", 2),
(try_begin),
(lt,":party_slot_095",":party_slot_021"),
(lt,":party_slot_095",750),
(party_slot_eq,":p_080",35,0),
(store_distance_to_party_from_party,":distance_parties_017",":p_080",":p_080"),
(try_begin),
(lt,":distance_parties_017",":var093"),
(assign,":var092",":p_080"),
(assign,":var093",":distance_parties_017"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":var092","p_town_1","p_salt_mine"),
(assign,":party_slot_033",1),
(assign,":party_id_034",":var092"),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s20,":str_store_faction_name(troop_faction_003)"),
(str_store_string,s21,":str_store_party_name(party_id_034)"),
(display_message, "str_s20_decided_to_attack_s21"),
(try_end),
(try_end),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_a_fortress_is_vulnerable")"),
(str_store_string,s16,":str_store_string("str_i_believe_that_the_enemy_may_be_vulnerable")"),
(try_end),
(else_try),
(eq,1,0),
(assign,":var096",-1),
(assign,":var097",300),
(troop_get_slot,":troop_slot_065",":troop_id_001",11),
(val_div, ":troop_slot_065", 10),
(val_add, ":var097", ":troop_slot_065"),
(try_begin),
(eq,":var014",0),
(try_begin),
(eq,1,1),
(faction_get_slot,":faction_slot_056",":troop_faction_003",8),
(assign,reg17,0),
(try_begin),
(party_slot_eq,":troop_slot_002",4,11),
(party_slot_eq,":troop_slot_002",5,":faction_slot_056"),
(assign,reg17,1),
(else_try),
(party_slot_eq,":troop_slot_002",31,1),
(assign,reg17,1),
(try_end),
(try_end),
(try_begin),
(eq,reg17,1),
(try_begin),
(neq,":faction_slot_056","trp_player"),
(neg|party_slot_eq,":troop_slot_002",31,1),
(val_add, ":var097", 125),
(else_try),
(val_add, ":var097", 250),
(try_end),
(try_end),
(try_end),
(try_for_range, ":p_050", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_050",7,":troop_id_001"),
(assign,reg17,0),
(try_begin),
(is_between,":p_050","p_village_1","p_salt_mine"),
(party_slot_eq,":p_050",35,0),
(assign,reg17,1),
(else_try),
(party_slot_eq,":p_050",54,-1),
(assign,reg17,1),
(try_end),
(try_begin),
(eq,reg17,1),
(party_get_slot,":party_slot_098",":p_050",48),
(party_get_slot,":party_slot_099",":p_050",47),
(store_add, ":var100", ":party_slot_099", ":party_slot_098"),
(try_begin),
(gt,":var100",":var097"),
(assign,":var096",":p_050"),
(assign,":var097",":var100"),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":var096","p_town_1","p_salt_mine"),
(try_begin),
(is_between,":var096","p_town_1","p_village_1"),
(assign,":party_slot_033",7),
(assign,":party_id_034",":var096"),
(else_try),
(assign,":party_slot_033",16),
(assign,":party_id_034",":var096"),
(try_end),
(try_end),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_need_to_inspect_my_properties_and_collect_my_dues")"),
(str_store_string,s16,":str_store_string("str_it_has_been_too_long_since_i_have_inspected_my_estates")"),
(try_end),
(else_try),
(eq,":var032",0),
(this_or_next|gt,":cur_hours_022",504),
(lt,":var031",25),
(gt,":cur_hours_022",168),
(eq,":var014",0),
(call_script, "script_lord_get_home_center", ":troop_id_001"),
(assign,":var060",reg0),
(try_begin),
(gt,":var060",-1),
(assign,":party_slot_033",7),
(assign,":party_id_034",":var060"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_my_men_are_weary_so_we_are_returning_home")"),
(str_store_string,s16,":str_store_string("str_my_men_are_becoming_weary")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(this_or_next|gt,":cur_hours_026",12),
(lt,":cur_hours_022",96),
(eq,":var014",0),
(eq,":var011",1),
(this_or_next|eq,":troop_slot_018",5),
(eq,":troop_slot_018",2),
(assign,":var101",-1),
(assign,":var097",0),
(try_for_range, ":p_102", ":p.village_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_103", ":p_102"),
(store_relation,":faction_relation_013",":party_faction_103",":troop_faction_003"),
(try_begin),
(lt,":faction_relation_013",0),
(neg|party_slot_ge,":p_102",35,2),
(party_get_slot,":party_slot_104",":p_102",7),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":party_slot_104"),
(assign,":var105",reg0),
(try_begin),
(lt,":var105",":var097"),
(assign,":var097",":var105"),
(assign,":var101",":p_102"),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":var101","p_town_1","p_salt_mine"),
(assign,":party_slot_033",5),
(assign,":party_id_034",":var101"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_have_a_score_to_settle_with_the_lord_there")"),
(str_store_string,s16,":str_store_string("str_i_am_thinking_of_settling_an_old_score")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var011",1),
(eq,":var014",0),
(this_or_next|gt,":cur_hours_026",12),
(lt,":cur_hours_022",96),
(gt,":var031",40),
(this_or_next|eq,":troop_slot_018",5),
(this_or_next|eq,":troop_slot_018",3),
(this_or_next|eq,":troop_slot_018",4),
(eq,":troop_slot_018",2),
(troop_get_slot,":troop_slot_106",":troop_id_001",11),
(try_begin),
(lt,":troop_slot_106",500),
(assign,":var097",0),
(assign,":var101",-1),
(try_for_range, ":p_102", ":p.village_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_103", ":p_102"),
(store_relation,":faction_relation_013",":party_faction_103",":troop_faction_003"),
(try_begin),
(lt,":faction_relation_013",0),
(this_or_next|party_slot_eq,":p_102",35,0),
(party_slot_eq,":p_102",35,1),
(party_get_slot,reg17,":p_102",50),
(store_distance_to_party_from_party,":distance_parties_017",":troop_slot_002",":troop_slot_002"),
(val_sub, reg17, ":distance_parties_017"),
(try_begin),
(gt,reg17,":var097"),
(assign,":var097",reg17),
(assign,":var101",":p_102"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var101",-1),
(assign,":party_slot_033",5),
(assign,":party_id_034",":var101"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_am_short_of_money_and_i_hear_that_there_is_much_wealth_there")"),
(str_store_string,s16,":str_store_string("str_i_need_to_refill_my_purse_preferably_with_the_enemys_money")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var011",1),
(eq,":var014",0),
(gt,":var031",65),
(assign,":var097",0),
(assign,":var101",-1),
(try_for_range, ":p_102", ":p.village_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_103", ":p_102"),
(store_relation,":faction_relation_013",":party_faction_103",":troop_faction_003"),
(try_begin),
(lt,":faction_relation_013",0),
(neg|party_slot_eq,":p_102",35,2),
(party_get_slot,":party_slot_107",":p_102",50),
(val_mul, ":party_slot_107", 2),
(store_distance_to_party_from_party,":distance_parties_017",":troop_slot_002",":troop_slot_002"),
(val_sub, ":party_slot_107", ":distance_parties_017"),
(try_begin),
(gt,":party_slot_107",":var097"),
(assign,":var097",":party_slot_107"),
(assign,":var101",":p_102"),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var101",-1),
(assign,":party_slot_033",5),
(assign,":party_id_034",":var101"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_by_striking_at_the_enemys_richest_lands_perhaps_i_can_draw_them_out_to_battle")"),
(str_store_string,s16,":str_store_string("str_i_am_thinking_of_going_on_the_attack")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":troop_slot_018",7),
(eq,":var011",1),
(eq,":var014",0),
(assign,":var108",-1),
(try_for_range, ":fac_109", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(store_relation,":faction_relation_013",":troop_faction_003",":fac_109"),
(try_begin),
(lt,":faction_relation_013",0),
(faction_slot_eq,":fac_109",21,0),
(store_add, ":slot_no_110", ":fac_109", 140),
(assign,":slot_no_110 -","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_111",":troop_faction_003",":slot_no_110"),
(store_add, ":slot_no_112", ":troop_faction_003", 140),
(assign,":slot_no_112 -","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_113",":fac_109",":slot_no_112"),
(try_begin),
(gt,":faction_slot_111",80),
(lt,":faction_slot_111",":faction_slot_113"),
(assign,":var108",":fac_109"),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var108",-1),
(assign,":var101",-1),
(assign,":var097",50),
(try_for_range, ":p_114", ":p.village_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_103", ":p_114"),
(try_begin),
(eq,":party_faction_103",":var108"),
(neg|party_slot_eq,":p_114",35,2),
(store_distance_to_party_from_party,":distance_parties_017",":troop_slot_002",":troop_slot_002"),
(try_begin),
(lt,":distance_parties_017",":var097"),
(assign,":var097",":distance_parties_017"),
(assign,":var101",":p_114"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var101",-1),
(assign,":party_slot_033",5),
(assign,":party_id_034",":var101"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_perhaps_if_i_strike_one_more_blow_we_may_end_this_war_on_our_terms_")"),
(str_store_string,s16,":str_store_string("str_we_may_be_able_to_bring_this_war_to_a_close_with_a_few_more_blows")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(faction_slot_eq,":troop_faction_003",4,6),
(faction_get_slot,":faction_slot_076",":troop_faction_003",5),
(party_get_slot,":party_slot_115",":faction_slot_076",7),
(try_begin),
(eq,":var014",0),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":party_slot_115"),
(assign,":var116",reg0),
(try_begin),
(ge,":var116",0),
(assign,":party_slot_033",7),
(assign,":party_id_034",":faction_slot_076"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_wish_to_attend_the_feast_there")"),
(str_store_string,s16,":str_store_string("str_there_is_a_feast_which_i_wish_to_attend")"),
(try_end),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(neg|troop_slot_eq,"trp_player",34,":troop_id_001"),
(troop_slot_eq,":troop_id_001",30,-1),
(neg|is_between,":troop_id_001","trp_kingdom_1_lord","trp_knight_1_1"),
(neg|is_between,":troop_id_001","trp_kingdom_1_pretender","trp_knight_1_1_wife"),
(gt,":cur_hours_028",72),
(eq,":var014",0),
(assign,":var096",-1),
(assign,":var097",150),
(try_for_range, ":slot_no_117", 35, 38),
(troop_get_slot,":troop_slot_118",":troop_id_001",":slot_no_117"),
(try_begin),
(is_between,":troop_slot_118","trp_knight_1_1_wife","trp_heroes_end"),
(troop_get_slot,":troop_slot_119",":troop_slot_118",12),
(try_begin),
(is_between,":troop_slot_119","p_town_1","p_salt_mine"),
(store_faction_of_party, ":party_faction_120", ":troop_slot_119"),
(try_begin),
(eq,":troop_faction_003",":party_faction_120"),
(store_distance_to_party_from_party,":distance_parties_017",":troop_slot_002",":troop_slot_002"),
(try_begin),
(lt,":distance_parties_017",":var097"),
(assign,":var096",":troop_slot_119"),
(assign,":var097",":distance_parties_017"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var096",-1),
(assign,":party_slot_033",7),
(assign,":party_id_034",":var096"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_there_is_a_fair_lady_there_whom_i_wish_to_court")"),
(str_store_string,s16,":str_store_string("str_i_have_the_inclination_to_pay_court_to_a_fair_lady")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(assign,":party_slot_015",-1),
(assign,":var097",60),
(try_begin),
(eq,":var014",0),
(gt,":var031",40),
(try_for_range, ":p_121", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_051", ":p_121"),
(try_begin),
(eq,":party_faction_051",":troop_faction_003"),
(party_slot_ge,":p_121",55,0),
(party_get_slot,":party_slot_122",":p_121",66),
(party_get_slot,":party_slot_123",":p_121",67),
(store_mul, ":var124", ":party_slot_123", 14),
(val_div, ":var124", 10),
(party_get_slot,":party_slot_125",":troop_slot_002",56),
(try_begin),
(this_or_next|party_is_in_town,":troop_slot_002",":p_121"),
(gt,":party_slot_122",":var124"),
(ge,":party_slot_125",100),
(party_get_slot,reg17,":p_121",7),
(call_script, "script_troop_get_relation_with_troop", reg17, ":troop_id_001"),
(try_begin),
(this_or_next|eq,":troop_slot_018",7),
(gt,reg0,-5),
(store_distance_to_party_from_party,":distance_parties_017",":troop_slot_002",":troop_slot_002"),
(try_begin),
(lt,":distance_parties_017",":var097"),
(assign,":party_slot_015",":p_121"),
(assign,":var097",":distance_parties_017"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":party_slot_015","p_town_1","p_salt_mine"),
(assign,":party_slot_033",4),
(assign,":party_id_034",":party_slot_015"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_we_have_heard_reports_that_the_enemy_is_in_the_area")"),
(str_store_string,s16,":str_store_string("str_i_have_heard_reports_of_enemy_incursions_into_our_territory")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(gt,":cur_hours_024",168),
(eq,":var014",0),
(call_script, "script_lord_get_home_center", ":troop_id_001"),
(assign,":var060",reg0),
(try_begin),
(gt,":var060",-1),
(assign,":party_slot_033",7),
(assign,":party_id_034",":var060"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_need_to_spend_some_time_with_my_household")"),
(str_store_string,s16,":str_store_string("str_it_has_been_a_long_time_since_i_have_been_able_to_spend_time_with_my_household")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var011",1),
(gt,":var031",65),
(eq,":var014",0),
(assign,":p_121",-1),
(assign,":var097",75),
(try_for_range, ":p_126", ":p.village_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_103", ":p_126"),
(store_relation,":faction_relation_013",":party_faction_103",":troop_faction_003"),
(try_begin),
(lt,":faction_relation_013",0),
(store_distance_to_party_from_party,":distance_parties_017",":p_126",":p_126"),
(try_begin),
(lt,":distance_parties_017",":var097"),
(assign,":var097",":distance_parties_017"),
(assign,":p_121",":p_126"),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":p_121","p_village_1","p_salt_mine"),
(assign,":party_slot_033",4),
(assign,":party_id_034",":p_121"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_am_watching_the_borders")"),
(str_store_string,s16,":str_store_string("str_i_may_be_needed_to_watch_the_borders")"),
(try_end),
(try_end),
(else_try),
(eq,1,0),
(else_try),
(eq,":var032",0),
(call_script, "script_lord_get_home_center", ":troop_id_001"),
(assign,":var060",reg0),
(try_begin),
(is_between,":var060","p_town_1","p_salt_mine"),
(eq,":var014",0),
(assign,":party_slot_033",4),
(assign,":party_id_034",":var060"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_will_guard_the_areas_near_my_home")"),
(str_store_string,s16,":str_store_string("str_i_am_perhaps_needed_most_at_home")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var014",0),
(call_script, "script_lord_get_home_center", ":troop_id_001"),
(assign,":var060",reg0),
(try_begin),
(is_between,":var060","p_town_1","p_village_1"),
(assign,":party_slot_033",7),
(assign,":party_id_034",":var060"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_cant_think_of_anything_better_to_do")"),
(try_end),
(try_end),
(else_try),
(eq,":var032",0),
(eq,":var014",1),
(party_get_slot,":party_slot_033",":troop_slot_002",4),
(party_get_slot,":party_id_034",":troop_slot_002",5),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_am_completing_what_i_have_already_begun")"),
(try_end),
(else_try),
(eq,":var032",0),
(assign,":party_slot_033",-1),
(assign,":party_id_034",-1),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s14,":str_store_string("str_i_dont_even_have_a_home_to_which_to_return")"),
(try_end),
(try_end),
(try_begin),
(eq,":::cheat_mode",2),
(str_store_string,s10,":str_store_troop_name(troop_id_001)"),
(display_message, "str_debug__s10_decides_s14_faction_ai_s15"),
(try_end),
(assign,reg0,":party_slot_033"),
(assign,reg1,":party_id_034"),
]),

("npc_decision_checklist_troop_follow_or_not", [
(store_script_param, ":troop_id_001", 1),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(faction_get_slot,":faction_slot_003",":troop_faction_002",4),
(troop_get_slot,":troop_slot_004",":troop_id_001",52),
(faction_get_slot,":faction_slot_005",":troop_faction_002",8),
(troop_get_slot,":troop_slot_007",":faction_slot_005",10),
(try_begin),
(eq,":faction_slot_005",-1),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s15,":str_store_string("str__i_am_acting_independently_because_no_marshal_is_appointed")"),
(try_end),
(else_try),
(neg|party_is_active,":troop_slot_007"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s15,":str_store_string("str__i_am_acting_independently_because_our_marshal_is_currently_indisposed")"),
(try_end),
(else_try),
(neq,":faction_slot_003",2),
(neq,":faction_slot_003",3),
(neq,":faction_slot_003",5),
(neq,":faction_slot_003",4),
(neq,":faction_slot_003",1),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s15,":str_store_string("str__i_am_acting_independently_because_our_realm_is_currently_not_on_campaign")"),
(try_end),
(else_try),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":faction_slot_005"),
(assign,":var008",reg0),
(try_begin),
(le,":var008",-10),
(assign,":var009",10000),
(else_try),
(store_mul, ":var009", ":var008", -1000),
(try_end),
(val_add, ":var009", 1500),
(game_get_reduce_campaign_ai, ":campaign_ai"),
(try_begin),
(neq,":troop_faction_002",":::players_kingdom"),
(try_begin),
(eq,":campaign_ai",0),
(val_add, ":var009", -1250),
(else_try),
(eq,":campaign_ai",1),
(else_try),
(eq,":campaign_ai",2),
(val_add, ":var009", 1250),
(try_end),
(else_try),
(faction_slot_eq,":troop_faction_002",8,"trp_player"),
(try_begin),
(eq,":campaign_ai",0),
(val_add, ":var009", -1000),
(else_try),
(eq,":campaign_ai",1),
(val_add, ":var009", -1500),
(else_try),
(eq,":campaign_ai",2),
(val_add, ":var009", -2000),
(try_end),
(try_end),
(troop_get_slot,":troop_slot_011",":troop_id_001",49),
(try_begin),
(le,":troop_slot_011",":var009"),
(try_begin),
(eq,":troop_id_001",":::g_talk_troop"),
(str_store_string,s15,":str_store_string("str__i_am_not_accompanying_the_marshal_because_i_fear_that_he_may_lead_us_into_disaster")"),
(try_end),
(try_end),
(try_end),
(assign,reg0,0), # var006
]),

("find_total_prosperity_score", [
(store_script_param, ":party_id_001", 1),
(try_begin),
(is_between,":party_id_001","p_town_1","p_village_1"),
(party_get_slot,":party_slot_002",":party_id_001",50),
(store_add, ":var003", ":party_slot_002", 200),
(val_div, ":var003", 10),
(try_begin),
(is_between,":party_id_001","p_town_1","p_castle_1"),
(store_mul, ":var004", ":var003", 15),
(else_try),
(store_mul, ":var004", ":var003", 5),
(try_end),
(assign,":var005",":var004"),
(try_for_range, ":p_006", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_006",120,":party_id_001"),
(party_get_slot,":party_slot_007",":p_006",50),
(store_add, ":var008", ":party_slot_007", 200),
(val_div, ":var008", 10),
(store_mul, ":var009", ":var008", 5),
(val_add, ":var005", ":var009"),
(try_end),
(else_try),
(party_get_slot,":party_slot_002",":party_id_001",50),
(store_add, ":var003", ":party_slot_002", 200),
(val_div, ":var003", 10),
(store_mul, ":var004", ":var003", 5),
(assign,":var005",":var004"),
(try_end),
(val_div, ":var005", 10),
(assign,reg0,":var005"),
]),

("calculate_center_assailability_score", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":party_id_002", 2),
(store_script_param, ":var003", 3),
(assign,":var004",-1),
(store_troop_faction,":troop_faction_005",":troop_id_001"),
(store_current_hours,":cur_hours_006"),
(faction_get_slot,":faction_slot_007",":troop_faction_005",95),
(val_sub, ":cur_hours_006", ":faction_slot_007"),
(store_div, ":var___x1", ":cur_hours_006", 12),
(assign,":var008",":var___x1"),
(val_add, ":var008", 30),
(val_min,":var008",100),
(faction_get_slot,":faction_slot_009",":troop_faction_005",8),
(assign,":troop_slot_010",-1),
(assign,":party_slot_011",0),
(try_begin),
(gt,":faction_slot_009",0),
(troop_get_slot,":troop_slot_010",":faction_slot_009",10),
(try_begin),
(party_is_active,":troop_slot_010"),
(party_get_slot,":party_slot_011",":troop_slot_010",56),
(party_get_slot,":party_slot_012",":troop_slot_010",59),
(try_end),
(try_end),
(faction_get_slot,":faction_slot_013",":troop_faction_005",85),
(faction_get_slot,":faction_slot_014",":troop_faction_005",86),
(try_begin),
(eq,1,1),
(store_current_hours,":cur_hours_015"),
(store_add, ":var016", ":faction_slot_014", 24),
(try_begin),
(gt,":cur_hours_015",":var016"),
(faction_set_slot,":troop_faction_005",85,0),
(assign,":faction_slot_013",0),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":faction_slot_013",0),
(this_or_next|eq,":faction_slot_013",":party_id_002"),
(this_or_next|neg|eq,":::g_do_not_skip_other_than_current_ai_object",1),
(neg|faction_slot_eq,":troop_faction_005",8,":troop_id_001"),
(party_is_active,":party_id_002"),
(store_faction_of_party, ":party_faction_017", ":party_id_002"),
(store_relation,":faction_relation_018",":party_faction_017",":troop_faction_005"),
(try_begin),
(lt,":faction_relation_018",0),
(assign,":party_faction_019",-1),
(try_begin),
(is_between,":party_id_002","p_town_1","p_village_1"),
(neg|party_slot_eq,":party_id_002",54,-1),
(party_get_slot,":party_slot_020",":party_id_002",54),
(party_is_active,":party_slot_020"),
(store_faction_of_party, ":party_faction_019", ":party_slot_020"),
(try_end),
(try_end),
(this_or_next|eq,":party_faction_019",":troop_faction_005"),
(eq,":party_faction_019",-1),
(assign,":var021",0),
(try_begin),
(is_between,":party_id_002","p_village_1","p_salt_mine"),
(party_slot_eq,":party_id_002",35,1),
(party_get_slot,":party_slot_022",":party_id_002",34),
(party_is_active,":party_slot_022"),
(store_faction_of_party, ":party_faction_023", ":party_slot_022"),
(try_begin),
(neq,":party_faction_023",":troop_faction_005"),
(assign,":var024",1),
(else_try),
(assign,":var024",0),
(try_end),
(try_end),
(this_or_next|party_slot_eq,":party_id_002",35,2),
(eq,":var024",1),
(assign,":var021",1),
(try_end),
(eq,":var021",0),
(assign,":var025",0),
(try_for_range, ":fac_026", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(is_between,":fac_026","fac_kingdom_1","fac_kingdoms_end"),
(neq,":fac_026",":troop_faction_005"),
(faction_get_slot,":faction_slot_027",":fac_026",5),
(eq,":faction_slot_027",":party_id_002"),
(store_relation,":faction_relation_028",":party_faction_017",":fac_026"),
(lt,":faction_relation_028",0),
(assign,":var025",1),
(try_end),
(try_end),
(try_end),
(eq,":var025",0),
(try_begin),
(is_between,":party_id_002","p_town_1","p_village_1"),
(party_get_slot,":party_slot_029",":party_id_002",56),
(party_get_slot,":party_slot_030",":party_id_002",57),
(val_div, ":party_slot_030", 2),
(store_add, ":var031", ":party_slot_029", ":party_slot_030"),
(val_mul, ":var031", 4),
(val_div, ":var031", 3),
(assign,":var032",":party_slot_011"),
(val_add, ":var032", ":party_slot_012"),
(store_mul, ":var033", ":var032", 100),
(try_begin),
(gt,":var031",0),
(val_div, ":var033", ":var031"),
(else_try),
(assign,":var033",1000),
(try_end),
(try_end),
(else_try),
(party_get_slot,":party_slot_030",":party_id_002",57),
(assign,":var031",1000),
(assign,":var032",":party_slot_011"),
(val_add, ":var032", ":party_slot_012"),
(store_mul, ":var033", ":var032", 100),
(try_begin),
(gt,":var031",0),
(val_div, ":var033", ":var031"),
(else_try),
(assign,":var033",1000),
(try_end),
(try_end),
(try_begin),
(ge,":var033",120),
(store_sub, ":var034", ":var033", 120),
(try_begin),
(lt,":var034",100),
(store_add, ":var035", ":var034", 20),
(else_try),
(lt,":var034",200),
(store_sub, ":var035", ":var034", 100),
(val_div, ":var035", 2),
(val_add, ":var035", 120),
(else_try),
(lt,":var034",400),
(store_sub, ":var035", ":var034", 200),
(val_div, ":var035", 5),
(val_add, ":var035", 170),
(else_try),
(lt,":var034",800),
(store_sub, ":var035", ":var034", 400),
(val_div, ":var035", 10),
(val_add, ":var035", 210),
(else_try),
(assign,":var035",250),
(try_end),
(try_end),
(assign,":var036",0),
(assign,":var037",0),
(try_for_range, ":p_038", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_039", ":p_038"),
(try_begin),
(eq,":party_faction_039",":troop_faction_005"),
(store_distance_to_party_from_party,":distance_parties_040",":p_038",":p_038"),
(val_add, ":var037", ":distance_parties_040"),
(val_add, ":var036", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var036",0),
(store_div, ":var___x1", ":var037", ":var036"),
(assign,":var041",":var___x1"),
(try_begin),
(ge,":troop_slot_010",0),
(party_is_active,":troop_slot_010"),
(store_distance_to_party_from_party,":distance_parties_042",":troop_slot_010",":troop_slot_010"),
(else_try),
(assign,":distance_parties_042",100),
(try_end),
(try_begin),
(eq,1,1),
(faction_get_slot,":faction_slot_043",":troop_faction_005",4),
(try_begin),
(eq,":faction_slot_043",2),
(faction_get_slot,":faction_slot_044",":troop_faction_005",5),
(try_begin),
(ge,":faction_slot_044",0),
(neq,":faction_slot_044",":party_id_002"),
(try_begin),
(ge,":var035",300),
(assign,":var035",200),
(else_try),
(ge,":var035",100),
(val_sub, ":var035", 100),
(val_div, ":var035", 2),
(val_add, ":var035", 100),
(try_end),
(try_end),
(try_end),
(faction_slot_eq,":troop_faction_005",8,":troop_id_001"),
(neg|eq,":::g_do_not_skip_other_than_current_ai_object",0),
(assign,":var035",0),
(try_end),
(faction_set_slot,":troop_faction_005",85,":faction_slot_044"),
(store_current_hours,":cur_hours_015"),
(faction_set_slot,":troop_faction_005",86,":cur_hours_015"),
(try_begin),
(eq,":var003",0),
(store_mul, ":var045", ":distance_parties_042", 2),
(val_div, ":var045", 3),
(else_try),
(store_div, ":var___x1", ":distance_parties_042", 3),
(assign,":var045",":var___x1"),
(try_end),
(store_add, ":var037", ":var041", ":var045"),
(else_try),
(assign,":var037",100),
(try_end),
(this_or_next|troop_slot_eq,":troop_id_001",52,7),
(this_or_next|troop_slot_eq,":troop_id_001",52,5),
(this_or_next|troop_slot_eq,":troop_id_001",52,6),
(troop_slot_eq,":troop_id_001",52,4),
(try_begin),
(lt,":var037",30),
(assign,":var046",100),
(else_try),
(lt,":var037",80),
(store_sub, ":var046", ":var037", 30),
(val_div, ":var046", 1),
(store_sub, ":var046", 100, ":var046"),
(else_try),
(lt,":var037",160),
(store_sub, ":var046", ":var037", 80),
(val_div, ":var046", 2),
(store_sub, ":var046", 50, ":var046"),
(else_try),
(assign,":var046",10),
(try_end),
(else_try),
(try_begin),
(lt,":var037",40),
(assign,":var046",100),
(else_try),
(lt,":var037",140),
(store_sub, ":var046", ":var037", 40),
(val_div, ":var046", 2),
(store_sub, ":var046", 100, ":var046"),
(else_try),
(lt,":var037",300),
(store_sub, ":var046", ":var037", 140),
(val_div, ":var046", 4),
(store_sub, ":var046", 50, ":var046"),
(else_try),
(assign,":var046",10),
(try_end),
(try_end),
(store_mul, ":var004", ":var046", ":var035"),
(val_mul, ":var004", ":var008"),
(val_div, ":var004", 100),
(call_script, "script_find_total_prosperity_score", ":party_id_002"),
(assign,":var047",reg0),
(val_mul, ":var047", 3),
(val_div, ":var047", 2),
(val_mul, ":var004", ":var047"),
(try_begin),
(party_slot_eq,":party_id_002",62,":troop_faction_005"),
(party_slot_eq,":party_id_002",61,":troop_faction_005"),
(val_mul, ":var004", 12),
(val_div, ":var004", 10),
(else_try),
(this_or_next|party_slot_eq,":party_id_002",62,":troop_faction_005"),
(party_slot_eq,":party_id_002",61,":troop_faction_005"),
(val_mul, ":var004", 11),
(val_div, ":var004", 10),
(try_end),
(val_div, ":var004", 1000),
(try_begin),
(eq,":party_faction_017","fac_player_supporters_faction"),
(game_get_reduce_campaign_ai, ":campaign_ai"),
(assign,":var049",0),
(try_for_range, ":p_050", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_051", ":p_050"),
(try_begin),
(eq,":party_faction_051","fac_player_supporters_faction"),
(val_add, ":var049", 1),
(try_end),
(try_end),
(try_begin),
(eq,":campaign_ai",2),
(try_begin),
(le,":var049",2),
(assign,":var052",0),
(else_try),
(eq,":var049",3),
(assign,":var052",20),
(else_try),
(eq,":var049",4),
(assign,":var052",40),
(else_try),
(eq,":var049",5),
(eq,":var049",6),
(assign,":var052",55),
(else_try),
(eq,":var049",7),
(eq,":var049",8),
(eq,":var049",9),
(assign,":var052",70),
(else_try),
(assign,":var052",85),
(try_end),
(else_try),
(eq,":campaign_ai",1),
(try_begin),
(le,":var049",1),
(assign,":var052",25),
(else_try),
(eq,":var049",2),
(assign,":var052",45),
(else_try),
(eq,":var049",3),
(assign,":var052",60),
(else_try),
(eq,":var049",4),
(eq,":var049",5),
(assign,":var052",75),
(else_try),
(eq,":var049",6),
(eq,":var049",7),
(eq,":var049",8),
(assign,":var052",85),
(else_try),
(assign,":var052",92),
(try_end),
(else_try),
(assign,":var052",100),
(try_end),
(val_mul, ":var004", ":var052"),
(val_div, ":var004", 100),
(try_end),
(try_begin),
(ge,":::cheat_mode",1),
(eq,":troop_faction_005","fac_kingdom_4"),
(ge,":var004",-1),
(assign,reg0,":var004"),
(assign,reg7,":var047"),
(assign,reg8,":var035"),
(assign,reg9,":var046"),
(assign,reg10,":var008"),
(str_store_string,s8,":str_store_party_name(party_id_002)"),
(assign,reg11,":var003"),
(try_end),
(assign,reg0,":var004"),
(assign,reg1,":var033"),
(assign,reg2,":var046"),
(assign,reg3,":var047"),
]),

("find_center_to_defend", [
(store_script_param, ":troop_id_001", 1),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(faction_get_slot,":faction_slot_003",":troop_faction_002",8),
(faction_get_slot,":faction_slot_004",":troop_faction_002",4),
(assign,":troop_slot_005",-1),
(try_begin),
(gt,":faction_slot_003",0),
(troop_get_slot,":troop_slot_005",":faction_slot_003",10),
(try_end),
(assign,":var006",-1),
(assign,":var007",0),
(try_for_range, ":p_008", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_009", ":p_008"),
(try_begin),
(eq,":party_faction_009",":troop_faction_002"),
(party_get_slot,":party_slot_010",":p_008",67),
(assign,":var011",":party_slot_010"),
(assign,":var012",0),
(try_begin),
(is_between,":p_008","p_town_1","p_village_1"),
(party_slot_ge,":p_008",54,0),
(call_script, "script_find_total_prosperity_score", ":p_008"),
(assign,":var013",reg0),
(party_get_slot,":party_slot_014",":p_008",56),
(val_mul, ":party_slot_014", 4),
(val_div, ":party_slot_014", 3),
(val_add, ":party_slot_014", 0), # var015
(store_mul, ":var016", ":var011", 100),
(val_add, ":party_slot_014", 1),
(val_max,":party_slot_014",1),
(val_div, ":var016", ":party_slot_014"),
(assign,":var017",0),
(party_get_slot,":party_slot_018",":p_008",54),
(try_begin),
(party_is_active,":party_slot_018"),
(try_begin),
(eq,":party_slot_018","p_main_party"),
(assign,":var017",1),
(else_try),
(store_faction_of_party, ":party_faction_019", ":party_slot_018"),
(try_begin),
(eq,":party_faction_019","fac_player_faction"),
(assign,":var017",1),
(else_try),
(party_get_attached_to, ":party_attached_020", "p_main_party"),
(try_begin),
(ge,":party_attached_020",0),
(eq,":party_attached_020",":party_slot_018"),
(assign,":var017",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var017",0),
(try_begin),
(lt,":var016",40),
(assign,":var012",1),
(else_try),
(lt,":var016",80),
(store_sub, ":var012", ":var016", 40),
(val_div, ":var012", 5),
(val_add, ":var012", 1),
(else_try),
(lt,":var016",120),
(store_sub, ":var012", ":var016", 80),
(val_div, ":var012", 4),
(val_add, ":var012", 7),
(else_try),
(lt,":var016",200),
(store_sub, ":var012", ":var016", 120),
(val_div, ":var012", 10),
(val_add, ":var012", 17),
(else_try),
(assign,":var012",25),
(try_end),
(else_try),
(try_begin),
(lt,":var016",200),
(store_div, ":var___x1", ":var016", 10),
(assign,":var012",":var___x1"),
(val_add, ":var012", 6),
(else_try),
(assign,":var012",26),
(try_end),
(try_end),
(else_try),
(is_between,":p_008","p_village_1","p_salt_mine"),
(party_slot_eq,":p_008",35,1),
(gt,":var011",0),
(call_script, "script_find_total_prosperity_score", ":p_008"),
(assign,":var016",100),
(assign,":var013",reg0),
(assign,":var012",10),
(try_end),
(try_begin),
(gt,":var012",0),
(try_begin),
(is_between,":p_008","p_town_1","p_village_1"),
(assign,":var021",120),
(try_begin),
(ge,":troop_slot_005",0),
(party_is_active,":troop_slot_005"),
(store_distance_to_party_from_party,":distance_parties_022",":troop_slot_005",":troop_slot_005"),
(else_try),
(assign,":distance_parties_022",100),
(try_end),
(try_end),
(try_begin),
(eq,":faction_slot_004",5),
(faction_get_slot,":faction_slot_023",":troop_faction_002",5),
(try_begin),
(is_between,":faction_slot_023","p_town_1","p_village_1"),
(neq,":faction_slot_023",":p_008"),
(val_mul, ":distance_parties_022", 2),
(val_add, ":distance_parties_022", 20),
(try_end),
(try_end),
(val_mul, ":distance_parties_022", 2),
(try_begin),
(lt,":distance_parties_022",10),
(assign,":var024",100),
(else_try),
(lt,":distance_parties_022",160),
(store_sub, ":var024", ":distance_parties_022", 10),
(val_div, ":var024", 3),
(store_sub, ":var024", 100, ":var024"),
(else_try),
(lt,":distance_parties_022",360),
(store_sub, ":var024", ":distance_parties_022", 250),
(val_div, ":var024", 5),
(store_sub, ":var024", 50, ":var024"),
(else_try),
(assign,":var024",10),
(try_end),
(else_try),
(store_add, ":var021", ":var011", 20000),
(val_div, ":var021", 200),
(assign,":var024",70),
(try_end),
(store_mul, ":var025", ":var021", ":var013"),
(val_mul, ":var025", ":var012"),
(val_mul, ":var025", ":var024"),
(val_div, ":var025", 10000),
(try_begin),
(ge,":::cheat_mode",1),
(gt,":var025",0),
(eq,":troop_faction_002","fac_kingdom_6"),
(assign,reg0,":var025"),
(str_store_string,s32,":str_store_party_name(p_008)"),
(assign,reg1,":var013"),
(assign,reg2,":var021"),
(assign,reg3,":var012"),
(assign,reg4,":var024"),
(try_end),
(try_begin),
(gt,":var025",":var007"),
(assign,":var006",":p_008"),
(assign,":var007",":var025"),
(assign,":var026",":var011"),
(try_end),
(try_end),
(val_mul, ":var007", 3),
(val_div, ":var007", 2),
(assign,reg0,":var006"),
(assign,reg1,":var007"),
(assign,reg2,":var026"),
]),

("npc_decision_checklist_peace_or_war", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":faction_id_002", 2),
(store_script_param, ":troop_id_003", 3),
(assign,":faction_slot_004",0),
(assign,":faction_slot_005",0),
(assign,":var006",0),
(assign,":var007",0),
(assign,":var008",0),
(assign,":var009",0),
(assign,"$g_concession_demanded",0),
(store_relation,":faction_relation_010",":faction_id_001",":faction_id_002"),
(try_begin),
(eq,":faction_id_002","fac_player_supporters_faction"),
(assign,":var011","$player_honor"),
(val_add, ":faction_slot_005", 2),
(else_try),
(assign,":var011",0),
(try_end),
(faction_get_slot,":faction_slot_012",":faction_id_001",11),
(faction_get_slot,":faction_slot_013",":faction_id_002",11),
(call_script, "script_troop_get_relation_with_troop", ":faction_slot_012", ":faction_slot_013"),
(assign,":var014",reg0),
(val_min,":var014",10),
(val_add, ":var011", ":var014"),
(str_store_string,s15,":str_store_troop_name(faction_slot_012)"),
(str_store_string,s16,":str_store_troop_name(faction_slot_013)"),
(assign,":faction_slot_015",0),
(assign,":faction_slot_016",0),
(call_script, "script_diplomacy_faction_get_diplomatic_status_with_faction", ":faction_id_001", ":faction_id_002"),
(assign,":var017",reg0),
(str_clear, 12),
(try_begin),
(eq,":var017",-2),
(str_store_string,s12,":str_store_string("str_s15_is_at_war_with_s16_")"),
(store_add, ":slot_no_018", ":faction_id_002", 140),
(assign,":slot_no_018 -","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_016",":faction_id_001",":slot_no_018"),
(store_add, ":slot_no_019", ":faction_id_001", 140),
(assign,":slot_no_019 -","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_015",":faction_id_002",":slot_no_019"),
(else_try),
(eq,":var017",1),
(str_store_string,s12,":str_store_string("str_in_the_short_term_s15_has_a_truce_with_s16_as_a_matter_of_general_policy_")"),
(else_try),
(eq,":var017",-1),
(str_store_string,s12,":str_store_string("str_in_the_short_term_s15_was_recently_provoked_by_s16_and_is_under_pressure_to_declare_war_as_a_matter_of_general_policy_")"),
(try_end),
(try_begin),
(is_between,"$g_talk_troop","trp_npc1","trp_knight_1_1_wife"),
(str_clear, 12),
(try_end),
(try_begin),
(gt,":troop_id_003",-1),
(store_skill_level,":skill_lvl_020","skl_persuasion",":troop_id_003"),
(val_mul, ":skill_lvl_020", 2),
(val_add, ":var011", ":skill_lvl_020"),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg4,":var011"),
(display_message, "str_envoymodified_diplomacy_score_honor_plus_relation_plus_envoy_persuasion_=_reg4"),
(try_end),
(try_end),
(try_for_range, ":fac_021", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_set_slot,":fac_021",12,0),
(try_end),
(try_for_parties, ":cur_party"),
(assign,":var023",0),
(try_begin),
(is_between,":cur_party","p_town_1","p_castle_1"),
(assign,":var023",3),
(else_try),
(is_between,":cur_party","p_castle_1","p_village_1"),
(assign,":var023",2),
(else_try),
(is_between,":cur_party","p_village_1","p_salt_mine"),
(assign,":var023",1),
(else_try),
(party_get_template_id,":party_template_id_024",":cur_party"),
(try_begin),
(eq,":party_template_id_024","pt_kingdom_hero_party"),
(assign,":var023",2),
(try_end),
(try_end),
(store_faction_of_party, ":party_faction_025", ":cur_party"),
(party_get_slot,":party_slot_026",":cur_party",61),
(party_get_slot,":party_slot_027",":cur_party",62),
(try_begin),
(is_between,":party_faction_025","fac_player_supporters_faction","fac_kingdoms_end"),
(faction_get_slot,":faction_slot_028",":party_faction_025",12),
(val_add, ":faction_slot_028", ":var023"),
(faction_set_slot,":party_faction_025",12,":faction_slot_028"),
(try_end),
(try_begin),
(eq,":party_faction_025",":faction_id_002"),
(val_add, ":faction_slot_005", ":var023"),
(try_begin),
(this_or_next|eq,":party_slot_026",":faction_id_001"),
(eq,":party_slot_027",":faction_id_001"),
(val_add, ":var006", 1),
(is_between,":cur_party","p_town_1","p_village_1"),
(assign,"$g_concession_demanded",":cur_party"),
(str_store_string,s18,":str_store_party_name(_g_concession_demanded)"),
(try_end),
(else_try),
(eq,":party_faction_025",":faction_id_001"),
(val_add, ":faction_slot_004", ":var023"),
(try_end),
(try_end),
(assign,":var029",-1),
(assign,":var030",60),
(try_for_range, ":fac_031", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(faction_get_slot,":faction_slot_032",":fac_031",12),
(try_begin),
(gt,":faction_slot_032",":var030"),
(assign,":var029",":fac_031"),
(assign,":var030",":faction_slot_032"),
(try_end),
(try_end),
(try_begin),
(eq,":::cheat_mode",2),
(gt,":var029",1),
(str_store_string,s4,":str_store_faction_name(var029)"),
(assign,reg3,":var030"),
(display_message, "@@{!}DEBUG - {s4} strongest kingdom with {reg3} strength"),
(try_end),
(assign,":var033",1),
(try_begin),
(gt,":faction_slot_004",0),
(store_mul, ":var033", ":faction_slot_005", 100),
(val_div, ":var033", ":faction_slot_004"),
(try_end),
(try_for_range, ":fac_034", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(neq,":fac_034",":faction_id_002"),
(neq,":fac_034",":faction_id_001"),
(faction_slot_eq,":fac_034",21,0),
(store_relation,":faction_relation_035",":fac_034",":faction_id_001"),
(lt,":faction_relation_035",0),
(assign,":var007",":fac_034"),
(val_add, ":var008", 1),
(store_relation,":faction_relation_035",":fac_034",":faction_id_002"),
(lt,":faction_relation_035",0),
(assign,":var009",":fac_034"),
(try_end),
(try_end),
(store_current_hours,":cur_hours_036"),
(faction_get_slot,":faction_slot_037",":faction_id_001",98),
(store_sub, ":var038", ":cur_hours_036", ":faction_slot_037"),
(try_begin),
(gt,":::supported_pretender",0),
(this_or_next|eq,":::supported_pretender",":faction_slot_012"),
(eq,":::supported_pretender",":faction_slot_013"),
(this_or_next|eq,":faction_id_001",":::supported_pretender_old_faction"),
(eq,":faction_id_002",":::supported_pretender_old_faction"),
(assign,":var039",-3),
(troop_get_type,reg4,":faction_slot_012"),
(assign,":var040","str_s12s15_cannot_negotiate_with_s16_as_to_do_so_would_undermine_reg4herhis_own_claim_to_the_throne_this_civil_war_must_almost_certainly_end_with_the_defeat_of_one_side_or_another"),
(else_try),
(lt,":var011",-20),
(lt,":var033",125),
(lt,":faction_slot_015",400),
(this_or_next|eq,":var017",-2),
(lt,":var038",720),
(eq,":var008",0),
(assign,":var039",-3),
(troop_get_type,reg4,":faction_slot_012"),
(assign,":var040","str_s12s15_considers_s16_to_be_dangerous_and_untrustworthy_and_shehe_wants_to_bring_s16_down"),
(else_try),
(gt,":var006",0),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "@@{!}Actor centers held by target noted"),
(try_end),
(try_begin),
(lt,":faction_slot_015",200),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "@@{!}War damage under minimum"),
(try_end),
(try_end),
(try_begin),
(lt,":var033",125),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "@@{!}Strength ratio correct"),
(try_end),
(try_end),
(try_begin),
(eq,":var008",0),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "@@{!}Third party wars"),
(try_end),
(try_end),
(assign,":var039",-2),
(assign,":var040","str_s12s15_is_anxious_to_reclaim_old_lands_such_as_s18_now_held_by_s16"),
(else_try),
(eq,":var017",-2),
(lt,":var033",125),
(le,":var008",1),
(ge,":faction_slot_016",5),
(this_or_next|eq,":var017",-2),
(lt,":var038",720),
(store_mul, ":var041", ":faction_slot_015", 2),
(try_begin),
(gt,":faction_slot_016",":var041"),
(assign,":var039",-2),
(troop_get_type,reg4,":faction_slot_012"),
(assign,":var040","str_s12s15_feels_that_reg4shehe_is_winning_the_war_against_s16_and_sees_no_reason_not_to_continue"),
(else_try),
(le,":var017",-1),
(this_or_next|eq,":var017",-1),
(le,":faction_slot_016",1),
(lt,":var033",150),
(eq,":var008",0),
(faction_slot_ge,":faction_id_001",61,60),
(assign,":var039",-1),
(assign,":var040","str_s12s15_faces_too_much_internal_discontent_to_feel_comfortable_ignoring_recent_provocations_by_s16s_subjects"),
(else_try),
(eq,":var017",-2),
(lt,":faction_slot_016",100),
(eq,":var008",1),
(assign,":var039",-1),
(troop_get_type,reg4,":faction_slot_012"),
(assign,":var040","str_s12even_though_reg4shehe_is_fighting_on_two_fronts_s15_is_inclined_to_continue_the_war_against_s16_for_a_little_while_longer_for_the_sake_of_honor"),
(else_try),
(eq,":var017",-2),
(lt,":faction_slot_016",100),
(eq,":var008",0),
(assign,":var039",-1),
(troop_get_type,reg4,":faction_slot_012"),
(assign,":var040","str_s12s15_feels_that_reg4shehe_must_pursue_the_war_against_s16_for_a_little_while_longer_for_the_sake_of_honor"),
(else_try),
(this_or_next|faction_slot_eq,":faction_id_001",4,2),
(this_or_next|faction_slot_eq,":faction_id_001",4,3),
(faction_slot_eq,":faction_id_001",4,4),
(faction_get_slot,":faction_slot_042",":faction_id_001",5),
(try_begin),
(party_is_active,":faction_slot_042"),
(store_faction_of_party, ":party_faction_043", ":faction_slot_042"),
(try_begin),
(eq,":party_faction_043",":faction_id_002"),
(str_store_string,s17,":str_store_party_name(faction_slot_042)"),
(assign,":var039",-1),
(assign,":var040","str_s12s15_is_currently_on_the_offensive_against_s17_now_held_by_s16_and_reluctant_to_negotiate"),
(else_try),
(eq,":var029",":faction_id_002"),
(eq,":var008",0),
(this_or_next|ge,":var017",-1),
(lt,":var038",1440),
(assign,":var044",0),
(try_for_range, ":fac_045", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(neq,":fac_045",":faction_id_001"),
(neq,":fac_045",":faction_id_002"),
(faction_slot_eq,":fac_045",21,0),
(store_relation,":faction_relation_046",":fac_045",":faction_id_002"),
(try_begin),
(lt,":faction_relation_046",0),
(assign,":var044",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var044",1),
(assign,":var039",-1),
(assign,":var040","str_s12s15_is_alarmed_by_the_growing_power_of_s16"),
(else_try),
(eq,":var008",0),
(try_begin),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- No third party wars for {s15}"),
(try_end),
(try_end),
(try_begin),
(eq,":faction_id_001",":var029"),
(try_begin),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- {s15} is strongest kingdom"),
(try_end),
(try_end),
(faction_get_slot,":faction_slot_004",":faction_id_001",12),
(faction_get_slot,":faction_slot_005",":faction_id_002",12),
(store_sub, ":var047", ":faction_slot_004", ":faction_slot_005"),
(try_begin),
(ge,":var047",30),
(try_begin),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- {s15} has 30 point advantage over {s16}"),
(try_end),
(try_end),
(assign,":var048",0),
(try_for_range, ":p_049", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_050", ":p_049"),
(try_begin),
(eq,":party_faction_050",":faction_id_001"),
(try_for_range, ":p_051", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_052", ":p_051"),
(try_begin),
(eq,":party_faction_052",":faction_id_002"),
(store_distance_to_party_from_party,":distance_parties_053",":p_051",":p_051"),
(try_begin),
(lt,":distance_parties_053",25),
(assign,":var048",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var048",1),
(try_begin),
(ge,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- {s15} has proximity to {s16}"),
(try_end),
(try_end),
(assign,":var039",-1),
(assign,":var040","str_s12s15_declared_war_to_control_calradia"),
(else_try),
(lt,":var011",-20),
(assign,":var039",0),
(assign,":var040","str_s12s15_distrusts_s16_and_fears_that_any_deals_struck_between_the_two_realms_will_not_be_kept"),
(else_try),
(lt,":faction_relation_010",0),
(ge,":var008",2),
(assign,":var039",3),
(assign,":var040","str_s12s15_is_at_war_on_too_many_fronts_and_eager_to_make_peace_with_s16"),
(else_try),
(gt,":var009",0),
(eq,":var006",0),
(this_or_next|ge,":faction_relation_010",0),
(eq,1,1),
(assign,":var039",3),
(str_store_string,s17,":str_store_faction_name(var009)"),
(troop_get_type,reg4,":faction_slot_012"),
(assign,":var040","str_s12s15_seems_to_think_that_s16_and_reg4shehe_have_a_common_enemy_in_the_s17"),
(else_try),
(eq,":var017",-2),
(ge,":var038",720),
(troop_get_type,reg4,":faction_slot_012"),
(assign,":var039",2),
(assign,":var040","str_s12s15_feels_frustrated_by_reg4herhis_inability_to_strike_a_decisive_blow_against_s16"),
(else_try),
(lt,":faction_relation_010",0),
(gt,":faction_slot_015",100),
(val_mul, ":var041", 2),
(try_begin),
(lt,":faction_slot_016",":var041"),
(assign,":var039",2),
(assign,":var040","str_s12s15_has_suffered_enough_in_the_war_with_s16_for_too_little_gain_and_is_ready_to_pursue_a_peace"),
(else_try),
(gt,":var007",0),
(ge,":var011",0),
(lt,":faction_relation_010",0),
(assign,":var039",1),
(str_store_string,s17,":str_store_faction_name(var007)"),
(assign,":var040","str_s12s15_would_like_to_firm_up_a_truce_with_s16_to_respond_to_the_threat_from_the_s17"),
(else_try),
(gt,":var007",0),
(ge,":var011",0),
(assign,":var039",1),
(str_store_string,s17,":str_store_faction_name(var007)"),
(assign,":var040","str_s12s15_wishes_to_be_at_peace_with_s16_so_as_to_pursue_the_war_against_the_s17"),
(else_try),
(gt,":var033",175),
(assign,":var039",1),
(assign,":var040","str_s12s15_seems_to_be_intimidated_by_s16_and_would_like_to_avoid_hostilities"),
(else_try),
(lt,":faction_relation_010",0),
(assign,":var039",1),
(assign,":var040","str_s12s15_has_no_particular_reason_to_continue_the_war_with_s16_and_would_probably_make_peace_if_given_the_opportunity"),
(else_try),
(assign,":var039",1),
(assign,":var040","str_s12s15_seems_to_be_willing_to_improve_relations_with_s16"),
(try_end),
(try_end),
(str_store_string,s14,":str_store_string(var040)"),
(assign,reg0,":var039"),
(assign,reg1,":var040"),
]),

("npc_decision_checklist_male_guardian_assess_suitor", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_001",52),
(store_troop_faction,":troop_faction_004",":troop_id_001"),
(try_begin),
(eq,":troop_id_002","trp_player"),
(assign,":troop_faction_005","$players_kingdom"),
(else_try),
(store_troop_faction,":troop_faction_005",":troop_id_002"),
(try_end),
(store_relation,":faction_relation_006",":troop_faction_004",":troop_faction_005"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":troop_id_002"),
(assign,":var007",reg0),
(troop_get_slot,":troop_slot_008",":troop_id_002",7),
(assign,":var009",-1),
(try_begin),
(eq,":troop_id_002","trp_player"),
(gt,":::marriage_candidate",0),
(try_for_range, ":trp_010", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(store_troop_faction,":troop_faction_011",":trp_010"),
(eq,":troop_faction_011",":troop_faction_004"),
(this_or_next|troop_slot_eq,":trp_010",35,"$marriage_candidate"),
(this_or_next|troop_slot_eq,":trp_010",36,"$marriage_candidate"),
(troop_slot_eq,":trp_010",37,"$marriage_candidate"),
(call_script, "script_troop_get_relation_with_troop", ":trp_010", ":troop_id_001"),
(gt,reg0,5),
(troop_slot_ge,":trp_010",7,":troop_slot_008"),
(assign,":var009",":trp_010"),
(str_store_string,s14,":str_store_troop_name(trp_010)"),
(str_store_string,s16,":str_store_troop_name(_marriage_candidate)"),
(try_end),
(try_end),
(try_begin),
(lt,":troop_slot_008",50),
(this_or_next|troop_slot_eq,":troop_id_001",52,2),
(this_or_next|troop_slot_eq,":troop_id_001",52,5),
(troop_slot_eq,":troop_id_001",52,3),
(assign,":var012","str_excuse_me_how_can_you_possibly_imagine_yourself_worthy_to_marry_into_our_family"),
(assign,":var013",-3),
(else_try),
(lt,":troop_slot_008",50),
(troop_slot_eq,":troop_id_001",52,6),
(assign,":var012","str_em_with_regard_to_her_ladyship_we_were_looking_specifically_for_a_groom_of_some_distinction_fight_hard_count_your_dinars_and_perhaps_some_day_in_the_future_we_may_speak_of_such_things_my_good_man"),
(assign,":var013",-1),
(else_try),
(lt,":troop_slot_008",50),
(assign,":var012","str_em_with_regard_to_her_ladyship_we_were_looking_specifically_for_a_groom_of_some_distinction"),
(assign,":var013",-2),
(else_try),
(lt,":troop_slot_008",200),
(neg|troop_slot_eq,":troop_id_001",52,6),
(assign,":var012","str_it_is_too_early_for_you_to_be_speaking_of_such_things_you_are_still_making_your_mark_in_the_world"),
(assign,":var013",-1),
(else_try),
(eq,":troop_id_002","trp_player"),
(neq,":troop_faction_005",":::players_kingdom"),
(str_store_string,s4,":str_store_faction_name(troop_faction_004)"),
(try_begin),
(this_or_next|eq,":troop_slot_003",5),
(eq,":troop_slot_003",2),
(assign,":var012","str_you_dont_serve_the_s4_so_id_say_no_one_day_we_may_be_at_war_and_i_prefer_not_to_have_to_kill_my_inlaws_if_at_all_possible"),
(assign,":var013",-1),
(else_try),
(eq,":troop_id_002","trp_player"),
(neq,":troop_faction_005",":::players_kingdom"),
(neq,":troop_slot_003",6),
(neq,":troop_slot_003",4),
(assign,":var012","str_as_you_are_not_a_vassal_of_the_s4_i_must_decline_your_request_the_twists_of_fate_may_mean_that_we_will_one_day_cross_swords_and_i_would_hope_not_to_make_a_widow_of_a_lady_whom_i_am_obligated_to_protect"),
(assign,":var013",-1),
(else_try),
(eq,":troop_id_002","trp_player"),
(lt,":faction_relation_006",0),
(assign,":var012","str_as_you_are_not_a_vassal_of_the_s4_i_must_decline_your_request_the_twists_of_fate_may_mean_that_we_will_one_day_cross_swords_and_i_would_hope_not_to_make_a_widow_of_a_lady_whom_i_am_obligated_to_protect"),
(assign,":var013",-1),
(else_try),
(eq,":troop_id_002","trp_player"),
(neq,":::player_has_homage",1),
(neg|faction_slot_eq,"fac_player_supporters_faction",21,0),
(assign,":var012","str_as_you_are_not_a_pledged_vassal_of_our_liege_with_the_right_to_hold_land_i_must_refuse_your_request_to_marry_into_our_family"),
(assign,":var013",-1),
(else_try),
(gt,":var009",-1),
(this_or_next|eq,":troop_slot_003",3),
(this_or_next|eq,":troop_slot_003",5),
(this_or_next|eq,":troop_slot_003",1),
(eq,":troop_slot_003",2),
(assign,":var012","str_look_here_lad__the_young_s14_has_been_paying_court_to_s16_and_youll_have_to_admit__hes_a_finer_catch_for_her_than_you_so_lets_have_no_more_of_this_talk_shall_we"),
(assign,":var013",-1),
(else_try),
(lt,":var007",-4),
(assign,":var012","str_i_do_not_care_for_you_sir_and_i_consider_it_my_duty_to_protect_the_ladies_of_my_household_from_undesirable_suitors"),
(assign,":var013",-3),
(else_try),
(lt,":var007",5),
(assign,":var012","str_hmm_young_girls_may_easily_be_led_astray_so_out_of_a_sense_of_duty_to_the_ladies_of_my_household_i_think_i_would_like_to_get_to_know_you_a_bit_better_we_may_speak_of_this_at_a_later_date"),
(assign,":var013",-1),
(else_try),
(assign,":var012","str_you_may_indeed_make_a_fine_match_for_the_young_mistress"),
(assign,":var013",1),
(try_end),
(try_end),
(assign,reg0,":var013"),
(assign,reg1,":var012"),
]),

("npc_decision_checklist_marry_female_pc", [
(store_script_param, ":troop_id_001", 1),
(troop_get_slot,":troop_slot_002",":troop_id_001",52),
(call_script, "script_troop_get_romantic_chemistry_with_troop", ":troop_id_001", "trp_player"),
(assign,":var003",reg0),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", "trp_player"),
(assign,":var004",reg0),
(assign,":var005",-1),
(try_for_range, ":trp_006", ":trp.knight_1_1_wife", ":trp.heroes_end"),
(this_or_next|troop_slot_eq,":troop_id_001",35,":trp_006"),
(this_or_next|troop_slot_eq,":troop_id_001",36,":trp_006"),
(troop_slot_eq,":troop_id_001",37,":trp_006"),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":var005"),
(assign,":var007",reg0),
(gt,":var007",":var004"),
(assign,":var005",":trp_006"),
(try_end),
(try_end),
(assign,":var008",0),
(try_for_range, ":p_009", ":p.town_1", ":p.salt_mine"),
(troop_slot_eq,":p_009",7,"trp_player"),
(val_add, ":var008", 1),
(try_end),
(assign,":var010",0),
(try_begin),
(troop_slot_ge,"trp_player",34,"trp_npc1"),
(neg|troop_slot_eq,"trp_player",34,":troop_id_001"),
(str_store_string,s14,":str_store_string("str_my_lady_engaged_to_another")"),
(else_try),
(lt,":var004",-3),
(this_or_next|eq,":troop_slot_002",7),
(this_or_next|eq,":troop_slot_002",4),
(eq,":troop_slot_002",6),
(str_store_string,s14,":str_store_string("str_madame__given_our_relations_in_the_past_this_proposal_is_most_surprising_i_do_not_think_that_you_are_the_kind_of_woman_who_can_be_bent_to_a_hushands_will_and_i_would_prefer_not_to_have_our_married_life_be_a_source_of_constant_acrimony")"),
(else_try),
(lt,":var004",-10),
(this_or_next|eq,":troop_slot_002",2),
(this_or_next|eq,":troop_slot_002",5),
(eq,":troop_slot_002",3),
(str_store_string,s14,":str_store_string("str_i_would_prefer_to_marry_a_proper_maiden_who_will_obey_her_husband_and_is_not_likely_to_split_his_head_with_a_sword")"),
(else_try),
(lt,":var003",5),
(str_store_string,s14,":str_store_string("str_my_lady_not_sufficient_chemistry")"),
(else_try),
(this_or_next|eq,":troop_slot_002",1),
(eq,":troop_slot_002",7),
(str_store_string,s14,":str_store_string("str_my_lady_while_i_admire_your_valor_you_will_forgive_me_if_i_tell_you_that_a_woman_like_you_does_not_uphold_to_my_ideal_of_the_feminine_of_the_delicate_and_of_the_pure")"),
(else_try),
(eq,":troop_slot_002",2),
(lt,":var003",15),
(str_store_string,s14,":str_store_string("str_nah_i_want_a_woman_wholl_keep_quiet_and_do_what_shes_told_i_dont_think_thats_you")"),
(else_try),
(this_or_next|eq,":troop_slot_002",3),
(eq,":troop_slot_002",5),
(ge,":var003",10),
(eq,":var008",0),
(str_store_string,s14,":str_store_string("str_my_lady_you_are_possessed_of_great_charms_but_no_properties_until_you_obtain_some_to_marry_you_would_be_an_act_of_ingratitude_towards_my_ancestors_and_my_lineage")"),
(else_try),
(this_or_next|eq,":troop_slot_002",3),
(eq,":troop_slot_002",5),
(eq,":var008",0),
(str_store_string,s14,":str_store_string("str_my_lady_you_are_a_woman_of_no_known_family_of_no_possessions__in_short_a_nobody_do_you_think_that_you_are_fit_to_marry_into_may_family")"),
(else_try),
(lt,":var003",5),
(lt,":var004",20),
(neq,":troop_slot_002",5),
(neq,":troop_slot_002",3),
(str_store_string,s14,":str_store_string("str_my_lady__forgive_me__the_quality_of_our_bond_is_not_of_the_sort_which_the_poets_tell_us_is_necessary_to_sustain_a_happy_marriage")"),
(else_try),
(eq,":troop_slot_002",4),
(faction_get_slot,":faction_slot_011",11,"$g_talk_troop_faction"),
(str_store_string,s4,":str_store_troop_name(faction_slot_011)"),
(call_script, "script_troop_get_relation_with_troop", ":faction_slot_011", "trp_player"),
(try_begin),
(lt,reg0,-10),
(str_store_string,s14,":str_store_string("str_um_i_think_that_if_i_want_to_stay_on_s4s_good_side_id_best_not_marry_you")"),
(else_try),
(gt,":::players_kingdom",0),
(neq,":::players_kingdom",":::g_talk_troop_faction"),
(faction_get_slot,":faction_slot_011",11,"$g_talk_troop_faction"),
(troop_get_type,reg4,":faction_slot_011"),
(str_store_string,s14,":str_store_string("str_you_serve_another_realm_i_dont_see_s4_granting_reg4herhis_blessing_to_our_union")"),
(else_try),
(gt,":var005",-1),
(str_store_string,s4,":str_store_troop_name(var005)"),
(str_store_string,s14,":str_store_string("str_madame_my_heart_currently_belongs_to_s4")"),
(else_try),
(lt,":var004",10),
(assign,":var010",2),
(str_store_string,s14,":str_store_string("str_my_lady_you_are_a_woman_of_great_spirit_and_bravery_possessed_of_beauty_grace_and_wit_i_shall_give_your_proposal_consideration")"),
(else_try),
(assign,":var010",1),
(str_store_string,s14,":str_store_string("str_my_lady_you_are_a_woman_of_great_spirit_and_bravery_possessed_of_beauty_grace_and_wit_i_would_be_most_honored_were_you_to_become_my_wife")"),
(try_end),
(try_end),
(assign,reg0,":var010"),
]),

("courtship_poem_reactions", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(troop_get_slot,":troop_slot_003",":troop_id_001",52),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg4,":var002"),
(assign,reg5,":troop_slot_003"),
(display_message, "str_poem_choice_reg4_lady_rep_reg5"),
(try_end),
(try_begin),
(eq,":var002",1),
(eq,":troop_slot_003",21),
(str_store_string,s11,":str_store_string("str_ah__kais_and_layali__such_a_sad_tale_many_a_time_has_it_been_recounted_for_my_family_by_the_wandering_poets_who_come_to_our_home_and_it_has_never_failed_to_bring_tears_to_our_eyes")"),
(assign,":var004",5),
(else_try),
(eq,":var002",1),
(eq,":troop_slot_003",24),
(str_store_string,s11,":str_store_string("str_kais_and_layali_three_hundred_stanzas_of_pathetic_sniveling_if_you_ask_me_if_kais_wanted_to_escape_heartbreak_he_should_have_learned_to_live_within_his_station_and_not_yearn_for_what_he_cannot_have")"),
(assign,":var004",0),
(else_try),
(eq,":var002",1),
(eq,":troop_slot_003",23),
(str_store_string,s11,":str_store_string("str_kais_and_layali_no_one_should_ever_have_written_such_a_sad_poem_if_it_was_the_destiny_of_kais_and_layali_to_be_together_than_their_love_should_have_conquered_all_obstacles")"),
(assign,":var004",1),
(else_try),
(eq,":var002",1),
(str_store_string,s11,":str_store_string("str_ah_kais_and_layali_a_very_old_standby_but_moving_in_its_way")"),
(assign,":var004",3),
(else_try),
(eq,":var002",2),
(eq,":troop_slot_003",22),
(str_store_string,s11,":str_store_string("str_the_saga_of_helgered_and_kara_such_happy_times_in_which_our_ancestors_lived_women_like_kara_could_venture_out_into_the_world_like_men_win_a_name_for_themselves_and_not_linger_in_their_husbands_shadow")"),
(assign,":var004",5),
(else_try),
(eq,":var002",2),
(eq,":troop_slot_003",24),
(str_store_string,s11,":str_store_string("str_ah_the_saga_of_helgered_and_kara_now_there_was_a_lady_who_knew_what_she_wanted_and_was_not_afraid_to_obtain_it")"),
(assign,":var004",2),
(else_try),
(eq,":var002",2),
(eq,":troop_slot_003",23),
(str_store_string,s11,":str_store_string("str_the_saga_of_helgered_and_kara_a_terrible_tale__but_it_speaks_of_a_very_great_love_if_she_were_willing_to_make_war_on_her_own_family")"),
(assign,":var004",2),
(else_try),
(eq,":var002",2),
(eq,":troop_slot_003",25),
(str_store_string,s11,":str_store_string("str_the_saga_of_helgered_and_kara_as_i_recall_kara_valued_her_own_base_passions_over_duty_to_her_family_that_she_made_war_on_her_own_father_i_have_no_time_for_a_poem_which_praises_such_a_woman")"),
(assign,":var004",0),
(else_try),
(eq,":var002",2),
(eq,":troop_slot_003",21),
(str_store_string,s11,":str_store_string("str_the_saga_of_helgered_and_kara_how_could_a_woman_don_armor_and_carry_a_sword_how_could_a_man_love_so_ungentle_a_creature")"),
(assign,":var004",0),
(else_try),
(eq,":var002",3),
(eq,":troop_slot_003",23),
(str_store_string,s11,":str_store_string("str_a_conversation_in_the_garden_i_cannot_understand_the_lady_in_that_poem_if_she_loves_the_man_why_does_she_tease_him_so")"),
(assign,":var004",0),
(else_try),
(eq,":var002",3),
(eq,":troop_slot_003",25),
(str_store_string,s11,":str_store_string("str_a_conversation_in_the_garden_let_us_see__it_is_morally_unedifying_it_exalts_deception_it_ends_with_a_maiden_surrendering_to_her_base_passions_and_yet_i_cannot_help_but_find_it_charming_perhaps_because_it_tells_us_that_love_need_not_be_tragic_to_be_memorable")"),
(assign,":var004",1),
(else_try),
(eq,":var002",3),
(eq,":troop_slot_003",24),
(str_store_string,s11,":str_store_string("str_a_conversation_in_the_garden_now_that_is_a_tale_every_lady_should_know_by_heart_to_learn_the_subtleties_of_the_politics_she_must_practice")"),
(assign,":var004",5),
(else_try),
(eq,":var002",3),
(str_store_string,s11,":str_store_string("str_a_conversation_in_the_garden_it_is_droll_i_suppose__although_there_is_nothing_there_that_truly_stirs_my_soul")"),
(assign,":var004",3),
(else_try),
(eq,":var002",5),
(eq,":troop_slot_003",22),
(str_store_string,s11,":str_store_string("str_storming_the_fortress_of_love_ah_yes_the_lady_sits_within_doing_nothing_while_the_man_is_the_one_who_strives_and_achieves_i_have_enough_of_that_in_my_daily_life_why_listen_to_poems_about_it")"),
(assign,":var004",0),
(else_try),
(eq,":var002",5),
(this_or_next|eq,":troop_slot_003",21),
(eq,":troop_slot_003",25),
(str_store_string,s11,":str_store_string("str_storming_the_fortress_of_love_ah_yes_an_uplifting_tribute_to_the_separate_virtues_of_man_and_woman")"),
(assign,":var004",3),
(else_try),
(eq,":var002",5),
(eq,":troop_slot_003",23),
(str_store_string,s11,":str_store_string("str_storming_the_fortress_of_love_ah_yes_but_although_it_is_a_fine_tale_of_virtues_it_speaks_nothing_of_passion")"),
(assign,":var004",1),
(else_try),
(eq,":var002",5),
(eq,":troop_slot_003",24),
(str_store_string,s11,":str_store_string("str_storming_the_fortress_of_love_ah_a_sermon_dressed_up_as_a_love_poem_if_you_ask_me")"),
(assign,":var004",1),
(else_try),
(eq,":var002",4),
(eq,":troop_slot_003",23),
(str_store_string,s11,":str_store_string("str_a_hearts_desire_ah_such_a_beautiful_account_of_the_perfect_perfect_love_to_love_like_that_must_be_to_truly_know_rapture")"),
(assign,":var004",4),
(else_try),
(eq,":var002",4),
(eq,":troop_slot_003",24),
(str_store_string,s11,":str_store_string("str_a_hearts_desire_silly_if_you_ask_me_if_the_poet_desires_a_lady_then_he_should_endeavor_to_win_her__and_not_dress_up_his_desire_with_a_pretense_of_piety")"),
(assign,":var004",0),
(else_try),
(eq,":var002",4),
(eq,":troop_slot_003",25),
(str_store_string,s11,":str_store_string("str_a_hearts_desire_hmm__it_is_an_interesting_exploration_of_earthly_and_divine_love_it_does_speak_of_the_spiritual_quest_which_brings_out_the_best_in_man_but_i_wonder_if_the_poet_has_not_confused_his_yearning_for_higher_things_with_his_baser_passions")"),
(assign,":var004",2),
(else_try),
(eq,":var002",4),
(str_store_string,s11,":str_store_string("str_a_hearts_desire_oh_yes__it_is_very_worthy_and_philosophical_but_if_i_am_to_listen_to_a_bard_strum_a_lute_for_three_hours_i_personally_prefer_there_to_be_a_bit_of_a_story")"),
(assign,":var004",1),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg4,":var004"),
(display_message, "str_result_reg4_string_s11"),
(try_end),
(assign,reg0,":var004"),
]),

("diplomacy_faction_get_diplomatic_status_with_faction", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":var002", 2),
(store_add, ":slot_no_003", ":var002", 120),
(store_add, ":slot_no_004", ":var002", 130),
(assign,":slot_no_003 -","fac_player_supporters_faction"),
(assign,":slot_no_004 -","fac_player_supporters_faction"),
(assign,":var005",0),
(assign,":faction_slot_006",0),
(try_begin),
(eq,1,1),
(store_relation,":faction_relation_007",":faction_id_001",":var002"),
(try_begin),
(lt,":faction_relation_007",0),
(assign,":var005",-2),
(else_try),
(faction_slot_ge,":faction_id_001",":slot_no_003",1),
(assign,":var005",1),
(faction_get_slot,":faction_slot_006",":faction_id_001",":slot_no_003"),
(else_try),
(faction_slot_ge,":faction_id_001",":slot_no_004",1),
(assign,":var005",-1),
(faction_get_slot,":faction_slot_006",":faction_id_001",":slot_no_004"),
(try_end),
(try_end),
(assign,reg0,":var005"),
(assign,reg1,":faction_slot_006"),
]),

("faction_follows_controversial_policy", [
(store_script_param, ":faction_id_001", 1),
(store_script_param, ":var002", 2),
(faction_get_slot,":faction_slot_003",":faction_id_001",11),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s3,":str_store_faction_name(faction_id_001)"),
(display_message, "str_calculating_effect_for_policy_for_s3"),
(val_add, ":::number_of_controversial_policy_decisions", 1),
(try_end),
(try_begin),
(eq,":var002",80),
(assign,":var004",0),
(assign,":var005",-2),
(assign,":var006",-1),
(else_try),
(eq,":var002",81),
(assign,":var004",-3),
(assign,":var005",0),
(assign,":var006",0),
(else_try),
(eq,":var002",83),
(assign,":var004",3),
(assign,":var005",1),
(assign,":var006",0),
(else_try),
(eq,":var002",84),
(assign,":var004",0),
(assign,":var005",-3),
(assign,":var006",-5),
(else_try),
(eq,":var002",82),
(assign,":var004",-5),
(assign,":var005",0),
(assign,":var006",0),
(try_end),
(try_begin),
(eq,":faction_slot_003","trp_player"),
(call_script, "script_change_player_honor", ":var006"),
(try_end),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_007",2,2),
(store_troop_faction,":troop_faction_008",":trp_007"),
(eq,":troop_faction_008",":faction_id_001"),
(neq,":trp_007",":faction_slot_003"),
(this_or_next|troop_slot_eq,":trp_007",52,1),
(this_or_next|troop_slot_eq,":trp_007",52,2),
(this_or_next|troop_slot_eq,":trp_007",52,3),
(troop_slot_eq,":trp_007",52,5),
(call_script, "script_troop_change_relation_with_troop", ":faction_slot_003", ":trp_007", ":var004"),
(val_add, ":::total_policy_dispute_changes", ":var004"),
(try_end),
(this_or_next|troop_slot_eq,":trp_007",52,1),
(this_or_next|troop_slot_eq,":trp_007",52,6),
(this_or_next|troop_slot_eq,":trp_007",52,3),
(this_or_next|troop_slot_eq,":trp_007",52,9),
(this_or_next|troop_slot_eq,":trp_007",52,10),
(troop_slot_eq,":trp_007",52,7),
(call_script, "script_troop_change_relation_with_troop", ":faction_slot_003", ":trp_007", ":var005"),
(val_add, ":::total_policy_dispute_changes", ":var005"),
(try_end),
]),

("internal_politics_rate_feast_to_s9", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(val_max,":var002",1),
(try_for_range, ":itm_004", ":itm.spice", ":itm.siege_supply"),
(item_set_slot,":itm_004",7,0),
(try_end),
(troop_get_inventory_capacity,":troop_inv_capacity_005",":troop_id_001"),
(try_for_range, ":inventory_slot_no_006", 0, ":troop_inv_capacity_005"),
(troop_get_inventory_slot,":itm_004",":troop_id_001",":inventory_slot_no_006"),
(try_begin),
(is_between,":itm_004","itm_spice","itm_siege_supply"),
(troop_inventory_slot_get_item_amount,":troop_inv_slot_item_amount_007",":troop_id_001",":inventory_slot_no_006"),
(item_get_slot,":item_slot_008",":itm_004",7),
(val_add, ":item_slot_008", ":troop_inv_slot_item_amount_007"),
(item_set_slot,":itm_004",7,":item_slot_008"),
(try_end),
(try_end),
(assign,":var009",0),
(assign,":var010",0),
(store_div, ":var___x1", ":var002", 12),
(assign,":var011",":var___x1"),
(try_for_range, ":itm_012", ":itm.smoked_fish", ":itm.siege_supply"),
(item_get_slot,":item_slot_013",":itm_012",7),
(val_add, ":var009", ":item_slot_013"),
(try_begin),
(ge,":item_slot_013",":var011"),
(val_add, ":var010", 1),
(try_end),
(try_end),
(val_mul, ":var009", 100),
(val_div, ":var009", ":var002"),
(val_min,":var009",100),
(val_mul, ":var010", 85),
(val_div, ":var010", 10),
(val_min,":var010",100),
(assign,":var014",0),
(assign,":var015",0),
(store_div, ":var___x1", ":var002", 4),
(assign,":var016",":var___x1"),
(try_for_range, ":itm_017", ":itm.wine", ":itm.smoked_fish"),
(assign,":item_id_018",":itm_017"),
(item_get_slot,":item_slot_019",":item_id_018",7),
(val_add, ":var014", ":item_slot_019"),
(try_begin),
(ge,":item_slot_019",":var016"),
(val_add, ":var015", 1),
(try_end),
(try_end),
(val_mul, ":var014", 200),
(val_max,":var002",1),
(val_div, ":var014", ":var002"),
(val_min,":var014",100),
(val_mul, ":var015", 50),
(item_get_slot,":item_slot_020","itm_spice",7),
(store_mul, ":var021", ":item_slot_020", 100),
(val_max,":var011",1),
(val_div, ":item_slot_020", ":var011"),
(val_min,":var021",100),
(item_get_slot,":item_slot_022","itm_oil",7),
(store_mul, ":var023", ":item_slot_022", 100),
(val_max,":var011",1),
(val_div, ":item_slot_022", ":var011"),
(val_min,":var023",100),
(store_div, ":var___x1", ":var009", 20),
(assign,":var024",":var___x1"),
(assign,":var024 +","str_feast_description"),
(str_store_string,s8,":str_store_string(var024)"),
(str_store_string,s9,":str_store_string("str_of_food_which_must_come_before_everything_else_the_amount_is_s8")"),
(store_div, ":var___x1", ":var010", 20),
(assign,":var025",":var___x1"),
(assign,":var025 +","str_feast_description"),
(str_store_string,s8,":str_store_string(var025)"),
(str_store_string,s9,":str_store_string("str_s9_and_the_variety_is_s8_")"),
(store_div, ":var___x1", ":var014", 20),
(assign,":var026",":var___x1"),
(assign,":var026 +","str_feast_description"),
(str_store_string,s8,":str_store_string(var026)"),
(str_store_string,s9,":str_store_string("str_s9_of_drink_which_guests_will_expect_in_great_abundance_the_amount_is_s8")"),
(store_div, ":var___x1", ":var015", 20),
(assign,":var027",":var___x1"),
(assign,":var027 +","str_feast_description"),
(str_store_string,s8,":str_store_string(var027)"),
(str_store_string,s9,":str_store_string("str_s9_and_the_variety_is_s8_")"),
(store_div, ":var___x1", ":var021", 20),
(assign,":var028",":var___x1"),
(assign,":var028 +","str_feast_description"),
(str_store_string,s8,":str_store_string(var028)"),
(str_store_string,s9,":str_store_string("str_s9_of_spice_which_is_essential_to_demonstrate_that_we_spare_no_expense_as_hosts_the_amount_is_s8_")"),
(store_div, ":var___x1", ":var023", 20),
(assign,":var029",":var___x1"),
(assign,":var029 +","str_feast_description"),
(str_store_string,s8,":str_store_string(var029)"),
(str_store_string,s9,":str_store_string("str_s9_of_oil_which_we_shall_require_to_light_the_lamps_the_amount_is_s8")"),
(store_mul, ":var030", ":var009", 8),
(store_add, ":var031", ":var009", ":var010"),
(val_mul, ":var031", 2),
(val_add, ":var031", ":var015"),
(val_add, ":var031", ":var014"),
(val_add, ":var031", ":item_slot_020"),
(val_add, ":var031", ":item_slot_022"),
(val_min,":var031",":var030"),
(val_div, ":var031", 8),
(val_clamp,":var031",1, 101),
(store_div, ":var___x1", ":var031", 20),
(assign,":var032",":var___x1"),
(assign,":var032 +","str_feast_description"),
(str_store_string,s8,":str_store_string(var032)"),
(str_store_string,s9,":str_store_string("str_s9_overall_our_table_will_be_considered_s8")"),
(assign,reg0,":var031"),
(try_begin),
(eq,":var003",1),
(assign,":var033",":var002"),
(try_for_range, ":var034", 0, 1999),
(gt,":var033",0),
(try_for_range, ":itm_004", ":itm.spice", ":itm.siege_supply"),
(item_set_slot,":itm_004",0,0),
(try_end),
(troop_get_inventory_capacity,":troop_inv_capacity_035",":troop_id_001"),
(try_for_range, ":inventory_slot_no_036", 0, ":troop_inv_capacity_035"),
(troop_get_inventory_slot,":itm_004",":troop_id_001",":inventory_slot_no_036"),
(this_or_next|eq,":itm_004","itm_spice"),
(this_or_next|eq,":itm_004","itm_oil"),
(this_or_next|eq,":itm_004","itm_wine"),
(this_or_next|eq,":itm_004","itm_ale"),
(is_between,":itm_004","itm_smoked_fish","itm_siege_supply"),
(item_slot_eq,":itm_004",0,0),
(troop_inventory_slot_get_item_amount,":troop_inv_slot_item_amount_037",":troop_id_001",":inventory_slot_no_036"),
(gt,":troop_inv_slot_item_amount_037",0),
(val_sub, ":troop_inv_slot_item_amount_037", 1),
(troop_inventory_slot_set_item_amount,":troop_id_001",":inventory_slot_no_036",":troop_inv_slot_item_amount_037"),
(val_sub, ":var033", 1),
(item_set_slot,":itm_004",0,1),
(try_end),
(try_end),
(try_end),
]),

("faction_get_adjective_to_s10", [
(store_script_param, ":faction_id_001", 1),
(try_begin),
(eq,":faction_id_001","fac_player_faction"),
(assign,":faction_id_001","$players_kingdom"),
(try_end),
(try_begin),
(eq,":faction_id_001","fac_player_supporters_faction"),
(str_store_string,s10,":str_store_string("str_rebel")"),
(else_try),
(this_or_next|eq,":faction_id_001","fac_deserters"),
(this_or_next|eq,":faction_id_001","fac_forest_bandits"),
(this_or_next|eq,":faction_id_001","fac_mountain_bandits"),
(eq,":faction_id_001","fac_outlaws"),
(str_store_string,s10,":str_store_string("str_bandit")"),
(else_try),
(faction_get_slot,":faction_slot_002",":faction_id_001",22),
(str_store_string,s10,":str_store_string(faction_slot_002)"),
(try_end),
]),

("setup_tavern_attacker", [
(store_script_param, ":entry_no_001", 1),
(try_begin),
(neg|troop_slot_eq,"trp_hired_assassin",12,"$g_encountered_party"),
(troop_slot_eq,"trp_belligerent_drunk",12,"$g_encountered_party"),
(set_visitor,":entry_no_001","trp_belligerent_drunk"),
(try_end),
(try_begin),
(troop_slot_eq,"trp_hired_assassin",12,"$g_encountered_party"),
(set_visitor,":entry_no_001","trp_hired_assassin"),
(try_end),
]),

("activate_tavern_attackers", [
(set_party_battle_mode),
(try_for_agents, ":cur_agent"),
(agent_get_troop_id,":troop_id_002", ":cur_agent"),
(try_begin),
(this_or_next|eq,":troop_id_002","trp_hired_assassin"),
(this_or_next|eq,":troop_id_002","trp_belligerent_drunk"),
(eq,":troop_id_002","trp_fugitive"),
(agent_set_team, ":cur_agent", 1),
(assign,"$g_main_attacker_agent",":cur_agent"),
(agent_ai_set_aggressiveness, ":cur_agent", 199),
(try_end),
(try_end),
]),

("deactivate_tavern_attackers", [
(finish_party_battle_mode),
(try_for_agents, ":cur_agent"),
(agent_get_troop_id,":troop_id_002", ":cur_agent"),
(try_begin),
(this_or_next|eq,":troop_id_002","trp_hired_assassin"),
(this_or_next|eq,":troop_id_002","trp_belligerent_drunk"),
(eq,":troop_id_002","trp_fugitive"),
(agent_set_team, ":cur_agent", 0),
(agent_ai_set_aggressiveness, ":cur_agent", 0),
(try_end),
(try_end),
]),

("activate_town_guard", [
(set_party_battle_mode),
(try_for_agents, ":cur_agent"),
(agent_get_troop_id,":troop_id_002", ":cur_agent"),
(try_begin),
(is_between,":troop_id_002","trp_swadian_recruit","trp_looter"),
(agent_set_team, ":cur_agent", 1),
(else_try),
(this_or_next|is_between,":cur_agent","trp_town_walker_1","trp_tournament_master"),
(is_between,":cur_agent","trp_town_1_armorer","trp_village_1_elder"),
(agent_clear_scripted_mode,":cur_agent"),
(agent_set_team, ":cur_agent", 2),
(try_end),
(try_end),
]),

("cf_prisoner_offered_parole", [
(store_script_param, ":troop_id_001", 1),
(try_begin),
(eq,1,0),
(troop_get_slot,":troop_slot_002",":troop_id_001",8),
(try_begin),
(party_is_active,":troop_slot_002"),
(is_between,":troop_slot_002","p_town_1","p_village_1"),
(party_get_slot,":party_slot_003",":troop_slot_002",7),
(troop_get_slot,":troop_slot_004",":troop_id_001",52),
(troop_get_slot,":troop_slot_005",":party_slot_003",52),
(neq,":troop_slot_004",5),
(neq,":troop_slot_005",5),
(neq,":troop_slot_005",2),
(this_or_next|eq,":troop_slot_005",6),
(this_or_next|troop_slot_eq,":troop_id_001",2,2),
(troop_slot_eq,":troop_id_001",2,6),
(call_script, "script_troop_get_relation_with_troop", ":party_slot_003", ":troop_id_001"),
(try_end),
(try_end),
]),

("neutral_behavior_in_fight", [
(get_player_agent_no,":agent_no_001"),
(agent_get_position,pos3,":agent_no_001"),
(agent_get_team, ":agent_team_no_002", ":agent_no_001"),
(try_begin),
(gt,":::g_main_attacker_agent",0),
(agent_get_team, ":agent_team_no_003", "$g_main_attacker_agent"),
(agent_get_position,pos5,"$g_main_attacker_agent"),
(else_try),
(eq,":agent_team_no_003",-1),
(agent_get_position,pos5,":agent_no_001"),
(try_end),
(set_fixed_point_multiplier, 100),
(try_for_agents, ":cur_agent"),
(agent_get_team, ":agent_team_no_005", ":cur_agent"),
(try_begin),
(neq,":agent_team_no_005",":agent_team_no_003"),
(neq,":agent_team_no_005",":agent_team_no_002"),
(agent_get_troop_id,":troop_id_006", ":cur_agent"),
(try_begin),
(neg|is_between,":troop_id_006","trp_swadian_recruit","trp_looter"),
(agent_get_position,pos4,":cur_agent"),
(assign,":var007",0),
(assign,":var008",-1),
(neg|agent_slot_eq,":cur_agent",15,0),
(agent_get_slot,":agent_slot_009",":cur_agent",15),
(store_sub, ":var010", ":agent_slot_009", 1),
(entry_point_get_position, pos6, ":var010"),
(get_distance_between_positions,":distance_011",6,4),
(lt,":distance_011",100),
(agent_set_slot,":cur_agent",15,0),
(try_end),
(try_end),
(agent_slot_eq,":cur_agent",15,0),
(try_begin),
(eq,1,1),
(get_distance_between_positions,":distance_012",4,5),
(get_distance_between_positions,":distance_013",4,3),
(val_min,":distance_012",":distance_013"),
(try_begin),
(this_or_next|gt,":distance_012",700),
(main_hero_fallen),
(agent_set_scripted_destination,":cur_agent",4),
(else_try),
(try_for_range, ":var010", 0, 64),
(neg|entry_point_is_auto_generated, ":var010"),
(entry_point_get_position, pos6, ":var010"),
(get_distance_between_positions,":distance_011",6,4),
(get_distance_between_positions,":distance_014",6,3),
(store_sub, ":var015", ":distance_014", ":distance_011"),
(try_begin),
(ge,":var015",0),
(try_begin),
(ge,":distance_011",2000),
(store_sub, ":var016", ":distance_011", 2000),
(val_min,":var016",1000),
(val_min,":distance_011",2000),
(val_sub, ":distance_011", ":var016"),
(try_end),
(try_end),
(try_end),
(try_end),
(val_mul, ":var015", ":distance_011"),
(ge,":var015",":var007"),
(assign,":var007",":var015"),
(assign,":var008",":var010"),
(try_end),
(ge,":var008",0),
(entry_point_get_position, pos6, ":var008"),
(agent_set_speed_limit,":cur_agent",10),
(agent_set_scripted_destination,":cur_agent",6),
(store_add, ":var017", ":var008", 1),
(agent_set_slot,":cur_agent",15,":var017"),
(try_end),
]),

("party_inflict_attrition", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(party_clear,"p_temp_casualties"),
(party_get_num_companion_stacks,":party_num_companions_stacks_003",":party_id_001"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005",":party_id_001",":stack_no_004"),
(try_begin),
(neg|troop_is_hero,":troop_id_005"),
(party_stack_get_size,          ":party_stack_size_006",":party_id_001",":stack_no_004"),
(store_mul, ":var007", ":var002", ":party_stack_size_006"),
(store_div, ":var___x1", ":var007", 100),
(assign,":var008",":var___x1"),
(party_add_members,"p_temp_casualties",":troop_id_005",":var008"),
(store_mul, ":var009", ":var008", 100),
(store_sub, ":var010", ":var007", ":var009"),
(gt,":var010",0),
(store_random_in_range,":random_x_011",0,100),
(lt,":random_x_011",":var010"),
(party_add_members,"p_temp_casualties",":troop_id_005",":var008"),
(try_end),
(try_end),
(party_get_num_companion_stacks,":party_num_companions_stacks_003","p_temp_casualties"),
(try_for_range, ":stack_no_004", 0, ":party_num_companions_stacks_003"),
(party_stack_get_troop_id,      ":troop_id_005","p_temp_casualties",":stack_no_004"),
(party_stack_get_size,          ":party_stack_size_006","p_temp_casualties",":stack_no_004"),
(party_remove_members,":party_id_001",":troop_id_005",":party_stack_size_006"),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg3,":party_stack_size_006"),
(str_store_string,s4,":str_store_troop_name(troop_id_005)"),
(str_store_string,s5,":str_store_party_name(party_id_001)"),
(str_store_string,s65,":str_store_string("str_s5_suffers_attrition_reg3_x_s4")"),
(display_message, "str_s65"),
(eq,":::debug_message_in_queue",0),
(call_script, "script_add_notification_menu", "mnu_debug_alert_from_s65", 0, 0),
(assign,"$debug_message_in_queue",1),
(try_end),
(try_end),
]),

("add_rumor_string_to_troop_notes", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(store_script_param, ":var003", 3),
(str_store_string,s10,":str_store_troop_name(_g_talk_troop)"),
(str_store_string,s11,":str_store_string_reg(var003)"),
(store_current_hours,":cur_hours_004"),
(call_script, "script_game_get_date_text", 0, ":cur_hours_004"),
(str_store_string,s5,":str_store_string("str_s10_said_on_s1_s11__")"),
(try_begin),
(is_between,":troop_id_001","trp_npc1","trp_heroes_end"),
(troop_get_slot,":troop_slot_005",":troop_id_001",45),
(val_add, ":troop_slot_005", 1),
(try_begin),
(neg|is_between,":troop_slot_005",3,16),
(assign,":troop_slot_005",3),
(try_end),
(troop_set_slot,":troop_id_001",45,":troop_slot_005"),
(add_troop_note_from_sreg,":troop_id_001",":troop_slot_005",5, 0),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s3,":str_store_troop_name(troop_id_001)"),
(assign,reg4,":troop_slot_005"),
(display_message, "str_rumor_note_to_s3s_slot_reg4_s5"),
(try_end),
(try_end),
(try_begin),
(is_between,":troop_id_002","trp_npc1","trp_heroes_end"),
(troop_get_slot,":troop_slot_005",":troop_id_002",45),
(val_add, ":troop_slot_005", 1),
(try_begin),
(neg|is_between,":troop_slot_005",3,16),
(assign,":troop_slot_005",3),
(try_end),
(troop_set_slot,":troop_id_002",45,":troop_slot_005"),
(add_troop_note_from_sreg,":troop_id_002",":troop_slot_005",5, 0),
(try_begin),
(eq,":::cheat_mode",1),
(str_store_string,s3,":str_store_troop_name(troop_id_002)"),
(assign,reg4,":troop_slot_005"),
(display_message, "str_rumor_note_to_s3s_slot_reg4_s5"),
(try_end),
(try_end),
]),

("character_can_wed_character", [
]),

("troop_change_career", [
]),

("center_get_goods_availability", [
(store_script_param, ":party_id_001", 1),
(str_store_string,s4,":str_store_party_name(party_id_001)"),
(assign,":var002",0),
(try_for_range, ":itm_003", ":itm.spice", ":itm.siege_supply"),
(is_between,":party_id_001","p_village_1","p_salt_mine"),
(item_get_slot,":item_slot_004",":itm_003",12),
(else_try),
(item_get_slot,":item_slot_004",":itm_003",11),
(try_begin),
(gt,":item_slot_004",2),
(store_div, ":var___x1", ":item_slot_004", 4),
(assign,":var005",":var___x1"),
(store_sub, ":slot_no_006", ":itm_003", ":itm.spice"),
(val_add, ":slot_no_006", 250),
(party_get_slot,":party_slot_007",":party_id_001",":slot_no_006"),
(store_sub, ":var008", ":party_slot_007", 1000),
(gt,":var008",200),
(val_div, ":var008", 200),
(val_min,":var008",":var005"),
(val_add, ":var002", ":var008"),
(try_end),
(try_end),
(assign,reg0,":var002"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- hardship index for {s4} = {reg0}"),
(try_end),
]),

("lord_find_alternative_faction", [
(store_script_param, ":troop_id_001", 1),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(assign,":var003",-1),
(assign,":var004",-5),
(try_begin),
(eq,1,1),
(store_random_in_range,":random_x_005",0,10000),
(try_begin),
(this_or_next|gt,":::g_advantegous_faction",0),
(eq,":random_x_005",0),
(store_random_in_range,"$g_advantegous_faction","fac_player_supporters_faction","fac_kingdoms_end"),
(try_end),
(try_end),
(try_for_range, ":fac_006", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(this_or_next|eq,":::g_give_advantage_to_original_faction",1),
(neq,":fac_006",":troop_faction_002"),
(faction_slot_eq,":fac_006",21,0),
(assign,":var007",0),
(try_for_range, ":p_008", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_009", ":p_008"),
(eq,":party_faction_009",":fac_006"),
(try_begin),
(party_slot_eq,":p_008",0,3),
(val_add, ":var007", 2),
(else_try),
(val_add, ":var007", 1),
(try_end),
(try_end),
(try_end),
(assign,":var010",0),
(try_for_range, ":trp_011", ":trp.kingdom_1_lord", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_012",":trp_011"),
(try_begin),
(eq,":troop_faction_012",":fac_006"),
(val_add, ":var010", 1),
(try_end),
(try_end),
(val_max,":var010",1),
(faction_get_slot,":faction_slot_013",":fac_006",11),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":faction_slot_013"),
(assign,":var014",reg0),
(store_mul, ":var015", ":var007", 100),
(val_div, ":var015", ":var010"),
(val_add, ":var015", ":var014"),
(try_begin),
(eq,":fac_006",":troop_faction_002"),
(eq,":::g_give_advantage_to_original_faction",1),
(val_add, ":var015", 100),
(try_end),
(try_begin),
(eq,":::g_advantegous_faction",":fac_006"),
(val_add, ":var015", 50),
(try_end),
(try_begin),
(eq,":fac_006",":::players_kingdom"),
(val_sub, ":var015", 100),
(val_add,"$player_right_to_rule"),
(try_end),
(try_begin),
(gt,":var015",":var004"),
(assign,":var004",":var015"),
(assign,":var003",":fac_006"),
(try_end),
(try_end),
(assign,reg0,":var003"),
]),

("set_up_duel_with_troop", [
(store_script_param, "$g_duel_troop", 1),
(assign,"$g_start_arena_fight_at_nearest_town",1),
(try_begin),
(eq,":::g_start_arena_fight_at_nearest_town",1),
(try_end),
(unlock_achievement, 48),
(jump_to_menu,"mnu_arena_duel_fight"),
(finish_mission, ":"),
]),

("test_player_for_career_and_marriage_incompatability", [
]),

("deduct_casualties_from_garrison", [
(try_for_agents, ":cur_agent"),
(agent_get_troop_id,":troop_id_002", ":cur_agent"),
(try_begin),
(is_between,":troop_id_002","trp_novice_fighter","trp_tournament_master"),
(neg|agent_is_alive,":cur_agent"),
(eq,1,1),
(store_troop_count_companions,":troop_count_companions_003",":troop_id_002","$g_encountered_party"),
(eq,":troop_count_companions_003",0),
(assign,":troop_id_002",0),
(try_for_range, ":slot_no_004", 41, 45),
(faction_get_slot,":troop_id_002","$g_encountered_party_faction",":slot_no_004"),
(faction_get_slot,":faction_slot_005","$g_encountered_party_faction",":slot_no_004"),
(store_troop_count_companions,":troop_count_companions_003",":faction_slot_005","$g_encountered_party"),
(gt,":troop_count_companions_003",0),
(assign,":troop_id_002",":faction_slot_005"),
(try_end),
(try_end),
(gt,":troop_id_002",0),
(party_remove_members,"$g_encountered_party",":troop_id_002",1),
(str_store_string,s4,":str_store_troop_name(troop_id_002)"),
(str_store_string,s5,":str_store_party_name(_g_encountered_party)"),
(try_end),
]),

("npc_decision_checklist_take_stand_on_issue", [
(store_script_param, ":troop_id_001", 1),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(assign,":var003",-1),
(faction_get_slot,":faction_slot_004",":troop_faction_002",64),
(assign,":var005",0),
(try_begin),
(is_between,":faction_slot_004","p_town_1","p_salt_mine"),
(gt,":::g_dont_give_fief_to_player_days",1),
(assign,":var005",1),
(else_try),
(gt,":::g_dont_give_marshalship_to_player_days",1),
(assign,":var005",1),
(try_end),
(assign,":troop_slot_006",0),
(troop_set_slot,"trp_player",46,0),
(try_begin),
(eq,":::players_kingdom",":troop_faction_002"),
(eq,":::player_has_homage",1),
(troop_get_slot,":troop_slot_006","trp_player",7),
(try_end),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_set_slot,":trp_007",46,0),
(store_troop_faction,":troop_faction_008",":trp_007"),
(try_begin),
(eq,":troop_faction_008",":troop_faction_002"),
(troop_slot_eq,":trp_007",2,2),
(troop_get_slot,":troop_slot_009",":trp_007",7),
(val_add, ":troop_slot_006", ":troop_slot_009"),
(try_end),
(try_end),
(assign,":var010",0),
(try_for_range, ":p_011", ":p.town_1", ":p.salt_mine"),
(store_faction_of_party, ":party_faction_012", ":p_011"),
(try_begin),
(eq,":party_faction_012",":troop_faction_002"),
(assign,":var013",1),
(try_begin),
(is_between,":p_011","p_town_1","p_castle_1"),
(assign,":var013",2),
(try_end),
(try_end),
(val_add, ":var010", ":var013"),
(party_get_slot,":party_slot_014",":p_011",7),
(try_begin),
(gt,":party_slot_014",-1),
(troop_get_slot,":troop_slot_015",":party_slot_014",46),
(val_add, ":troop_slot_015", ":var013"),
(troop_set_slot,":party_slot_014",46,":troop_slot_015"),
(try_end),
(try_end),
(val_max,":var010",1),
(store_div, ":var___x1", ":troop_slot_006", ":var010"),
(assign,":var016",":var___x1"),
(try_begin),
(is_between,":faction_slot_004","p_town_1","p_salt_mine"),
(try_begin),
(neg|troop_slot_eq,":troop_id_001",52,5),
(neg|troop_slot_eq,":troop_id_001",52,3),
(neg|troop_slot_eq,":troop_id_001",52,2),
(is_between,":faction_slot_004","p_village_1","p_salt_mine"),
(assign,":var017",-1),
(assign,":var018",-1),
(try_begin),
(eq,":::players_kingdom",":troop_faction_002"),
(eq,":::player_has_homage",1),
(eq,":var005",0),
(troop_slot_eq,"trp_player",46,0),
(call_script, "script_troop_get_relation_with_troop", "trp_player", ":troop_id_001"),
(assign,":var019",reg0),
(try_begin),
(gt,":var019",":var018"),
(neg|troop_slot_ge,"trp_player",150,75),
(assign,":var017","trp_player"),
(assign,":var018",":var019"),
(try_end),
(try_end),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_008",":trp_007"),
(try_begin),
(eq,":troop_faction_008",":troop_faction_002"),
(troop_slot_eq,":trp_007",2,2),
(troop_slot_eq,":trp_007",46,0),
(try_begin),
(eq,":trp_007",":troop_id_001"),
(assign,":var019",50),
(else_try),
(call_script, "script_troop_get_relation_with_troop", ":trp_007", ":troop_id_001"),
(assign,":var019",reg0),
(try_end),
(try_end),
(neg|troop_slot_ge,":trp_007",150,75),
(gt,":var019",":var018"),
(assign,":var017",":trp_007"),
(assign,":var018",":var019"),
(try_end),
(try_begin),
(gt,":var017",-1),
(assign,":var003",":var017"),
(assign,":var020","str_political_explanation_lord_lacks_center"),
(else_try),
(is_between,":faction_slot_004","p_town_1","p_village_1"),
(neg|troop_slot_eq,":troop_id_001",52,5),
(neg|troop_slot_eq,":troop_id_001",52,3),
(neg|troop_slot_eq,":troop_id_001",52,4),
(party_get_slot,":party_slot_021",":faction_slot_004",28),
(try_begin),
(eq,1,1),
(try_begin),
(neq,":troop_faction_002",":::players_kingdom"),
(assign,":party_slot_021",-1),
(else_try),
(eq,":::player_has_homage",0),
(assign,":party_slot_021",-1),
(else_try),
(eq,":faction_slot_004",":::g_castle_requested_by_player"),
(assign,":party_slot_021","trp_player"),
(else_try),
(eq,":faction_slot_004",":::g_castle_requested_for_troop"),
(assign,":party_slot_021","trp_player"),
(else_try),
(gt,":party_slot_021",-1),
(store_troop_faction,":troop_faction_022",":party_slot_021"),
(try_begin),
(neq,":troop_faction_022",":troop_faction_002"),
(assign,":party_slot_021",-1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":party_slot_021",-1),
(try_begin),
(eq,":::cheat_mode",1),
(gt,":party_slot_021",-1),
(str_store_string,s3,":str_store_troop_name(party_slot_021)"),
(display_message, "@@{!}Castle taken by {s3}"),
(try_end),
(try_end),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":party_slot_021"),
(try_begin),
(ge,reg0,0),
(neg|troop_slot_ge,":party_slot_021",150,25),
(troop_get_slot,":troop_slot_009",":party_slot_021",7),
(troop_get_slot,":troop_slot_023",":party_slot_021",46),
(val_max,":troop_slot_023",1),
(store_div, ":var___x1", ":troop_slot_009", ":troop_slot_023"),
(assign,":var024",":var___x1"),
(val_mul, ":var024", 6),
(val_div, ":var024", 4),
(try_begin),
(ge,":var024",":var016"),
(assign,":var003",":party_slot_021"),
(assign,":var020","str_political_explanation_lord_took_center"),
(else_try),
(assign,":var025",-1),
(assign,":var018",":var016"),
(val_div, ":var018", 3),
(val_mul, ":var018", 2),
(try_begin),
(eq,":::cheat_mode",1),
(assign,reg3,":var018"),
(display_message, "@@{!}Two-thirds average renown = {reg3}"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":::players_kingdom",":troop_faction_002"),
(eq,":::player_has_homage",1),
(eq,":var005",0),
(call_script, "script_troop_get_relation_with_troop", "trp_player", ":troop_id_001"),
(assign,":var019",reg0),
(try_begin),
(ge,":var019",20),
(neg|troop_slot_ge,"trp_player",150,50),
(troop_get_slot,":troop_slot_009","trp_player",7),
(troop_get_slot,":troop_slot_023","trp_player",46),
(val_max,":troop_slot_023",1),
(store_div, ":var___x1", ":troop_slot_009", ":troop_slot_023"),
(assign,":var024",":var___x1"),
(assign,":var025","trp_player"),
(assign,":var018",":var024"),
(try_end),
(try_end),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_008",":trp_007"),
(try_begin),
(eq,":troop_faction_008",":troop_faction_002"),
(troop_slot_eq,":trp_007",2,2),
(call_script, "script_troop_get_relation_with_troop", ":trp_007", ":troop_id_001"),
(assign,":var019",reg0),
(this_or_next|eq,":trp_007",":troop_id_001"),
(ge,":var019",20),
(neg|troop_slot_ge,":trp_007",150,50),
(troop_get_slot,":troop_slot_009",":trp_007",7),
(troop_get_slot,":troop_slot_023",":trp_007",46),
(val_max,":troop_slot_023",1),
(store_div, ":var___x1", ":troop_slot_009", ":troop_slot_023"),
(assign,":var024",":var___x1"),
(eq,":::cheat_mode",1),
(str_store_string,s10,":str_store_troop_name(trp_007)"),
(assign,reg3,":var024"),
(display_message, "@@{!}DEBUG -- Colleague test: score for {s10} = {reg3}"),
(try_end),
(gt,":var024",":var018"),
(assign,":var025",":trp_007"),
(assign,":var018",":var024"),
(try_end),
(try_begin),
(gt,":var025",-1),
(assign,":var003",":var025"),
(assign,":var020","str_political_explanation_most_deserving_friend"),
(else_try),
(neg|troop_slot_eq,":troop_id_001",52,5),
(neg|troop_slot_eq,":troop_id_001",52,3),
(neg|troop_slot_eq,":troop_id_001",52,2),
(assign,":var026",-1),
(assign,":var018",0),
(try_begin),
(eq,":::players_kingdom",":troop_faction_002"),
(eq,":::player_has_homage",1),
(eq,":var005",0),
(call_script, "script_troop_get_relation_with_troop", "trp_player", ":troop_id_001"),
(assign,":var019",reg0),
(try_begin),
(ge,":var019",0),
(troop_get_slot,":troop_slot_009","trp_player",7),
(troop_get_slot,":troop_slot_023","trp_player",46),
(try_begin),
(neg|troop_slot_ge,"trp_player",150,25),
(val_max,":troop_slot_023",1),
(store_div, ":var___x1", ":troop_slot_009", ":troop_slot_023"),
(assign,":var024",":var___x1"),
(assign,":var026","trp_player"),
(assign,":var018",":var024"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_008",":trp_007"),
(try_begin),
(eq,":troop_faction_008",":troop_faction_002"),
(troop_slot_eq,":trp_007",2,2),
(call_script, "script_troop_get_relation_with_troop", ":trp_007", ":troop_id_001"),
(assign,":var019",reg0),
(try_begin),
(this_or_next|eq,":trp_007",":troop_id_001"),
(ge,":var019",0),
(neg|troop_slot_ge,":trp_007",150,25),
(troop_get_slot,":troop_slot_009",":trp_007",7),
(troop_get_slot,":troop_slot_023",":trp_007",46),
(val_max,":troop_slot_023",1),
(store_div, ":var___x1", ":troop_slot_009", ":troop_slot_023"),
(assign,":var024",":var___x1"),
(gt,":var024",":var018"),
(eq,":::cheat_mode",1),
(str_store_string,s10,":str_store_string(trp_007)"),
(assign,reg3,":var024"),
(display_message, "@@{!}DEBUG -- Open test: score for {s10} = {reg3}"),
(try_end),
(try_end),
(assign,":var026",":trp_007"),
(assign,":var018",":var024"),
(try_end),
(try_begin),
(gt,":var026",-1),
(assign,":var003",":var026"),
(assign,":var020","str_political_explanation_most_deserving_in_faction"),
(else_try),
(assign,":var003",":troop_id_001"),
(assign,":var020","str_political_explanation_self"),
(try_end),
(try_end),
(else_try),
(eq,":faction_slot_004",1),
(assign,":var027",15),
(try_begin),
(troop_slot_eq,":troop_id_001",52,7),
(assign,":var027",5),
(else_try),
(troop_slot_eq,":troop_id_001",52,5),
(assign,":var027",25),
(try_end),
(assign,":var028",-1),
(assign,":var018",0),
(try_begin),
(eq,":::players_kingdom",":troop_faction_002"),
(eq,":::player_has_homage",1),
(eq,":::g_player_is_captive",0),
(eq,":var005",0),
(call_script, "script_troop_get_relation_with_troop", "trp_player", ":troop_id_001"),
(try_begin),
(ge,reg0,":var027"),
(assign,":var028","trp_player"),
(troop_get_slot,":troop_slot_009","trp_player",7),
(troop_get_slot,":troop_slot_029","trp_player",150),
(val_add, ":troop_slot_029", 50),
(store_div, ":var___x1", ":troop_slot_009", ":troop_slot_029"),
(assign,":var018",":var___x1"),
(try_end),
(try_end),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_008",":trp_007"),
(try_begin),
(eq,":troop_faction_008",":troop_faction_002"),
(troop_slot_eq,":trp_007",2,2),
(troop_slot_eq,":trp_007",8,-1),
(neg|faction_slot_eq,":troop_faction_002",11,":trp_007"),
(call_script, "script_troop_get_relation_with_troop", ":trp_007", ":troop_id_001"),
(assign,":var019",reg0),
(try_begin),
(this_or_next|eq,":trp_007",":troop_id_001"),
(ge,":var019",":var027"),
(troop_get_slot,":troop_slot_009",":trp_007",7),
(troop_get_slot,":troop_slot_029",":trp_007",150),
(val_add, ":troop_slot_029", 50),
(store_div, ":var___x1", ":troop_slot_009", ":troop_slot_029"),
(assign,":var030",":var___x1"),
(try_begin),
(gt,":var030",":var018"),
(assign,":var028",":trp_007"),
(assign,":var018",":var030"),
(try_end),
(try_end),
(try_end),
(try_end),
(assign,":var003",":var028"),
(assign,":var020","str_political_explanation_marshal"),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(gt,":var003",-1),
(str_store_string,s8,":str_store_troop_name(troop_id_001)"),
(str_store_string,s9,":str_store_troop_name(var003)"),
(str_store_string,s10,":str_store_string(var020)"),
(display_message, "@@{!}DEBUG -- {s8} backs {s9}:{s10}"),
(try_end),
(assign,reg0,":var003"),
(assign,reg1,":var020"),
]),

("npc_decision_checklist_evaluate_faction_strategy", [
]),

("process_player_enterprise", [
(store_script_param, ":item_id_001", 1),
(store_script_param, ":party_id_002", 2),
(item_get_slot,":item_slot_003",":item_id_001",56),
(item_get_slot,":item_slot_004",":item_id_001",53),
(store_sub, ":slot_no_005", ":item_id_001", ":itm.spice"),
(val_add, ":slot_no_005", 250),
(party_get_slot,":party_slot_006",":party_id_002",":slot_no_005"),
(store_mul, ":var007", ":item_slot_004", ":party_slot_006"),
(val_div, ":var007", 1000),
(item_get_slot,":item_slot_008",":item_id_001",55),
(store_mul, ":var009", ":item_slot_008", ":var007"),
(item_get_slot,":item_slot_010",":item_id_001",50),
(item_get_slot,":item_slot_004",":item_slot_010",53),
(store_sub, ":slot_no_005", ":item_slot_010", ":itm.spice"),
(val_add, ":slot_no_005", 250),
(party_get_slot,":party_slot_006",":party_id_002",":slot_no_005"),
(store_mul, ":var011", ":item_slot_004", ":party_slot_006"),
(val_div, ":var011", 1000),
(item_get_slot,":item_slot_012",":item_id_001",52),
(try_begin),
(lt,":item_slot_012",0),
(store_div, ":var___x1", ":var011", 2),
(assign,":var013",":var___x1"),
(else_try),
(store_mul, ":var013", ":var011", ":item_slot_012"),
(try_end),
(try_begin),
(item_slot_ge,":item_id_001",57,1),
(item_get_slot,":item_slot_014",":item_id_001",57),
(item_get_slot,":item_slot_004",":item_slot_014",53),
(store_sub, ":slot_no_005", ":item_slot_014", ":itm.spice"),
(val_add, ":slot_no_005", 250),
(party_get_slot,":party_slot_006",":party_id_002",":slot_no_005"),
(try_begin),
(lt,":item_slot_012",0),
(store_div, ":var___x1", ":var015", 2),
(assign,":var015",":var___x1"),
(else_try),
(store_mul, ":var015", ":var015", ":item_slot_012"),
(try_end),
(store_mul, ":var015", ":item_slot_004", ":party_slot_006"),
(val_div, ":var015", 1000),
(else_try),
(assign,":var015",0),
(try_end),
(store_sub, ":var016", ":var009", ":var013"),
(val_sub, ":var016", ":item_slot_003"),
(val_sub, ":var016", ":var015"),
(assign,reg0,":var016"),
(assign,reg1,":var009"),
(assign,reg2,":var013"),
(assign,reg3,":item_slot_003"),
(assign,reg4,":var007"),
(assign,reg5,":var011"),
(assign,reg10,":var015"),
]),

("replace_scene_items_with_spawn_items_before_ms", [
(try_for_range, ":item_id_001", 0, ":itm.items_end"),
(scene_item_get_num_instances, ":item_num_instances_002", ":item_id_001"),
(item_set_slot,":item_id_001",22,0),
(assign,":var003",0),
(try_for_range, ":var004", 0, ":item_num_instances_002"),
(scene_item_get_instance, ":item_instance_005", ":item_id_001", ":var004"),
(prop_instance_get_position, "$g_position_to_use_for_replacing_scene_items", ":item_instance_005"),
(store_add, ":slot_no_006", 23, ":var003"),
(item_set_slot,":item_id_001",":slot_no_006","$g_position_to_use_for_replacing_scene_items"),
(val_add, ":var003", 1),
(val_add, ":::g_position_to_use_for_replacing_scene_items", 1),
(item_set_slot,":item_id_001",22,":var003"),
(try_end),
(replace_scene_items_with_scene_props, ":item_id_001","spr_empty"),
(try_end),
]),

("replace_scene_items_with_spawn_items_after_ms", [
(try_for_range, ":item_id_001", 0, ":itm.items_end"),
(item_get_slot,":item_slot_002",":item_id_001",22),
(try_for_range, ":var003", 0, ":item_slot_002"),
(store_add, ":slot_no_004", 23, ":var003"),
(item_get_slot,":item_slot_005",":item_id_001",":slot_no_004"),
(set_spawn_position, ":item_slot_005"),
(spawn_item, ":item_id_001", 0),
(try_end),
(try_end),
]),

("cf_is_melee_weapon_for_tutorial", [
(store_script_param, ":var001", 1),
(try_begin),
(this_or_next|eq,":var001","itm_practice_sword"),
(eq,":var001","itm_quarter_staff"),
(assign,0,1), # var002
(try_end),
]),

("iterate_pointer_arrow", [
(store_mission_timer_a_msec,":m_timer_a_ms_001"),
(try_begin),
(eq,1,1),
(assign,":var002",":m_timer_a_ms_001"),
(assign,":var003",":m_timer_a_ms_001"),
(val_mod, ":var002", 1080),
(val_div, ":var002", 3),
(scene_prop_get_instance, ":scp_instance_004", "spr_pointer_arrow", 0),
(prop_instance_get_position, pos0, ":scp_instance_004"),
(position_set_z_to_ground_level, 0),
(position_move_z,0,"$g_pointer_arrow_height_adder",1),
(set_fixed_point_multiplier, 100),
(val_mul, ":var002", 100),
(store_sin, ":var005", ":var002"),
(position_move_z,0,":var005",1),
(position_move_z,0,100,1),
(val_mod, ":var003", 2880),
(val_div, ":var003", 8),
(init_position,1),
(position_rotate_z,1,":var003"),
(position_copy_rotation,0,1),
(prop_instance_set_position, ":scp_instance_004", 0),
(try_end),
]),

("find_center_to_attack_alt", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(assign,":var004",-1),
(assign,":var005",0),
(try_for_range, ":p_006", ":p.town_1", ":p.salt_mine"),
(call_script, "script_npc_decision_checklist_evaluate_enemy_center_for_attack", ":var001", ":p_006", ":var002", ":var003"),
(assign,":var007",reg0),
(try_begin),
(gt,":var007",":var005"),
(assign,":var004",":p_006"),
(assign,":var005",":var007"),
(try_end),
(try_end),
(assign,reg0,":var004"),
(assign,reg1,":var005"),
]),

("npc_decision_checklist_evaluate_enemy_center_for_attack", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":party_id_002", 2),
(store_script_param, ":var003", 3),
(store_script_param, ":var004", 4),
(assign,":var005",-1),
(assign,":var006",-1),
(assign,":var007",0),
(store_troop_faction,":troop_faction_008",":troop_id_001"),
(try_begin),
(eq,":var003",1),
(faction_get_slot,":faction_slot_009",":troop_faction_008",8),
(try_begin),
(ge,":faction_slot_009",0),
(troop_get_slot,":troop_slot_010",":faction_slot_009",10),
(else_try),
(troop_get_slot,":troop_slot_010",":troop_id_001",10),
(try_end),
(try_end),
(assign,"$g_use_current_ai_object_as_s8",0),
(try_begin),
(neg|party_is_active,":troop_slot_010"),
(assign,":var005",-1),
(assign,":var006","str_center_party_not_active"),
(else_try),
(store_faction_of_party, ":party_faction_011", ":party_id_002"),
(store_relation,":faction_relation_012",":party_faction_011",":troop_faction_008"),
(try_begin),
(ge,":faction_relation_012",0),
(assign,":var005",-1),
(assign,":var006","str_center_is_friendly"),
(else_try),
(is_between,":party_id_002","p_town_1","p_village_1"),
(assign,":party_faction_013",-1),
(try_begin),
(neg|party_slot_eq,":party_id_002",54,-1),
(party_get_slot,":party_slot_014",":party_id_002",54),
(try_begin),
(party_is_active,":party_slot_014"),
(store_faction_of_party, ":party_faction_013", ":party_slot_014"),
(try_end),
(try_end),
(try_end),
(try_begin),
(neq,":party_faction_013",-1),
(neq,":party_faction_013",":troop_faction_008"),
(assign,":var005",-1),
(assign,":var006","str_center_is_already_besieged"),
(else_try),
(is_between,":party_id_002","p_village_1","p_salt_mine"),
(assign,":var015",0),
(try_begin),
(party_slot_eq,":party_id_002",35,1),
(party_get_slot,":party_slot_016",":party_id_002",34),
(try_begin),
(party_is_active,":party_slot_016"),
(store_faction_of_party, ":party_faction_017", ":party_slot_016"),
(try_begin),
(neq,":party_faction_017",":troop_faction_008"),
(assign,":var018",1),
(else_try),
(assign,":var018",0),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(this_or_next|party_slot_eq,":party_id_002",35,2),
(eq,":var018",1),
(assign,":var015",1),
(try_end),
(try_begin),
(eq,":var015",1),
(assign,":var005",-1),
(assign,":var006","str_center_is_looted_or_raided_already"),
(else_try),
(this_or_next|troop_slot_eq,":troop_id_001",52,7),
(troop_slot_eq,":troop_id_001",52,6),
(is_between,":party_id_002","p_village_1","p_salt_mine"),
(assign,":var005",-1),
(assign,":var006","str_center_marshal_does_not_want_to_attack_innocents"),
(else_try),
(assign,":var019",1000),
(try_for_range, ":p_020", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_021", ":p_020"),
(try_begin),
(eq,":party_faction_021",":troop_faction_008"),
(store_distance_to_party_from_party,":distance_parties_022",":p_020",":p_020"),
(try_begin),
(lt,":distance_parties_022",":var019"),
(assign,":var019",":distance_parties_022"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(gt,":var019",75),
(this_or_next|troop_slot_eq,":troop_id_001",52,7),
(this_or_next|troop_slot_eq,":troop_id_001",52,5),
(this_or_next|troop_slot_eq,":troop_id_001",52,6),
(troop_slot_eq,":troop_id_001",52,4),
(assign,":var005",-1),
(assign,":var006","str_center_far_away_our_cautious_marshal_does_not_wish_to_reconnoiter"),
(else_try),
(gt,":var019",90),
(assign,":var005",-1),
(assign,":var006","str_center_far_away_even_for_our_aggressive_marshal_to_reconnoiter"),
(else_try),
(is_between,":party_id_002","p_town_1","p_village_1"),
(neg|troop_slot_eq,":troop_id_001",52,1),
(neg|troop_slot_eq,":troop_id_001",52,2),
(neg|troop_slot_eq,":troop_id_001",52,3),
(assign,":var023",0),
(try_for_range, ":p_024", ":p.town_1", ":p.village_1"),
(eq,":var023",0),
(store_faction_of_party, ":party_faction_025", ":p_024"),
(try_begin),
(eq,":party_faction_025",":troop_faction_008"),
(store_distance_to_party_from_party,":distance_parties_026",":party_id_002",":party_id_002"),
(try_begin),
(lt,":distance_parties_026",60),
(assign,":var023",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var023",0),
(assign,":var005",-1),
(assign,":var006","str_center_is_indefensible"),
(else_try),
(party_get_slot,":party_slot_027",":troop_slot_010",56),
(party_get_slot,":party_slot_028",":troop_slot_010",59),
(party_get_slot,":party_slot_029",":troop_slot_010",57),
(store_add, ":var030", ":party_slot_027", ":party_slot_028"),
(val_add, ":var030", ":party_slot_029"),
(try_begin),
(is_between,":party_id_002","p_village_1","p_salt_mine"),
(assign,":party_slot_031",10),
(else_try),
(party_get_slot,":party_slot_031",":party_id_002",56),
(party_get_slot,":party_slot_032",":party_id_002",57),
(val_add, ":party_slot_031", ":party_slot_032"),
(try_end),
(try_end),
(val_max,":party_slot_031",1),
(try_begin),
(this_or_next|troop_slot_eq,":troop_id_001",52,1),
(this_or_next|troop_slot_eq,":troop_id_001",52,2),
(troop_slot_eq,":troop_id_001",52,3),
(store_mul, ":var007", ":var030", 100),
(val_div, ":var007", ":party_slot_031"),
(try_begin),
(lt,":var007",150),
(assign,":var005",-1),
(assign,":var006","str_center_protected_by_enemy_army_aggressive"),
(else_try),
(ge,":party_slot_031",":var030"),
(assign,":var005",-1),
(assign,":var006","str_center_protected_by_enemy_army_cautious"),
(else_try),
(store_mul, ":var007", ":var030", 100),
(val_div, ":var007", ":party_slot_031"),
(try_begin),
(lt,":var007",185),
(this_or_next|troop_slot_eq,":troop_id_001",52,7),
(this_or_next|troop_slot_eq,":troop_id_001",52,5),
(this_or_next|troop_slot_eq,":troop_id_001",52,6),
(troop_slot_eq,":troop_id_001",52,4),
(assign,":var005",-1),
(assign,":var006","str_center_cautious_marshal_believes_center_too_difficult_to_capture"),
(else_try),
(lt,":var007",140),
(assign,":var005",-1),
(assign,":var006","str_center_even_aggressive_marshal_believes_center_too_difficult_to_capture"),
(else_try),
(faction_slot_eq,":troop_faction_008",4,3),
(faction_get_slot,":faction_slot_033",":troop_faction_008",5),
(try_begin),
(is_between,":faction_slot_033","p_village_1","p_salt_mine"),
(neq,":party_id_002",":faction_slot_033"),
(party_slot_eq,":faction_slot_033",35,5),
(store_current_hours,":cur_hours_034"),
(party_get_slot,":party_slot_035",":faction_slot_033",64),
(val_sub, ":cur_hours_034", ":party_slot_035"),
(try_begin),
(gt,":cur_hours_034",4),
(call_script, "script_npc_decision_checklist_evaluate_enemy_center_for_attack", ":troop_id_001", ":faction_slot_033", ":var003", 0),
(try_begin),
(gt,reg0,-1),
(assign,":var005",-1),
(assign,":var006","str_center_we_have_already_committed_too_much_time_to_our_present_siege_to_move_elsewhere"),
(else_try),
(faction_slot_eq,":troop_faction_008",4,3),
(faction_get_slot,":faction_slot_033",":troop_faction_008",5),
(try_begin),
(neq,":party_id_002",":faction_slot_033"),
(is_between,":faction_slot_033","p_village_1","p_salt_mine"),
(store_distance_to_party_from_party,":distance_parties_036",":troop_slot_010",":troop_slot_010"),
(try_begin),
(lt,":distance_parties_036",10),
(call_script, "script_npc_decision_checklist_evaluate_enemy_center_for_attack", ":troop_id_001", ":faction_slot_033", ":var003", 0),
(try_begin),
(gt,reg0,-1),
(assign,"$g_use_current_ai_object_as_s8",1),
(assign,":var005",-1),
(assign,":var006","str_center_we_are_already_here_we_should_at_least_loot_the_village"),
(else_try),
(try_begin),
(eq,":::cheat_mode",1),
(eq,":troop_faction_008","fac_kingdom_3"),
(store_faction_of_party, ":party_faction_011", ":party_id_002"),
(store_relation,":faction_relation_012",":party_faction_011",":troop_faction_008"),
(try_begin),
(lt,":faction_relation_012",0),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(call_script, "script_calculate_center_assailability_score", ":troop_id_001", ":party_id_002", ":var004"),
(assign,":var037",reg0),
(assign,":var007",reg1),
(assign,":var005",":var037"),
(try_begin),
(le,":var007",100),
(try_begin),
(this_or_next|troop_slot_eq,":troop_id_001",52,7),
(this_or_next|troop_slot_eq,":troop_id_001",52,5),
(this_or_next|troop_slot_eq,":troop_id_001",52,6),
(troop_slot_eq,":troop_id_001",52,4),
(assign,":var006","str_center_cautious_marshal_believes_center_too_difficult_to_capture"),
(else_try),
(assign,":var006","str_center_even_aggressive_marshal_believes_center_too_difficult_to_capture"),
(try_end),
(else_try),
(le,":var007",150),
(try_begin),
(this_or_next|troop_slot_eq,":troop_id_001",52,7),
(this_or_next|troop_slot_eq,":troop_id_001",52,5),
(this_or_next|troop_slot_eq,":troop_id_001",52,6),
(troop_slot_eq,":troop_id_001",52,4),
(assign,":var006","str_center_protected_by_enemy_army_cautious"),
(else_try),
(assign,":var006","str_center_protected_by_enemy_army_aggressive"),
(try_end),
(else_try),
(try_begin),
(le,":var037",":::g_faction_object_score"),
(assign,":var006","str_center_value_outweighed_by_difficulty_of_capture"),
(else_try),
(assign,":var006","str_center_value_justifies_the_difficulty_of_capture"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var005"),
(assign,reg1,":var006"),
(assign,reg2,":var007"),
]),

("npc_decision_checklist_faction_ai_alt", [
(store_script_param, ":troop_id_001", 1),
(store_troop_faction,":troop_faction_002",":troop_id_001"),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(str_store_string,s33,":str_store_faction_name(troop_faction_002)"),
(try_begin),
(eq,":::cheat_mode",1),
(display_message, "@@{!}DEBUG -- {s4} produces a faction strategy for {s33}"),
(try_end),
(faction_get_slot,":faction_slot_003",":troop_faction_002",8),
(faction_get_slot,":faction_slot_004",":troop_faction_002",4),
(faction_get_slot,":faction_slot_005",":troop_faction_002",5),
(assign,":troop_slot_006",-1),
(assign,":var007",0),
(try_begin),
(gt,":faction_slot_003",0),
(troop_get_slot,":troop_slot_006",":faction_slot_003",10),
(try_begin),
(party_is_active,":troop_slot_006"),
(party_get_slot,":party_slot_008",":troop_slot_006",56),
(party_get_slot,":party_slot_009",":troop_slot_006",59),
(store_add, ":var007", ":party_slot_008", ":party_slot_009"),
(try_end),
(try_end),
(store_current_hours,":cur_hours_010"),
(faction_get_slot,":faction_slot_011",":troop_faction_002",95),
(val_sub, ":cur_hours_010", ":faction_slot_011"),
(store_current_hours,":cur_hours_012"),
(faction_get_slot,":faction_slot_013",":troop_faction_002",94),
(val_sub, ":cur_hours_012", ":faction_slot_013"),
(store_current_hours,":cur_hours_014"),
(faction_get_slot,":faction_slot_015",":troop_faction_002",97),
(val_sub, ":cur_hours_014", ":faction_slot_015"),
(store_current_hours,":cur_hours_016"),
(faction_get_slot,":faction_slot_017",":troop_faction_002",96),
(val_sub, ":cur_hours_016", ":faction_slot_017"),
(try_begin),
(ge,":cur_hours_010",1080),
(assign,":var018",100),
(else_try),
(ge,":cur_hours_010",480),
(store_sub, ":var018", ":cur_hours_010", 480),
(val_div, ":var018", 20),
(val_add, ":var018", 64),
(else_try),
(ge,":cur_hours_010",240),
(store_sub, ":var018", ":cur_hours_010", 240),
(val_div, ":var018", 10),
(val_add, ":var018", 40),
(else_try),
(store_div, ":var___x1", ":cur_hours_010", 6),
(assign,":var018",":var___x1"),
(try_end),
(call_script, "script_find_center_to_defend", ":troop_id_001"),
(assign,":var019",reg0),
(assign,":var020",reg1),
(assign,":var021",reg2),
(assign,":var022",0),
(assign,":var023",0),
(try_for_range, ":trp_024", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_025",":trp_024"),
(try_begin),
(eq,":troop_faction_025",":troop_faction_002"),
(troop_get_slot,":troop_slot_026",":trp_024",10),
(party_is_active,":troop_slot_026"),
(val_add, ":var023", 1),
(party_slot_eq,":troop_slot_026",4,11),
(party_slot_eq,":troop_slot_026",5,":troop_slot_006"),
(party_is_active,":troop_slot_006"),
(store_distance_to_party_from_party,":distance_parties_027",":troop_slot_026",":troop_slot_026"),
(lt,":distance_parties_027",15),
(val_add, ":var022", 1),
(try_end),
(try_end),
(assign,":var028",-1),
(try_begin),
(gt,":var023",0),
(store_mul, ":var028", ":var022", 100),
(val_div, ":var028", ":var023"),
(try_end),
(store_mul, ":var029", ":var028", 3),
(val_add, ":var029", 90),
(try_begin),
(ge,":faction_slot_003",0),
(ge,":troop_slot_006",0),
(party_is_active,":troop_slot_006"),
(call_script, "script_party_count_fit_for_battle", ":troop_slot_006"),
(assign,":var030",reg0),
(try_begin),
(ge,":var030",40),
(call_script, "script_find_center_to_attack_alt", ":troop_id_001", 1, 0),
(assign,":var031",reg0),
(assign,":var032",reg1),
(call_script, "script_find_center_to_attack_alt", ":troop_id_001", 1, 1),
(assign,":var033",reg0),
(assign,":var034",reg1),
(else_try),
(assign,":var032",0),
(assign,":var034",0),
(assign,":var031",-1),
(assign,":var033",-1),
(try_end),
(try_end),
(try_begin),
(ge,":var032",":var033"),
(assign,":var035",":var031"),
(assign,":var036",":var032"),
(else_try),
(assign,":var035",":var033"),
(assign,":var036",":var034"),
(try_end),
(try_begin),
(eq,":faction_slot_004",2),
(val_mul, ":var036", 3),
(val_div, ":var036", 2),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(try_begin),
(is_between,":var035","p_town_1","p_salt_mine"),
(str_store_string,s4,":str_store_party_name(var035)"),
(display_message, "@@{!}Best offensive target {s4} has value level of {reg1}"),
(else_try),
(display_message, "@@{!}No center found to attack"),
(try_end),
(try_begin),
(is_between,":var019","p_town_1","p_salt_mine"),
(str_store_string,s4,":str_store_party_name(var019)"),
(assign,reg1,":var020"),
(display_message, "@@{!}Best threat of {s4} has value level of {reg1}"),
(else_try),
(display_message, "@@{!}No center found to defend"),
(try_end),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(try_begin),
(is_between,":var019","p_town_1","p_salt_mine"),
(str_store_string,s4,":str_store_party_name(var019)"),
(assign,reg1,":var020"),
(display_message, "@@Best threat of {s4} has value level of {reg1}"),
(else_try),
(display_message, "@@No center found to defend"),
(try_end),
(try_end),
(assign,"$g_target_after_gathering",-1),
(store_current_hours,":cur_hours_037"),
(try_begin),
(ge,":var036",":var020"),
(faction_set_slot,":troop_faction_002",87,":cur_hours_037"),
(try_end),
(faction_get_slot,":faction_slot_038",":troop_faction_002",87),
(try_begin),
(eq,":faction_slot_038",0),
(faction_set_slot,":troop_faction_002",87,":cur_hours_037"),
(try_end),
(faction_get_slot,":faction_slot_038",":troop_faction_002",87),
(store_sub, ":var039", ":cur_hours_037", ":faction_slot_038"),
(str_store_string,s7,":str_store_faction_name(troop_faction_002)"),
(assign,":var040",1),
(try_for_range, ":fac_041", ":fac.player_supporters_faction", ":fac.kingdoms_end"),
(store_relation,":faction_relation_042",":troop_faction_002",":fac_041"),
(try_begin),
(lt,":faction_relation_042",0),
(assign,":var040",0),
(try_end),
(try_end),
(try_begin),
(eq,":troop_id_001","trp_player"),
(eq,":faction_slot_004",6),
(ge,":cur_hours_014",72),
(assign,":var043",0),
(assign,":var044",-1),
(assign,"$player_marshal_ai_state",0),
(assign,"$player_marshal_ai_object",-1),
(else_try),
(eq,":::players_kingdom","fac_player_supporters_faction"),
(faction_slot_eq,"$players_kingdom",11,"trp_player"),
(neq,":troop_id_001","trp_player"),
(eq,":faction_slot_004",6),
(le,":cur_hours_014",48),
(party_slot_eq,":faction_slot_005",7,"trp_player"),
(store_faction_of_party, ":party_faction_045", ":faction_slot_005"),
(try_begin),
(eq,":party_faction_045",":::players_kingdom"),
(assign,":var043",6),
(assign,":var044",":faction_slot_005"),
(else_try),
(eq,":troop_id_001","trp_player"),
(str_clear, 14),
(assign,":var043","$player_marshal_ai_state"),
(assign,":var044","$player_marshal_ai_object"),
(else_try),
(neq,":faction_slot_004",0),
(neq,":faction_slot_004",6),
(party_is_active,":troop_slot_006"),
(party_slot_eq,":troop_slot_006",4,14),
(assign,":var043",0),
(assign,":var044",-1),
(str_store_string,s14,":str_store_string("str_the_enemy_temporarily_has_the_field")"),
(else_try),
(neq,":faction_slot_004",6),
(assign,":var046",0),
(try_begin),
(eq,":faction_slot_004",2),
(is_between,":faction_slot_005","p_town_1","p_village_1"),
(party_get_slot,":party_slot_047",":faction_slot_005",54),
(try_begin),
(party_is_active,":party_slot_047"),
(store_faction_of_party, ":party_faction_048", ":party_slot_047"),
(try_begin),
(eq,":party_faction_048",":troop_faction_002"),
(assign,":var046",1),
(try_end),
(try_end),
(try_end),
(try_end),
(assign,":var049",0),
(try_begin),
(eq,":faction_slot_004",5),
(gt,":troop_slot_006",0),
(party_is_active,":troop_slot_006"),
(assign,":party_battle_opponent_050",-1),
(try_begin),
(party_slot_eq,":troop_slot_006",4,7),
(party_get_slot,":party_slot_051",":troop_slot_006",5),
(party_get_battle_opponent, ":party_battle_opponent_052", ":party_slot_051"),
(try_begin),
(ge,":party_battle_opponent_052",0),
(assign,":party_battle_opponent_050",":party_slot_051"),
(else_try),
(party_slot_eq,":troop_slot_006",4,10),
(party_get_slot,":party_slot_051",":troop_slot_006",5),
(try_begin),
(ge,":party_slot_051",0),
(neg|is_between,":party_slot_051","p_town_1","p_salt_mine"),
(party_is_active,":party_slot_051"),
(party_get_battle_opponent, ":party_battle_opponent_050", ":party_slot_051"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":party_battle_opponent_050",":faction_slot_005"),
(assign,":var049",1),
(try_end),
(try_end),
(try_begin),
(eq,":var046",0),
(eq,":var049",0),
(ge,":cur_hours_016",1240),
(assign,":var043",0),
(assign,":var044",-1),
(str_store_string,s14,":str_store_string("str_the_vassals_are_tired_we_let_them_rest_for_some_time")"),
(else_try),
(party_is_active,":troop_slot_006"),
(eq,":var040",0),
(is_between,":var019","p_town_1","p_salt_mine"),
(this_or_next|eq,":faction_slot_004",0),
(this_or_next|eq,":faction_slot_004",6),
(gt,":var020",":var036"),
(assign,":var053",0),
(assign,":var054",0),
(try_begin),
(is_between,":var019","p_village_1","p_salt_mine"),
(assign,":var053",0),
(else_try),
(try_begin),
(lt,":var039",3),
(assign,":var055",150),
(else_try),
(lt,":var039",6),
(assign,":var055",140),
(else_try),
(lt,":var039",9),
(assign,":var055",132),
(else_try),
(lt,":var039",12),
(assign,":var055",124),
(else_try),
(lt,":var039",15),
(assign,":var055",118),
(else_try),
(lt,":var039",18),
(assign,":var055",114),
(else_try),
(lt,":var039",21),
(assign,":var055",110),
(else_try),
(lt,":var039",24),
(assign,":var055",106),
(else_try),
(lt,":var039",27),
(assign,":var055",102),
(else_try),
(lt,":var039",31),
(assign,":var055",98),
(else_try),
(lt,":var039",34),
(assign,":var055",94),
(else_try),
(lt,":var039",37),
(assign,":var055",90),
(else_try),
(lt,":var039",40),
(assign,":var055",86),
(else_try),
(lt,":var039",43),
(assign,":var055",82),
(else_try),
(lt,":var039",46),
(assign,":var055",79),
(else_try),
(lt,":var039",49),
(assign,":var055",76),
(else_try),
(lt,":var039",52),
(assign,":var055",73),
(else_try),
(lt,":var039",56),
(assign,":var055",70),
(else_try),
(lt,":var039",60),
(assign,":var055",68),
(else_try),
(lt,":var039",66),
(assign,":var055",66),
(else_try),
(lt,":var039",72),
(assign,":var055",64),
(else_try),
(lt,":var039",80),
(assign,":var055",62),
(else_try),
(lt,":var039",90),
(assign,":var055",60),
(else_try),
(lt,":var039",100),
(assign,":var055",58),
(else_try),
(assign,":var055",56),
(try_end),
(try_end),
(store_mul, ":var056", ":var021", ":var055"),
(val_div, ":var056", 100),
(try_begin),
(lt,":var007",":var056"),
(assign,":var053",1),
(try_end),
(else_try),
(eq,":faction_slot_004",5),
(neq,":var019",":faction_slot_005"),
(assign,":var057",0),
(try_begin),
(gt,":troop_slot_006",0),
(party_is_active,":troop_slot_006"),
(assign,":party_battle_opponent_050",-1),
(try_begin),
(party_slot_eq,":troop_slot_006",4,7),
(party_get_slot,":party_slot_051",":troop_slot_006",5),
(party_get_battle_opponent, ":party_battle_opponent_052", ":party_slot_051"),
(try_begin),
(ge,":party_battle_opponent_052",0),
(assign,":party_battle_opponent_050",":party_slot_051"),
(else_try),
(party_slot_eq,":troop_slot_006",4,10),
(party_get_slot,":party_slot_051",":troop_slot_006",5),
(try_begin),
(ge,":party_slot_051",0),
(neg|is_between,":party_slot_051","p_town_1","p_salt_mine"),
(party_is_active,":party_slot_051"),
(party_get_battle_opponent, ":party_battle_opponent_050", ":party_slot_051"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":party_battle_opponent_050",":faction_slot_005"),
(assign,":var057",1),
(try_end),
(try_end),
(try_begin),
(eq,":var057",0),
(store_mul, ":var056", ":var021", 80),
(val_div, ":var056", 100),
(try_begin),
(lt,":var007",":var056"),
(this_or_next|is_between,":var019","p_town_1","p_village_1"),
(neq,":troop_faction_002",":::players_kingdom"),
(assign,":var054",1),
(try_end),
(try_end),
(try_end),
(try_begin),
(this_or_next|eq,":var053",1),
(eq,":var054",1),
(assign,":var043",1),
(assign,":var044",-1),
(str_store_string,s21,":str_store_party_name(var019)"),
(str_store_string,s14,":str_store_string("str_we_should_prepare_to_defend_s21_but_we_should_gather_our_forces_until_we_are_strong_enough_to_engage_them")"),
(try_begin),
(eq,":troop_faction_002",":::players_kingdom"),
(assign,"$g_gathering_reason",":var019"),
(try_end),
(try_end),
(else_try),
(party_is_active,":troop_slot_006"),
(is_between,":var019","p_town_1","p_village_1"),
(this_or_next|eq,":faction_slot_004",0),
(this_or_next|eq,":faction_slot_004",6),
(ge,":var020",":var036"),
(party_slot_ge,":var019",54,0),
(assign,":var043",5),
(assign,":var044",":var019"),
(str_store_string,s21,":str_store_party_name(var019)"),
(str_store_string,s14,":str_store_string("str_we_should_ride_to_break_the_siege_of_s21")"),
(else_try),
(party_is_active,":troop_slot_006"),
(this_or_next|eq,":faction_slot_004",0),
(this_or_next|eq,":faction_slot_004",6),
(ge,":var020",":var036"),
(is_between,":var019","p_village_1","p_salt_mine"),
(assign,":var043",5),
(assign,":var044",":var019"),
(str_store_string,s21,":str_store_party_name(var019)"),
(str_store_string,s14,":str_store_string("str_we_should_ride_to_defeat_the_enemy_gathered_near_s21")"),
(else_try),
(this_or_next|eq,":faction_slot_004",1),
(this_or_next|eq,":faction_slot_004",2),
(eq,":faction_slot_004",3),
(ge,":cur_hours_016",":var029"),
(ge,":cur_hours_014",24),
(assign,":var058",0),
(try_begin),
(is_between,":faction_slot_005","p_town_1","p_village_1"),
(party_get_battle_opponent, ":party_slot_047", ":faction_slot_005"),
(try_begin),
(party_is_active,":party_slot_047"),
(store_faction_of_party, ":party_faction_048", ":party_slot_047"),
(try_begin),
(this_or_next|eq,":party_faction_048","fac_player_faction"),
(eq,":party_faction_048",":troop_faction_002"),
(assign,":var058",1),
(else_try),
(is_between,":faction_slot_005","p_town_1","p_village_1"),
(party_get_slot,":party_slot_047",":faction_slot_005",54),
(try_begin),
(party_is_active,":party_slot_047"),
(store_faction_of_party, ":party_faction_048", ":party_slot_047"),
(try_begin),
(this_or_next|eq,":party_faction_048","fac_player_faction"),
(eq,":party_faction_048",":troop_faction_002"),
(assign,":var058",1),
(else_try),
(is_between,":faction_slot_005","p_town_1","p_salt_mine"),
(neg|is_between,":faction_slot_005","p_town_1","p_village_1"),
(party_slot_eq,":faction_slot_005",35,1),
(assign,":var058",1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":var058",0),
(assign,reg7,":cur_hours_016"),
(assign,reg8,":var029"),
(str_store_string,s14,":str_store_string("str_this_offensive_needs_to_wind_down_soon_so_the_vassals_can_attend_to_their_own_business")"),
(assign,":var043",0),
(assign,":var044",-1),
(else_try),
(party_is_active,":troop_slot_006"),
(eq,":var040",0),
(eq,":faction_slot_004",0),
(ge,":cur_hours_010",60),
(lt,":cur_hours_016",120),
(assign,":var043",1),
(assign,":var044",-1),
(str_store_string,s14,":str_store_string("str_it_is_time_to_go_on_the_offensive_and_we_must_first_assemble_the_army")"),
(try_begin),
(eq,":troop_faction_002",":::players_kingdom"),
(assign,"$g_gathering_reason",-1),
(try_end),
(try_end),
(else_try),
(party_is_active,":troop_slot_006"),
(eq,":faction_slot_004",1),
(eq,":var040",0),
(lt,":cur_hours_014",54),
(lt,":var028",12),
(str_store_string,s14,":str_store_string("str_we_must_continue_to_gather_the_army_before_we_ride_forth_on_an_offensive_operation")"),
(assign,":var043",1),
(assign,":var044",-1),
(else_try),
(assign,":var059",50),
(try_begin),
(eq,":var040",0),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_060",":troop_id_001",52),
(try_begin),
(this_or_next|eq,":troop_slot_060",3),
(this_or_next|eq,":troop_slot_060",2),
(eq,":troop_slot_060",1),
(val_mul, ":var059", 9),
(val_div, ":var059", 10),
(try_end),
(try_end),
(try_end),
(try_begin),
(party_is_active,":troop_slot_006"),
(eq,":faction_slot_004",1),
(try_begin),
(lt,":cur_hours_014",6),
(assign,":var061",1500),
(else_try),
(lt,":cur_hours_014",10),
(assign,":var061",1000),
(else_try),
(lt,":cur_hours_014",14),
(assign,":var061",720),
(else_try),
(lt,":cur_hours_014",18),
(assign,":var061",480),
(else_try),
(lt,":cur_hours_014",22),
(assign,":var061",360),
(else_try),
(lt,":cur_hours_014",26),
(assign,":var061",240),
(else_try),
(lt,":cur_hours_014",30),
(assign,":var061",180),
(else_try),
(lt,":cur_hours_014",34),
(assign,":var061",120),
(else_try),
(lt,":cur_hours_014",38),
(assign,":var061",100),
(else_try),
(lt,":cur_hours_014",42),
(assign,":var061",80),
(else_try),
(lt,":cur_hours_014",46),
(assign,":var061",65),
(else_try),
(lt,":cur_hours_014",50),
(assign,":var061",55),
(else_try),
(assign,":var061",":var059"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_060",":troop_id_001",52),
(try_begin),
(this_or_next|eq,":troop_slot_060",3),
(this_or_next|eq,":troop_slot_060",2),
(eq,":troop_slot_060",1),
(val_mul, ":var061", 9),
(val_div, ":var061", 10),
(try_end),
(try_end),
(try_begin),
(le,":var036",":var061"),
(le,":cur_hours_014",54),
(str_store_string,s14,":str_store_string("str_we_have_assembled_some_vassals")"),
(assign,":var043",1),
(assign,":var044",-1),
(else_try),
(party_is_active,":troop_slot_006"),
(neq,":faction_slot_004",0),
(neq,":faction_slot_004",6),
(assign,":var035",":var033"),
(try_begin),
(is_between,":var035","p_town_1","p_village_1"),
(ge,":var036",":var059"),
(assign,":var043",2),
(assign,":var044",":var035"),
(str_store_string,s14,":str_store_string("str_we_believe_the_fortress_will_be_worth_the_effort_to_take_it")"),
(else_try),
(party_is_active,":troop_slot_006"),
(neq,":faction_slot_004",0),
(neq,":faction_slot_004",6),
(assign,":var035",":var033"),
(try_begin),
(is_between,":var035","p_village_1","p_salt_mine"),
(ge,":var036",":var059"),
(assign,":var043",3),
(assign,":var044",":var035"),
(str_store_string,s14,":str_store_string("str_we_shall_leave_a_fiery_trail_through_the_heart_of_the_enemys_lands_targeting_the_wealthy_settlements_if_we_can")"),
(else_try),
(eq,":faction_slot_004",1),
(str_store_string,s14,":str_store_string("str_the_army_will_be_disbanded_because_we_have_been_waiting_too_long_without_a_target")"),
(assign,":var043",0),
(assign,":var044",-1),
(else_try),
(eq,":faction_slot_004",6),
(gt,":cur_hours_014",72),
(assign,":var043",0),
(assign,":var044",-1),
(str_store_string,s14,":str_store_string("str_it_is_time_for_the_feast_to_conclude")"),
(else_try),
(eq,":faction_slot_004",6),
(le,":cur_hours_014",72),
(assign,":var043",6),
(assign,":var044",":faction_slot_005"),
(str_store_string,s14,":str_store_string("str_we_should_continue_the_feast_unless_there_is_an_emergency")"),
(else_try),
(check_quest_active,"qst_organize_feast"),
(eq,":::players_kingdom",":troop_faction_002"),
(quest_get_slot,":quest_slot_062","qst_organize_feast",1),
(assign,":var043",6),
(assign,":var044",":quest_slot_062"),
(str_store_string,s14,":str_store_string("str_you_had_wished_to_hold_a_feast")"),
(else_try),
(check_quest_active,"qst_wed_betrothed_female"),
(quest_get_slot,":quest_slot_063","qst_wed_betrothed_female",6),
(try_begin),
(troop_slot_eq,":quest_slot_063",8,-1),
(store_troop_faction,":troop_faction_064",":quest_slot_063"),
(try_begin),
(eq,":troop_faction_064",":troop_faction_002"),
(faction_get_slot,":faction_slot_065",":troop_faction_064",11),
(assign,":party_id_066",-1),
(try_for_range, ":p_067", ":p.town_1", ":p.village_1"),
(eq,":party_id_066",-1),
(party_slot_eq,":p_067",7,":quest_slot_063"),
(party_slot_ge,":p_067",54,0),
(assign,":party_id_066",":p_067"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_for_range, ":p_067", ":p.town_1", ":p.village_1"),
(eq,":party_id_066",-1),
(party_slot_eq,":p_067",7,":faction_slot_065"),
(party_slot_ge,":p_067",54,0),
(assign,":party_id_066",":p_067"),
(try_end),
(try_begin),
(is_between,":party_id_066","p_town_1","p_village_1"),
(assign,":var043",6),
(assign,":var044",":party_id_066"),
(str_store_string,s14,":str_store_string("str_your_wedding_day_approaches_my_lady")"),
(else_try),
(check_quest_active,"qst_wed_betrothed"),
(neg|quest_slot_ge,"qst_wed_betrothed",23,362),
(quest_get_slot,":quest_slot_068","qst_wed_betrothed",2),
(call_script, "script_get_kingdom_lady_social_determinants", ":quest_slot_068"),
(assign,":troop_id_069",reg0),
(store_troop_faction,":troop_faction_070",":troop_id_069"),
(try_begin),
(eq,":troop_faction_070",":troop_faction_002"),
(troop_slot_eq,":troop_id_069",8,-1),
(assign,":var071",reg1),
(try_begin),
(is_between,":var071","p_town_1","p_salt_mine"),
(party_slot_eq,":var071",54,-1),
(assign,":var043",6),
(assign,":var044",":var071"),
(str_store_string,s14,":str_store_string("str_your_wedding_day_approaches")"),
(else_try),
(ge,":cur_hours_012",192),
(assign,":party_id_066",-1),
(try_for_range, ":trp_072", ":trp.knight_1_1_wife", ":trp.heroes_end"),
(troop_get_slot,":quest_slot_063",":trp_072",34),
(try_begin),
(gt,":quest_slot_063",0),
(store_troop_faction,":troop_faction_073",":trp_072"),
(store_troop_faction,":troop_faction_064",":quest_slot_063"),
(try_begin),
(troop_slot_ge,":quest_slot_063",8,0),
(else_try),
(neq,":troop_faction_064",":troop_faction_073"),
(neq,":troop_faction_064","fac_player_faction"),
(call_script, "script_courtship_event_lady_break_relation_with_suitor", ":trp_072", ":quest_slot_063"),
(else_try),
(eq,":troop_faction_073",":troop_faction_002"),
(store_current_hours,":cur_hours_074"),
(troop_get_slot,":troop_slot_075",":trp_072",39),
(val_sub, ":cur_hours_074", ":troop_slot_075"),
(try_begin),
(ge,":cur_hours_074",719),
(call_script, "script_get_kingdom_lady_social_determinants", ":trp_072"),
(assign,":var071",reg1),
(assign,":party_id_066",":var071"),
(assign,":var076",":trp_072"),
(assign,":var077",":quest_slot_063"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(ge,":party_id_066","p_town_1"),
(assign,":var043",6),
(assign,":var044",":party_id_066"),
(str_store_string,s22,":str_store_troop_name(var076)"),
(str_store_string,s23,":str_store_troop_name(var077)"),
(str_store_string,s14,":str_store_string("str_s22_and_s23_wish_to_marry")"),
(else_try),
(eq,":faction_slot_004",0),
(gt,":cur_hours_012",240),
(assign,":var078",0),
(assign,":party_id_066",-1),
(try_for_range, ":p_079", ":p.town_1", ":p.village_1"),
(store_faction_of_party, ":party_faction_080", ":p_079"),
(try_begin),
(eq,":party_faction_080",":troop_faction_002"),
(try_begin),
(neg|party_slot_eq,":p_079",35,5),
(party_get_slot,":party_slot_081",":p_079",7),
(try_begin),
(is_between,":party_slot_081","trp_npc1","trp_knight_1_1_wife"),
(troop_get_slot,":troop_slot_082",":party_slot_081",7),
(store_random_in_range,":random_x_083",0,1000),
(val_add, ":troop_slot_082", ":random_x_083"),
(try_begin),
(gt,":troop_slot_082",":var078"),
(assign,":var078",":troop_slot_082"),
(assign,":party_id_066",":p_079"),
(else_try),
(this_or_next|party_slot_eq,":p_079",35,5),
(party_slot_eq,":p_079",35,1),
(assign,":var078",9999),
(assign,":party_id_066",-1),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_begin),
(is_between,":party_id_066","p_town_1","p_village_1"),
(party_get_slot,":troop_id_069",":party_id_066",7),
(try_begin),
(troop_slot_eq,":troop_id_069",8,-1),
(assign,":var043",6),
(assign,":var044",":party_id_066"),
(str_store_string,s14,":str_store_string("str_it_has_been_a_long_time_since_the_lords_of_the_realm_gathered_for_a_feast")"),
(else_try),
(neq,":faction_slot_004",0),
(assign,":var043",0),
(assign,":var044",-1),
(str_store_string,s14,":str_store_string("str_the_circumstances_which_led_to_this_decision_no_longer_apply_so_we_should_stop_and_reconsider_shortly")"),
(else_try),
(eq,":faction_slot_004",0),
(eq,":var040",1),
(assign,":var043",0),
(assign,":var044",-1),
(str_store_string,s14,":str_store_string("str_we_are_currently_at_peace")"),
(else_try),
(eq,":faction_slot_004",0),
(faction_slot_eq,":troop_faction_002",8,-1),
(assign,":var043",0),
(assign,":var044",-1),
(str_store_string,s14,":str_store_string("str_we_are_waiting_for_selection_of_marshal")"),
(else_try),
(eq,":faction_slot_004",0),
(assign,":var043",0),
(assign,":var044",-1),
(str_store_string,s14,":str_store_string("str_the_vassals_still_need_time_to_attend_to_their_own_business")"),
(try_end),
(try_end),
(try_end),
(assign,reg0,":var043"),
(assign,reg1,":var044"),
]),

("faction_last_reconnoitered_center", [
(store_script_param, ":var001", 1),
(store_script_param, ":party_id_002", 2),
(store_sub, ":slot_no_003", ":var001", ":fac.player_supporters_faction"),
(val_add, ":slot_no_003", 350),
(store_current_hours,":cur_hours_004"),
(party_get_slot,":party_slot_005",":party_id_002",":slot_no_003"),
(try_begin),
(lt,":party_slot_005",1),
(assign,":cur_hours_004",1000),
(else_try),
(val_sub, ":cur_hours_004", ":party_slot_005"),
(try_end),
(assign,reg0,":cur_hours_004"),
(assign,reg1,":party_slot_005"),
]),

("reduce_exact_number_to_estimate", [
(store_script_param, ":var001", 1),
(try_begin),
(lt,":var001",500),
(assign,":var002",0),
(else_try),
(lt,":var001",1000),
(assign,":var002",750),
(else_try),
(lt,":var001",2000),
(assign,":var002",1500),
(else_try),
(lt,":var001",4000),
(assign,":var002",3000),
(else_try),
(lt,":var001",8000),
(assign,":var002",6000),
(else_try),
(lt,":var001",16000),
(assign,":var002",12000),
(else_try),
(assign,":var002",24000),
(try_end),
(assign,reg0,":var002"),
]),

("calculate_castle_prosperities_by_using_its_villages", [
(try_for_range, ":p_001", ":p.castle_1", ":p.village_1"),
(assign,":var002",0),
(assign,":var003",0),
(try_for_range, ":p_004", ":p.village_1", ":p.salt_mine"),
(party_get_slot,":party_slot_005",":p_004",120),
(try_begin),
(eq,":p_001",":party_slot_005"),
(party_get_slot,":party_slot_006",":p_004",50),
(val_add, ":var002", ":party_slot_006"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(store_div, ":var___x1", ":var002", ":var003"),
(assign,":var007",":var___x1"),
(else_try),
(assign,":var007",50),
(try_end),
(party_set_slot,":p_001",50,":var007"),
(try_end),
]),

("initialize_tavern_variables", [
(assign,"$g_main_attacker_agent",0),
(assign,"$g_attacker_drawn_weapon",0),
(assign,"$g_start_belligerent_drunk_fight",0),
(assign,"$g_start_hired_assassin_fight",0),
(assign,"$g_belligerent_drunk_leaving",0),
]),

("prepare_alley_to_fight", [
(party_get_slot,":party_slot_001","$current_town",17),
(modify_visitors_at_site,":party_slot_001"),
(reset_visitors),
(set_visitor,0,"trp_player"),
(set_visitor,3,"trp_bandit"),
(assign,"$talked_with_merchant",0),
(set_jump_mission,"mt_alley_fight"),
(jump_to_scene,":party_slot_001"),
(change_screen_mission),
]),

("prepare_town_to_fight", [
(str_store_string,s9,":str_store_party_name_link(_g_starting_town)"),
(str_store_string,s2,":str_store_string("str_save_town_from_bandits")"),
(call_script, "script_start_quest", "qst_save_town_from_bandits", "$g_talk_troop"),
(assign,"$g_mt_mode",0),
(store_faction_of_party, ":party_faction_001", "$current_town"),
(faction_get_slot,":faction_slot_002",":party_faction_001",43),
(faction_get_slot,":faction_slot_003",":party_faction_001",43),
(faction_get_slot,":faction_slot_004",":party_faction_001",44),
(party_get_slot,":party_slot_005","$current_town",10),
(modify_visitors_at_site,":party_slot_005"),
(reset_visitors),
(try_begin),
(eq,1,1),
(try_for_range, ":var006", 0, 8),
(store_add, ":slot_no_007", 160, ":var006"),
(party_get_slot,":party_slot_008","$current_town",":slot_no_007"),
(gt,":party_slot_008",0),
(store_add, ":entry_no_009", 32, ":var006"),
(set_visitor,":entry_no_009",":party_slot_008"),
(try_end),
(try_end),
(set_visitors,25,":faction_slot_002",1),
(set_visitors,26,":faction_slot_003",1),
(set_visitors,27,":faction_slot_004",1),
(set_visitors,10,"trp_looter",1),
(set_visitors,11,"trp_bandit",1),
(set_visitors,12,"trp_looter",1),
(store_faction_of_party, ":party_faction_010", "$g_starting_town"),
(try_begin),
(eq,":party_faction_010","fac_kingdom_1"),
(assign,":troop_id_011","trp_swadian_merchant"),
(else_try),
(eq,":party_faction_010","fac_kingdom_2"),
(assign,":troop_id_011","trp_vaegir_merchant"),
(else_try),
(eq,":party_faction_010","fac_kingdom_3"),
(assign,":troop_id_011","trp_khergit_merchant"),
(else_try),
(eq,":party_faction_010","fac_kingdom_4"),
(assign,":troop_id_011","trp_nord_merchant"),
(else_try),
(eq,":party_faction_010","fac_kingdom_5"),
(assign,":troop_id_011","trp_rhodok_merchant"),
(else_try),
(eq,":party_faction_010","fac_kingdom_6"),
(assign,":troop_id_011","trp_sarranid_merchant"),
(try_end),
(str_store_string,s10,":str_store_troop_name(troop_id_011)"),
(set_visitors,24,"trp_looter",1),
(set_visitors,2,"trp_looter",2),
(set_visitors,4,"trp_looter",1),
(set_visitors,5,"trp_looter",2),
(set_visitors,6,"trp_looter",1),
(set_visitors,7,"trp_looter",1),
(set_visitors,3,":troop_id_011",1),
(set_jump_mission,"mt_town_fight"),
(jump_to_scene,":party_slot_005"),
(change_screen_mission),
]),

("change_player_right_to_rule", [
(store_script_param, ":var001", 1),
(val_add, ":::player_right_to_rule", ":var001"),
(val_clamp,"$player_right_to_rule",0, 100),
(try_begin),
(gt,":var001",0),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(else_try),
(lt,":var001",0),
(assign, reg0, ":"),
(display_message, "@{reg0}"),
(try_end),
]),

("indict_lord_for_treason", [
(store_script_param, ":troop_id_001", 1),
(store_script_param, ":faction_id_002", 2),
(troop_get_type,reg4,":troop_id_001"),
(try_for_range, ":p_003", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_003",7,":troop_id_001"),
(party_set_slot,":p_003",7,-1),
(try_end),
(faction_get_slot,":faction_slot_004",":faction_id_002",11),
(call_script, "script_troop_get_relation_with_troop", ":troop_id_001", ":faction_slot_004"),
(assign,":var005",reg0),
(assign,":var006",":-150 - var005"),
(val_div, ":var006", 40),
(val_min,":var006",-1),
(try_for_range, ":trp_007", ":trp.npc1", ":trp.knight_1_1_wife"),
(store_troop_faction,":troop_faction_008",":trp_007"),
(try_begin),
(eq,":faction_id_002",":troop_faction_008"),
(call_script, "script_troop_get_family_relation_to_troop", ":troop_id_001", ":trp_007"),
(assign,":var009",reg0),
(assign,":var010",":var006"),
(gt,":var009",1),
(store_div, ":var___x1", reg0, 3),
(assign,":var011",":var___x1"),
(val_sub, ":var010", ":var011"),
(try_end),
(lt,":var010",0),
(call_script, "script_troop_change_relation_with_troop", ":faction_slot_004", ":trp_007", ":var010"),
(val_add, ":::total_indictment_changes", ":var010"),
(eq,":::cheat_mode",1),
(str_store_string,s17,":str_store_troop_name(trp_007)"),
(str_store_string,s18,":str_store_troop_name(faction_slot_004)"),
(assign,reg3,":var010"),
(display_message, "str_trial_influences_s17s_relation_with_s18_by_reg3"),
(try_end),
(assign,":var012","fac_outlaws"),
(try_begin),
(eq,":troop_id_001","trp_player"),
(assign,":var012",0),
(else_try),
(call_script, "script_lord_find_alternative_faction", ":troop_id_001"),
(assign,":var012",reg0),
(try_end),
(try_begin),
(is_between,":var012","fac_player_supporters_faction","fac_kingdoms_end"),
(try_begin),
(ge,":::cheat_mode",1),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(display_message, "@@{!}DEBUG - {s4} faction changed in indictment"),
(try_end),
(call_script, "script_change_troop_faction", ":troop_id_001", ":var012"),
(try_begin),
(neq,":var012","fac_player_supporters_faction"),
(troop_slot_eq,":troop_id_001",2,0),
(troop_set_slot,":troop_id_001",2,2),
(try_end),
(str_store_string,s10,":str_store_faction_name(var012)"),
(str_store_string,s11,":str_store_string("str_with_the_s10")"),
(else_try),
(neq,":troop_id_001","trp_player"),
(call_script, "script_change_troop_faction", ":troop_id_001", "fac_outlaws"),
(str_store_string,s11,":str_store_string("str_outside_calradia")"),
(else_try),
(eq,":troop_id_001","trp_player"),
(call_script, "script_player_leave_faction", 1),
(try_end),
(try_begin),
(eq,":troop_id_001","trp_player"),
(str_store_string,s9,":str_store_string("str_you_have_been_indicted_for_treason_to_s7_your_properties_have_been_confiscated_and_you_would_be_well_advised_to_flee_for_your_life")"),
(else_try),
(str_store_string,s4,":str_store_troop_name(troop_id_001)"),
(str_store_string,s5,":str_store_faction_name(faction_id_002)"),
(str_store_string,s6,":str_store_troop_name(faction_slot_004)"),
(troop_get_type,reg4,":troop_id_001"),
(str_store_string,s9,":str_store_string("str_by_order_of_s6_s4_of_the_s5_has_been_indicted_for_treason_the_lord_has_been_stripped_of_all_reg4herhis_properties_and_has_fled_for_reg4herhis_life_he_is_rumored_to_have_gone_into_exile_s11")"),
(try_end),
(display_message, "@@{!}{s9}"),
(troop_get_slot,":troop_slot_013",":troop_id_001",10),
(try_begin),
(party_is_active,":troop_slot_013"),
(neq,":troop_slot_013","p_main_party"),
(remove_party,":troop_slot_013"),
(troop_set_slot,":troop_id_001",10,-1),
(try_end),
(try_begin),
(eq,":::cheat_mode",1),
(this_or_next|eq,":faction_id_002",":::players_kingdom"),
(eq,":var012",":::players_kingdom"),
(call_script, "script_add_notification_menu", "mnu_notification_treason_indictment", ":troop_id_001", ":faction_id_002"),
(try_end),
]),

("give_center_to_faction_while_maintaining_lord", [
(store_script_param, ":party_id_001", 1),
(store_script_param, ":var002", 2),
(store_faction_of_party, ":party_faction_003", ":party_id_001"),
(party_set_slot,":party_id_001",62,":party_faction_003"),
(party_set_faction,":party_id_001",":var002"),
(try_begin),
(party_slot_eq,":party_id_001",0,4),
(party_get_slot,":party_slot_004",":party_id_001",122),
(try_begin),
(gt,":party_slot_004",0),
(party_is_active,":party_slot_004"),
(party_set_faction,":party_slot_004",":var002"),
(try_end),
(try_end),
(call_script, "script_update_faction_notes", ":var002"),
(call_script, "script_update_center_notes", ":party_id_001"),
(try_for_range, ":p_005", ":p.town_1", ":p.salt_mine"),
(party_slot_eq,":p_005",120,":party_id_001"),
(call_script, "script_give_center_to_faction_while_maintaining_lord", ":p_005", ":var002"),
(try_end),
]),

("check_concilio_calradi_achievement", [
(try_begin),
(eq,":::players_kingdom","fac_player_supporters_faction"),
(faction_get_slot,":faction_slot_001","fac_player_supporters_faction",11),
(try_begin),
(eq,":faction_slot_001","trp_player"),
(assign,":var002",0),
(try_for_range, ":trp_003", ":trp.npc1", ":trp.knight_1_1_wife"),
(troop_slot_eq,":trp_003",2,2),
(store_troop_faction,":troop_faction_004",":trp_003"),
(eq,":troop_faction_004","fac_player_supporters_faction"),
(val_add, ":var002", 1),
(try_end),
(try_end),
(try_end),
(ge,":var002",3),
(unlock_achievement, 54),
(try_end),
]),

("refresh_center_inventories", [
(set_merchandise_modifier_quality,150),
(reset_item_probabilities),
(try_for_range, ":p_001", ":p.town_1", ":p.castle_1"),
(party_get_slot,":party_slot_002",":p_001",23),
(reset_item_probabilities),
(assign,":var003",0),
(try_for_range, ":itm_004", ":itm.spice", ":itm.siege_supply"),
(call_script, "script_center_get_production", ":p_001", ":itm_004"),
(assign,":item_probability_005",reg0),
(try_for_range, ":p_006", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_006",120,":p_001"),
(call_script, "script_center_get_production", ":p_006", ":itm_004"),
(val_div, reg0, 3),
(val_add, ":item_probability_005", reg0),
(try_end),
(val_max,":item_probability_005",1),
(val_mul, ":item_probability_005", 4),
(val_add, ":var003", ":item_probability_005"),
(try_end),
(party_get_slot,":party_slot_007",":p_001",50),
(assign,":merch_amount_008",25),
(try_begin),
(ge,":party_slot_007",50),
(store_sub, ":var009", ":party_slot_007", 50),
(val_mul, ":var009", 2),
(val_add, ":var009", 100),
(val_mul, ":merch_amount_008", ":var009"),
(val_div, ":merch_amount_008", 100),
(else_try),
(store_sub, ":var009", ":party_slot_007", 50),
(val_add, ":var009", 100),
(val_mul, ":merch_amount_008", ":var009"),
(val_div, ":merch_amount_008", 100),
(try_end),
(val_clamp,":merch_amount_008",10, 40),
(try_begin),
(is_between,":p_001","p_castle_1","p_village_1"),
(val_div, ":merch_amount_008", 2),
(try_end),
(try_for_range, ":itm_004", ":itm.spice", ":itm.siege_supply"),
(call_script, "script_center_get_production", ":p_001", ":itm_004"),
(assign,":item_probability_005",reg0),
(try_for_range, ":p_006", ":p.village_1", ":p.salt_mine"),
(party_slot_eq,":p_006",120,":p_001"),
(call_script, "script_center_get_production", ":p_006", ":itm_004"),
(val_div, reg0, 3),
(val_add, ":item_probability_005", reg0),
(try_end),
(val_max,":item_probability_005",1),
(val_mul, ":item_probability_005", 4),
(val_mul, ":item_probability_005", ":merch_amount_008"),
(val_mul, ":item_probability_005", 100),
(val_div, ":item_probability_005", ":var003"),
(set_item_probability_in_merchandise,":itm_004",":item_probability_005"),
(try_end),
(troop_clear_inventory,":party_slot_002"),
(troop_add_merchandise,":party_slot_002",11,":merch_amount_008"),
(troop_ensure_inventory_space,":party_slot_002",20),
(troop_sort_inventory,":party_slot_002"),
(store_troop_gold,":troop_gold_010",":party_slot_002"),
(try_begin),
(lt,":troop_gold_010",1500),
(store_random_in_range,":random_x_011",500,1000),
(call_script, "script_troop_add_gold", ":party_slot_002", ":random_x_011"),
(try_end),
(try_end),
]),

("refresh_center_armories", [
(reset_item_probabilities),
(set_merchandise_modifier_quality,150),
(try_for_range, ":trp_001", ":trp.town_1_armorer", ":trp.town_1_weaponsmith"),
(store_sub, ":party_id_002", ":trp_001", ":trp.town_1_armorer"),
(assign,":party_id_002 +","p_town_1"),
(troop_clear_inventory,":trp_001"),
(party_get_slot,":party_slot_003",":party_id_002",61),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",13,16),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",12,16),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",14,8),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",15,4),
(troop_ensure_inventory_space,":trp_001",30),
(troop_sort_inventory,":trp_001"),
(store_troop_gold,reg6,":trp_001"),
(try_begin),
(lt,reg6,1000),
(store_random_in_range,":random_x_004",250,500),
(call_script, "script_troop_add_gold", ":trp_001", ":random_x_004"),
(try_end),
(try_end),
]),

("refresh_center_weaponsmiths", [
(reset_item_probabilities),
(set_merchandise_modifier_quality,150),
(try_for_range, ":trp_001", ":trp.town_1_weaponsmith", ":trp.town_1_tavernkeeper"),
(store_sub, ":party_id_002", ":trp_001", ":trp.town_1_weaponsmith"),
(assign,":party_id_002 +","p_town_1"),
(troop_clear_inventory,":trp_001"),
(party_get_slot,":party_slot_003",":party_id_002",61),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",2,5),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",3,5),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",4,5),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",7,6),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",8,4),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",9,3),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",10,5),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",5,2),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",6,2),
(troop_ensure_inventory_space,":trp_001",30),
(troop_sort_inventory,":trp_001"),
(store_troop_gold,reg6,":trp_001"),
(try_begin),
(lt,reg6,1000),
(store_random_in_range,":random_x_004",250,500),
(call_script, "script_troop_add_gold", ":trp_001", ":random_x_004"),
(try_end),
(try_end),
]),

("refresh_center_stables", [
(reset_item_probabilities),
(set_merchandise_modifier_quality,150),
(try_for_range, ":trp_001", ":trp.town_1_horse_merchant", ":trp.town_1_mayor"),
(troop_clear_inventory,":trp_001"),
(store_sub, ":party_id_002", ":trp_001", ":trp.town_1_horse_merchant"),
(assign,":party_id_002 +","p_town_1"),
(party_get_slot,":party_slot_003",":party_id_002",61),
(troop_add_merchandise_with_faction,":trp_001",":party_slot_003",1,5),
(troop_ensure_inventory_space,":trp_001",65),
(troop_sort_inventory,":trp_001"),
(store_troop_gold,":troop_gold_004",":trp_001"),
(try_begin),
(lt,":troop_gold_004",600),
(store_random_in_range,":random_x_005",250,500),
(call_script, "script_troop_add_gold", ":trp_001", ":random_x_005"),
(try_end),
(try_end),
]),

("player_get_value_of_original_items", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":agent_id_002", 2),
(store_script_param, ":var003", 3),
(assign,":var004",0),
(try_for_range, ":var005", 0, 8),
(neg|player_item_slot_is_picked_up, ":player_id_001", ":var005"),
(agent_get_item_slot, ":agent_item_slot_006", ":agent_id_002", ":var005"),
(neq,":agent_item_slot_006",-1),
(call_script, "script_multiplayer_get_item_value_for_troop", ":agent_item_slot_006", ":var003"),
(val_add, ":var004", reg0),
(try_end),
(try_end),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(neg|agent_is_human,":cur_agent"),
(agent_get_slot,":agent_slot_008",":agent_id_002",26),
(eq,":agent_slot_008",":cur_agent"),
(assign,":var009",0),
(eq,1,1),
(agent_get_rider,":agent_rider_010",":cur_agent"),
(neq,":agent_rider_010",-1),
(neg|agent_is_non_player, ":agent_rider_010"),
(agent_get_slot,":agent_slot_008",":agent_rider_010",26),
(try_begin),
(eq,":agent_slot_008",":cur_agent"),
(assign,":var009",1),
(else_try),
(eq,":agent_rider_010",-1),
(agent_get_horse,":agent_horse_011",":agent_id_002"),
(try_begin),
(eq,":agent_horse_011",-1),
(agent_get_slot,":agent_slot_008",":agent_id_002",26),
(try_begin),
(eq,":agent_slot_008",":cur_agent"),
(assign,":var009",1),
(try_end),
(try_end),
(try_end),
(try_end),
(eq,":var009",1),
(agent_get_item_id,":agent_item_id_012", ":cur_agent"),
(call_script, "script_multiplayer_get_item_value_for_troop", ":agent_item_id_012", ":var003"),
(val_add, ":var004", reg0),
(multiplayer_send_string_to_player, ":player_id_001", 111, "@Added money for your old horse"),
(try_end),
(try_end),
(agent_set_slot,":agent_id_002",26,-1),
(assign,reg0,":var004"),
]),

("multiplayer_ccoop_prepare_spawn_wave", [
(try_begin),
(multiplayer_is_server),
(set_fixed_point_multiplier, 100),
(store_random_in_range,":random_x_001",80,88),
(store_random_in_range,":random_x_002",80,88),
(try_begin),
(eq,":random_x_001",":random_x_002"),
(assign,":random_x_002",-1),
(try_end),
(store_sub, ":var003", "$g_multiplayer_ccoop_wave_no", "$g_mp_coop_last_king_wave"),
(assign,":var004",4),
(assign,":var005",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_007", 0, ":max_players"),
(player_is_active, ":player_id_007"),
(player_get_team_no,  ":team_no_008", ":player_id_007"),
(eq,":team_no_008",0),
(val_add, ":var005", 1),
(try_end),
(try_end),
(assign,reg0,":var005"),
(val_sub, ":var005", 1),
(try_for_range, ":var009", 1, 4),
(gt,":var005",0),
(store_mul, ":var010", ":var009", 2),
(val_min,":var010",":var005"),
(val_sub, ":var005", ":var010"),
(store_sub, ":var011", 5, ":var009"),
(store_mul, ":var012", ":var011", ":var010"),
(val_add, ":var004", ":var012"),
(try_end),
(try_begin),
(le,":::g_multiplayer_ccoop_wave_no",3),
(assign,":random_x_002",-1),
(try_end),
(troop_set_slot,"trp_multiplayer_data",186,0),
(troop_set_slot,"trp_multiplayer_data",187,0),
(troop_set_slot,"trp_multiplayer_data",188,0),
(troop_set_slot,"trp_multiplayer_data",189,0),
(troop_set_slot,"trp_multiplayer_data",190,0),
(troop_set_slot,"trp_multiplayer_data",191,0),
(troop_set_slot,"trp_multiplayer_data",192,0),
(troop_set_slot,"trp_multiplayer_data",193,0),
(troop_set_slot,"trp_multiplayer_data",194,0),
(troop_set_slot,"trp_multiplayer_data",195,0),
(troop_set_slot,"trp_multiplayer_data",196,0),
(troop_set_slot,"trp_multiplayer_data",197,0),
(troop_set_slot,"trp_multiplayer_data",198,0),
(troop_set_slot,"trp_multiplayer_data",199,0),
(troop_set_slot,"trp_multiplayer_data",200,0),
(troop_set_slot,"trp_multiplayer_data",201,0),
(store_mul, ":var013", 20, ":var003"),
(val_add, ":var013", 80),
(val_mul, ":var004", ":var013"),
(val_div, ":var004", 100),
(try_begin),
(ge,":::g_mp_coop_king_waves",1),
(val_mul, ":var004", 130),
(val_div, ":var004", 100),
(try_end),
(store_sub, ":var014", "$g_multiplayer_ccoop_wave_no", "$g_mp_coop_last_king_wave"),
(try_begin),
(ge,":var014",10),
(assign,":var015",30),
(else_try),
(ge,":var014",8),
(assign,":var015",24),
(else_try),
(ge,":var014",6),
(assign,":var015",20),
(else_try),
(ge,":var014",4),
(assign,":var015",15),
(else_try),
(ge,":var014",2),
(assign,":var015",10),
(else_try),
(ge,":var014",1),
(assign,":var015",6),
(try_end),
(assign,":var016",0),
(assign,"$g_ccoop_king_troop",-1),
(try_begin),
(ge,":var014",3),
(store_random_in_range,":random_x_017",0,2),
(try_begin),
(this_or_next|ge,":random_x_017",1),
(this_or_next|eq,":var014",3),
(eq,":var014",10),
(val_add, ":::g_mp_coop_lord_waves", 1),
(try_begin),
(eq,1,1),
(store_mod,":var018","$g_mp_coop_lord_waves",5),
(try_begin),
(this_or_next|eq,":var018",0),
(eq,":var014",10),
(gt,":::g_mp_coop_lord_waves",0),
(gt,":var014",1),
(try_begin),
(eq,":::g_multiplayer_team_2_faction","fac_ccoop_all_stars"),
(store_random_in_range,":random_x_019","trp_kingdom_1_lord","trp_knight_1_1"),
(else_try),
(eq,":::g_multiplayer_team_2_faction","fac_outlaws"),
(assign,":var020",1),
(try_for_range, ":var021", 0, 10),
(eq,":var020",1),
(store_random_in_range,":random_x_019","trp_quick_battle_troop_1","trp_quick_battle_troops_end"),
(try_begin),
(neg|troop_slot_eq,":random_x_019",155,2),
(assign,":var020",0),
(try_end),
(try_end),
(try_end),
(try_end),
(else_try),
(try_for_range, ":trp_022", ":trp.kingdom_1_lord", ":trp.knight_1_1"),
(store_troop_faction,":troop_faction_023",":trp_022"),
(try_begin),
(eq,":troop_faction_023",":::g_multiplayer_team_2_faction"),
(assign,":random_x_019",":trp_022"),
(try_end),
(try_end),
(try_end),
(assign,":var016",1),
(assign,"$g_ccoop_king_troop",":random_x_019"),
(try_for_range, ":trp_022", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(troop_set_slot,":trp_022",155,0),
(try_end),
(try_for_range, ":trp_022", ":trp.quick_battle_troop_1", ":trp.quick_battle_troops_end"),
(troop_set_slot,":trp_022",155,0),
(try_end),
(else_try),
(assign,":var016",1),
(try_for_range, ":trp_022", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(neg|troop_slot_eq,":trp_022",155,2),
(troop_set_slot,":trp_022",155,0),
(try_end),
(try_for_range, ":trp_022", ":trp.quick_battle_troop_1", ":trp.quick_battle_troops_end"),
(neg|troop_slot_eq,":trp_022",155,2),
(troop_set_slot,":trp_022",155,0),
(try_end),
(assign,":var024",0),
(try_for_range, ":trp_022", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(store_troop_faction,":troop_faction_023",":trp_022"),
(try_begin),
(this_or_next|eq,":troop_faction_023",":::g_multiplayer_team_2_faction"),
(eq,":::g_multiplayer_team_2_faction","fac_ccoop_all_stars"),
(neg|troop_slot_eq,":trp_022",155,2),
(troop_set_slot,":trp_022",155,1),
(val_add, ":var024", 1),
(try_end),
(try_end),
(try_for_range, ":trp_022", ":trp.quick_battle_troop_1", ":trp.quick_battle_troops_end"),
(store_troop_faction,":troop_faction_023",":trp_022"),
(try_begin),
(this_or_next|eq,":::g_multiplayer_team_2_faction","fac_outlaws"),
(eq,":::g_multiplayer_team_2_faction","fac_ccoop_all_stars"),
(neg|troop_slot_eq,":trp_022",155,2),
(troop_set_slot,":trp_022",155,1),
(val_add, ":var024", 1),
(try_end),
(try_end),
(store_random_in_range,":random_x_025",0,":var024"),
(assign,":var026",0),
(try_for_range, ":trp_022", ":trp.knight_1_1", ":trp.kingdom_1_pretender"),
(troop_slot_eq,":trp_022",155,1),
(assign,reg0,":trp_022"),
(try_begin),
(eq,":var026",":random_x_025"),
(assign,":random_x_019",":trp_022"),
(troop_set_slot,":trp_022",155,2),
(try_end),
(val_add, ":var026", 1),
(try_end),
(try_for_range, ":trp_022", ":trp.quick_battle_troop_1", ":trp.quick_battle_troops_end"),
(troop_slot_eq,":trp_022",155,1),
(assign,reg0,":trp_022"),
(try_begin),
(eq,":var026",":random_x_025"),
(assign,":random_x_019",":trp_022"),
(troop_set_slot,":trp_022",155,2),
(try_end),
(val_add, ":var026", 1),
(try_end),
(try_end),
(troop_set_slot,"trp_multiplayer_data",187,":random_x_019"),
(troop_set_slot,"trp_multiplayer_data",188,1),
(troop_set_slot,"trp_multiplayer_data",189,":random_x_001"),
(troop_get_slot,":troop_slot_027","trp_multiplayer_data",186),
(val_add, ":troop_slot_027", 2),
(troop_set_slot,"trp_multiplayer_data",186,":troop_slot_027"),
(assign,":var028",-1),
(store_troop_faction,":troop_faction_029",":random_x_019"),
(try_begin),
(eq,":::g_multiplayer_team_2_faction","fac_outlaws"),
(assign,":var030","trp_sea_raider_leader"),
(else_try),
(try_for_range, ":trp_022", ":trp.farmer", ":trp.town_walker_1"),
(store_troop_faction,":troop_faction_023",":trp_022"),
(try_begin),
(eq,":troop_faction_023",":troop_faction_029"),
(store_character_level,":character_lvl_031",":trp_022"),
(try_begin),
(gt,":character_lvl_031",":var028"),
(assign,":var028",":character_lvl_031"),
(assign,":var030",":trp_022"),
(try_end),
(try_end),
(try_end),
(try_end),
(troop_set_slot,"trp_multiplayer_data",190,":var030"),
(try_begin),
(eq,":var018",0),
(gt,":::g_mp_coop_lord_waves",0),
(gt,":var014",1),
(assign,":var032",2),
(else_try),
(assign,":var032",1),
(try_end),
(get_max_players, ":max_players"),
(assign,":var033",0),
(try_for_range, ":player_id_007", 0, ":max_players"),
(player_is_active, ":player_id_007"),
(player_get_team_no,  ":team_no_034", ":player_id_007"),
(multiplayer_send_int_to_player, ":player_id_007", 124, "$g_ccoop_king_troop"),
(eq,":team_no_034",0),
(val_add, ":var033", 1),
(try_end),
(try_end),
(val_mul, ":var032", ":var033"),
(troop_set_slot,"trp_multiplayer_data",191,":var032"),
(troop_set_slot,"trp_multiplayer_data",192,":random_x_001"),
(val_add, ":var016", 1),
(try_end),
(assign,":var024",0),
(try_for_range, ":trp_022", ":trp.farmer", ":trp.town_walker_1"),
(troop_set_slot,":trp_022",156,0),
(try_end),
(try_for_range, ":trp_022", ":trp.farmer", ":trp.town_walker_1"),
(neq,":trp_022","trp_mercenaries_end"),
(store_troop_faction,":troop_faction_023",":trp_022"),
(this_or_next|eq,":troop_faction_023",":::g_multiplayer_team_2_faction"),
(eq,":::g_multiplayer_team_2_faction","fac_ccoop_all_stars"),
(store_character_level,":character_lvl_035",":trp_022"),
(le,":character_lvl_035",":var015"),
(troop_set_slot,":trp_022",156,1),
(val_add, ":var024", 1),
(assign,reg0,":random_x_019"),
(display_debug_message,"@{!}used troop no is {reg0}"),
(try_end),
(try_end),
(try_for_range, ":var036", 0, ":var004"),
(assign,reg0,":var036"),
(try_begin),
(neg|troop_slot_eq,"trp_multiplayer_data",199,0),
(store_random_in_range,":random_x_037",":var016",5),
(val_mul, ":random_x_037", 3),
(val_add, ":random_x_037", 187),
(val_add, ":random_x_037", 1),
(troop_get_slot,":troop_slot_038","trp_multiplayer_data",":random_x_037"),
(val_add, ":troop_slot_038", 1),
(troop_set_slot,"trp_multiplayer_data",":random_x_037",":troop_slot_038"),
(else_try),
(store_random_in_range,":random_x_025",0,":var024"),
(assign,":var026",0),
(try_for_range, ":trp_022", ":trp.farmer", ":trp.town_walker_1"),
(troop_slot_eq,":trp_022",156,1),
(try_begin),
(eq,":var026",":random_x_025"),
(assign,":random_x_019",":trp_022"),
(try_end),
(val_add, ":var026", 1),
(try_end),
(try_begin),
(eq,1,1),
(assign,":var039",0),
(try_for_range, ":slot_no_040", 0, 5),
(val_mul, ":slot_no_040", 3),
(val_add, ":slot_no_040", 187),
(troop_get_slot,":troop_slot_041","trp_multiplayer_data",":slot_no_040"),
(try_begin),
(eq,":troop_slot_041",":random_x_019"),
(val_add, ":slot_no_040", 1),
(troop_get_slot,":troop_slot_038","trp_multiplayer_data",":slot_no_040"),
(val_add, ":troop_slot_038", 1),
(troop_set_slot,"trp_multiplayer_data",":slot_no_040",":troop_slot_038"),
(assign,":var039",1),
(try_end),
(try_end),
(try_begin),
(eq,":var039",1),
(else_try),
(assign,":var042",0),
(try_for_range, ":slot_no_040", ":var016", 5),
(neq,":var042",1),
(val_mul, ":slot_no_040", 3),
(val_add, ":slot_no_040", 187),
(troop_get_slot,":troop_slot_041","trp_multiplayer_data",":slot_no_040"),
(try_begin),
(eq,":troop_slot_041",0),
(troop_set_slot,"trp_multiplayer_data",":slot_no_040",":random_x_019"),
(val_add, ":slot_no_040", 1),
(troop_get_slot,":troop_slot_038","trp_multiplayer_data",":slot_no_040"),
(val_add, ":troop_slot_038", 1),
(troop_set_slot,"trp_multiplayer_data",":slot_no_040",":troop_slot_038"),
(troop_get_slot,":troop_slot_027","trp_multiplayer_data",186),
(val_add, ":troop_slot_027", 1),
(troop_set_slot,"trp_multiplayer_data",186,":troop_slot_027"),
(assign,":slot_no_043",":slot_no_040"),
(assign,":var042",1),
(store_random_in_range,":random_x_044",0,2),
(try_begin),
(this_or_next|eq,":random_x_044",0),
(le,":random_x_002",0),
(assign,":random_x_044",":random_x_001"),
(else_try),
(assign,":random_x_044",":random_x_002"),
(try_end),
(try_end),
(try_end),
(val_add, ":slot_no_043", 1),
(troop_set_slot,"trp_multiplayer_data",":slot_no_043",":random_x_044"),
(try_end),
(try_end),
(try_end),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_007", 1, ":max_players"),
(player_is_active, ":player_id_007"),
(call_script, "script_multiplayer_ccoop_send_troop_data_to_client", ":player_id_007"),
(try_end),
(try_end),
]),

("multiplayer_ccoop_calculate_round_duration", [
(try_begin),
(multiplayer_is_server),
(assign,"$g_multiplayer_ccoop_enemy_respawn_secs",300),
(store_sub, ":var001", "$g_multiplayer_ccoop_wave_no", 1),
(val_max,":var001",0),
(store_mod,":var002",":var001",10),
(val_mul, ":var002", 30),
(val_add, ":::g_multiplayer_ccoop_enemy_respawn_secs", ":var002"),
(try_begin),
(gt,":::g_multiplayer_ccoop_wave_no",20),
(val_mul, ":::g_multiplayer_ccoop_enemy_respawn_secs", 2),
(else_try),
(gt,":::g_multiplayer_ccoop_wave_no",10),
(val_mul, ":::g_multiplayer_ccoop_enemy_respawn_secs", 3),
(val_div, ":::g_multiplayer_ccoop_enemy_respawn_secs", 2),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_004", 1, ":max_players"),
(player_is_active, ":player_id_004"),
(assign,reg0,":player_id_004"),
(display_debug_message,"@{!}sending message to {reg0} multiplayer event other event ccoop count down invisible"),
(multiplayer_send_3_int_to_player, ":player_id_004", 48, 4, "$g_multiplayer_ccoop_enemy_respawn_secs", "$g_multiplayer_ccoop_wave_no"),
(try_end),
(try_end),
]),

("multiplayer_ccoop_send_troop_data_to_client", [
(store_script_param, ":player_id_001", 1),
(try_begin),
(eq,1,1),
(troop_get_slot,":troop_slot_002","trp_multiplayer_data",186),
(troop_get_slot,":troop_slot_003","trp_multiplayer_data",187),
(troop_get_slot,":troop_slot_004","trp_multiplayer_data",188),
(multiplayer_send_4_int_to_player, ":player_id_001", 48, 7, ":troop_slot_002", ":troop_slot_003", ":troop_slot_004"),
(troop_get_slot,":troop_slot_002","trp_multiplayer_data",189),
(troop_get_slot,":troop_slot_003","trp_multiplayer_data",190),
(troop_get_slot,":troop_slot_004","trp_multiplayer_data",191),
(multiplayer_send_4_int_to_player, ":player_id_001", 48, 8, ":troop_slot_002", ":troop_slot_003", ":troop_slot_004"),
(troop_get_slot,":troop_slot_002","trp_multiplayer_data",192),
(troop_get_slot,":troop_slot_003","trp_multiplayer_data",193),
(troop_get_slot,":troop_slot_004","trp_multiplayer_data",194),
(multiplayer_send_4_int_to_player, ":player_id_001", 48, 9, ":troop_slot_002", ":troop_slot_003", ":troop_slot_004"),
(troop_get_slot,":troop_slot_002","trp_multiplayer_data",195),
(troop_get_slot,":troop_slot_003","trp_multiplayer_data",196),
(troop_get_slot,":troop_slot_004","trp_multiplayer_data",197),
(multiplayer_send_4_int_to_player, ":player_id_001", 48, 10, ":troop_slot_002", ":troop_slot_003", ":troop_slot_004"),
(troop_get_slot,":troop_slot_002","trp_multiplayer_data",198),
(troop_get_slot,":troop_slot_003","trp_multiplayer_data",199),
(troop_get_slot,":troop_slot_004","trp_multiplayer_data",200),
(multiplayer_send_4_int_to_player, ":player_id_001", 48, 11, ":troop_slot_002", ":troop_slot_003", ":troop_slot_004"),
(troop_get_slot,":troop_slot_002","trp_multiplayer_data",201),
(multiplayer_send_2_int_to_player, ":player_id_001", 48, 12, ":troop_slot_002"),
(try_end),
]),

("multiplayer_ccoop_spawn_wave", [
(store_script_param, ":var001", 1),
(try_begin),
(multiplayer_is_server),
(set_fixed_point_multiplier, 100),
(assign,reg0,":var001"),
(display_debug_message,"@{!}spawn required is: {reg0}"),
(assign,":var002",0),
(try_for_range, ":var003", 0, 5),
(store_mul, ":slot_no_004", ":var003", 3),
(val_add, ":slot_no_004", 188),
(troop_get_slot,":troop_slot_005","trp_multiplayer_data",":slot_no_004"),
(val_add, ":var002", ":troop_slot_005"),
(try_end),
(assign,reg0,":var002"),
(display_debug_message,"@{!}num troops for wave is {reg0}"),
(assign,":var006",0),
(assign,":var007",0),
(try_begin),
(gt,":var002",":var001"),
(store_sub, ":var006", ":var002", ":var001"),
(assign,reg0,":var006"),
(assign,reg1,":var007"),
(display_debug_message,":reduced spawn amount mod is {reg1}""),
(try_end),
(store_current_scene,":cur_scene_008"),
(modify_visitors_at_site,":cur_scene_008"),
(try_for_range, ":var010", 0, 5),
(store_mul, ":slot_no_004", ":var010", 3),
(val_add, ":slot_no_004", 187),
(troop_get_slot,":troop_slot_011","trp_multiplayer_data",":slot_no_004"),
(try_begin),
(gt,":troop_slot_011",0),
(val_add, ":slot_no_004", 1),
(troop_get_slot,":troop_slot_012","trp_multiplayer_data",":slot_no_004"),
(assign,":var013",":troop_slot_012"),
(assign,reg0,":var013"),
(display_debug_message,"@{!}original spawned troop count is {reg0}"),
(val_add, ":slot_no_004", 1),
(troop_get_slot,":troop_slot_014","trp_multiplayer_data",":slot_no_004"),
(val_sub, ":troop_slot_012", ":var006"),
(try_begin),
(lt,":var010",":var007"),
(val_sub, ":troop_slot_012", 1),
(assign,reg0,":var010"),
(assign,reg1,":var007"),
(display_debug_message,"@{!}reducing spawn amount by one"),
(try_end),
(try_end),
(assign,reg0,":var010"),
(assign,reg1,":troop_slot_014"),
(str_store_string,s0,":str_store_troop_name(troop_slot_011)"),
(assign,reg2,":troop_slot_012"),
(display_debug_message,"@{!}spawning bot group {reg0}: {reg2} {s0} from entry point {reg1}"),
(add_visitors_to_current_scene,":troop_slot_014",":troop_slot_011",":troop_slot_012", 1, -1),
(val_add, 0, ":troop_slot_012"), # var009
(val_sub, ":var013", ":troop_slot_012"),
(store_mul, ":slot_no_004", ":var010", 3),
(val_add, ":slot_no_004", 188),
(troop_set_slot,"trp_multiplayer_data",":slot_no_004",":var013"),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_016", 1, ":max_players"),
(player_is_active, ":player_id_016"),
(call_script, "script_multiplayer_ccoop_send_troop_data_to_client", ":player_id_016"),
(try_end),
(try_end),
]),

("multiplayer_ccoop_check_reinforcement", [
(try_begin),
(multiplayer_is_server),
(call_script, "script_multiplayer_ccoop_get_alive_enemy_count"),
(store_sub, ":var001", 100, reg0),
(try_begin),
(ge,":var001",50),
(call_script, "script_multiplayer_ccoop_spawn_wave", ":var001"),
(else_try),
(assign,":var002",0),
(troop_get_slot,":troop_slot_003","trp_multiplayer_data",186),
(try_for_range, ":var004", 0, ":troop_slot_003"),
(store_mul, ":slot_no_005", ":var004", 3),
(val_add, ":slot_no_005", 188),
(troop_get_slot,":troop_slot_006","trp_multiplayer_data",":slot_no_005"),
(val_add, ":var002", ":troop_slot_006"),
(try_end),
(try_begin),
(ge,":var001",":var002"),
(call_script, "script_multiplayer_ccoop_spawn_wave", ":var001"),
(try_end),
(try_end),
(try_end),
]),

("multiplayer_get_balance_dif", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_004", 0, ":max_players"),
(player_is_active, ":player_id_004"),
(player_get_team_no,  ":team_no_005", ":player_id_004"),
(try_begin),
(eq,":team_no_005",0),
(val_add, ":var001", 1),
(else_try),
(eq,":team_no_005",1),
(val_add, ":var002", 1),
(try_end),
(try_end),
(assign,":var006",2),
(store_sub, ":var007", ":var001", ":var002"),
(assign,":var008",0),
(try_begin),
(eq,1,1),
(store_mul, ":var009", "$g_multiplayer_auto_team_balance_limit", -1),
(try_begin),
(le,":var007",":var009"),
(store_div, ":var___x1", ":var007", ":var006"),
(assign,":var008",":var___x1"),
(else_try),
(ge,":var007",":::g_multiplayer_auto_team_balance_limit"),
(store_div, ":var___x1", ":var007", ":var006"),
(assign,":var008",":var___x1"),
(try_end),
(try_end),
(assign,reg0,":var008"),
]),

("multiplayer_server_play_sound_at_position", [
(store_script_param, ":var001", 1),
(try_begin),
(this_or_next|multiplayer_is_server),
(neg|game_in_multiplayer_mode),
(is_between,":var001",0,"snd_sounds_end"),
(try_begin),
(neg|multiplayer_is_dedicated_server),
(play_sound_at_position, ":var001", 60),
(try_end),
(try_begin),
(multiplayer_is_server),
(set_fixed_point_multiplier, 100),
(position_get_x,":pos_x_002",60),
(position_get_y,":pos_y_003",60),
(position_get_z,":pos_z_004",60),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_006", 1, ":max_players"),
(player_is_active, ":player_id_006"),
(multiplayer_send_4_int_to_player, ":player_id_006", 117, ":pos_x_002", ":pos_y_003", ":pos_z_004", ":var001"),
(try_end),
(try_end),
(try_end),
]),

("mp_set_coop_companions", [
(store_script_param, ":player_id_001", 1),
(assign,":slot_no_002",43),
(player_set_slot,":player_id_001",":slot_no_002","$g_presentation_obj_coop_companion_0"),
(val_add, ":slot_no_002", 1),
(player_set_slot,":player_id_001",":slot_no_002","$g_presentation_obj_coop_companion_1"),
(val_add, ":slot_no_002", 1),
(player_set_slot,":player_id_001",":slot_no_002","$g_presentation_obj_coop_companion_class_0"),
(assign,reg0,"$g_presentation_obj_coop_companion_class_0"),
(val_add, ":slot_no_002", 1),
(player_set_slot,":player_id_001",":slot_no_002","$g_presentation_obj_coop_companion_class_1"),
]),

("mp_get_player_alive_troop_count", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":var002", 2),
(player_get_team_no,  ":team_no_003", ":player_id_001"),
(assign,":var004",0),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_get_team, ":agent_team_no_006", ":cur_agent"),
(eq,":team_no_003",":agent_team_no_006"),
(agent_get_troop_id,":troop_id_007", ":cur_agent"),
(eq,":var002",":troop_id_007"),
(agent_get_group, ":agent_group_008", ":cur_agent"),
(eq,":agent_group_008",":player_id_001"),
(val_add, ":var004", 1),
(try_end),
(try_end),
(assign,reg0,":var004"),
]),

("mp_get_player_total_alive_troop_count", [
(store_script_param, ":player_id_001", 1),
(player_get_team_no,  ":team_no_002", ":player_id_001"),
(assign,":var003",0),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_get_team, ":agent_team_no_005", ":cur_agent"),
(agent_get_group, ":agent_group_006", ":cur_agent"),
(eq,":agent_group_006",":player_id_001"),
(eq,":team_no_002",":agent_team_no_005"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(assign,reg0,":var003"),
]),

("multiplayer_spawn_player_bot_squad_at_point", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":var002", 2),
(store_script_param, ":var003", 3),
(try_begin),
(eq,1,1),
(call_script, "script_multiplayer_get_bots_count", ":player_id_001"),
(assign,":var004",reg0),
(try_for_range, ":slot_no_005", 43, 45),
(lt,":var004",2),
(player_get_slot,":player_slot_006",":player_id_001",":slot_no_005"),
(call_script, "script_mp_get_player_alive_troop_count", ":player_id_001", ":player_slot_006"),
(eq,reg0,0),
(call_script, "script_mp_spawn_coop_companion", ":player_id_001", ":player_slot_006", ":slot_no_005", ":var002", ":var003"),
(val_add, ":var004", 1),
(try_end),
(try_end),
(try_end),
]),

("multiplayer_get_spawn_point_close_to_bots", [
(store_script_param, ":player_id_001", 1),
(player_get_team_no,  ":team_no_002", ":player_id_001"),
(assign,":var003",0),
(assign,":var004",0),
(assign,":var005",0),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_get_group, ":agent_group_007", ":cur_agent"),
(agent_get_team, ":agent_team_no_008", ":cur_agent"),
(eq,":agent_group_007",":player_id_001"),
(eq,":agent_team_no_008",":team_no_002"),
(agent_get_position,pos2,":cur_agent"),
(position_get_x,":pos_x_009",2),
(position_get_y,":pos_y_010",2),
(val_add, ":var003", ":pos_x_009"),
(val_add, ":var004", ":pos_y_010"),
(val_add, ":var005", 1),
(try_end),
(try_end),
(try_begin),
(gt,":var005",0),
(val_div, ":var003", ":var005"),
(val_div, ":var004", ":var005"),
(try_end),
(position_set_x,0,":var003"),
(position_set_y,0,":var004"),
(position_set_z,0,0),
(assign,":var011",0),
(assign,":var012",0),
(try_for_range, ":var013", 0, 64),
(entry_point_get_position, pos1, ":var013"),
(position_set_z,1,0),
(get_sq_distance_between_positions_in_meters,":sq_distance_014",0,1),
(le,":sq_distance_014",1500),
(val_max,":sq_distance_014",1),
(store_mul, ":var015", 1500, 1000),
(val_div, ":var015", ":sq_distance_014"),
(gt,":var015",":var011"),
(assign,":var012",":var013"),
(assign,":var011",":var015"),
(try_end),
(assign,reg0,":var012"),
]),

("multiplayer_get_spawn_point_close_to_player", [
(store_script_param, ":player_id_001", 1),
(player_get_agent_id, ":agent_id_002", ":player_id_001"),
(position_set_x,0,0),
(position_set_y,0,0),
(try_begin),
(agent_is_alive,":agent_id_002"),
(agent_get_position,pos0,":agent_id_002"),
(try_end),
(position_set_z,0,0),
(assign,":var003",0),
(assign,":var004",0),
(try_for_range, ":var005", 0, 64),
(entry_point_get_position, pos1, ":var005"),
(position_set_z,1,0),
(get_sq_distance_between_positions_in_meters,":sq_distance_006",0,1),
(le,":sq_distance_006",1500),
(val_max,":sq_distance_006",1),
(store_mul, ":var007", 1500, 1000),
(val_div, ":var007", ":sq_distance_006"),
(gt,":var007",":var003"),
(assign,":var004",":var005"),
(assign,":var003",":var007"),
(try_end),
(assign,reg0,":var004"),
]),

("multiplayer_get_bots_count", [
(store_script_param, ":player_id_001", 1),
(player_get_team_no,  ":team_no_002", ":player_id_001"),
(assign,":var003",0),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_get_group, ":agent_group_005", ":cur_agent"),
(agent_get_team, ":agent_team_no_006", ":cur_agent"),
(eq,":agent_group_005",":player_id_001"),
(eq,":agent_team_no_006",":team_no_002"),
(val_add, ":var003", 1),
(try_end),
(try_end),
(assign,reg0,":var003"),
]),

("multiplayer_get_selected_squad_slot_id", [
(store_script_param, ":player_id_001", 1),
(assign,":var002",35),
(try_for_range, ":slot_no_003", 35, 39),
(player_get_slot,":player_slot_004",":player_id_001",":slot_no_003"),
(try_begin),
(eq,":player_slot_004",1),
(assign,":var002",":slot_no_003"),
(try_end),
(try_end),
(assign,reg0,":var002"),
]),

("cf_multiplayer_event_team_change", [
(store_script_param, ":player_id_001", 1),
(try_begin),
(eq,":::g_multiplayer_is_game_type_captain",1),
(player_get_team_no,  ":team_no_002", ":player_id_001"),
(try_for_agents, ":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_get_group, ":agent_group_004", ":cur_agent"),
(agent_get_team, ":agent_team_no_005", ":cur_agent"),
(eq,":agent_group_004",":player_id_001"),
(eq,":agent_team_no_005",":team_no_002"),
(remove_agent, ":cur_agent"),
(try_end),
(try_end),
(try_end),
]),

("team_get_attack_readying_ranged_agent_percentage", [
(store_script_param, ":var001", 1),
(store_script_param, ":var002", 2),
(assign,":var003",0),
(assign,":var004",0),
(try_for_agents, ":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_get_team, ":agent_team_no_006", ":cur_agent"),
(assign,":var007",0),
(try_begin),
(eq,":var002",1),
(teams_are_enemies, ":agent_team_no_006", ":var001"),
(assign,":var007",1),
(else_try),
(eq,":agent_team_no_006",":var001"),
(assign,":var007",1),
(try_end),
(eq,":var007",1),
(agent_get_combat_state, ":agent_combat_state_008", ":cur_agent"),
(agent_get_wielded_item,":agent_wieled_item_009",":cur_agent",0),
(is_between,":agent_wieled_item_009","itm_darts","itm_torch"),
(val_add, ":var003", 1),
(eq,":agent_combat_state_008",1),
(val_add, ":var004", 1),
(try_end),
(try_begin),
(eq,":var003",0),
(assign,":var003",1),
(try_end),
(store_mul, ":var010", ":var004", 100),
(val_div, ":var010", ":var003"),
(assign,reg0,":var010"),
]),

("multiplayer_get_requested_squad_count", [
(store_script_param, ":player_id_001", 1),
(assign,":var002",0),
(try_for_range, ":slot_no_003", 43, 45),
(player_get_slot,":player_slot_004",":player_id_001",":slot_no_003"),
(val_add, ":var002", ":player_slot_004"),
(try_end),
(assign,reg0,":var002"),
]),

("multiplayer_update_cost_labels", [
(multiplayer_get_my_player, ":my_player"),
(player_get_gold, ":gold_002", ":my_player"),
(call_script, "script_multiplayer_calculate_cur_selected_items_cost", ":my_player", 1),
(overlay_set_text, "$g_presentation_obj_item_select_12", "str_total_item_cost_reg0"),
(try_begin),
(ge,":gold_002",reg0),
(overlay_set_color, "$g_presentation_obj_item_select_12", 16777215),
(else_try),
(overlay_set_color, "$g_presentation_obj_item_select_12", 16711680),
(try_end),
]),

("multiplayer_ccoop_give_round_bonus_gold", [
(try_begin),
(gt,":::g_multiplayer_ccoop_wave_no",0),
(store_mul, ":var001", "$g_multiplayer_ccoop_wave_no", 100),
(val_add, ":var001", 400),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_003", 0, ":max_players"),
(player_is_active, ":player_id_003"),
(player_get_gold, ":gold_004", ":player_id_003"),
(val_add, ":gold_004", ":var001"),
(player_set_gold, ":player_id_003", ":gold_004", 15000),
(try_end),
(try_end),
]),

("multiplayer_ccoop_destroy_prison_cart", [
(try_begin),
(multiplayer_is_server),
(try_begin),
(multiplayer_is_dedicated_server),
(assign,"$g_prison_cart_previous_point","$g_prison_cart_point"),
(assign,"$g_prison_cart_point",0),
(scene_prop_get_instance, ":scp_instance_001", "spr_prison_cart", 0),
(scene_prop_get_instance, ":scp_instance_002", "spr_prison_cart_door_left", 0),
(scene_prop_get_instance, ":scp_instance_003", "spr_prison_cart_door_right", 0),
(set_fixed_point_multiplier, 100),
(prop_instance_get_position, pos1, ":scp_instance_001"),
(position_set_z,1,-4000),
(prop_instance_set_position, ":scp_instance_001", 1),
(prop_instance_set_position, ":scp_instance_002", 1),
(prop_instance_set_position, ":scp_instance_003", 1),
(try_end),
(display_debug_message,"@{!}destroy prison cart"),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 0, ":max_players"),
(player_is_active, ":player_id_005"),
(multiplayer_send_int_to_player, ":player_id_005", 48, 6),
(try_end),
(try_end),
]),

("multiplayer_ccoop_spawn_prison_cart", [
(try_begin),
(multiplayer_is_server),
(store_random_in_range,"$g_prison_cart_point",70,75),
(assign,reg0,"$g_prison_cart_point"),
(display_debug_message,"@{!}spawning prison cart at point {reg0}"),
(set_fixed_point_multiplier, 100),
(scene_prop_get_instance, ":scp_instance_001", "spr_prison_cart", 0),
(entry_point_get_position, pos1, "$g_prison_cart_point"),
(position_move_y,1,-400),
(position_set_z_to_ground_level, 1),
(prop_instance_set_position, ":scp_instance_001", 1),
(scene_prop_get_instance, ":scp_instance_002", "spr_prison_cart_door_left", 0),
(init_position,2),
(position_set_x,2,84),
(position_set_y,2,-314),
(position_set_z,2,121),
(position_transform_position_to_parent,3,1,2),
(prop_instance_set_position, ":scp_instance_002", 3),
(scene_prop_set_hit_points, ":scp_instance_002", 300),
(scene_prop_get_instance, ":scp_instance_003", "spr_prison_cart_door_right", 0),
(init_position,2),
(position_set_x,2,-84),
(position_set_y,2,-315),
(position_set_z,2,123),
(position_transform_position_to_parent,3,1,2),
(prop_instance_set_position, ":scp_instance_003", 3),
(scene_prop_set_hit_points, ":scp_instance_003", 300),
(try_begin),
(eq,1,1),
(call_script, "script_multiplayer_ccoop_set_prison_cart_visibility", 1),
(get_player_agent_no,":agent_no_004"),
(try_begin),
(ge,":agent_no_004",0),
(display_message, "str_prison_cart_hint"),
(start_presentation, ":"),
(try_end),
(try_end),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_006", 1, ":max_players"),
(player_is_active, ":player_id_006"),
(multiplayer_send_3_int_to_player, ":player_id_006", 48, 5, "$g_prison_cart_point", 300),
(try_end),
(try_end),
]),

("multiplayer_ccoop_get_alive_enemy_count", [
(assign,":var001",0),
(try_for_agents, ":cur_agent"),
(agent_is_active,":cur_agent"),
(agent_is_human,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_get_team, ":agent_team_no_003", ":cur_agent"),
(eq,":agent_team_no_003",1),
(val_add, ":var001", 1),
(try_end),
(try_end),
(assign,reg0,":var001"),
]),

("add_troop_to_cur_tableau_for_multiplayer", [
(store_script_param, ":troop_id_001", 1),
(set_fixed_point_multiplier, 100),
(cur_tableau_clear_override_items),
(cur_tableau_set_override_flags, 512),
(init_position,2),
(cur_tableau_set_camera_parameters, 1, 8, 8, 10, 10000),
(init_position,5),
(assign,":var002",300),
(assign,":var003",1000),
(assign,":var004",-15),
(assign,":var005",-18),
(assign,":var006",1),
(troop_get_inventory_slot,":troop_inv_slot_007",":troop_id_001",8),
(try_begin),
(gt,":troop_inv_slot_007",0),
(cur_tableau_add_horse, ":troop_inv_slot_007", 2, "anim_horse_stand"),
(assign,":var006","anim_ride_0"),
(assign,":var005",-20),
(assign,":var004",-25),
(assign,":var002",500),
(assign,":var003",1400),
(position_move_x,5,50,0),
(try_end),
(position_set_z,5,":var002"),
(position_rotate_x,5,-90),
(position_rotate_z,5,180),
(position_rotate_y,5,":var004"),
(position_rotate_x,5,":var005"),
(position_move_z,5,":var003",0),
(position_move_x,5,-120,0),
(position_move_y,5,130,0),
(try_begin),
(troop_is_hero,":troop_id_001"),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var006", -1),
(else_try),
(store_mul, ":var008", ":troop_id_001", 126233),
(val_mod, ":var008", 1000),
(val_add, ":var008", 1),
(cur_tableau_add_troop, ":troop_id_001", 2, ":var006", ":var008"),
(try_end),
(cur_tableau_set_camera_position, 5),
(copy_position,8,5),
(position_rotate_x,8,-90),
(position_rotate_z,8,30),
(position_rotate_x,8,-60),
(cur_tableau_add_sun_light, 0, 8, 175, 150, 125),
]),

("mp_set_player_troop_id", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(store_script_param, ":var003", 3),
(player_set_troop_id, ":player_id_001", ":troop_id_002"),
(try_begin),
(eq,":troop_id_002",-1),
(call_script, "script_multiplayer_clear_player_selected_items", ":player_id_001"),
(else_try),
(call_script, "script_multiplayer_set_default_item_selections_for_troop", ":player_id_001", ":troop_id_002"),
(try_end),
(try_begin),
(neq,":var003",0),
(multiplayer_send_int_to_server, 20, ":troop_id_002"),
(try_end),
]),

("mp_set_player_team_no", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":team_no_002", 2),
(store_script_param, ":var003", 3),
(player_get_team_no,  ":player_id_001", ":team_no_002"),
(try_begin),
(neq,":var003",0),
(multiplayer_send_int_to_server, 19, ":team_no_002"),
(try_end),
(call_script, "script_mp_set_player_troop_id", ":player_id_001", -1, 0),
]),

("multiplayer_ccoop_set_prison_cart_visibility", [
(store_script_param, ":var001", 1),
(set_fixed_point_multiplier, 100),
(try_begin),
(eq,1,1),
(scene_prop_get_instance, ":scp_instance_002", "spr_prison_cart", 0),
(scene_prop_get_instance, ":scp_instance_003", "spr_prison_cart_door_left", 0),
(scene_prop_get_instance, ":scp_instance_004", "spr_prison_cart_door_right", 0),
(try_begin),
(eq,":var001",0),
(scene_prop_fade_out, ":scp_instance_002", 400),
(scene_prop_fade_out, ":scp_instance_003", 400),
(scene_prop_fade_out, ":scp_instance_004", 400),
(prop_instance_enable_physics, ":scp_instance_002", 0),
(prop_instance_enable_physics, ":scp_instance_003", 0),
(prop_instance_enable_physics, ":scp_instance_004", 0),
(store_mission_timer_a,"$g_multiplayer_ccoop_move_prison_cart"),
(val_add, ":::g_multiplayer_ccoop_move_prison_cart", 5),
(assign,"$g_prison_cart_previous_point","$g_prison_cart_point"),
(assign,"$g_prison_cart_point",0),
(else_try),
(gt,":var001",0),
(scene_prop_fade_in, ":scp_instance_002", 300),
(scene_prop_fade_in, ":scp_instance_003", 300),
(scene_prop_fade_in, ":scp_instance_004", 300),
(prop_instance_enable_physics, ":scp_instance_002", 1),
(prop_instance_enable_physics, ":scp_instance_003", 1),
(prop_instance_enable_physics, ":scp_instance_004", 1),
(try_end),
(try_end),
]),

("multiplayer_ccoop_spawn_player_and_bots", [
(store_script_param, ":player_id_001", 1),
(try_begin),
(neg|player_is_busy_with_menus, ":player_id_001"),
(player_get_team_no,  ":team_no_002", ":player_id_001"),
(try_begin),
(lt,":team_no_002",2),
(player_get_troop_id, ":troop_id_003", ":player_id_001"),
(try_begin),
(ge,":troop_id_003",0),
(call_script, "script_multiplayer_buy_agent_equipment", ":player_id_001"),
(troop_get_inventory_slot,":troop_inv_slot_004",":troop_id_003",8),
(try_begin),
(ge,":troop_inv_slot_004",0),
(assign,":var005",1),
(else_try),
(assign,":var005",0),
(try_end),
(try_end),
(try_end),
(call_script, "script_multiplayer_get_bots_count", ":player_id_001"),
(assign,":var006",reg0),
(try_begin),
(gt,":::g_multiplayer_ccoop_enemy_respawn_secs",31),
(assign,reg0,"$g_prison_cart_previous_point"),
(display_debug_message,"@{!}prison cart spawn at point {reg0}"),
(player_spawn_new_agent, ":player_id_001", "$g_prison_cart_previous_point"),
(call_script, "script_multiplayer_spawn_player_bot_squad_at_point", ":player_id_001", ":team_no_002", "$g_prison_cart_previous_point"),
(else_try),
(try_begin),
(gt,":var006",0),
(call_script, "script_multiplayer_get_spawn_point_close_to_bots", ":player_id_001"),
(player_spawn_new_agent, ":player_id_001", reg0),
(call_script, "script_multiplayer_get_spawn_point_close_to_bots", ":player_id_001"),
(call_script, "script_multiplayer_spawn_player_bot_squad_at_point", ":player_id_001", ":team_no_002", reg0),
(else_try),
(call_script, "script_multiplayer_find_spawn_point", ":team_no_002", 1, ":var005"),
(assign,":entry_point_007",reg0),
(player_spawn_new_agent, ":player_id_001", ":entry_point_007"),
(call_script, "script_multiplayer_spawn_player_bot_squad_at_point", ":player_id_001", ":team_no_002", ":entry_point_007"),
(try_end),
(try_end),
(eq,1,1),
(player_get_slot,":player_slot_008",":player_id_001",24),
(try_begin),
(gt,":player_slot_008",0),
(player_set_slot,":player_id_001",24,0),
(try_end),
(try_end),
(assign,reg0,1),
(else_try),
(assign,reg0,0),
]),

("multiplayer_set_g_multiplayer_is_game_type_captain", [
(try_begin),
(eq,":::g_multiplayer_game_type",8),
(assign,"$g_multiplayer_is_game_type_captain",1),
(else_try),
(assign,"$g_multiplayer_is_game_type_captain",0),
(try_end),
]),

("cf_multiplayer_can_buy_squad", [
(try_begin),
(eq,":::g_multiplayer_is_game_type_captain",1),
(assign,0,1), # var001
(try_end),
]),

("avarage_of_two_points", [
(position_get_x,":pos_x_001",1),
(position_get_x,":pos_x_002",2),
(val_add, ":pos_x_001", ":pos_x_002"),
(val_div, ":pos_x_001", 2),
(position_set_x,1,":pos_x_001"),
(position_get_y,":pos_y_003",1),
(position_get_y,":pos_y_004",2),
(val_add, ":pos_y_003", ":pos_y_004"),
(val_div, ":pos_y_003", 2),
(position_set_y,1,":pos_y_003"),
(position_get_z,":pos_z_005",1),
(position_get_z,":pos_z_006",2),
(val_add, ":pos_z_005", ":pos_z_006"),
(val_div, ":pos_z_005", 2),
(position_set_z,1,":pos_z_005"),
]),

("multiplayer_ccoop_start_player_and_squad_respawn_period", [
(store_script_param, "$g_multiplayer_ccoop_spawn_alive_player_squad_and_minus_one_first_spawn_slots_and_minus_one_first_spawn_slots", 1),
(try_begin),
(multiplayer_is_server),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_002", 0, ":max_players"),
(player_is_active, ":player_id_002"),
(try_begin),
(eq,":::g_multiplayer_ccoop_spawn_alive_player_squad_and_minus_one_first_spawn_slots_and_minus_one_first_spawn_slots",1),
(player_set_slot,":player_id_002",24,1),
(else_try),
(player_get_slot,":player_slot_003",":player_id_002",24),
(try_begin),
(ge,":player_slot_003",0),
(player_set_slot,":player_id_002",24,1),
(try_end),
(try_end),
(try_end),
(assign,"$g_multiplayer_ccoop_spawn_player_and_squad_counter",30),
(try_end),
]),

("multiplayer_upgrade_player_equipment", [
(store_script_param, ":player_id_001", 1),
(assign,reg0,":player_id_001"),
(display_debug_message,"@{!}multiplayer upgrade player equipment: {reg0}"),
(player_get_troop_id, ":troop_id_002", ":player_id_001"),
(player_get_agent_id, ":agent_id_003", ":player_id_001"),
(player_get_gold, ":gold_004", ":player_id_001"),
(try_for_range, ":var005", 0, 8),
(store_add, ":slot_no_006", ":var005", 11),
(store_add, ":slot_no_007", ":var005", 2),
(player_get_slot,":player_slot_008",":player_id_001",":slot_no_007"),
(agent_get_item_slot, ":agent_item_slot_009", ":agent_id_003", ":var005"),
(try_begin),
(this_or_next|ge,":player_slot_008",0),
(this_or_next|is_between,":agent_item_slot_009","itm_javelin_bow","itm_ccoop_new_items_end"),
(player_item_slot_is_picked_up, ":player_id_001", ":var005"),
(player_set_slot,":player_id_001",":slot_no_006",-1),
(else_try),
(player_set_slot,":player_id_001",":slot_no_006",":agent_item_slot_009"),
(try_end),
(try_end),
(player_set_slot,":player_id_001",19,-1),
(call_script, "script_multiplayer_calculate_cur_selected_items_cost", ":player_id_001", 0),
(assign,":var010",reg0),
(val_add, ":gold_004", ":var010"),
(try_for_range, ":slot_no_011", 2, 11),
(player_get_slot,":player_slot_012",":player_id_001",":slot_no_011"),
(store_sub, ":slot_no_013", ":slot_no_011", 2),
(agent_get_item_slot, ":agent_item_slot_009", ":agent_id_003", ":slot_no_013"),
(try_begin),
(this_or_next|ge,":player_slot_012",0),
(this_or_next|player_item_slot_is_picked_up, ":player_id_001", ":slot_no_013"),
(this_or_next|is_between,":agent_item_slot_009","itm_javelin_bow","itm_ccoop_new_items_end"),
(eq,":slot_no_013",8),
(assign,":player_slot_012",-1),
(try_end),
(val_add, ":slot_no_013", 11),
(player_set_slot,":player_id_001",":slot_no_013",":player_slot_012"),
(try_end),
(assign,":var014",1000),
(try_for_range, ":var015", 0, ":var014"),
(call_script, "script_multiplayer_calculate_cur_selected_items_cost", ":player_id_001", 0),
(assign,":var016",reg0),
(try_begin),
(gt,":var016",":gold_004"),
(call_script, "script_multiplayer_get_troop_class", ":troop_id_002"),
(assign,":var017",reg0),
(assign,":var018",0),
(assign,":slot_no_019",-1),
(try_for_range, ":slot_no_011", 11, 20),
(player_get_slot,":player_slot_020",":player_id_001",":slot_no_011"),
(try_begin),
(ge,":player_slot_020",0),
(call_script, "script_multiplayer_get_item_value_for_troop", ":player_slot_020", ":troop_id_002"),
(assign,":var021",reg0),
(store_sub, ":var022", ":slot_no_011", 11),
(try_begin),
(this_or_next|eq,":var022",3),
(this_or_next|eq,":var022",2),
(this_or_next|eq,":var022",1),
(eq,":var022",0),
(val_mul, ":var021", 5),
(else_try),
(eq,":var022",4),
(val_mul, ":var021", 4),
(else_try),
(eq,":var022",5),
(val_mul, ":var021", 2),
(else_try),
(eq,":var022",6),
(val_mul, ":var021", 8),
(else_try),
(eq,":var022",7),
(val_mul, ":var021", 8),
(else_try),
(try_end),
(try_end),
(item_get_slot,":item_slot_023",":player_slot_020",60),
(try_begin),
(eq,":var017",1),
(this_or_next|eq,":item_slot_023",1),
(this_or_next|eq,":item_slot_023",2),
(this_or_next|eq,":item_slot_023",3),
(this_or_next|eq,":item_slot_023",4),
(this_or_next|eq,":item_slot_023",6),
(this_or_next|eq,":item_slot_023",10),
(eq,":item_slot_023",7),
(val_div, ":var021", 2),
(else_try),
(eq,":var017",2),
(this_or_next|eq,":item_slot_023",8),
(eq,":item_slot_023",11),
(val_div, ":var021", 2),
(else_try),
(eq,":var017",3),
(this_or_next|eq,":item_slot_023",9),
(this_or_next|eq,":item_slot_023",1),
(eq,":item_slot_023",18),
(val_div, ":var021", 2),
(else_try),
(eq,":var017",4),
(this_or_next|eq,":item_slot_023",12),
(eq,":item_slot_023",14),
(val_div, ":var021", 2),
(else_try),
(eq,":var017",5),
(this_or_next|eq,":item_slot_023",13),
(eq,":item_slot_023",15),
(val_div, ":var021", 2),
(else_try),
(eq,":var017",6),
(this_or_next|eq,":item_slot_023",12),
(this_or_next|eq,":item_slot_023",14),
(eq,":item_slot_023",18),
(val_div, ":var021", 2),
(else_try),
(eq,":var017",7),
(this_or_next|eq,":item_slot_023",13),
(this_or_next|eq,":item_slot_023",15),
(eq,":item_slot_023",18),
(val_div, ":var021", 2),
(try_end),
(try_begin),
(gt,":var021",":var018"),
(assign,":var018",":var021"),
(assign,":slot_no_019",":slot_no_011"),
(try_end),
(try_end),
(player_get_slot,":player_slot_020",":player_id_001",":slot_no_019"),
(call_script, "script_multiplayer_get_previous_item_for_item_and_troop", ":player_slot_020", ":troop_id_002"),
(assign,":player_slot_020",reg0),
(player_set_slot,":player_id_001",":slot_no_019",":player_slot_020"),
(else_try),
(assign,":var014",0),
(assign,":var016",reg0),
(val_sub, ":gold_004", ":var016"),
(player_set_gold, ":player_id_001", ":gold_004", 15000),
(try_for_range, ":slot_no_011", 11, 20),
(player_get_slot,":player_slot_020",":player_id_001",":slot_no_011"),
(try_begin),
(ge,":player_slot_020",0),
(store_sub, ":var024", ":slot_no_011", 11),
(agent_get_item_slot, ":agent_item_slot_009", ":agent_id_003", ":var024"),
(try_begin),
(neq,":agent_item_slot_009",":player_slot_020"),
(neg|is_between,":agent_item_slot_009","itm_javelin_bow","itm_ccoop_new_items_end"),
(get_max_players, ":max_players"),
(try_begin),
(ge,":agent_item_slot_009",0),
(agent_unequip_item, ":agent_id_003", ":agent_item_slot_009", ":var024"),
(try_for_range, ":player_id_026", 1, ":max_players"),
(player_is_active, ":player_id_026"),
(multiplayer_send_4_int_to_player, ":player_id_026", 48, 15, ":agent_id_003", ":agent_item_slot_009", ":var024"),
(try_end),
(try_end),
(try_end),
(agent_equip_item, ":agent_id_003", ":player_slot_020"),
(try_for_range, ":player_id_026", 1, ":max_players"),
(player_is_active, ":player_id_026"),
(multiplayer_send_3_int_to_player, ":player_id_026", 48, 16, ":agent_id_003", ":player_slot_020"),
(try_end),
(try_end),
(try_end),
(player_set_slot,":player_id_001",27,":var016"),
(try_end),
(try_end),
]),

("cf_multiplayer_upgrade_companion_equipment", [
(store_script_param, ":var001", 1),
(agent_get_group, ":agent_group_002", ":var001"),
(try_begin),
(player_is_active, ":agent_group_002"),
(agent_get_troop_id,":troop_id_003", ":var001"),
(assign,":var004",0),
(try_for_range, ":slot_no_005", 43, 45),
(player_get_slot,":player_slot_006",":agent_group_002",":slot_no_005"),
(eq,":troop_id_003",":player_slot_006"),
(assign,":var004",1),
(val_sub, ":slot_no_005", 43),
(val_add, ":slot_no_005", 47),
(player_get_slot,":player_slot_007",":agent_group_002",":slot_no_005"),
(val_sub, ":slot_no_005", 47),
(val_add, ":slot_no_005", 45),
(player_get_slot,":player_slot_008",":agent_group_002",":slot_no_005"),
(try_end),
(try_end),
(try_begin),
(eq,":var004",1),
(try_begin),
(is_between,":player_slot_008","trp_swadian_crossbowman_multiplayer_coop_tier_1","trp_coop_faction_troop_templates_end"),
(assign,":var009",18),
(else_try),
(assign,":var009",16),
(try_end),
(try_end),
(try_begin),
(lt,":player_slot_007",3),
(store_mul, ":var010", ":player_slot_007", ":var009"),
(val_add, ":player_slot_008", ":var010"),
(else_try),
(store_mul, ":var010", 3, ":var009"),
(val_add, ":player_slot_008", ":var010"),
(try_end),
(assign,":var011",0),
(assign,":var012",0),
(troop_equip_items,":player_slot_008"),
(get_max_players, ":max_players"),
(try_for_range, ":slot_no_005", 0, 4),
(agent_get_item_slot, ":agent_item_slot_014", ":var001", ":slot_no_005"),
(try_begin),
(ge,":agent_item_slot_014",0),
(try_begin),
(is_between,":agent_item_slot_014","itm_javelin_bow","itm_ccoop_new_items_end"),
(item_get_type, ":item_type_015", ":agent_item_slot_014"),
(try_begin),
(this_or_next|eq,":item_type_015",4),
(this_or_next|eq,":item_type_015",3),
(eq,":item_type_015",2),
(assign,":var011",1),
(else_try),
(this_or_next|eq,":item_type_015",10),
(this_or_next|eq,":item_type_015",9),
(eq,":item_type_015",8),
(assign,":var012",1),
(try_end),
(try_end),
(else_try),
(agent_unequip_item, ":var001", ":agent_item_slot_014", ":slot_no_005"),
(try_for_range, ":player_id_016", 1, ":max_players"),
(player_is_active, ":player_id_016"),
(multiplayer_send_4_int_to_player, ":player_id_016", 48, 15, ":var001", ":agent_item_slot_014", ":slot_no_005"),
(try_end),
(try_end),
(try_end),
(try_for_range, ":slot_no_005", 0, 9),
(troop_get_inventory_slot,":troop_inv_slot_017",":player_slot_008",":slot_no_005"),
(try_begin),
(gt,":troop_inv_slot_017",0),
(item_get_type, ":item_type_018", ":troop_inv_slot_017"),
(try_begin),
(is_between,":item_type_018",12,16),
(assign,":var019",0),
(try_for_range, ":var020", 4, 8),
(agent_get_item_slot, ":agent_item_slot_021", ":var001", ":var020"),
(try_begin),
(ge,":agent_item_slot_021",0),
(item_get_type, ":item_type_022", ":agent_item_slot_021"),
(eq,":item_type_018",":item_type_022"),
(assign,":var019",1),
(neq,":agent_item_slot_021",":troop_inv_slot_017"),
(neg|is_between,":agent_item_slot_021","itm_javelin_bow","itm_ccoop_new_items_end"),
(agent_unequip_item, ":var001", ":agent_item_slot_021", ":var020"),
(try_for_range, ":player_id_016", 1, ":max_players"),
(player_is_active, ":player_id_016"),
(multiplayer_send_4_int_to_player, ":player_id_016", 48, 15, ":var001", ":agent_item_slot_021", ":var020"),
(try_end),
(try_end),
(try_end),
(agent_equip_item, ":var001", ":troop_inv_slot_017"),
(try_for_range, ":player_id_016", 1, ":max_players"),
(player_is_active, ":player_id_016"),
(multiplayer_send_3_int_to_player, ":player_id_016", 48, 16, ":var001", ":troop_inv_slot_017"),
(try_end),
(try_end),
(eq,":var019",0),
(agent_equip_item, ":var001", ":troop_inv_slot_017"),
(try_for_range, ":player_id_016", 1, ":max_players"),
(player_is_active, ":player_id_016"),
(multiplayer_send_3_int_to_player, ":player_id_016", 48, 16, ":var001", ":troop_inv_slot_017"),
(try_end),
(try_end),
(else_try),
(assign,":var023",0),
(try_begin),
(this_or_next|eq,":item_type_018",2),
(this_or_next|eq,":item_type_018",3),
(this_or_next|eq,":item_type_018",7),
(eq,":item_type_018",4),
(eq,":var011",0),
(assign,":var023",1),
(else_try),
(this_or_next|eq,":item_type_018",8),
(this_or_next|eq,":item_type_018",9),
(this_or_next|eq,":item_type_018",10),
(this_or_next|eq,":item_type_018",6),
(eq,":item_type_018",5),
(eq,":var012",0),
(assign,":var023",1),
(try_end),
(try_begin),
(eq,":var023",1),
(agent_equip_item, ":var001", ":troop_inv_slot_017"),
(try_for_range, ":player_id_016", 1, ":max_players"),
(player_is_active, ":player_id_016"),
(multiplayer_send_3_int_to_player, ":player_id_016", 48, 16, ":var001", ":troop_inv_slot_017"),
(try_end),
(try_end),
(try_end),
]),

("mp_spawn_coop_companion", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":troop_id_002", 2),
(store_script_param, ":slot_no_003", 3),
(store_script_param, ":team_no_004", 4),
(store_script_param, ":entry_no_005", 5),
(troop_equip_items,":troop_id_002"),
(val_add, ":slot_no_003", 2),
(player_get_slot,":player_slot_006",":player_id_001",":slot_no_003"),
(assign,":var007",0),
(try_for_range, ":inventory_slot_no_008", 0, 9),
(eq,":var007",0),
(troop_get_inventory_slot,":troop_inv_slot_009",":player_slot_006",":inventory_slot_no_008"),
(gt,":troop_inv_slot_009",0),
(item_get_type, ":item_type_010", ":troop_inv_slot_009"),
(eq,":item_type_010",1),
(assign,":var007",1),
(try_end),
(try_end),
(store_current_scene,":cur_scene_011"),
(scene_get_slot,":scene_slot_012",":cur_scene_011",1),
(try_for_range, ":inventory_slot_no_008", 0, 9),
(troop_get_inventory_slot,":troop_inv_slot_009",":troop_id_002",":inventory_slot_no_008"),
(try_begin),
(ge,":troop_inv_slot_009",0),
(item_get_type, ":item_type_010", ":troop_inv_slot_009"),
(troop_remove_item,":troop_id_002",":troop_inv_slot_009"),
(try_begin),
(eq,":item_type_010",1),
(troop_set_slot,":troop_id_002",155,":troop_inv_slot_009"),
(else_try),
(val_add, ":inventory_slot_no_008", 202),
(troop_set_slot,"trp_multiplayer_data",":inventory_slot_no_008",":troop_inv_slot_009"),
(try_end),
(try_end),
(try_end),
(troop_clear_inventory,":troop_id_002"),
(try_for_range, ":inventory_slot_no_008", 202, 211),
(troop_get_slot,":troop_inv_slot_009","trp_multiplayer_data",":inventory_slot_no_008"),
(try_begin),
(gt,":troop_inv_slot_009",0),
(troop_add_item,":troop_id_002",":troop_inv_slot_009"),
(try_end),
(try_end),
(try_begin),
(eq,":scene_slot_012",0),
(eq,":var007",1),
(troop_get_slot,":troop_slot_013",":troop_id_002",155),
(troop_add_item,":troop_id_002",":troop_slot_013"),
(troop_set_slot,":troop_id_002",155,-1),
(try_end),
(troop_equip_items,":troop_id_002"),
(modify_visitors_at_site,":cur_scene_011"),
(add_visitors_to_current_scene,":entry_no_005",":troop_id_002",1, ":team_no_004", ":player_id_001"),
]),

("coop_generate_item_drop", [
(store_script_param, ":player_id_001", 1),
(store_random_in_range,"$g_ccoop_currently_dropping_item","itm_javelin_bow","itm_javelin_bow_ammo"),
(player_set_slot,":player_id_001",49,"$g_ccoop_currently_dropping_item"),
]),

("coop_drop_item", [
(store_script_param, ":reg0", 1),
(store_script_param, ":reg1", 2),
(store_script_param, ":reg2", 3),
(start_presentation, ":"),
]),

("cf_coop_give_item_to_assigned_group_member", [
(store_script_param, ":player_id_001", 1),
(store_script_param, ":agent_id_002", 2),
(try_begin),
(player_is_active, ":player_id_001"),
(assign,":var003",0),
(assign,":var004",0),
(player_get_slot,":player_slot_005",":player_id_001",49),
(try_begin),
(ge,":player_slot_005",0),
(try_begin),
(eq,":agent_id_002",0),
(player_get_agent_id, ":agent_id_002", ":player_id_001"),
(assign,":agent_group_006",":player_id_001"),
(try_begin),
(agent_is_active,":agent_id_002"),
(agent_is_alive,":agent_id_002"),
(assign,":var007",0),
(item_get_slot,":item_slot_008",":player_slot_005",59),
(val_add, ":item_slot_008", 1),
(try_for_range, ":var009", 0, 4),
(agent_get_item_slot, ":agent_item_slot_010", ":agent_id_002", ":var009"),
(ge,":agent_item_slot_010",0),
(val_add, ":var007", 1),
(try_end),
(try_end),
(try_end),
(eq,1,1),
(item_get_type, ":item_type_011", ":player_slot_005"),
(try_begin),
(ge,":item_type_011",12),
(assign,":item_slot_008",0),
(try_end),
(try_end),
(store_add, ":var004", ":var007", ":item_slot_008"),
(else_try),
(assign,":var003",1),
(player_set_slot,":player_id_001",49,-1),
(else_try),
(agent_is_active,":agent_id_002"),
(agent_is_alive,":agent_id_002"),
(agent_is_human,":agent_id_002"),
(agent_get_group, ":agent_group_006", ":agent_id_002"),
(else_try),
(assign,":var003",1),
(player_set_slot,":player_id_001",49,-1),
(try_end),
(try_begin),
(eq,":var003",0),
(try_begin),
(gt,":var004",4),
(assign,":var003",1),
(player_set_slot,":player_id_001",49,-1),
(agent_get_position,pos1,":agent_id_002"),
(position_move_z,1,20),
(set_spawn_position, 1),
(spawn_item, ":player_slot_005"),
(str_store_string,s0,":str_store_string("str_ccoop_dropping_item_on_ground")"),
(multiplayer_send_string_to_player, ":player_id_001", 111, 0),
(eq,":player_slot_005","itm_javelin_bow"),
(spawn_item, "itm_javelin_bow_ammo"),
(try_end),
(try_end),
(try_begin),
(eq,":var003",0),
(get_max_players, ":max_players"),
(try_begin),
(eq,":agent_group_006",":player_id_001"),
(player_is_active, ":agent_group_006"),
(item_get_type, ":item_type_011", ":player_slot_005"),
(try_begin),
(agent_is_non_player, ":agent_id_002"),
(try_begin),
(this_or_next|eq,":item_type_011",4),
(this_or_next|eq,":item_type_011",3),
(eq,":item_type_011",2),
(try_for_range, ":var009", 0, 4),
(agent_get_item_slot, ":agent_item_slot_010", ":agent_id_002", ":var009"),
(ge,":agent_item_slot_010",0),
(item_get_type, ":item_type_013", ":agent_item_slot_010"),
(this_or_next|eq,":item_type_013",4),
(this_or_next|eq,":item_type_013",7),
(this_or_next|eq,":item_type_013",3),
(eq,":item_type_013",2),
(agent_unequip_item, ":agent_id_002", ":agent_item_slot_010", ":var009"),
(try_for_range, ":player_id_014", 0, ":max_players"),
(player_is_active, ":player_id_014"),
(multiplayer_send_4_int_to_player, ":player_id_014", 48, 15, ":agent_id_002", ":agent_item_slot_010", ":var009"),
(try_end),
(try_end),
(try_end),
(else_try),
(this_or_next|eq,":item_type_011",10),
(this_or_next|eq,":item_type_011",9),
(eq,":item_type_011",8),
(try_for_range, ":var009", 0, 4),
(agent_get_item_slot, ":agent_item_slot_010", ":agent_id_002", ":var009"),
(try_begin),
(ge,":agent_item_slot_010",0),
(item_get_type, ":item_type_013", ":agent_item_slot_010"),
(try_begin),
(this_or_next|eq,":item_type_013",4),
(this_or_next|eq,":item_type_013",7),
(this_or_next|eq,":item_type_013",3),
(eq,":item_type_013",2),
(agent_unequip_item, ":agent_id_002", ":agent_item_slot_010", ":var009"),
(try_for_range, ":player_id_014", 0, ":max_players"),
(player_is_active, ":player_id_014"),
(multiplayer_send_4_int_to_player, ":player_id_014", 48, 15, ":agent_id_002", ":agent_item_slot_010", ":var009"),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(try_end),
(is_between,":item_type_011",12,16),
(try_for_range, ":var009", 4, 8),
(agent_get_item_slot, ":agent_item_slot_010", ":agent_id_002", ":var009"),
(ge,":agent_item_slot_010",0),
(item_get_type, ":item_type_013", ":agent_item_slot_010"),
(try_begin),
(eq,":item_type_013",":item_type_011"),
(agent_unequip_item, ":agent_id_002", ":agent_item_slot_010"),
(try_for_range, ":player_id_014", 0, ":max_players"),
(player_is_active, ":player_id_014"),
(multiplayer_send_4_int_to_player, ":player_id_014", 48, 15, ":agent_id_002", ":agent_item_slot_010", ":var009"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,":agent_item_slot_010","itm_running_boots"),
(agent_set_speed_modifier, ":agent_id_002", 100),
(else_try),
(eq,":agent_item_slot_010","itm_power_gloves"),
(agent_set_damage_modifier, ":agent_id_002", 100),
(try_end),
(try_end),
(agent_equip_item, ":agent_id_002", ":player_slot_005"),
(try_for_range, ":player_id_014", 0, ":max_players"),
(player_is_active, ":player_id_014"),
(multiplayer_send_3_int_to_player, ":player_id_014", 48, 16, ":agent_id_002", ":player_slot_005"),
(try_end),
(try_begin),
(eq,":player_slot_005","itm_javelin_bow"),
(agent_equip_item, ":agent_id_002", "itm_javelin_bow_ammo"),
(try_for_range, ":player_id_014", 0, ":max_players"),
(player_is_active, ":player_id_014"),
(multiplayer_send_3_int_to_player, ":player_id_014", 48, 16, ":agent_id_002", "itm_javelin_bow_ammo"),
(try_end),
(else_try),
(eq,":player_slot_005","itm_running_boots"),
(agent_set_speed_modifier, ":agent_id_002", 150),
(else_try),
(eq,":player_slot_005","itm_power_gloves"),
(agent_set_damage_modifier, ":agent_id_002", 150),
(else_try),
(eq,":player_slot_005","itm_kicking_boots"),
(agent_is_non_player, ":agent_id_002"),
(agent_set_kick_allowed, ":agent_id_002", 1),
(try_end),
(player_set_slot,":player_id_001",49,-1),
]),

("add_player_to_cur_tableau_for_coop", [
(cur_tableau_set_override_flags, 511),
(multiplayer_get_my_player, ":my_player"),
(assign,":var002","trp_coop_companion_equipment_ui_0"),
(player_get_agent_id, ":agent_id_003", ":my_player"),
(try_for_range, ":var004", 0, 8),
(agent_get_item_slot, ":agent_item_slot_005", ":agent_id_003", ":var004"),
(try_begin),
(ge,":agent_item_slot_005",0),
(cur_tableau_add_override_item, ":agent_item_slot_005"),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(player_get_gender, ":gender_006", ":my_player"),
(try_begin),
(eq,":gender_006",1),
(val_add, ":var002", 1),
(try_end),
(try_end),
(str_store_string,s0,":str_store_player_face_keys(my_player)"),
(troop_set_face_keys, ":var002", 0),
(store_mod,":var007",":agent_id_003",4),
(assign,":var007 +","anim_pose_1"),
(set_fixed_point_multiplier, 100),
(cur_tableau_set_camera_parameters, 1, 6, 6, 10, 10000),
(init_position,5),
(position_set_z,5,145), # var008
(position_rotate_x,5,-90),
(position_rotate_z,5,180),
(position_move_x,5,-10,0),
(position_rotate_y,5,-50), # var011
(position_rotate_x,5,2), # var010
(position_move_z,5,350,0), # var009
(position_move_y,5,60,0),
(init_position,2),
(cur_tableau_add_troop, ":var002", 2, ":var007", 0),
(cur_tableau_set_camera_position, 5),
(copy_position,8,5),
(position_rotate_x,8,-90),
(position_rotate_z,8,30),
(position_rotate_x,8,-50),
(cur_tableau_add_sun_light, 0, 8, 175, 150, 125),
]),

("add_troop_to_cur_tableau_for_coop", [
(store_script_param, ":troop_id_001", 1),
(cur_tableau_set_override_flags, 511),
(multiplayer_get_my_player, ":my_player"),
(assign,":var003",0),
(assign,":var004","trp_coop_companion_equipment_ui_0"),
(try_for_agents, ":cur_agent"),
(eq,":var003",0),
(agent_is_active,":cur_agent"),
(agent_is_alive,":cur_agent"),
(agent_is_non_player, ":cur_agent"),
(agent_get_troop_id,":troop_id_006", ":cur_agent"),
(try_begin),
(eq,":troop_id_006",":troop_id_001"),
(agent_get_group, ":agent_group_007", ":cur_agent"),
(eq,":agent_group_007",":my_player"),
(try_for_range, ":slot_no_008", 43, 45),
(player_slot_eq,":my_player",":slot_no_008",":troop_id_006"),
(try_for_range, ":inventory_slot_no_009", 0, 8),
(agent_get_item_slot, ":agent_item_slot_010", ":cur_agent", ":inventory_slot_no_009"),
(ge,":agent_item_slot_010",0),
(cur_tableau_add_override_item, ":agent_item_slot_010"),
(try_end),
(try_end),
(try_end),
(gt,":slot_no_008",43),
(val_add, ":var004", 2),
(try_end),
(assign,":var003",1),
(try_end),
(try_begin),
(eq,":var003",0),
(try_for_range, ":slot_no_008", 43, 45),
(player_slot_eq,":my_player",":slot_no_008",":troop_id_001"),
(try_begin),
(gt,":slot_no_008",43),
(val_add, ":var004", 2),
(try_end),
(val_add, ":slot_no_008", 2),
(player_get_slot,":player_slot_011",":my_player",":slot_no_008"),
(val_add, ":slot_no_008", 2),
(player_get_slot,":player_slot_012",":my_player",":slot_no_008"),
(try_begin),
(ge,":player_slot_011","trp_npc1_1"),
(val_mul, ":player_slot_012", 16),
(val_add, ":player_slot_011", ":player_slot_012"),
(else_try),
(val_mul, ":player_slot_012", 18),
(val_add, ":player_slot_011", ":player_slot_012"),
(try_end),
(try_for_range, ":inventory_slot_no_009", 0, 8),
(troop_get_inventory_slot,":agent_item_slot_010",":player_slot_011",":inventory_slot_no_009"),
(ge,":agent_item_slot_010",0),
(cur_tableau_add_override_item, ":agent_item_slot_010"),
(try_end),
(try_end),
(try_end),
(try_begin),
(eq,1,1),
(troop_get_type,":troop_type_013",":troop_id_001"),
(try_begin),
(eq,":troop_type_013",1),
(val_add, ":var004", 1),
(try_end),
(try_end),
(str_store_string,s0,":str_store_troop_face_keys(troop_id_001)"),
(troop_set_face_keys, ":var004", 0),
(try_begin),
(eq,":var003",1),
(store_mod,":var014",":cur_agent",4),
(else_try),
(store_mod,":var014",":player_slot_011",4),
(try_end),
(assign,":var014 +","anim_pose_1"),
(set_fixed_point_multiplier, 100),
(cur_tableau_set_camera_parameters, 1, 6, 6, 10, 10000),
(init_position,5),
(position_set_z,5,145), # var015
(position_rotate_x,5,-90),
(position_rotate_z,5,180),
(try_begin),
(lt,":var004","trp_coop_companion_equipment_ui_1"),
(assign,":var018",-50),
(position_move_x,5,-10,0),
(else_try),
(assign,":var018",-10),
(position_move_x,5,10,0),
(try_end),
(position_rotate_y,5,":var018"),
(position_rotate_x,5,2), # var017
(position_move_z,5,350,0), # var016
(position_move_y,5,60,0),
(init_position,2),
(cur_tableau_add_troop, ":var004", 2, ":var014", 0),
(cur_tableau_set_camera_position, 5),
(copy_position,8,5),
(position_rotate_x,8,-90),
(position_rotate_z,8,30),
(position_rotate_x,8,-50),
(cur_tableau_add_sun_light, 0, 8, 175, 150, 125),
]),

]

from header_common import *
from header_presentations import *
from header_mission_templates import *
from ID_meshes import *
from header_operations import *
from header_triggers import *
from module_constants import *
import string

presentations = [

("game_credits",prsntf_read_only|prsntf_manual_end_only,mesh_load_window,[

(ti_on_presentation_load, [
(assign,"$g_presentation_credits_obj_1",-1),
(assign,"$g_presentation_credits_obj_2",-1),
(assign,"$g_presentation_credits_obj_3",-1),
(assign,"$g_presentation_credits_obj_4",-1),
(assign,"$g_presentation_credits_obj_5",-1),
(assign,"$g_presentation_credits_obj_6",-1),
(assign,"$g_presentation_credits_obj_7",-1),
(assign,"$g_presentation_credits_obj_8",-1),
(assign,"$g_presentation_credits_obj_9",-1),
(assign,"$g_presentation_credits_obj_10",-1),
(assign,"$g_presentation_credits_obj_11",-1),
(assign,"$g_presentation_credits_obj_12",-1),
(assign,"$g_presentation_credits_obj_1_alpha",0),
(assign,"$g_presentation_credits_obj_2_alpha",0),
(assign,"$g_presentation_credits_obj_3_alpha",0),
(assign,"$g_presentation_credits_obj_4_alpha",0),
(assign,"$g_presentation_credits_obj_5_alpha",0),
(assign,"$g_presentation_credits_obj_6_alpha",0),
(assign,"$g_presentation_credits_obj_7_alpha",0),
(assign,"$g_presentation_credits_obj_8_alpha",0),
(assign,"$g_presentation_credits_obj_9_alpha",0),
]),

(ti_on_presentation_run, [
(set_fixed_point_multiplier, 1000),
(presentation_set_duration, 1000000),
(try_begin),
    (this_or_next|key_clicked, 57),
    (this_or_next|key_clicked, 28),
    (this_or_next|key_clicked, 1),
    (this_or_next|key_clicked, 14),
    (this_or_next|key_clicked, 224),
    (this_or_next|key_clicked, 225),
    (this_or_next|key_clicked, 252),
    (key_clicked, 253),
    (presentation_set_duration, 0),
(try_end),
(try_begin),
    (lt,"$g_presentation_credits_obj_1",0),
    (str_store_string,s1,"str_credits_1"),
    (create_text_overlay, "$g_presentation_credits_obj_1", 1),
    (overlay_set_color, "$g_presentation_credits_obj_1", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_1", 0),
    (position_set_x,1,1500),
    (position_set_y,1,1500),
    (overlay_set_size, "$g_presentation_credits_obj_1", 1),
    (position_set_x,1,500),
    (position_set_y,1,375),
    (overlay_set_position, "$g_presentation_credits_obj_1", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_1", 1000, 255),
(else_try),
    (gt,":var001",2000),
    (eq,"$g_presentation_credits_obj_1_alpha",0),
    (assign,"$g_presentation_credits_obj_1_alpha",1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_1", 1000, 0),
(else_try),
    (gt,":var001",3500),
    (lt,"$g_presentation_credits_obj_2",0),
    (str_store_string,s1,"str_credits_2"),
    (create_text_overlay, "$g_presentation_credits_obj_2", 1),
    (overlay_set_color, "$g_presentation_credits_obj_2", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_2", 0),
    (position_set_x,1,1750),
    (position_set_y,1,1750),
    (overlay_set_size, "$g_presentation_credits_obj_2", 1),
    (position_set_x,1,500),
    (position_set_y,1,375),
    (overlay_set_position, "$g_presentation_credits_obj_2", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_2", 1000, 255),
(else_try),
    (gt,":var001",5500),
    (eq,"$g_presentation_credits_obj_2_alpha",0),
    (assign,"$g_presentation_credits_obj_2_alpha",1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_2", 1000, 0),
(else_try),
    (gt,":var001",7000),
    (lt,"$g_presentation_credits_obj_3",0),
    (str_store_string,s1,"str_credits_3"),
    (create_text_overlay, "$g_presentation_credits_obj_3", 1),
    (overlay_set_color, "$g_presentation_credits_obj_3", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_3", 0),
    (position_set_x,1,1750),
    (position_set_y,1,1750),
    (overlay_set_size, "$g_presentation_credits_obj_3", 1),
    (position_set_x,1,500),
    (position_set_y,1,375),
    (overlay_set_position, "$g_presentation_credits_obj_3", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_3", 1000, 255),
(else_try),
    (gt,":var001",9000),
    (eq,"$g_presentation_credits_obj_3_alpha",0),
    (assign,"$g_presentation_credits_obj_3_alpha",1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_3", 1000, 0),
(else_try),
    (gt,":var001",10500),
    (lt,"$g_presentation_credits_obj_4",0),
    (str_store_string,s1,"str_credits_4"),
    (create_text_overlay, "$g_presentation_credits_obj_4", 1),
    (overlay_set_color, "$g_presentation_credits_obj_4", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_4", 0),
    (position_set_x,1,1750),
    (position_set_y,1,1750),
    (overlay_set_size, "$g_presentation_credits_obj_4", 1),
    (position_set_x,1,500),
    (position_set_y,1,375),
    (overlay_set_position, "$g_presentation_credits_obj_4", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_4", 1000, 255),
(else_try),
    (gt,":var001",12500),
    (eq,"$g_presentation_credits_obj_4_alpha",0),
    (assign,"$g_presentation_credits_obj_4_alpha",1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_4", 1000, 0),
(else_try),
    (gt,":var001",14000),
    (lt,"$g_presentation_credits_obj_5",0),
    (str_store_string,s1,"str_credits_5"),
    (create_text_overlay, "$g_presentation_credits_obj_5", 1),
    (overlay_set_color, "$g_presentation_credits_obj_5", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_5", 0),
    (position_set_x,1,1750),
    (position_set_y,1,1750),
    (overlay_set_size, "$g_presentation_credits_obj_5", 1),
    (position_set_x,1,500),
    (position_set_y,1,375),
    (overlay_set_position, "$g_presentation_credits_obj_5", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_5", 1000, 255),
(else_try),
    (gt,":var001",16000),
    (eq,"$g_presentation_credits_obj_5_alpha",0),
    (assign,"$g_presentation_credits_obj_5_alpha",1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_5", 1000, 0),
(else_try),
    (gt,":var001",17500),
    (lt,"$g_presentation_credits_obj_6",0),
    (str_store_string,s1,"str_credits_6"),
    (create_text_overlay, "$g_presentation_credits_obj_6", 1),
    (overlay_set_color, "$g_presentation_credits_obj_6", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_6", 0),
    (position_set_x,1,1750),
    (position_set_y,1,1750),
    (overlay_set_size, "$g_presentation_credits_obj_6", 1),
    (position_set_x,1,500),
    (position_set_y,1,375),
    (overlay_set_position, "$g_presentation_credits_obj_6", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_6", 1000, 255),
(else_try),
    (gt,":var001",19500),
    (eq,"$g_presentation_credits_obj_6_alpha",0),
    (assign,"$g_presentation_credits_obj_6_alpha",1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_6", 1000, 0),
(else_try),
    (gt,":var001",21000),
    (lt,"$g_presentation_credits_obj_7",0),
    (str_store_string,s1,"str_credits_7"),
    (create_text_overlay, "$g_presentation_credits_obj_7", 1),
    (overlay_set_color, "$g_presentation_credits_obj_7", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_7", 0),
    (position_set_x,1,1750),
    (position_set_y,1,1750),
    (overlay_set_size, "$g_presentation_credits_obj_7", 1),
    (position_set_x,1,500),
    (position_set_y,1,375),
    (overlay_set_position, "$g_presentation_credits_obj_7", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_7", 1000, 255),
(else_try),
    (gt,":var001",23000),
    (eq,"$g_presentation_credits_obj_7_alpha",0),
    (assign,"$g_presentation_credits_obj_7_alpha",1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_7", 1000, 0),
(else_try),
    (gt,":var001",24500),
    (lt,"$g_presentation_credits_obj_8",0),
    (str_store_string,s1,"str_credits_8"),
    (create_text_overlay, "$g_presentation_credits_obj_8", 1),
    (overlay_set_color, "$g_presentation_credits_obj_8", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_8", 0),
    (position_set_x,1,1750),
    (position_set_y,1,1750),
    (overlay_set_size, "$g_presentation_credits_obj_8", 1),
    (position_set_x,1,500),
    (position_set_y,1,375),
    (overlay_set_position, "$g_presentation_credits_obj_8", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_8", 1000, 255),
(else_try),
    (gt,":var001",26500),
    (eq,"$g_presentation_credits_obj_8_alpha",0),
    (assign,"$g_presentation_credits_obj_8_alpha",1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_8", 1000, 0),
(else_try),
    (gt,":var001",28000),
    (lt,"$g_presentation_credits_obj_9",0),
    (str_store_string,s1,"str_credits_10"),
    (create_text_overlay, "$g_presentation_credits_obj_9", 1),
    (overlay_set_color, "$g_presentation_credits_obj_9", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_9", 0),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, "$g_presentation_credits_obj_9", 1),
    (position_set_x,1,250),
    (position_set_y,1,485),
    (overlay_set_position, "$g_presentation_credits_obj_9", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_9", 1000, 255),
    (str_store_string,s1,"str_credits_11"),
    (create_text_overlay, "$g_presentation_credits_obj_10", 1),
    (overlay_set_color, "$g_presentation_credits_obj_10", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_10", 0),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, "$g_presentation_credits_obj_10", 1),
    (position_set_x,1,750),
    (position_set_y,1,470),
    (overlay_set_position, "$g_presentation_credits_obj_10", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_10", 1000, 255),
    (str_store_string,s1,"str_credits_12"),
    (create_text_overlay, "$g_presentation_credits_obj_11", 1),
    (overlay_set_color, "$g_presentation_credits_obj_11", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_11", 0),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, "$g_presentation_credits_obj_11", 1),
    (position_set_x,1,500),
    (position_set_y,1,105),
    (overlay_set_position, "$g_presentation_credits_obj_11", 1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_11", 1000, 255),
(else_try),
    (gt,":var001",34000),
    (eq,"$g_presentation_credits_obj_9_alpha",0),
    (assign,"$g_presentation_credits_obj_9_alpha",1),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_9", 1000, 0),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_10", 1000, 0),
    (overlay_animate_to_alpha, "$g_presentation_credits_obj_11", 1000, 0),
(else_try),
    (gt,":var001",35500),
    (lt,"$g_presentation_credits_obj_12",0),
    (str_store_string,s1,"str_credits_9"),
    (create_text_overlay, "$g_presentation_credits_obj_12", 1),
    (overlay_set_color, "$g_presentation_credits_obj_12", 0),
    (overlay_set_alpha, "$g_presentation_credits_obj_12", 255),
    (position_set_x,1,1000),
    (position_set_y,1,1000),
    (overlay_set_size, "$g_presentation_credits_obj_12", 1),
    (position_set_x,1,500),
    (position_set_y,1,-4800),
    (overlay_set_position, "$g_presentation_credits_obj_12", 1),
    (position_set_x,1,500),
    (position_set_y,1,760),
    (overlay_animate_to_position, "$g_presentation_credits_obj_12", 70000, 1),
(else_try),
    (gt,":var001",105500),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("game_profile_banner_selection",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(str_store_string,s1,"str_profile_banner_selection_text"),
(create_text_overlay, reg1, 1),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, reg1, 1),
(overlay_set_text, reg1, 1),
(create_button_overlay, "$g_presentation_obj_profile_banner_selection_1", "@Next Page"),
(position_set_x,1,700),
(position_set_y,1,50),
(overlay_set_position, "$g_presentation_obj_profile_banner_selection_1", 1),
(create_button_overlay, "$g_presentation_obj_profile_banner_selection_2", "str_use_default_banner"),
(position_set_x,1,300),
(position_set_y,1,50),
(overlay_set_position, "$g_presentation_obj_profile_banner_selection_2", 1),
(assign,":var001",150),
(assign,":var002",575),
(store_mul, ":var003", 16, "$g_presentation_page_no"),
(store_add, ":var004", ":var003", 16),
(store_add, "$g_presentation_banner_start", "$g_presentation_obj_profile_banner_selection_2", 1),
(assign,":var005",0),
(try_for_range, ":mesh_006", ":mesh.banner_a01", ":mesh.banner_f21"),
    (assign,":var007",0),
    (try_for_range, ":fac_008", ":fac.kingdom_1", ":fac.kingdoms_end"),
        (try_begin),
            (faction_slot_eq,":fac_008",15,":mesh_006"),
            (assign,":var007",1),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":var007",0),
        (val_add, ":var005", 1),
        (try_begin),
            (gt,":var005",":var003"),
            (le,":var005",":var004"),
            (create_image_button_overlay, reg1, ":mesh_006", ":mesh_006"),
            (position_set_x,1,":var001"),
            (position_set_y,1,":var002"),
            (overlay_set_position, reg1, 1),
            (position_set_x,1,100),
            (position_set_y,1,100),
            (overlay_set_size, reg1, 1),
            (val_add, ":var001", 100),
            (try_begin),
                (ge,":var001",900),
                (assign,":var001",150),
                (val_sub, ":var002", 250),
            (try_end),
        (try_end),
    (try_end),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_profile_banner_selection_1"),
    (val_add, "$g_presentation_page_no", 1),
    (val_mod, "$g_presentation_page_no", 8),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_profile_banner_selection"),
(else_try),
    (eq,":var001","$g_presentation_obj_profile_banner_selection_2"),
    (profile_set_banner_id, -1),
    (presentation_set_duration, 0),
(else_try),
    (store_sub, ":var002", ":var001", "$g_presentation_banner_start"),
    (store_mul, ":var003", 16, "$g_presentation_page_no"),
    (val_add, ":var002", ":var003"),
    (assign,":var004",0),
    (assign,":var005","mesh_banner_f21"),
    (try_for_range, ":var006", ":mesh.banner_a01", ":var005"),
        (assign,":var007",0),
        (try_for_range, ":fac_008", ":fac.kingdom_1", ":fac.kingdoms_end"),
            (try_begin),
                (faction_slot_eq,":fac_008",15,":var006"),
                (assign,":var007",1),
            (try_end),
        (try_end),
        (try_begin),
            (eq,":var007",0),
            (try_begin),
                (eq,":var002",":var004"),
                (store_sub, ":var009", ":var006", ":mesh.banner_a01"),
                (profile_set_banner_id, ":var009"),
                (assign,":var005",0),
            (try_end),
        (try_end),
        (val_add, ":var004", 1),
    (try_end),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("game_custom_battle_designer",0,mesh_cb_ui_main,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_text_overlay, reg0, "str_player"),
(overlay_set_color, reg0, 4294967295),
(position_set_x,1,1500),
(position_set_y,1,1500),
(overlay_set_size, reg0, 1),
(position_set_x,1,175),
(position_set_y,1,700),
(overlay_set_position, reg0, 1),
(create_text_overlay, reg0, "str_enemy"),
(overlay_set_color, reg0, 4294967295),
(position_set_x,1,1500),
(position_set_y,1,1500),
(overlay_set_size, reg0, 1),
(position_set_x,1,820),
(position_set_y,1,700),
(overlay_set_position, reg0, 1),
(create_text_overlay, reg0, "str_character"),
(position_set_x,1,175),
(position_set_y,1,670),
(overlay_set_position, reg0, 1),
(create_combo_label_overlay, "$g_presentation_obj_custom_battle_designer_18"),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_18", 1),
(position_set_x,1,175),
(position_set_y,1,635),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_18", 1),
(try_for_range, ":trp_001", ":trp.quick_battle_troop_1", ":trp.quick_battle_troops_end"),
    (str_store_troop_name,s0,":trp_001"),
    (overlay_add_item, "$g_presentation_obj_custom_battle_designer_18", 0),
(try_end),
(store_sub, ":trp_001", "$g_quick_battle_troop", ":trp.quick_battle_troop_1"),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_18", ":trp_001"),
(store_mul, ":trp_001", "$g_quick_battle_troop", 2),
(create_mesh_overlay_with_tableau_material, reg0, -1, "tab_game_party_window", ":trp_001"),
(position_set_x,1,25),
(position_set_y,1,370),
(overlay_set_position, reg0, 1),
(try_begin),
    (eq,"$g_quick_battle_team_2_faction","fac_kingdom_1"),
    (assign,":trp_001","trp_swadian_knight"),
(else_try),
    (eq,"$g_quick_battle_team_2_faction","fac_kingdom_2"),
    (assign,":trp_001","trp_vaegir_knight"),
(else_try),
    (eq,"$g_quick_battle_team_2_faction","fac_kingdom_3"),
    (assign,":trp_001","trp_khergit_veteran_horse_archer"),
(else_try),
    (eq,"$g_quick_battle_team_2_faction","fac_kingdom_4"),
    (assign,":trp_001","trp_nord_champion"),
(else_try),
    (eq,"$g_quick_battle_team_2_faction","fac_kingdom_5"),
    (assign,":trp_001","trp_rhodok_sergeant"),
(else_try),
    (eq,"$g_quick_battle_team_2_faction","fac_kingdom_6"),
    (assign,":trp_001","trp_sarranid_mamluke"),
(else_try),
    (assign,":trp_001","trp_taiga_bandit"),
(try_end),
(val_mul, ":trp_001", 2),
(create_mesh_overlay_with_tableau_material, reg0, -1, "tab_game_party_window", ":trp_001"),
(position_set_x,1,670),
(position_set_y,1,370),
(overlay_set_position, reg0, 1),
(create_text_overlay, reg0, "str_biography"),
(position_set_x,1,500),
(position_set_y,1,700),
(overlay_set_position, reg0, 1),
(store_sub, ":var002", "$g_quick_battle_troop", ":trp.quick_battle_troop_1"),
(assign,":var002 +","str_quick_battle_troop_1"),
(create_text_overlay, reg0, ":var002"),
(position_set_x,1,850),
(position_set_y,1,850),
(overlay_set_size, reg0, 1),
(position_set_x,1,320),
(position_set_y,1,560),
(overlay_set_position, reg0, 1),
(position_set_x,1,360),
(position_set_y,1,130),
(overlay_set_area_size, reg0, 1),
(create_text_overlay, reg0, "str_map_basic"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,1500),
(position_set_y,1,1500),
(overlay_set_size, reg0, 1),
(position_set_x,1,500),
(position_set_y,1,450),
(overlay_set_position, reg0, 1),
(create_combo_label_overlay, "$g_presentation_obj_custom_battle_designer_1"),
(position_set_x,1,700),
(position_set_y,1,700),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_1", 1),
(position_set_x,1,500),
(position_set_y,1,415),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_1", 1),
(try_begin),
    (eq,"$g_quick_battle_game_type",0),
    (try_for_range, ":scn_003", ":scn.quick_battle_scene_1", ":scn.quick_battle_scene_4"),
        (store_sub, ":var004", ":scn_003", ":scn.quick_battle_scene_1"),
        (assign,":var004 +","str_quick_battle_scene_1"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_1", ":var004"),
    (try_end),
    (try_begin),
        (is_between,"$g_quick_battle_map","scn_quick_battle_scene_1","scn_quick_battle_scene_4"),
        (store_sub, ":var005", "$g_quick_battle_map", ":scn.quick_battle_scene_1"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_1", ":var005"),
    (else_try),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_1", 0),
        (assign,"$g_quick_battle_map","scn_quick_battle_scene_1"),
    (try_end),
(else_try),
    (try_for_range, ":scn_003", ":scn.quick_battle_scene_4", ":scn.quick_battle_maps_end"),
        (store_sub, ":var004", ":scn_003", ":scn.quick_battle_scene_1"),
        (assign,":var004 +","str_quick_battle_scene_1"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_1", ":var004"),
    (try_end),
    (try_begin),
        (is_between,"$g_quick_battle_map","scn_quick_battle_scene_4","scn_quick_battle_maps_end"),
        (store_sub, ":var005", "$g_quick_battle_map", ":scn.quick_battle_scene_4"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_1", ":var005"),
    (else_try),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_1", 0),
        (assign,"$g_quick_battle_map","scn_quick_battle_scene_4"),
    (try_end),
(try_end),
(store_sub, ":var006", "$g_quick_battle_map", ":scn.quick_battle_scene_1"),
(assign,":var006 +","mesh_cb_ui_maps_scene_01"),
(create_mesh_overlay, reg0, ":var006"),
(position_set_x,1,700),
(position_set_y,1,700),
(overlay_set_size, reg0, 1),
(position_set_x,1,380),
(position_set_y,1,220),
(overlay_set_position, reg0, 1),
(create_text_overlay, reg0, "str_game_type_basic"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,1500),
(position_set_y,1,1500),
(overlay_set_size, reg0, 1),
(position_set_x,1,500),
(position_set_y,1,180),
(overlay_set_position, reg0, 1),
(create_combo_label_overlay, "$g_presentation_obj_custom_battle_designer_23"),
(position_set_x,1,700),
(position_set_y,1,700),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_23", 1),
(position_set_x,1,500),
(position_set_y,1,150),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_23", 1),
(overlay_add_item, "$g_presentation_obj_custom_battle_designer_23", "str_battle"),
(overlay_add_item, "$g_presentation_obj_custom_battle_designer_23", "str_siege_offense"),
(overlay_add_item, "$g_presentation_obj_custom_battle_designer_23", "str_siege_defense"),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_23", "$g_quick_battle_game_type"),
(create_game_button_overlay, "$g_presentation_obj_custom_battle_designer_24", "str_randomize"),
(position_set_x,1,500),
(position_set_y,1,60),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_24", 1),
(assign,":var007",330),
(assign,":var007",350),
(assign,":var008",40),
(create_text_overlay, reg0, "str_faction"),
(position_set_x,1,175),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(create_text_overlay, reg0, "str_faction"),
(position_set_x,1,820),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(val_sub, ":var007", ":var008"),
(create_combo_label_overlay, "$g_presentation_obj_custom_battle_designer_4"),
(position_set_x,1,175),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_4", 1),
(try_begin),
    (is_trial_version),
    (str_store_faction_name,s0,"fac_kingdom_1"),
    (overlay_add_item, "$g_presentation_obj_custom_battle_designer_4", 0),
    (assign,":var009","fac_kingdom_1"),
    (val_add, ":var009", 1),
    (str_store_faction_name,s0,":var009"),
    (overlay_add_item, "$g_presentation_obj_custom_battle_designer_4", 0),
(else_try),
    (try_for_range, ":fac_009", ":fac.kingdom_1", ":fac.kingdoms_end"),
        (str_store_faction_name,s0,":fac_009"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_4", 0),
    (try_end),
    (str_store_faction_name,s0,"fac_outlaws"),
    (overlay_add_item, "$g_presentation_obj_custom_battle_designer_4", 0),
(try_end),
(try_begin),
    (eq,"$g_quick_battle_team_1_faction","fac_outlaws"),
    (assign,":var010","fac_kingdoms_end"),
    (assign,":var010 -","fac_kingdom_1"),
    (overlay_set_val, "$g_presentation_obj_custom_battle_designer_4", ":var010"),
(else_try),
    (store_sub, ":var011", "$g_quick_battle_team_1_faction", ":fac.kingdom_1"),
    (overlay_set_val, "$g_presentation_obj_custom_battle_designer_4", ":var011"),
(try_end),
(create_combo_label_overlay, "$g_presentation_obj_custom_battle_designer_5"),
(position_set_x,1,820),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_5", 1),
(try_begin),
    (is_trial_version),
    (str_store_faction_name,s0,"fac_kingdom_1"),
    (overlay_add_item, "$g_presentation_obj_custom_battle_designer_5", 0),
    (assign,":fac_009","fac_kingdom_1"),
    (val_add, ":fac_009", 1),
    (str_store_faction_name,s0,":fac_009"),
    (overlay_add_item, "$g_presentation_obj_custom_battle_designer_5", 0),
(else_try),
    (try_for_range, ":fac_009", ":fac.kingdom_1", ":fac.kingdoms_end"),
        (str_store_faction_name,s0,":fac_009"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_5", 0),
    (try_end),
    (str_store_faction_name,s0,"fac_outlaws"),
    (overlay_add_item, "$g_presentation_obj_custom_battle_designer_5", 0),
(try_end),
(try_begin),
    (eq,"$g_quick_battle_team_2_faction","fac_outlaws"),
    (assign,":var010","fac_kingdoms_end"),
    (assign,":var010 -","fac_kingdom_1"),
    (overlay_set_val, "$g_presentation_obj_custom_battle_designer_5", ":var010"),
(else_try),
    (store_sub, ":var012", "$g_quick_battle_team_2_faction", ":fac.kingdom_1"),
    (overlay_set_val, "$g_presentation_obj_custom_battle_designer_5", ":var012"),
(try_end),
(val_sub, ":var007", ":var008"),
(create_text_overlay, reg0, "str_army_composition"),
(position_set_x,1,175),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(create_text_overlay, reg0, "str_army_composition"),
(position_set_x,1,820),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(val_sub, ":var007", ":var008"),
(try_begin),
    (eq,"$g_presentation_obj_custom_battle_designer_6_last_value",0),
    (eq,"$g_presentation_obj_custom_battle_designer_7_last_value",0),
    (eq,"$g_presentation_obj_custom_battle_designer_8_last_value",0),
    (eq,"$g_presentation_obj_custom_battle_designer_9_last_value",0),
    (eq,"$g_presentation_obj_custom_battle_designer_10_last_value",0),
    (eq,"$g_presentation_obj_custom_battle_designer_11_last_value",0),
    (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",34),
    (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",33),
    (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",33),
    (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",34),
    (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",33),
    (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",33),
    (assign,"$g_presentation_obj_custom_battle_designer_6_locked",0),
    (assign,"$g_presentation_obj_custom_battle_designer_7_locked",0),
    (assign,"$g_presentation_obj_custom_battle_designer_8_locked",0),
    (assign,"$g_presentation_obj_custom_battle_designer_9_locked",0),
    (assign,"$g_presentation_obj_custom_battle_designer_10_locked",0),
    (assign,"$g_presentation_obj_custom_battle_designer_11_locked",0),
(try_end),
(create_mesh_overlay, reg0, "mesh_cb_ui_icon_infantry"),
(position_set_x,1,5),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(position_set_x,1,400),
(position_set_y,1,400),
(overlay_set_size, reg0, 1),
(create_mesh_overlay, reg0, "mesh_cb_ui_icon_infantry"),
(position_set_x,1,650),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(position_set_x,1,400),
(position_set_y,1,400),
(overlay_set_size, reg0, 1),
(create_slider_overlay, "$g_presentation_obj_custom_battle_designer_6", 0, 100),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
(position_set_x,1,900),
(position_set_y,1,1000),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_6", 1),
(position_set_x,1,175),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_6", 1),
(assign,reg0,"$g_presentation_obj_custom_battle_designer_6_last_value"),
(create_text_overlay, "$g_presentation_obj_custom_battle_designer_12", "str_reg0_percent"),
(position_set_x,1,295),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_12", 1),
(create_slider_overlay, "$g_presentation_obj_custom_battle_designer_9", 0, 100),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
(position_set_x,1,900),
(position_set_y,1,1000),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_9", 1),
(position_set_x,1,820),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_9", 1),
(assign,reg0,"$g_presentation_obj_custom_battle_designer_9_last_value"),
(create_text_overlay, "$g_presentation_obj_custom_battle_designer_15", "str_reg0_percent"),
(position_set_x,1,940),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_15", 1),
(val_sub, ":var007", ":var008"),
(create_mesh_overlay, reg0, "mesh_cb_ui_icon_archer"),
(position_set_x,1,15),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(position_set_x,1,400),
(position_set_y,1,400),
(overlay_set_size, reg0, 1),
(create_mesh_overlay, reg0, "mesh_cb_ui_icon_archer"),
(position_set_x,1,660),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(position_set_x,1,400),
(position_set_y,1,400),
(overlay_set_size, reg0, 1),
(create_slider_overlay, "$g_presentation_obj_custom_battle_designer_7", 0, 100),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
(position_set_x,1,900),
(position_set_y,1,1000),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_7", 1),
(position_set_x,1,175),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_7", 1),
(assign,reg0,"$g_presentation_obj_custom_battle_designer_7_last_value"),
(create_text_overlay, "$g_presentation_obj_custom_battle_designer_13", "str_reg0_percent"),
(position_set_x,1,295),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_13", 1),
(create_slider_overlay, "$g_presentation_obj_custom_battle_designer_10", 0, 100),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
(position_set_x,1,900),
(position_set_y,1,1000),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_10", 1),
(position_set_x,1,820),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_10", 1),
(assign,reg0,"$g_presentation_obj_custom_battle_designer_10_last_value"),
(create_text_overlay, "$g_presentation_obj_custom_battle_designer_16", "str_reg0_percent"),
(position_set_x,1,940),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_16", 1),
(val_sub, ":var007", ":var008"),
(create_mesh_overlay, reg0, "mesh_cb_ui_icon_horseman"),
(position_set_x,1,10),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(position_set_x,1,400),
(position_set_y,1,400),
(overlay_set_size, reg0, 1),
(create_mesh_overlay, reg0, "mesh_cb_ui_icon_horseman"),
(position_set_x,1,655),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(position_set_x,1,400),
(position_set_y,1,400),
(overlay_set_size, reg0, 1),
(create_slider_overlay, "$g_presentation_obj_custom_battle_designer_8", 0, 100),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
(position_set_x,1,900),
(position_set_y,1,1000),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_8", 1),
(position_set_x,1,175),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_8", 1),
(assign,reg0,"$g_presentation_obj_custom_battle_designer_8_last_value"),
(create_text_overlay, "$g_presentation_obj_custom_battle_designer_14", "str_reg0_percent"),
(position_set_x,1,295),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_14", 1),
(create_slider_overlay, "$g_presentation_obj_custom_battle_designer_11", 0, 100),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
(position_set_x,1,900),
(position_set_y,1,1000),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_11", 1),
(position_set_x,1,820),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_11", 1),
(assign,reg0,"$g_presentation_obj_custom_battle_designer_11_last_value"),
(create_text_overlay, "$g_presentation_obj_custom_battle_designer_17", "str_reg0_percent"),
(position_set_x,1,940),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_17", 1),
(val_sub, ":var007", ":var008"),
(create_text_overlay, reg0, "str_army_size"),
(position_set_x,1,175),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(create_text_overlay, reg0, "str_army_size"),
(position_set_x,1,820),
(position_set_y,1,":var007"),
(overlay_set_position, reg0, 1),
(val_sub, ":var007", ":var008"),
(try_begin),
    (is_trial_version),
    (val_min,"$g_quick_battle_army_1_size",25),
    (val_min,"$g_quick_battle_army_2_size",25),
(try_end),
(create_slider_overlay, "$g_presentation_obj_custom_battle_designer_2", 0, 100),
(overlay_set_boundaries, "$g_presentation_obj_custom_battle_designer_2", 1000, 75000),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_2", "$g_quick_battle_army_1_size"),
(position_set_x,1,900),
(position_set_y,1,1000),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_2", 1),
(position_set_x,1,135),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_2", 1),
(call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_1_size"),
(create_text_overlay, "$g_presentation_obj_custom_battle_designer_21", "str_reg0_men"),
(position_set_x,1,255),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_21", 1),
(create_slider_overlay, "$g_presentation_obj_custom_battle_designer_3", 200),
(overlay_set_boundaries, "$g_presentation_obj_custom_battle_designer_3", 1000, 75000),
(overlay_set_val, "$g_presentation_obj_custom_battle_designer_3", "$g_quick_battle_army_2_size"),
(position_set_x,1,900),
(position_set_y,1,1000),
(overlay_set_size, "$g_presentation_obj_custom_battle_designer_3", 1),
(position_set_x,1,780),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_3", 1),
(call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_2_size"),
(create_text_overlay, "$g_presentation_obj_custom_battle_designer_22", "str_reg0_men"),
(position_set_x,1,900),
(position_set_y,1,":var007"),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_22", 1),
(create_game_button_overlay, "$g_presentation_obj_custom_battle_designer_19", "str_start"),
(position_set_x,1,415),
(position_set_y,1,10),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_19", 1),
(create_game_button_overlay, "$g_presentation_obj_custom_battle_designer_20", "str_back"),
(position_set_x,1,585),
(position_set_y,1,10),
(overlay_set_position, "$g_presentation_obj_custom_battle_designer_20", 1),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_1"),
    (try_begin),
        (eq,"$g_quick_battle_game_type",0),
        (store_add, "$g_quick_battle_map", ":var002", ":scn.quick_battle_scene_1"),
    (else_try),
        (store_add, "$g_quick_battle_map", ":var002", ":scn.quick_battle_scene_4"),
    (try_end),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_custom_battle_designer"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_23"),
    (assign,"$g_quick_battle_game_type",":var002"),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_custom_battle_designer"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_24"),
    (store_random_in_range,"$g_quick_battle_game_type",0,3),
    (store_random_in_range,"$g_quick_battle_troop","trp_quick_battle_troop_1","trp_quick_battle_troops_end"),
    (try_begin),
        (is_trial_version),
        (store_random_in_range,"$g_quick_battle_team_1_faction",0,2),
        (try_begin),
            (eq,"$g_quick_battle_team_1_faction",0),
            (assign,"$g_quick_battle_team_2_faction",1),
        (else_try),
            (assign,"$g_quick_battle_team_2_faction",0),
        (try_end),
        (assign,"$g_quick_battle_team_1_faction +","fac_kingdom_1"),
        (assign,"$g_quick_battle_team_2_faction +","fac_kingdom_1"),
        (store_random_in_range,"$g_quick_battle_army_1_size",10,16),
        (store_random_in_range,":random_x_003",0,6),
        (val_add, "$g_quick_battle_army_1_size", ":random_x_003"),
        (store_random_in_range,":random_x_003",0,6),
        (val_add, "$g_quick_battle_army_1_size", ":random_x_003"),
    (else_try),
        (assign,":var004","fac_kingdoms_end"),
        (assign,":var004 -","fac_kingdom_1"),
        (val_add, ":var004", 1),
        (store_random_in_range,"$g_quick_battle_team_1_faction",0,":var004"),
        (try_begin),
            (eq,"$g_quick_battle_team_1_faction",0),
            (assign,"$g_quick_battle_team_1_faction","fac_outlaws"),
        (else_try),
            (assign,"$g_quick_battle_team_1_faction +","fac_kingdom_1"),
            (val_sub, "$g_quick_battle_team_1_faction", 1),
        (try_end),
        (assign,":var005",1000),
        (try_for_range, ":var006", 0, ":var005"),
            (store_random_in_range,"$g_quick_battle_team_2_faction",0,":var004"),
            (try_begin),
                (eq,"$g_quick_battle_team_2_faction",0),
                (assign,"$g_quick_battle_team_2_faction","fac_outlaws"),
            (else_try),
                (assign,"$g_quick_battle_team_2_faction +","fac_kingdom_1"),
                (val_sub, "$g_quick_battle_team_2_faction", 1),
            (try_end),
            (try_begin),
                (neq,"$g_quick_battle_team_1_faction","$g_quick_battle_team_2_faction"),
                (assign,":var005",0),
            (try_end),
        (try_end),
        (store_random_in_range,"$g_quick_battle_army_1_size",10,21),
        (store_random_in_range,":random_x_003",0,11),
        (val_add, "$g_quick_battle_army_1_size", ":random_x_003"),
        (store_random_in_range,":random_x_003",0,11),
        (val_add, "$g_quick_battle_army_1_size", ":random_x_003"),
    (try_end),
    (assign,"$g_quick_battle_army_2_size","$g_quick_battle_army_1_size"),
    (try_begin),
        (eq,"$g_quick_battle_game_type",0),
        (store_random_in_range,"$g_quick_battle_map","scn_quick_battle_scene_1","scn_quick_battle_scene_4"),
        (store_random_in_range,":random_x_007",0,3),
        (store_random_in_range,":random_x_008",0,2),
        (store_random_in_range,":random_x_009",0,100),
        (store_sub, ":var010", 100, ":random_x_009"),
        (store_random_in_range,":random_x_011",0,":var010"),
        (store_sub, ":var012", ":var010", ":random_x_011"),
        (try_begin),
            (eq,":random_x_007",0),
            (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",":random_x_009"),
            (try_begin),
                (eq,":random_x_008",0),
                (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",":var012"),
            (else_try),
                (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",":var012"),
            (try_end),
        (else_try),
            (eq,":random_x_007",1),
            (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",":random_x_009"),
            (try_begin),
                (eq,":random_x_008",0),
                (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",":var012"),
            (else_try),
                (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",":var012"),
            (try_end),
        (else_try),
            (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",":random_x_009"),
            (try_begin),
                (eq,":random_x_008",0),
                (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",":var012"),
            (else_try),
                (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",":var012"),
            (try_end),
        (try_end),
        (store_random_in_range,":random_x_007",0,3),
        (store_random_in_range,":random_x_008",0,2),
        (store_random_in_range,":random_x_009",0,100),
        (store_sub, ":var010", 100, ":random_x_009"),
        (store_random_in_range,":random_x_011",0,":var010"),
        (store_sub, ":var012", ":var010", ":random_x_011"),
        (try_begin),
            (eq,":random_x_007",0),
            (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",":random_x_009"),
            (try_begin),
                (eq,":random_x_008",0),
                (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",":var012"),
            (else_try),
                (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",":var012"),
            (try_end),
        (else_try),
            (eq,":random_x_007",1),
            (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",":random_x_009"),
            (try_begin),
                (eq,":random_x_008",0),
                (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",":var012"),
            (else_try),
                (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",":var012"),
            (try_end),
        (else_try),
            (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",":random_x_009"),
            (try_begin),
                (eq,":random_x_008",0),
                (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",":var012"),
            (else_try),
                (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",":random_x_011"),
                (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",":var012"),
            (try_end),
        (try_end),
    (else_try),
        (eq,"$g_quick_battle_game_type",1),
        (store_random_in_range,"$g_quick_battle_map","scn_quick_battle_scene_4","scn_quick_battle_maps_end"),
        (store_random_in_range,"$g_presentation_obj_custom_battle_designer_10_last_value",30,100),
        (store_sub, "$g_presentation_obj_custom_battle_designer_9_last_value", 100, "$g_presentation_obj_custom_battle_designer_10_last_value"),
        (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",0),
        (store_random_in_range,"$g_presentation_obj_custom_battle_designer_6_last_value",20,100),
        (store_sub, "$g_presentation_obj_custom_battle_designer_7_last_value", 100, "$g_presentation_obj_custom_battle_designer_6_last_value"),
        (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",0),
    (else_try),
        (store_random_in_range,"$g_quick_battle_map","scn_quick_battle_scene_4","scn_quick_battle_maps_end"),
        (store_random_in_range,"$g_presentation_obj_custom_battle_designer_7_last_value",30,100),
        (store_sub, "$g_presentation_obj_custom_battle_designer_6_last_value", 100, "$g_presentation_obj_custom_battle_designer_7_last_value"),
        (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",0),
        (store_random_in_range,"$g_presentation_obj_custom_battle_designer_9_last_value",20,100),
        (store_sub, "$g_presentation_obj_custom_battle_designer_10_last_value", 100, "$g_presentation_obj_custom_battle_designer_9_last_value"),
        (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",0),
    (try_end),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_custom_battle_designer"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_2"),
    (assign,"$g_quick_battle_army_1_size",":var002"),
    (try_begin),
        (is_trial_version),
        (gt,"$g_quick_battle_army_1_size",25),
        (assign,"$g_quick_battle_army_1_size",25),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_2", 25),
    (try_end),
    (call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_1_size"),
    (overlay_set_text, "$g_presentation_obj_custom_battle_designer_21", "str_reg0_men"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_3"),
    (assign,"$g_quick_battle_army_2_size",":var002"),
    (try_begin),
        (is_trial_version),
        (gt,"$g_quick_battle_army_2_size",25),
        (assign,"$g_quick_battle_army_2_size",25),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_3", 25),
    (try_end),
    (call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_2_size"),
    (overlay_set_text, "$g_presentation_obj_custom_battle_designer_22", "str_reg0_men"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_4"),
    (try_begin),
        (eq,1,1),
        (assign,":var013","fac_kingdoms_end"),
        (assign,":var013 -","fac_kingdom_1"),
        (try_begin),
            (eq,":var002",":var013"),
            (assign,"$g_quick_battle_team_1_faction","fac_outlaws"),
        (else_try),
            (store_add, "$g_quick_battle_team_1_faction", ":var002", ":fac.kingdom_1"),
        (try_end),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_5"),
    (try_begin),
        (eq,1,1),
        (assign,":var013","fac_kingdoms_end"),
        (assign,":var013 -","fac_kingdom_1"),
        (try_begin),
            (eq,":var002",":var013"),
            (assign,"$g_quick_battle_team_2_faction","fac_outlaws"),
        (else_try),
            (store_add, "$g_quick_battle_team_2_faction", ":var002", ":fac.kingdom_1"),
        (try_end),
    (try_end),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_custom_battle_designer"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_18"),
    (store_add, "$g_quick_battle_troop", ":var002", ":trp.quick_battle_troop_1"),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_custom_battle_designer"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_6"),
    (try_begin),
        (eq,"$g_presentation_obj_custom_battle_designer_6_locked",1),
        (neq,":var002","$g_presentation_obj_custom_battle_designer_6_last_value"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
    (else_try),
        (try_begin),
            (lt,":var002","$g_presentation_obj_custom_battle_designer_6_last_value"),
            (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_6_last_value", ":var002"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_7_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_8_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",":var002"),
            (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var015"),
            (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var016"),
            (try_begin),
                (gt,"$g_presentation_obj_custom_battle_designer_7_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_7_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",100),
            (else_try),
                (gt,"$g_presentation_obj_custom_battle_designer_8_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_8_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
        (else_try),
            (gt,":var002","$g_presentation_obj_custom_battle_designer_6_last_value"),
            (store_sub, ":var014", ":var002", "$g_presentation_obj_custom_battle_designer_6_last_value"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_7_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_8_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",":var002"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var015"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var016"),
            (try_begin),
                (lt,"$g_presentation_obj_custom_battle_designer_7_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",0),
            (else_try),
                (lt,"$g_presentation_obj_custom_battle_designer_8_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
        (try_end),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_6_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_12", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_7_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_13", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_8_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_14", "str_reg0_percent"),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_7"),
    (try_begin),
        (eq,"$g_presentation_obj_custom_battle_designer_7_locked",1),
        (neq,":var002","$g_presentation_obj_custom_battle_designer_7_last_value"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
    (else_try),
        (try_begin),
            (lt,":var002","$g_presentation_obj_custom_battle_designer_7_last_value"),
            (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_7_last_value", ":var002"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_6_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_8_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",":var002"),
            (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var015"),
            (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var016"),
            (try_begin),
                (gt,"$g_presentation_obj_custom_battle_designer_6_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_6_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",100),
            (else_try),
                (gt,"$g_presentation_obj_custom_battle_designer_8_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_8_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
        (else_try),
            (gt,":var002","$g_presentation_obj_custom_battle_designer_7_last_value"),
            (store_sub, ":var014", ":var002", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_6_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_8_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",":var002"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var015"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var016"),
            (try_begin),
                (lt,"$g_presentation_obj_custom_battle_designer_6_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", "$g_presentation_obj_custom_battle_designer_6_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",0),
            (else_try),
                (lt,"$g_presentation_obj_custom_battle_designer_8_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
        (try_end),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_6_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_12", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_7_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_13", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_8_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_14", "str_reg0_percent"),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_8"),
    (try_begin),
        (eq,"$g_presentation_obj_custom_battle_designer_8_locked",1),
        (neq,":var002","$g_presentation_obj_custom_battle_designer_8_last_value"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
    (else_try),
        (try_begin),
            (lt,":var002","$g_presentation_obj_custom_battle_designer_8_last_value"),
            (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_8_last_value", ":var002"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_7_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_6_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",":var002"),
            (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var015"),
            (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var016"),
            (try_begin),
                (gt,"$g_presentation_obj_custom_battle_designer_7_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_7_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",100),
            (else_try),
                (gt,"$g_presentation_obj_custom_battle_designer_6_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_6_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
        (else_try),
            (gt,":var002","$g_presentation_obj_custom_battle_designer_8_last_value"),
            (store_sub, ":var014", ":var002", "$g_presentation_obj_custom_battle_designer_8_last_value"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_7_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_6_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_8_last_value",":var002"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var015"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var016"),
            (try_begin),
                (lt,"$g_presentation_obj_custom_battle_designer_7_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_7_last_value",0),
            (else_try),
                (lt,"$g_presentation_obj_custom_battle_designer_6_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_6_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_6_last_value",0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
        (try_end),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_6_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_12", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_7_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_13", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_8_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_14", "str_reg0_percent"),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_9"),
    (try_begin),
        (eq,"$g_presentation_obj_custom_battle_designer_9_locked",1),
        (neq,":var002","$g_presentation_obj_custom_battle_designer_9_last_value"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
    (else_try),
        (try_begin),
            (lt,":var002","$g_presentation_obj_custom_battle_designer_9_last_value"),
            (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_9_last_value", ":var002"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_10_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_11_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",":var002"),
            (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var015"),
            (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var016"),
            (try_begin),
                (gt,"$g_presentation_obj_custom_battle_designer_10_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_10_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",100),
            (else_try),
                (gt,"$g_presentation_obj_custom_battle_designer_11_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_11_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
        (else_try),
            (gt,":var002","$g_presentation_obj_custom_battle_designer_9_last_value"),
            (store_sub, ":var014", ":var002", "$g_presentation_obj_custom_battle_designer_9_last_value"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_10_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_11_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",":var002"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var015"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var016"),
            (try_begin),
                (lt,"$g_presentation_obj_custom_battle_designer_10_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",0),
            (else_try),
                (lt,"$g_presentation_obj_custom_battle_designer_11_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
        (try_end),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_9_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_15", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_10_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_16", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_11_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_17", "str_reg0_percent"),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_10"),
    (try_begin),
        (eq,"$g_presentation_obj_custom_battle_designer_10_locked",1),
        (neq,":var002","$g_presentation_obj_custom_battle_designer_10_last_value"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
    (else_try),
        (try_begin),
            (lt,":var002","$g_presentation_obj_custom_battle_designer_10_last_value"),
            (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_10_last_value", ":var002"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_9_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_11_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",":var002"),
            (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var015"),
            (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var016"),
            (try_begin),
                (gt,"$g_presentation_obj_custom_battle_designer_9_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_9_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",100),
            (else_try),
                (gt,"$g_presentation_obj_custom_battle_designer_11_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_11_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
        (else_try),
            (gt,":var002","$g_presentation_obj_custom_battle_designer_10_last_value"),
            (store_sub, ":var014", ":var002", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_9_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_11_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",":var002"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var015"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var016"),
            (try_begin),
                (lt,"$g_presentation_obj_custom_battle_designer_9_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", "$g_presentation_obj_custom_battle_designer_9_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",0),
            (else_try),
                (lt,"$g_presentation_obj_custom_battle_designer_11_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
        (try_end),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_9_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_15", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_10_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_16", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_11_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_17", "str_reg0_percent"),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_11"),
    (try_begin),
        (eq,"$g_presentation_obj_custom_battle_designer_11_locked",1),
        (neq,":var002","$g_presentation_obj_custom_battle_designer_11_last_value"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
    (else_try),
        (try_begin),
            (lt,":var002","$g_presentation_obj_custom_battle_designer_11_last_value"),
            (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_11_last_value", ":var002"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_10_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_9_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",":var002"),
            (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var015"),
            (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var016"),
            (try_begin),
                (gt,"$g_presentation_obj_custom_battle_designer_10_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_10_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",100),
            (else_try),
                (gt,"$g_presentation_obj_custom_battle_designer_9_last_value",100),
                (store_sub, ":var014", "$g_presentation_obj_custom_battle_designer_9_last_value", 100),
                (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var014"),
                (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
        (else_try),
            (gt,":var002","$g_presentation_obj_custom_battle_designer_11_last_value"),
            (store_sub, ":var014", ":var002", "$g_presentation_obj_custom_battle_designer_11_last_value"),
            (try_begin),
                (eq,"$g_presentation_obj_custom_battle_designer_10_locked",1),
                (assign,":var015",0),
                (assign,":var016",":var014"),
            (else_try),
                (eq,"$g_presentation_obj_custom_battle_designer_9_locked",1),
                (assign,":var015",":var014"),
                (assign,":var016",0),
            (else_try),
                (store_div, ":var___x1", ":var014", 2),
                (assign,":var015",":var___x1"),
                (store_sub, ":var016", ":var014", ":var015"),
                (try_begin),
                    (neq,":var015",":var016"),
                    (store_random_in_range,":random_x_017",0,2),
                    (try_begin),
                        (eq,":random_x_017",0),
                        (val_sub, ":var016", 1),
                        (val_add, ":var015", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_custom_battle_designer_11_last_value",":var002"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var015"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var016"),
            (try_begin),
                (lt,"$g_presentation_obj_custom_battle_designer_10_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_10_last_value",0),
            (else_try),
                (lt,"$g_presentation_obj_custom_battle_designer_9_last_value",0),
                (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_9_last_value"),
                (assign,"$g_presentation_obj_custom_battle_designer_9_last_value",0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
        (try_end),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_9_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_15", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_10_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_16", "str_reg0_percent"),
        (assign,reg0,"$g_presentation_obj_custom_battle_designer_11_last_value"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_17", "str_reg0_percent"),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_19"),
    (assign,"$g_is_quick_battle",1),
    (assign,":scene_id_018","$g_quick_battle_map"),
    (try_begin),
        (eq,"$g_quick_battle_game_type",0),
        (assign,":var019","mt_quick_battle_battle"),
        (modify_visitors_at_site,":scene_id_018"),
        (call_script, "script_spawn_quick_battle_army", 0, "$g_quick_battle_team_1_faction", "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value", 0, 1),
        (call_script, "script_spawn_quick_battle_army", 16, "$g_quick_battle_team_2_faction", "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value", 0, 0),
    (else_try),
        (eq,"$g_quick_battle_game_type",1),
        (assign,":var019","mt_quick_battle_siege"),
        (modify_visitors_at_site,":scene_id_018"),
        (call_script, "script_spawn_quick_battle_army", 16, "$g_quick_battle_team_1_faction", "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value", 0, 1),
        (call_script, "script_spawn_quick_battle_army", 0, "$g_quick_battle_team_2_faction", "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value", 1, 0),
    (else_try),
        (assign,":var019","mt_quick_battle_siege"),
        (modify_visitors_at_site,":scene_id_018"),
        (call_script, "script_spawn_quick_battle_army", 0, "$g_quick_battle_team_1_faction", "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value", 1, 1),
        (call_script, "script_spawn_quick_battle_army", 16, "$g_quick_battle_team_2_faction", "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value", 0, 0),
    (try_end),
    (set_jump_mission,":var019"),
    (jump_to_menu,"mnu_custom_battle_end"),
    (jump_to_scene,":scene_id_018"),
    (change_screen_mission),
    (presentation_set_duration, 0),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_20"),
    (presentation_set_duration, 0),
(try_end),
]),

(ti_on_presentation_mouse_enter_leave, [
(try_begin),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_battle_designer_11"),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_battle_designer_10"),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_battle_designer_9"),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_battle_designer_8"),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_battle_designer_7"),
    (eq,":var001","$g_presentation_obj_custom_battle_designer_6"),
    (try_begin),
        (eq,":var002",1),
        (try_begin),
            (eq,":var001","$g_presentation_obj_custom_battle_last_mouse_over_object"),
            (assign,"$g_presentation_obj_custom_battle_last_mouse_over_object",-1),
        (try_end),
    (try_end),
(else_try),
    (assign,"$g_presentation_obj_custom_battle_last_mouse_over_object",":var001"),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (presentation_set_duration, 0),
(else_try),
    (key_clicked, 225),
    (neq,"$g_presentation_obj_custom_battle_last_mouse_over_object",-1),
    (try_begin),
        (eq,"$g_presentation_obj_custom_battle_last_mouse_over_object","$g_presentation_obj_custom_battle_designer_6"),
        (try_begin),
            (eq,"$g_presentation_obj_custom_battle_designer_6_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_6_locked",1),
            (assign,"$g_presentation_obj_custom_battle_designer_7_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_8_locked",0),
        (else_try),
            (assign,"$g_presentation_obj_custom_battle_designer_6_locked",0),
        (try_end),
    (else_try),
        (eq,"$g_presentation_obj_custom_battle_last_mouse_over_object","$g_presentation_obj_custom_battle_designer_7"),
        (try_begin),
            (eq,"$g_presentation_obj_custom_battle_designer_7_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_6_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_7_locked",1),
            (assign,"$g_presentation_obj_custom_battle_designer_8_locked",0),
        (else_try),
            (assign,"$g_presentation_obj_custom_battle_designer_7_locked",0),
        (try_end),
    (else_try),
        (eq,"$g_presentation_obj_custom_battle_last_mouse_over_object","$g_presentation_obj_custom_battle_designer_8"),
        (try_begin),
            (eq,"$g_presentation_obj_custom_battle_designer_8_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_6_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_7_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_8_locked",1),
        (else_try),
            (assign,"$g_presentation_obj_custom_battle_designer_8_locked",0),
        (try_end),
    (else_try),
        (eq,"$g_presentation_obj_custom_battle_last_mouse_over_object","$g_presentation_obj_custom_battle_designer_9"),
        (try_begin),
            (eq,"$g_presentation_obj_custom_battle_designer_9_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_9_locked",1),
            (assign,"$g_presentation_obj_custom_battle_designer_10_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_11_locked",0),
        (else_try),
            (assign,"$g_presentation_obj_custom_battle_designer_9_locked",0),
        (try_end),
    (else_try),
        (eq,"$g_presentation_obj_custom_battle_last_mouse_over_object","$g_presentation_obj_custom_battle_designer_10"),
        (try_begin),
            (eq,"$g_presentation_obj_custom_battle_designer_10_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_9_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_10_locked",1),
            (assign,"$g_presentation_obj_custom_battle_designer_11_locked",0),
        (else_try),
            (assign,"$g_presentation_obj_custom_battle_designer_10_locked",0),
        (try_end),
    (else_try),
        (eq,"$g_presentation_obj_custom_battle_last_mouse_over_object","$g_presentation_obj_custom_battle_designer_11"),
        (try_begin),
            (eq,"$g_presentation_obj_custom_battle_designer_11_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_9_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_10_locked",0),
            (assign,"$g_presentation_obj_custom_battle_designer_11_locked",1),
        (else_try),
            (assign,"$g_presentation_obj_custom_battle_designer_11_locked",0),
        (try_end),
    (try_end),
(try_end),
]),

]),
("game_multiplayer_admin_panel",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(assign,"$g_presentation_obj_admin_panel_1",-1),
(assign,"$g_presentation_obj_admin_panel_2",-1),
(assign,"$g_presentation_obj_admin_panel_3",-1),
(assign,"$g_presentation_obj_admin_panel_4",-1),
(assign,"$g_presentation_obj_admin_panel_5",-1),
(assign,"$g_presentation_obj_admin_panel_6",-1),
(assign,"$g_presentation_obj_admin_panel_7",-1),
(assign,"$g_presentation_obj_admin_panel_8",-1),
(assign,"$g_presentation_obj_admin_panel_9",-1),
(assign,"$g_presentation_obj_admin_panel_10",-1),
(assign,"$g_presentation_obj_admin_panel_11",-1),
(assign,"$g_presentation_obj_admin_panel_12",-1),
(assign,"$g_presentation_obj_admin_panel_13",-1),
(assign,"$g_presentation_obj_admin_panel_14",-1),
(assign,"$g_presentation_obj_admin_panel_15",-1),
(assign,"$g_presentation_obj_admin_panel_16",-1),
(assign,"$g_presentation_obj_admin_panel_17",-1),
(assign,"$g_presentation_obj_admin_panel_18",-1),
(assign,"$g_presentation_obj_admin_panel_19",-1),
(assign,"$g_presentation_obj_admin_panel_20",-1),
(assign,"$g_presentation_obj_admin_panel_21",-1),
(assign,"$g_presentation_obj_admin_panel_22",-1),
(assign,"$g_presentation_obj_admin_panel_23",-1),
(assign,"$g_presentation_obj_admin_panel_24",-1),
(assign,"$g_presentation_obj_admin_panel_25",-1),
(assign,"$g_presentation_obj_admin_panel_26",-1),
(assign,"$g_presentation_obj_admin_panel_27",-1),
(assign,"$g_presentation_obj_admin_panel_28",-1),
(assign,"$g_presentation_obj_admin_panel_29",-1),
(assign,"$g_presentation_obj_admin_panel_30",-1),
(assign,"$g_presentation_obj_admin_panel_31",-1),
(assign,"$g_presentation_obj_admin_panel_32",-1),
(assign,"$g_presentation_obj_admin_panel_33",-1),
(assign,"$g_presentation_obj_admin_panel_34",-1),
(assign,"$g_presentation_obj_admin_panel_35",-1),
(assign,"$g_presentation_obj_admin_panel_36",-1),
(assign,"$g_presentation_obj_admin_panel_37",-1),
(assign,"$g_presentation_obj_admin_panel_38",-1),
(assign,"$g_presentation_obj_admin_panel_39",-1),
(assign,"$g_presentation_obj_admin_panel_40",-1),
(assign,"$g_presentation_obj_admin_panel_41",-1),
(assign,"$g_presentation_obj_admin_panel_42",-1),
(assign,"$g_presentation_obj_admin_panel_43",-1),
(try_begin),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_1"),
    (assign,":var001","mesh_mp_ui_host_maps_1"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_2"),
    (assign,":var001","mesh_mp_ui_host_maps_2"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_3"),
    (assign,":var001","mesh_mp_ui_host_maps_3"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_4"),
    (assign,":var001","mesh_mp_ui_host_maps_4"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_5"),
    (assign,":var001","mesh_mp_ui_host_maps_5"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_6"),
    (assign,":var001","mesh_mp_ui_host_maps_6"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_7"),
    (assign,":var001","mesh_mp_ui_host_maps_7"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_8"),
    (assign,":var001","mesh_mp_ui_host_maps_8"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_9"),
    (assign,":var001","mesh_mp_ui_host_maps_9"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_10"),
    (assign,":var001","mesh_mp_ui_host_maps_10"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_11"),
    (assign,":var001","mesh_mp_ui_host_maps_11"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_12"),
    (assign,":var001","mesh_mp_ui_host_maps_12"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_13"),
    (assign,":var001","mesh_mp_ui_host_maps_13"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_14"),
    (assign,":var001","mesh_mp_ui_host_maps_14"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_15"),
    (assign,":var001","mesh_mp_ui_host_maps_15"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_16"),
    (assign,":var001","mesh_mp_ui_host_maps_16"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_17"),
    (assign,":var001","mesh_mp_ui_host_maps_17"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_18"),
    (assign,":var001","mesh_mp_ui_host_maps_18"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_19"),
    (assign,":var001","mesh_mp_ui_host_maps_19"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_20"),
    (assign,":var001","mesh_mp_ui_host_maps_20"),
(else_try),
    (eq,"$g_multiplayer_selected_map","scn_multi_scene_21"),
    (assign,":var001","mesh_mp_ui_host_maps_21"),
(else_try),
    (this_or_next|eq,"$g_multiplayer_selected_map","scn_random_multi_plain_large"),
    (eq,"$g_multiplayer_selected_map","scn_random_multi_plain_medium"),
    (assign,":var001","mesh_mp_ui_host_maps_randomp"),
(else_try),
    (this_or_next|eq,"$g_multiplayer_selected_map","scn_random_multi_plain_large"),
    (eq,"$g_multiplayer_selected_map","scn_random_multi_plain_medium"),
    (assign,":var001","mesh_mp_ui_host_maps_randoms"),
(else_try),
    (assign,":var001","mesh_mp_ui_host_maps_randomp"),
(try_end),
(create_mesh_overlay, reg0, ":var001"),
(position_set_x,1,-1),
(position_set_y,1,550),
(overlay_set_position, reg0, 1),
(position_set_x,1,1002),
(position_set_y,1,1002),
(overlay_set_size, reg0, 1),
(create_mesh_overlay, reg0, "mesh_mp_ui_host_main"),
(position_set_x,1,-1),
(position_set_y,1,-1),
(overlay_set_position, reg0, 1),
(position_set_x,1,1002),
(position_set_y,1,1002),
(overlay_set_size, reg0, 1),
(assign,":var002",1240),
(assign,":var003",40),
(try_begin),
    (this_or_next|eq,"$g_multiplayer_game_type",6),
    (this_or_next|eq,"$g_multiplayer_game_type",5),
    (this_or_next|eq,"$g_multiplayer_game_type",4),
    (this_or_next|eq,"$g_multiplayer_game_type",3),
    (this_or_next|eq,"$g_multiplayer_game_type",2),
    (eq,"$g_multiplayer_game_type",1),
    (val_add, ":var002", ":var003"),
    (val_add, ":var002", ":var003"),
    (try_begin),
        (this_or_next|eq,"$g_multiplayer_game_type",6),
        (this_or_next|eq,"$g_multiplayer_game_type",5),
        (this_or_next|eq,"$g_multiplayer_game_type",4),
        (this_or_next|eq,"$g_multiplayer_game_type",3),
        (this_or_next|eq,"$g_multiplayer_game_type",2),
        (eq,"$g_multiplayer_game_type",1),
        (val_add, ":var002", ":var003"),
        (try_begin),
            (this_or_next|eq,"$g_multiplayer_game_type",6),
            (this_or_next|eq,"$g_multiplayer_game_type",5),
            (this_or_next|eq,"$g_multiplayer_game_type",4),
            (this_or_next|eq,"$g_multiplayer_game_type",3),
            (this_or_next|eq,"$g_multiplayer_game_type",2),
            (eq,"$g_multiplayer_game_type",1),
            (val_add, ":var002", ":var003"),
            (try_begin),
                (this_or_next|eq,"$g_multiplayer_game_type",6),
                (this_or_next|eq,"$g_multiplayer_game_type",5),
                (this_or_next|eq,"$g_multiplayer_game_type",4),
                (this_or_next|eq,"$g_multiplayer_game_type",3),
                (this_or_next|eq,"$g_multiplayer_game_type",2),
                (eq,"$g_multiplayer_game_type",1),
                (val_add, ":var002", ":var003"),
            (try_end),
        (try_end),
    (try_end),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_is_game_type_captain",1),
    (val_sub, ":var002", ":var003"),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_game_type",8),
    (val_sub, ":var002", ":var003"),
    (val_sub, ":var002", ":var003"),
    (val_sub, ":var002", ":var003"),
(try_end),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_admin_panel_container", 0),
(position_set_x,1,59),
(position_set_y,1,50),
(overlay_set_position, "$g_presentation_obj_admin_panel_container", 1),
(position_set_x,1,640),
(position_set_y,1,520),
(overlay_set_area_size, "$g_presentation_obj_admin_panel_container", 1),
(set_container_overlay, "$g_presentation_obj_admin_panel_container"),
(create_text_overlay, reg0, "str_add_to_official_game_servers_list"),
(position_set_x,1,30),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_check_box_overlay, "$g_presentation_obj_admin_panel_14"),
(position_set_x,1,7),
(store_add, ":var004", ":var002", 7),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_admin_panel_14", 1),
(server_get_add_to_game_servers_list, ":server_add_to_game_servers_list"),
(overlay_set_val, "$g_presentation_obj_admin_panel_14", ":server_add_to_game_servers_list"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_enable_valve_anti_cheat"),
(position_set_x,1,30),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_check_box_overlay, "$g_presentation_obj_admin_panel_41"),
(position_set_x,1,7),
(store_add, ":var004", ":var002", 7),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_admin_panel_41", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_41", 0),
(server_set_anti_cheat, 0),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_server_name"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(str_store_server_name,s0,":"),
(try_begin),
    (eq,"$g_multiplayer_renaming_server_allowed",1),
    (create_simple_text_box_overlay, "$g_presentation_obj_admin_panel_20"),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_20", 1),
    (overlay_set_text, "$g_presentation_obj_admin_panel_20", 0),
(else_try),
    (assign,"$g_presentation_obj_admin_panel_20",-1),
    (create_text_overlay, reg0, 0),
    (position_set_x,1,385),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
(try_end),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_game_password"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_simple_text_box_overlay, "$g_presentation_obj_admin_panel_9"),
(position_set_x,1,390),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_9", 1),
(str_store_server_password,s0,":"),
(overlay_set_text, "$g_presentation_obj_admin_panel_9", 0),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_welcome_message"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_simple_text_box_overlay, "$g_presentation_obj_admin_panel_32"),
(position_set_x,1,390),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_32", 1),
(str_store_welcome_message,s0,":"),
(overlay_set_text, "$g_presentation_obj_admin_panel_32", 0),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_map"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(call_script, "script_multiplayer_fill_map_game_types", "$g_multiplayer_game_type"),
(assign,":var006",reg0),
(assign,":var007",0),
(try_begin),
    (gt,":var006",12),
    (create_combo_label_overlay, "$g_presentation_obj_admin_panel_1"),
(else_try),
    (create_combo_button_overlay, "$g_presentation_obj_admin_panel_1"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_admin_panel_1", 1),
(try_begin),
    (gt,":var006",14),
    (position_set_x,1,465),
(else_try),
    (position_set_x,1,490),
(try_end),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_1", 1),
(troop_get_slot,":troop_slot_008","trp_multiplayer_data",0),
(assign,":var009",0),
(try_for_range, ":var010", 0, ":var006"),
    (store_add, ":slot_no_011", ":var010", 0),
    (troop_get_slot,":troop_slot_012","trp_multiplayer_data",":slot_no_011"),
    (store_sub, ":var013", ":troop_slot_012", ":scn.multi_scene_1"),
    (assign,":var013 +","str_multi_scene_1"),
    (str_store_string,s0,":var013"),
    (overlay_add_item, "$g_presentation_obj_admin_panel_1", 0),
    (try_begin),
        (eq,":troop_slot_012","$g_multiplayer_selected_map"),
        (assign,":var007",":var010"),
        (assign,":var009",1),
    (try_end),
(try_end),
(overlay_set_val, "$g_presentation_obj_admin_panel_1", ":var007"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_game_type"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(try_begin),
    (eq,"$g_multiplayer_changing_game_type_allowed",1),
    (create_combo_button_overlay, "$g_presentation_obj_admin_panel_10"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, "$g_presentation_obj_admin_panel_10", 1),
    (position_set_x,1,490),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_10", 1),
    (try_for_range, ":var014", 0, 9),
        (store_add, ":var013", ":var014", ":gstr.multi_game_type_1"),
        (str_store_string,s0,":var013"),
        (overlay_add_item, "$g_presentation_obj_admin_panel_10", 0),
    (try_end),
    (overlay_set_val, "$g_presentation_obj_admin_panel_10", "$g_multiplayer_game_type"),
(else_try),
    (assign,"$g_presentation_obj_admin_panel_10",-1),
    (store_add, ":var013", "$g_multiplayer_game_type", ":gstr.multi_game_type_1"),
    (str_store_string,s0,":var013"),
    (create_text_overlay, reg0, 0),
    (position_set_x,1,385),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
(try_end),
(val_sub, ":var002", ":var003"),
(try_begin),
    (eq,"$g_multiplayer_game_type",8),
    (create_text_overlay, reg0, "str_ccoop_difficulty"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_combo_button_overlay, "$g_presentation_obj_admin_panel_43"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, "$g_presentation_obj_admin_panel_43", 1),
    (position_set_x,1,490),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_43", 1),
    (overlay_add_item, "$g_presentation_obj_admin_panel_43", "str_ccoop_easy"),
    (overlay_add_item, "$g_presentation_obj_admin_panel_43", "str_ccoop_normal"),
    (overlay_add_item, "$g_presentation_obj_admin_panel_43", "str_ccoop_endless"),
    (overlay_set_val, "$g_presentation_obj_admin_panel_43", "$g_multiplayer_ccoop_difficulty"),
    (val_sub, ":var002", ":var003"),
(try_end),
(assign,reg1,1),
(create_text_overlay, reg0, "str_team_reg1_faction"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_combo_button_overlay, "$g_presentation_obj_admin_panel_11"),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_admin_panel_11", 1),
(position_set_x,1,490),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_11", 1),
(call_script, "script_multiplayer_fill_available_factions_combo_button", "$g_presentation_obj_admin_panel_11", "$g_multiplayer_next_team_1_faction", "$g_multiplayer_next_team_2_faction"),
(val_sub, ":var002", ":var003"),
(try_begin),
    (eq,1,1),
    (assign,reg1,2),
    (create_text_overlay, reg0, "str_team_reg1_faction"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_combo_button_overlay, "$g_presentation_obj_admin_panel_12"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, "$g_presentation_obj_admin_panel_12", 1),
    (position_set_x,1,490),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_12", 1),
    (call_script, "script_multiplayer_fill_available_factions_combo_button", "$g_presentation_obj_admin_panel_12", "$g_multiplayer_next_team_2_faction", "$g_multiplayer_next_team_1_faction"),
    (val_sub, ":var002", ":var003"),
(try_end),
(assign,reg1,1),
(create_text_overlay, reg0, "str_max_number_of_players"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(try_begin),
    (eq,"$g_multiplayer_game_type",8),
    (store_add, ":var015", 12, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_21", 2, ":var015"),
    (try_begin),
        (eq,1,1),
        (server_get_max_num_players, ":server_max_players"),
        (try_begin),
            (gt,":server_max_players",12),
            (multiplayer_send_int_to_server, 3, 12),
        (try_end),
    (try_end),
(else_try),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_21", 2, 201),
(try_end),
(position_set_x,1,390),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_21", 1),
(server_get_max_num_players, ":server_max_players"),
(overlay_set_val, "$g_presentation_obj_admin_panel_21", ":server_max_players"),
(try_begin),
    (neq,"$g_multiplayer_game_type",8),
    (val_sub, ":var002", ":var003"),
    (assign,reg1,1),
    (create_text_overlay, reg0, "str_number_of_bots_in_team_reg1"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_3", 0, "$g_multiplayer_max_num_bots"),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_3", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_3", "$g_multiplayer_num_bots_team_1"),
    (val_sub, ":var002", ":var003"),
    (assign,reg1,2),
    (create_text_overlay, reg0, "str_number_of_bots_in_team_reg1"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_4", 0, "$g_multiplayer_max_num_bots"),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_4", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_4", "$g_multiplayer_num_bots_team_2"),
(try_end),
(try_begin),
    (neq,"$g_multiplayer_game_type",0),
    (neq,"$g_multiplayer_game_type",7),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_allow_friendly_fire"),
    (position_set_x,1,30),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_check_box_overlay, "$g_presentation_obj_admin_panel_5"),
    (position_set_x,1,7),
    (store_add, ":var004", ":var002", 7),
    (position_set_y,1,":var004"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_5", 1),
    (server_get_friendly_fire, ":server_friendly_fire"),
    (overlay_set_val, "$g_presentation_obj_admin_panel_5", ":server_friendly_fire"),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_allow_melee_friendly_fire"),
    (position_set_x,1,30),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_check_box_overlay, "$g_presentation_obj_admin_panel_36"),
    (position_set_x,1,7),
    (store_add, ":var004", ":var002", 7),
    (position_set_y,1,":var004"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_36", 1),
    (server_get_melee_friendly_fire, ":server_melee_friendly_fire"),
    (overlay_set_val, "$g_presentation_obj_admin_panel_36", ":server_melee_friendly_fire"),
(try_end),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_friendly_fire_damage_self_ratio"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_number_box_overlay, "$g_presentation_obj_admin_panel_37", 0, 101),
(position_set_x,1,390),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_37", 1),
(server_get_friendly_fire_damage_self_ratio, ":server_friendly_fire_damage_self_ratio"),
(overlay_set_val, "$g_presentation_obj_admin_panel_37", ":server_friendly_fire_damage_self_ratio"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_friendly_fire_damage_friend_ratio"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_number_box_overlay, "$g_presentation_obj_admin_panel_38", 0, 101),
(position_set_x,1,390),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_38", 1),
(server_get_friendly_fire_damage_friend_ratio, ":server_friendly_fire_damage_friend_ratio"),
(overlay_set_val, "$g_presentation_obj_admin_panel_38", ":server_friendly_fire_damage_friend_ratio"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_spectator_camera"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_combo_button_overlay, "$g_presentation_obj_admin_panel_19"),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_admin_panel_19", 1),
(position_set_x,1,490),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_19", 1),
(overlay_add_item, "$g_presentation_obj_admin_panel_19", "str_free"),
(overlay_add_item, "$g_presentation_obj_admin_panel_19", "str_stick_to_any_player"),
(overlay_add_item, "$g_presentation_obj_admin_panel_19", "str_stick_to_team_members"),
(overlay_add_item, "$g_presentation_obj_admin_panel_19", "str_stick_to_team_members_view"),
(server_get_ghost_mode, ":server_ghost_mode"),
(overlay_set_val, "$g_presentation_obj_admin_panel_19", ":server_ghost_mode"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_control_block_direction"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_combo_button_overlay, "$g_presentation_obj_admin_panel_15"),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_admin_panel_15", 1),
(position_set_x,1,490),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_15", 1),
(overlay_add_item, "$g_presentation_obj_admin_panel_15", "str_automatic"),
(overlay_add_item, "$g_presentation_obj_admin_panel_15", "str_by_mouse_movement"),
(server_get_control_block_dir, ":server_control_block_direction"),
(overlay_set_val, "$g_presentation_obj_admin_panel_15", ":server_control_block_direction"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_combat_speed"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_combo_button_overlay, "$g_presentation_obj_admin_panel_26"),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_admin_panel_26", 1),
(position_set_x,1,490),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_26", 1),
(overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_0"),
(overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_1"),
(overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_2"),
(overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_3"),
(overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_4"),
(server_get_combat_speed, ":server_combat_speed"),
(overlay_set_val, "$g_presentation_obj_admin_panel_26", ":server_combat_speed"),
(try_begin),
    (neq,"$g_multiplayer_game_type",5),
    (neq,"$g_multiplayer_game_type",8),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_map_time_limit"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_7", 5, 121),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_7", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_7", "$g_multiplayer_game_max_minutes"),
(else_try),
    (assign,"$g_presentation_obj_admin_panel_7",-1),
(try_end),
(try_begin),
    (this_or_next|eq,"$g_multiplayer_game_type",6),
    (this_or_next|eq,"$g_multiplayer_game_type",5),
    (this_or_next|eq,"$g_multiplayer_game_type",4),
    (this_or_next|eq,"$g_multiplayer_game_type",3),
    (this_or_next|eq,"$g_multiplayer_game_type",2),
    (eq,"$g_multiplayer_game_type",1),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_round_time_limit"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_16", 60, 901),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_16", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_16", "$g_multiplayer_round_max_seconds"),
(else_try),
    (assign,"$g_presentation_obj_admin_panel_16",-1),
(try_end),
(try_begin),
    (this_or_next|eq,"$g_multiplayer_game_type",6),
    (this_or_next|eq,"$g_multiplayer_game_type",5),
    (this_or_next|eq,"$g_multiplayer_game_type",4),
    (this_or_next|eq,"$g_multiplayer_game_type",3),
    (this_or_next|eq,"$g_multiplayer_game_type",2),
    (eq,"$g_multiplayer_game_type",1),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_players_take_control_of_a_bot_after_death"),
    (position_set_x,1,30),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_check_box_overlay, "$g_presentation_obj_admin_panel_25"),
    (position_set_x,1,7),
    (store_add, ":var004", ":var002", 7),
    (position_set_y,1,":var004"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_25", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_25", "$g_multiplayer_player_respawn_as_bot"),
(else_try),
    (assign,"$g_presentation_obj_admin_panel_25",-1),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_game_type",6),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_defender_spawn_count_limit"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_combo_button_overlay, "$g_presentation_obj_admin_panel_27"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, "$g_presentation_obj_admin_panel_27", 1),
    (position_set_x,1,490),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_27", 1),
    (assign,reg0,5),
    (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
    (assign,reg0,4),
    (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
    (assign,reg0,3),
    (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
    (assign,reg0,2),
    (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
    (assign,reg0,1),
    (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
    (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_unlimited"),
    (store_sub, ":var025", 5, "$g_multiplayer_number_of_respawn_count"),
    (overlay_set_val, "$g_presentation_obj_admin_panel_27", ":var025"),
(else_try),
    (assign,"$g_presentation_obj_admin_panel_27",-1),
(try_end),
(try_begin),
    (neq,"$g_multiplayer_game_type",8),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_team_points_limit"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_8", 3, 1001),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_8", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_8", "$g_multiplayer_game_max_points"),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_game_type",5),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_point_gained_from_flags"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_17", 25, 401),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_17", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_17", "$g_multiplayer_point_gained_from_flags"),
(else_try),
    (assign,"$g_presentation_obj_admin_panel_17",-1),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_game_type",4),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_point_gained_from_capturing_flag"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_18", 0, 11),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_18", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_18", "$g_multiplayer_point_gained_from_capturing_flag"),
(else_try),
    (assign,"$g_presentation_obj_admin_panel_18",-1),
(try_end),
(try_begin),
    (neq,"$g_multiplayer_game_type",8),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_respawn_period"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_6", 3, 31),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_6", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_6", "$g_multiplayer_respawn_period"),
(try_end),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_initial_gold_multiplier"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_number_box_overlay, "$g_presentation_obj_admin_panel_33", 0, 1001),
(position_set_x,1,390),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_33", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_33", "$g_multiplayer_initial_gold_multiplier"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_battle_earnings_multiplier"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_number_box_overlay, "$g_presentation_obj_admin_panel_34", 0, 1001),
(position_set_x,1,390),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_34", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_34", "$g_multiplayer_battle_earnings_multiplier"),
(try_begin),
    (this_or_next|eq,"$g_multiplayer_game_type",6),
    (this_or_next|eq,"$g_multiplayer_game_type",5),
    (this_or_next|eq,"$g_multiplayer_game_type",4),
    (this_or_next|eq,"$g_multiplayer_game_type",3),
    (this_or_next|eq,"$g_multiplayer_game_type",2),
    (eq,"$g_multiplayer_game_type",1),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_round_earnings_multiplier"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_35", 0, 1001),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_35", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_35", "$g_multiplayer_round_earnings_multiplier"),
(else_try),
    (assign,"$g_presentation_obj_admin_panel_35",-1),
(try_end),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_make_kick_voteable"),
(position_set_x,1,30),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_check_box_overlay, "$g_presentation_obj_admin_panel_28"),
(position_set_x,1,7),
(store_add, ":var004", ":var002", 7),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_admin_panel_28", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_28", "$g_multiplayer_kick_voteable"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_make_ban_voteable"),
(position_set_x,1,30),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_check_box_overlay, "$g_presentation_obj_admin_panel_29"),
(position_set_x,1,7),
(store_add, ":var004", ":var002", 7),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_admin_panel_29", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_29", "$g_multiplayer_ban_voteable"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_make_maps_voteable"),
(position_set_x,1,30),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_check_box_overlay, "$g_presentation_obj_admin_panel_24"),
(position_set_x,1,7),
(store_add, ":var004", ":var002", 7),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_admin_panel_24", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_24", "$g_multiplayer_maps_voteable"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_make_factions_voteable"),
(position_set_x,1,30),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_check_box_overlay, "$g_presentation_obj_admin_panel_23"),
(position_set_x,1,7),
(store_add, ":var004", ":var002", 7),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_admin_panel_23", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_23", "$g_multiplayer_factions_voteable"),
(try_begin),
    (neq,"$g_multiplayer_game_type",8),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_bots_upper_limit_for_votes"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (assign,":var026",51),
    (val_min,":var026","$g_multiplayer_max_num_bots"),
    (create_number_box_overlay, "$g_presentation_obj_admin_panel_22", 0, ":var026"),
    (position_set_x,1,390),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_22", 1),
    (overlay_set_val, "$g_presentation_obj_admin_panel_22", "$g_multiplayer_num_bots_voteable"),
(try_end),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_valid_vote_ratio"),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_number_box_overlay, "$g_presentation_obj_admin_panel_30", 50, 101),
(position_set_x,1,390),
(position_set_y,1,":var002"),
(overlay_set_position, "$g_presentation_obj_admin_panel_30", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_30", "$g_multiplayer_valid_vote_ratio"),
(try_begin),
    (neq,"$g_multiplayer_game_type",8),
    (val_sub, ":var002", ":var003"),
    (create_text_overlay, reg0, "str_auto_team_balance_limit"),
    (position_set_x,1,0),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg0, 1),
    (create_combo_button_overlay, "$g_presentation_obj_admin_panel_31"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, "$g_presentation_obj_admin_panel_31", 1),
    (position_set_x,1,490),
    (position_set_y,1,":var002"),
    (overlay_set_position, "$g_presentation_obj_admin_panel_31", 1),
    (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_unlimited"),
    (assign,reg0,6),
    (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
    (assign,reg0,5),
    (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
    (assign,reg0,4),
    (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
    (assign,reg0,3),
    (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
    (assign,reg0,2),
    (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
    (try_begin),
        (ge,"$g_multiplayer_auto_team_balance_limit",1000),
        (overlay_set_val, "$g_presentation_obj_admin_panel_31", 0),
    (else_try),
        (store_sub, ":var027", 7, "$g_multiplayer_auto_team_balance_limit"),
        (overlay_set_val, "$g_presentation_obj_admin_panel_31", ":var027"),
    (try_end),
(try_end),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_allow_player_banners"),
(position_set_x,1,30),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_check_box_overlay, "$g_presentation_obj_admin_panel_39"),
(position_set_x,1,7),
(store_add, ":var004", ":var002", 7),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_admin_panel_39", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_39", "$g_multiplayer_allow_player_banners"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_disallow_ranged_weapons"),
(position_set_x,1,30),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_check_box_overlay, "$g_presentation_obj_admin_panel_42"),
(position_set_x,1,7),
(store_add, ":var004", ":var002", 7),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_admin_panel_42", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_42", "$g_multiplayer_disallow_ranged_weapons"),
(val_sub, ":var002", ":var003"),
(create_text_overlay, reg0, "str_force_default_armor"),
(position_set_x,1,30),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(create_check_box_overlay, "$g_presentation_obj_admin_panel_40"),
(position_set_x,1,7),
(store_add, ":var004", ":var002", 7),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_admin_panel_40", 1),
(overlay_set_val, "$g_presentation_obj_admin_panel_40", "$g_multiplayer_force_default_armor"),
(set_container_overlay, -1),
(create_button_overlay, "$g_presentation_obj_admin_panel_13", "str_back"),
(position_set_x,1,825),
(position_set_y,1,50),
(overlay_set_position, "$g_presentation_obj_admin_panel_13", 1),
(position_set_x,1,1500),
(position_set_y,1,1500),
(overlay_set_size, "$g_presentation_obj_admin_panel_13", 1),
(create_button_overlay, "$g_presentation_obj_admin_panel_2", "str_start_map"),
(position_set_x,1,825),
(position_set_y,1,90),
(overlay_set_position, "$g_presentation_obj_admin_panel_2", 1),
(position_set_x,1,1500),
(position_set_y,1,1500),
(overlay_set_size, "$g_presentation_obj_admin_panel_2", 1),
(presentation_set_duration, 999999),
(try_begin),
    (eq,":var009",0),
    (assign,"$g_multiplayer_selected_map",":troop_slot_008"),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_multiplayer_admin_panel"),
(try_end),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_admin_panel_1"),
    (store_add, ":slot_no_003", ":var002", 0),
    (troop_get_slot,"$g_multiplayer_selected_map","trp_multiplayer_data",":slot_no_003"),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_multiplayer_admin_panel"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_2"),
    (multiplayer_send_2_int_to_server, 2, "$g_multiplayer_selected_map", "$g_multiplayer_game_type"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_3"),
    (multiplayer_send_2_int_to_server, 4, 1, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_4"),
    (multiplayer_send_2_int_to_server, 4, 2, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_5"),
    (multiplayer_send_int_to_server, 5, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_6"),
    (multiplayer_send_int_to_server, 9, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_7"),
    (multiplayer_send_int_to_server, 10, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_8"),
    (multiplayer_send_int_to_server, 12, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_9"),
    (multiplayer_send_string_to_server, 16, 0),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_10"),
    (assign,"$g_multiplayer_game_type",":var002"),
    (call_script, "script_multiplayer_set_g_multiplayer_is_game_type_captain"),
    (try_begin),
        (eq,"$g_multiplayer_is_game_type_captain",1),
        (try_begin),
            (eq,"$g_multiplayer_game_type",8),
        (try_end),
    (else_try),
        (ge,"$g_multiplayer_next_team_2_faction","fac_kingdoms_end"),
        (assign,"$g_multiplayer_next_team_2_faction","fac_kingdom_2"),
        (multiplayer_send_2_int_to_server, 17, 2, "$g_multiplayer_next_team_2_faction"),
    (try_end),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_multiplayer_admin_panel"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_11"),
    (store_add, "$g_multiplayer_next_team_1_faction", ":var002", ":fac.kingdom_1"),
    (multiplayer_send_2_int_to_server, 17, 1, "$g_multiplayer_next_team_1_faction"),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_multiplayer_admin_panel"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_12"),
    (try_begin),
        (eq,":var002",6),
        (assign,"$g_multiplayer_next_team_2_faction","fac_outlaws"),
    (else_try),
        (eq,":var002",7),
        (assign,"$g_multiplayer_next_team_2_faction","fac_ccoop_all_stars"),
    (else_try),
        (store_add, "$g_multiplayer_next_team_2_faction", ":var002", ":fac.kingdom_1"),
    (try_end),
    (multiplayer_send_2_int_to_server, 17, 2, "$g_multiplayer_next_team_2_faction"),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_game_multiplayer_admin_panel"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_13"),
    (presentation_set_duration, 0),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_14"),
    (multiplayer_send_int_to_server, 8, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_15"),
    (multiplayer_send_int_to_server, 7, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_16"),
    (multiplayer_send_int_to_server, 11, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_17"),
    (multiplayer_send_int_to_server, 13, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_18"),
    (multiplayer_send_int_to_server, 14, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_19"),
    (multiplayer_send_int_to_server, 6, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_20"),
    (multiplayer_send_string_to_server, 15, 0),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_21"),
    (multiplayer_send_int_to_server, 3, ":var002"),
    (try_begin),
        (eq,"$g_multiplayer_is_game_type_captain",1),
        (try_begin),
            (eq,"$g_multiplayer_game_type",8),
        (try_end),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_22"),
    (multiplayer_send_int_to_server, 25, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_23"),
    (multiplayer_send_int_to_server, 26, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_24"),
    (multiplayer_send_int_to_server, 27, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_25"),
    (multiplayer_send_int_to_server, 28, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_26"),
    (multiplayer_send_int_to_server, 29, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_27"),
    (store_sub, ":var004", 5, ":var002"),
    (multiplayer_send_int_to_server, 30, ":var004"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_28"),
    (multiplayer_send_int_to_server, 31, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_29"),
    (multiplayer_send_int_to_server, 32, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_30"),
    (multiplayer_send_int_to_server, 33, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_31"),
    (try_begin),
        (eq,":var002",0),
        (multiplayer_send_int_to_server, 34, 1000),
    (else_try),
        (store_sub, ":var004", 7, ":var002"),
        (multiplayer_send_int_to_server, 34, ":var004"),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_32"),
    (server_set_welcome_message, 0),
    (multiplayer_send_string_to_server, 35, 0),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_33"),
    (multiplayer_send_int_to_server, 36, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_34"),
    (multiplayer_send_int_to_server, 37, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_35"),
    (multiplayer_send_int_to_server, 38, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_36"),
    (multiplayer_send_int_to_server, 39, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_37"),
    (multiplayer_send_int_to_server, 40, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_38"),
    (multiplayer_send_int_to_server, 41, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_39"),
    (multiplayer_send_int_to_server, 42, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_40"),
    (multiplayer_send_int_to_server, 43, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_41"),
    (multiplayer_send_int_to_server, 44, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_42"),
    (multiplayer_send_int_to_server, 47, ":var002"),
(else_try),
    (eq,":var001","$g_presentation_obj_admin_panel_43"),
    (assign,"$g_multiplayer_ccoop_difficulty",":var002"),
    (multiplayer_send_2_int_to_server, 48, 14, ":var002"),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_welcome_message",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(str_store_welcome_message,s0,":"),
(try_begin),
    (neg|str_is_empty, 0),
    (eq,"$g_multiplayer_welcome_message_shown",0),
    (create_mesh_overlay, reg0, "mesh_mp_ui_welcome_panel"),
    (position_set_x,1,200),
    (position_set_y,1,400),
    (overlay_set_position, reg0, 1),
    (create_text_overlay, reg0, 0),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,230),
    (position_set_y,1,425),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,540),
    (position_set_y,1,150),
    (overlay_set_area_size, reg0, 1),
    (presentation_set_duration, 999999),
(else_try),
    (eq,"$g_multiplayer_show_server_rules",1),
    (create_mesh_overlay, reg0, "mesh_mp_ui_welcome_panel"),
    (position_set_x,1,200),
    (position_set_y,1,400),
    (overlay_set_position, reg0, 1),
    (try_begin),
        (neg|str_is_empty, 0),
        (str_clear, 3),
        (str_store_string,s2,0),
        (str_store_string,s2,"str_s2_s3"),
        (str_store_string,s2,"str_s2_s3"),
    (else_try),
        (str_clear, 2),
    (try_end),
    (str_store_string,s3,"@Game Rules:^"),
    (str_store_string,s2,"str_s2_s3"),
    (assign,":var001",1000),
    (call_script, "script_game_multiplayer_get_game_type_mission_template", "$g_multiplayer_game_type"),
    (assign,":var002",reg0),
    (str_store_server_name,s0,":"),
    (str_store_string,s3,"str_server_name_s0"),
    (str_store_string,s2,"str_s2_s3"),
    (try_begin),
        (eq,"$g_multiplayer_game_type",0),
        (str_store_string,s0,"str_multi_game_type_1"),
    (else_try),
        (eq,"$g_multiplayer_game_type",1),
        (str_store_string,s0,"str_multi_game_type_2"),
    (else_try),
        (eq,"$g_multiplayer_game_type",2),
        (str_store_string,s0,"str_multi_game_type_3"),
    (else_try),
        (eq,"$g_multiplayer_game_type",3),
        (str_store_string,s0,"str_multi_game_type_4"),
    (else_try),
        (eq,"$g_multiplayer_game_type",4),
        (str_store_string,s0,"str_multi_game_type_5"),
    (else_try),
        (eq,"$g_multiplayer_game_type",5),
        (str_store_string,s0,"str_multi_game_type_6"),
    (else_try),
        (eq,"$g_multiplayer_game_type",6),
        (str_store_string,s0,"str_multi_game_type_7"),
    (else_try),
        (eq,"$g_multiplayer_game_type",7),
        (str_store_string,s0,"str_multi_game_type_8"),
    (else_try),
        (eq,"$g_multiplayer_game_type",8),
        (str_store_string,s0,"str_multi_game_type_9"),
    (try_end),
    (str_store_string,s3,"str_game_type_s0"),
    (str_store_string,s2,"str_s2_s3"),
    (try_begin),
        (eq,"$g_multiplayer_game_type",8),
        (store_add, ":var003", "$g_multiplayer_ccoop_difficulty", ":gstr.ccoop_easy"),
        (str_store_string,s0,":var003"),
        (str_store_string,s3,"str_ccoop_difficulty_s0"),
        (str_store_string,s2,"str_s2_s3"),
    (try_end),
    (store_current_scene,":cur_scene_004"),
    (assign,":cur_scene_004 -","scn_multi_scene_1"),
    (assign,":cur_scene_004 +","str_multi_scene_1"),
    (str_store_string,s0,":cur_scene_004"),
    (str_store_string,s3,"str_map_name_s0"),
    (str_store_string,s2,"str_s2_s3"),
    (store_mission_timer_a,":m_timer_a_005"),
    (val_add, ":m_timer_a_005", "$server_mission_timer_while_player_joined"),
    (assign,reg0,":m_timer_a_005"),
    (store_mul, ":_g_multiplayer_game_max_seconds", "$g_multiplayer_game_max_minutes", 60),
    (store_sub, ":var006", "$g_multiplayer_game_max_seconds", ":m_timer_a_005"),
    (store_div, ":var___x1", ":var006", 60),
    (assign,reg0,":var___x1"),
    (store_mod,reg1,":var006",60),
    (try_begin),
        (ge,reg0,10),
        (ge,reg1,10),
        (str_clear, 0),
        (str_clear, 1),
    (else_try),
        (ge,reg0,10),
        (str_clear, 0),
        (str_store_string,s1,"@0"),
    (else_try),
        (ge,reg1,10),
        (str_store_string,s0,"@0"),
        (str_clear, 1),
    (else_try),
        (str_store_string,s0,"@0"),
        (str_store_string,s1,"@0"),
    (try_end),
    (str_store_string,s3,"str_remaining_time_s0reg0_s1reg1"),
    (str_store_string,s2,"str_s2_s3"),
    (try_for_range, ":var007", 0, ":var001"),
        (assign,reg0,-12345),
        (call_script, "script_game_get_multiplayer_server_option_for_mission_template", ":var002", ":var007"),
        (try_begin),
            (eq,reg0,-12345),
            (assign,":var001",0),
        (else_try),
            (call_script, "script_game_multiplayer_server_option_for_mission_template_to_string", ":var002", ":var007", reg0),
            (str_store_string,s3,0),
            (str_store_string,s2,"str_s2_s3"),
        (try_end),
    (try_end),
    (create_text_overlay, reg0, 2),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,230),
    (position_set_y,1,425),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,540),
    (position_set_y,1,150),
    (overlay_set_area_size, reg0, 1),
    (presentation_set_duration, 999999),
(try_end),
]),

(ti_on_presentation_run, [
(str_store_welcome_message,s0,":"),
(try_begin),
    (neq,"$g_multiplayer_show_server_rules",1),
    (this_or_next|str_is_empty, 0),
    (eq,"$g_multiplayer_welcome_message_shown",1),
    (presentation_set_duration, 0),
    (try_begin),
        (neg|is_presentation_active, "prsnt_multiplayer_escape_menu"),
        (neg|is_presentation_active, "prsnt_multiplayer_team_select"),
        (start_presentation, "prsnt_multiplayer_team_select"),
    (else_try),
        (store_mission_timer_a,":m_timer_a_001"),
        (try_begin),
            (gt,":m_timer_a_001",1),
            (this_or_next|key_clicked, 1),
            (this_or_next|key_clicked, 57),
            (this_or_next|key_clicked, 28),
            (this_or_next|key_clicked, 224),
            (this_or_next|key_clicked, 225),
            (this_or_next|key_clicked, 252),
            (key_clicked, 253),
            (assign,"$g_multiplayer_welcome_message_shown",1),
            (presentation_set_duration, 0),
            (try_begin),
                (neg|is_presentation_active, "prsnt_multiplayer_escape_menu"),
                (neg|is_presentation_active, "prsnt_multiplayer_team_select"),
                (try_begin),
                    (eq,"$g_multiplayer_show_server_rules",1),
                    (assign,"$g_multiplayer_show_server_rules",0),
                    (start_presentation, "prsnt_multiplayer_escape_menu"),
                (else_try),
                    (start_presentation, "prsnt_multiplayer_team_select"),
                (try_end),
            (try_end),
        (try_end),
    (try_end),
(try_end),
]),

]),
("multiplayer_team_select",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
(position_set_x,1,250),
(position_set_y,1,80),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_team_select_container", 0),
(position_set_x,1,285),
(position_set_y,1,125),
(overlay_set_position, "$g_presentation_obj_team_select_container", 1),
(position_set_x,1,405),
(position_set_y,1,500),
(overlay_set_area_size, "$g_presentation_obj_team_select_container", 1),
(set_container_overlay, "$g_presentation_obj_team_select_container"),
(assign,":var001",450),
(create_text_overlay, reg0, "str_choose_a_faction"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,0),
(position_set_y,1,":var001"),
(overlay_set_position, reg0, 1),
(val_sub, ":var001", 40),
(position_set_y,1,":var001"),
(position_set_x,1,100),
(multiplayer_get_my_player, ":my_player"),
(team_get_faction, ":team_faction_003", 0),
(str_store_faction_name,s0,":team_faction_003"),
(create_button_overlay, "$g_presentation_obj_team_select_1", 0),
(try_begin),
    (call_script, "script_cf_multiplayer_team_is_available", ":my_player", 0),
    (overlay_set_color, "$g_presentation_obj_team_select_1", 16777215),
    (overlay_set_hilight_color, "$g_presentation_obj_team_select_1", 5635920),
    (assign,"$g_multiplayer_team_select_1_available",1),
(else_try),
    (overlay_set_color, "$g_presentation_obj_team_select_1", 8947848),
    (overlay_set_hilight_color, "$g_presentation_obj_team_select_1", 8947848),
    (assign,"$g_multiplayer_team_select_1_available",0),
(try_end),
(position_set_y,1,":var001"),
(overlay_set_position, "$g_presentation_obj_team_select_1", 1),
(val_sub, ":var001", 40),
(position_set_y,1,":var001"),
(try_begin),
    (eq,1,1),
    (team_get_faction, ":team_faction_003", 1),
    (str_store_faction_name,s0,":team_faction_003"),
    (try_begin),
        (neq,"$g_multiplayer_game_type",8),
        (create_button_overlay, "$g_presentation_obj_team_select_2", 0),
    (else_try),
        (assign,"$g_presentation_obj_team_select_2",-1),
    (try_end),
    (try_begin),
        (call_script, "script_cf_multiplayer_team_is_available", ":my_player", 1),
        (try_begin),
            (neq,"$g_multiplayer_game_type",8),
            (overlay_set_color, "$g_presentation_obj_team_select_2", 16777215),
            (overlay_set_hilight_color, "$g_presentation_obj_team_select_2", 5635920),
        (try_end),
        (assign,"$g_multiplayer_team_select_2_available",1),
    (else_try),
        (try_begin),
            (neq,"$g_multiplayer_game_type",8),
            (overlay_set_color, "$g_presentation_obj_team_select_2", 8947848),
            (overlay_set_hilight_color, "$g_presentation_obj_team_select_2", 8947848),
        (try_end),
        (assign,"$g_multiplayer_team_select_2_available",0),
    (try_end),
    (try_begin),
        (neq,"$g_multiplayer_game_type",8),
        (overlay_set_position, "$g_presentation_obj_team_select_2", 1),
        (val_sub, ":var001", 40),
        (position_set_y,1,":var001"),
    (try_end),
(try_end),
(create_button_overlay, "$g_presentation_obj_team_select_3", "str_spectator"),
(overlay_set_color, "$g_presentation_obj_team_select_3", 16777215),
(overlay_set_position, "$g_presentation_obj_team_select_3", 1),
(val_sub, ":var001", 40),
(position_set_y,1,":var001"),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(multiplayer_get_my_player, ":my_player"),
(try_begin),
    (eq,"$g_waiting_for_confirmation_to_terminate",0),
    (try_begin),
        (eq,":var001","$g_presentation_obj_team_select_1"),
        (try_begin),
            (call_script, "script_cf_multiplayer_team_is_available", ":my_player", 0),
            (try_begin),
                (eq,1,1),
                (player_get_team_no,  ":team_no_003", ":my_player"),
                (try_begin),
                    (neq,":team_no_003",0),
                    (assign,"$g_confirmation_result",0),
                    (try_begin),
                        (neq,"$g_multiplayer_game_type",8),
                        (neq,"$g_multiplayer_game_type",0),
                        (neq,"$g_multiplayer_game_type",7),
                        (assign,"$g_waiting_for_confirmation_to_terminate",1),
                    (try_end),
                (try_end),
                (player_get_troop_id, "$g_confirmation_troop_backup", ":my_player"),
                (player_get_team_no,  "$g_confirmation_team_backup", ":my_player"),
                (player_set_troop_id, ":my_player", -1),
                (multiplayer_send_int_to_server, 19, 0),
                (player_get_team_no,  ":my_player", 0),
                (call_script, "script_mp_set_player_team_no", ":my_player", 0, 1),
                (try_begin),
                    (this_or_next|eq,"$g_multiplayer_game_type",7),
                    (this_or_next|eq,"$g_multiplayer_game_type",0),
                    (eq,"$g_multiplayer_game_type",8),
                    (presentation_set_duration, 0),
                    (start_presentation, "prsnt_multiplayer_troop_select"),
                (try_end),
            (else_try),
                (presentation_set_duration, 0),
                (start_presentation, "prsnt_multiplayer_troop_select"),
            (try_end),
        (try_end),
    (else_try),
        (eq,":var001","$g_presentation_obj_team_select_2"),
        (try_begin),
            (call_script, "script_cf_multiplayer_team_is_available", ":my_player", 1),
            (try_begin),
                (eq,1,1),
                (player_get_team_no,  ":team_no_003", ":my_player"),
                (try_begin),
                    (neq,":team_no_003",1),
                    (assign,"$g_confirmation_result",0),
                    (try_begin),
                        (neq,"$g_multiplayer_game_type",8),
                        (neq,"$g_multiplayer_game_type",0),
                        (neq,"$g_multiplayer_game_type",7),
                        (assign,"$g_waiting_for_confirmation_to_terminate",1),
                    (try_end),
                (try_end),
                (player_get_troop_id, "$g_confirmation_troop_backup", ":my_player"),
                (player_get_team_no,  "$g_confirmation_team_backup", ":my_player"),
                (player_set_troop_id, ":my_player", -1),
                (multiplayer_send_int_to_server, 19, 1),
                (player_get_team_no,  ":my_player", 1),
                (call_script, "script_mp_set_player_team_no", ":my_player", 1, 1),
                (try_begin),
                    (this_or_next|eq,"$g_multiplayer_game_type",7),
                    (this_or_next|eq,"$g_multiplayer_game_type",0),
                    (eq,"$g_multiplayer_game_type",8),
                    (presentation_set_duration, 0),
                    (start_presentation, "prsnt_multiplayer_troop_select"),
                (try_end),
            (else_try),
                (presentation_set_duration, 0),
                (start_presentation, "prsnt_multiplayer_troop_select"),
            (try_end),
        (try_end),
    (else_try),
        (eq,":var001","$g_presentation_obj_team_select_3"),
        (player_set_troop_id, ":my_player", -1),
        (multiplayer_send_int_to_server, 19, 2),
        (player_get_team_no,  ":my_player", 2),
        (presentation_set_duration, 0),
    (try_end),
(try_end),
]),

(ti_on_presentation_run, [
(multiplayer_get_my_player, ":my_player"),
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (eq,"$g_waiting_for_confirmation_to_terminate",0),
    (multiplayer_get_my_team, ":my_team_no"),
    (try_begin),
        (eq,":my_team_no",3),
        (player_set_troop_id, ":my_player", -1),
        (multiplayer_send_int_to_server, 19, 2),
        (player_get_team_no,  ":my_player", 2),
    (try_end),
    (presentation_set_duration, 0),
(else_try),
    (eq,"$g_waiting_for_confirmation_to_terminate",1),
    (eq,"$g_confirmation_result",1),
    (assign,"$g_waiting_for_confirmation_to_terminate",0),
    (assign,"$g_confirmation_result",0),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_multiplayer_troop_select"),
(else_try),
    (eq,"$g_waiting_for_confirmation_to_terminate",1),
    (eq,"$g_confirmation_result",-1),
    (player_set_troop_id, ":my_player", "$g_confirmation_troop_backup"),
    (player_get_team_no,  ":my_player", "$g_confirmation_team_backup"),
    (assign,"$g_waiting_for_confirmation_to_terminate",0),
    (assign,"$g_confirmation_result",0),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_multiplayer_team_select"),
(else_try),
    (assign,":var003",0),
    (try_begin),
        (call_script, "script_cf_multiplayer_team_is_available", ":my_player", 0),
        (try_begin),
            (eq,"$g_multiplayer_team_select_1_available",0),
            (assign,":var003",1),
        (try_end),
    (else_try),
        (try_begin),
            (eq,"$g_multiplayer_team_select_1_available",1),
            (assign,":var003",1),
        (try_end),
    (try_end),
    (try_begin),
        (call_script, "script_cf_multiplayer_team_is_available", ":my_player", 1),
        (try_begin),
            (eq,"$g_multiplayer_team_select_2_available",0),
            (assign,":var003",1),
        (try_end),
    (else_try),
        (try_begin),
            (eq,"$g_multiplayer_team_select_2_available",1),
            (assign,":var003",1),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":var003",1),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_team_select"),
    (try_end),
(try_end),
]),

]),
("multiplayer_troop_select",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
(position_set_x,1,250),
(position_set_y,1,80),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_troop_select_container", 0),
(position_set_x,1,285),
(position_set_y,1,125),
(overlay_set_position, "$g_presentation_obj_troop_select_container", 1),
(position_set_x,1,405),
(position_set_y,1,500),
(overlay_set_area_size, "$g_presentation_obj_troop_select_container", 1),
(set_container_overlay, "$g_presentation_obj_troop_select_container"),
(assign,":var001",450),
(create_text_overlay, reg0, "str_choose_a_troop"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,0),
(position_set_y,1,":var001"),
(overlay_set_position, reg0, 1),
(val_sub, ":var001", 40),
(position_set_y,1,":var001"),
(position_set_x,1,100),
(multiplayer_get_my_player, ":my_player"),
(player_get_team_no,  ":team_no_003", ":my_player"),
(team_get_faction, ":team_faction_004", ":team_no_003"),
(try_for_range, ":slot_no_005", 30, 46),
    (troop_set_slot,"trp_multiplayer_data",":slot_no_005",-1),
(try_end),
(assign,":var006",0),
(try_for_range, ":trp_007", ":trp.swadian_crossbowman_multiplayer", ":trp.multiplayer_end"),
    (store_troop_faction,":troop_faction_008",":trp_007"),
    (try_begin),
        (eq,":troop_faction_008",":team_faction_004"),
        (str_store_troop_name,s1,":trp_007"),
        (create_button_overlay, reg0, 1),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":slot_no_009", ":var006", 30),
        (troop_set_slot,"trp_multiplayer_data",":slot_no_009",reg0),
        (position_set_y,1,":var001"),
        (overlay_set_position, reg0, 1),
        (val_sub, ":var001", 40),
        (position_set_y,1,":var001"),
        (val_add, ":var006", 1),
    (try_end),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(multiplayer_get_my_player, ":my_player"),
(player_get_team_no,  ":team_no_003", ":my_player"),
(team_get_faction, ":team_faction_004", ":team_no_003"),
(assign,":troop_id_005",-1),
(assign,":var006",46),
(try_for_range, ":var007", 30, ":var006"),
    (try_begin),
        (troop_slot_eq,"trp_multiplayer_data",":var007",":var001"),
        (store_sub, ":var008", ":var007", 30),
        (assign,":var009","trp_multiplayer_end"),
        (try_for_range, ":troop_id_010", ":trp.swadian_crossbowman_multiplayer", ":var009"),
            (store_troop_faction,":troop_faction_011",":troop_id_010"),
            (try_begin),
                (eq,":troop_faction_011",":team_faction_004"),
                (val_sub, ":var008", 1),
                (try_begin),
                    (lt,":var008",0),
                    (assign,":troop_id_005",":troop_id_010"),
                    (assign,":var009",0),
                (try_end),
            (try_end),
        (try_end),
    (try_end),
    (try_begin),
        (eq,1,1),
        (multiplayer_get_my_troop, ":troop_id_010"),
        (try_begin),
            (neq,":troop_id_010",":troop_id_005"),
            (player_set_troop_id, ":my_player", ":troop_id_005"),
            (multiplayer_send_int_to_server, 20, ":troop_id_005"),
            (call_script, "script_multiplayer_set_default_item_selections_for_troop", ":troop_id_005"),
            (call_script, "script_multiplayer_send_item_selections"),
        (try_end),
    (try_end),
    (presentation_set_duration, 0),
    (assign,"$g_presentation_state",0),
    (try_begin),
        (call_script, "script_cf_multiplayer_can_buy_squad"),
        (assign,"$g_presentation_state",10),
    (try_end),
    (start_presentation, "prsnt_multiplayer_item_select"),
    (assign,":var006",0),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (is_between,":my_player",0,1000),
        (multiplayer_get_my_troop, ":my_troop_id"),
        (try_begin),
            (eq,"$g_multiplayer_is_game_type_captain",1),
            (neg|is_between,":my_troop_id","trp_swadian_crossbowman_multiplayer","trp_multiplayer_end"),
            (call_script, "script_mp_set_player_team_no", ":my_player", 2, 1),
        (else_try),
            (neg|is_between,":my_troop_id","trp_swadian_crossbowman_multiplayer","trp_multiplayer_end"),
            (player_set_troop_id, ":my_player", -1),
            (multiplayer_send_int_to_server, 20, -1),
            (multiplayer_send_int_to_server, 19, 2),
            (player_get_team_no,  ":my_player", 2),
        (try_end),
    (try_end),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_item_select",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(multiplayer_get_my_player, ":my_player"),
(assign,"$g_presentation_obj_item_select_1",-1),
(assign,"$g_presentation_obj_item_select_2",-1),
(assign,"$g_presentation_obj_item_select_3",-1),
(assign,"$g_presentation_obj_item_select_4",-1),
(assign,"$g_presentation_obj_item_select_5",-1),
(assign,"$g_presentation_obj_item_select_6",-1),
(assign,"$g_presentation_obj_item_select_7",-1),
(assign,"$g_presentation_obj_item_select_8",-1),
(assign,"$g_presentation_obj_item_select_9",-1),
(assign,"$g_presentation_obj_item_select_10",-1),
(assign,"$g_presentation_obj_item_select_11",-1),
(assign,"$g_presentation_obj_item_select_12",-1),
(assign,"$g_presentation_obj_item_select_13",-1),
(assign,"$g_presentation_obj_item_select_14",-1),
(assign,"$g_presentation_obj_item_select_15",-1),
(assign,"$g_presentation_obj_item_select_16",-1),
(assign,"$g_presentation_obj_item_select_17",-1),
(try_begin),
    (neq,"$g_current_opened_item_details",-1),
    (close_item_details),
    (assign,"$g_current_opened_item_details",-1),
(try_end),
(store_add, ":slot_no_002", 2, 0),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(try_begin),
    (ge,":player_slot_003",0),
    (create_image_button_overlay, "$g_presentation_obj_item_select_1", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
    (create_mesh_overlay_with_item_id, reg0, ":player_slot_003"),
    (position_set_x,1,950),
    (position_set_y,1,526),
    (overlay_set_position, reg0, 1),
    (assign,"$g_inside_obj_1",reg0),
(else_try),
    (create_image_button_overlay, "$g_presentation_obj_item_select_1", "mesh_mp_inventory_slot_equip", "mesh_mp_inventory_slot_equip"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_item_select_1", 1),
(position_set_x,1,899),
(position_set_y,1,475),
(overlay_set_position, "$g_presentation_obj_item_select_1", 1),
(store_add, ":slot_no_002", 2, 1),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(try_begin),
    (ge,":player_slot_003",0),
    (create_image_button_overlay, "$g_presentation_obj_item_select_2", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
    (create_mesh_overlay_with_item_id, reg0, ":player_slot_003"),
    (position_set_x,1,950),
    (position_set_y,1,426),
    (overlay_set_position, reg0, 1),
    (assign,"$g_inside_obj_2",reg0),
(else_try),
    (create_image_button_overlay, "$g_presentation_obj_item_select_2", "mesh_mp_inventory_slot_equip", "mesh_mp_inventory_slot_equip"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_item_select_2", 1),
(position_set_x,1,899),
(position_set_y,1,375),
(overlay_set_position, "$g_presentation_obj_item_select_2", 1),
(store_add, ":slot_no_002", 2, 2),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(try_begin),
    (ge,":player_slot_003",0),
    (create_image_button_overlay, "$g_presentation_obj_item_select_3", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
    (create_mesh_overlay_with_item_id, reg0, ":player_slot_003"),
    (position_set_x,1,950),
    (position_set_y,1,326),
    (overlay_set_position, reg0, 1),
    (assign,"$g_inside_obj_3",reg0),
(else_try),
    (create_image_button_overlay, "$g_presentation_obj_item_select_3", "mesh_mp_inventory_slot_equip", "mesh_mp_inventory_slot_equip"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_item_select_3", 1),
(position_set_x,1,899),
(position_set_y,1,275),
(overlay_set_position, "$g_presentation_obj_item_select_3", 1),
(store_add, ":slot_no_002", 2, 3),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(try_begin),
    (ge,":player_slot_003",0),
    (create_image_button_overlay, "$g_presentation_obj_item_select_4", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
    (create_mesh_overlay_with_item_id, reg0, ":player_slot_003"),
    (position_set_x,1,950),
    (position_set_y,1,226),
    (overlay_set_position, reg0, 1),
    (assign,"$g_inside_obj_4",reg0),
(else_try),
    (create_image_button_overlay, "$g_presentation_obj_item_select_4", "mesh_mp_inventory_slot_equip", "mesh_mp_inventory_slot_equip"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_item_select_4", 1),
(position_set_x,1,899),
(position_set_y,1,175),
(overlay_set_position, "$g_presentation_obj_item_select_4", 1),
(store_add, ":slot_no_002", 2, 4),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(try_begin),
    (ge,":player_slot_003",0),
    (create_image_button_overlay, "$g_presentation_obj_item_select_5", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
    (create_mesh_overlay_with_item_id, reg0, ":player_slot_003"),
    (position_set_x,1,53),
    (position_set_y,1,576),
    (overlay_set_position, reg0, 1),
    (assign,"$g_inside_obj_5",reg0),
(else_try),
    (create_image_button_overlay, "$g_presentation_obj_item_select_5", "mesh_mp_inventory_slot_helmet", "mesh_mp_inventory_slot_helmet"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_item_select_5", 1),
(position_set_x,1,2),
(position_set_y,1,525),
(overlay_set_position, "$g_presentation_obj_item_select_5", 1),
(store_add, ":slot_no_002", 2, 5),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(try_begin),
    (ge,":player_slot_003",0),
    (create_image_button_overlay, "$g_presentation_obj_item_select_6", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
    (create_mesh_overlay_with_item_id, reg0, ":player_slot_003"),
    (position_set_x,1,53),
    (position_set_y,1,476),
    (overlay_set_position, reg0, 1),
    (assign,"$g_inside_obj_6",reg0),
(else_try),
    (create_image_button_overlay, "$g_presentation_obj_item_select_6", "mesh_mp_inventory_slot_armor", "mesh_mp_inventory_slot_armor"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_item_select_6", 1),
(position_set_x,1,2),
(position_set_y,1,425),
(overlay_set_position, "$g_presentation_obj_item_select_6", 1),
(store_add, ":slot_no_002", 2, 6),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(try_begin),
    (ge,":player_slot_003",0),
    (create_image_button_overlay, "$g_presentation_obj_item_select_7", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
    (create_mesh_overlay_with_item_id, reg0, ":player_slot_003"),
    (position_set_x,1,53),
    (position_set_y,1,376),
    (overlay_set_position, reg0, 1),
    (assign,"$g_inside_obj_7",reg0),
(else_try),
    (create_image_button_overlay, "$g_presentation_obj_item_select_7", "mesh_mp_inventory_slot_boot", "mesh_mp_inventory_slot_boot"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_item_select_7", 1),
(position_set_x,1,2),
(position_set_y,1,325),
(overlay_set_position, "$g_presentation_obj_item_select_7", 1),
(store_add, ":slot_no_002", 2, 7),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(try_begin),
    (ge,":player_slot_003",0),
    (create_image_button_overlay, "$g_presentation_obj_item_select_8", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
    (create_mesh_overlay_with_item_id, reg0, ":player_slot_003"),
    (position_set_x,1,53),
    (position_set_y,1,276),
    (overlay_set_position, reg0, 1),
    (assign,"$g_inside_obj_8",reg0),
(else_try),
    (create_image_button_overlay, "$g_presentation_obj_item_select_8", "mesh_mp_inventory_slot_glove", "mesh_mp_inventory_slot_glove"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_item_select_8", 1),
(position_set_x,1,2),
(position_set_y,1,225),
(overlay_set_position, "$g_presentation_obj_item_select_8", 1),
(store_add, ":slot_no_002", 2, 8),
(player_get_slot,":player_slot_003",":my_player",":slot_no_002"),
(try_begin),
    (ge,":player_slot_003",0),
    (eq,"$g_horses_are_avaliable",1),
    (create_image_button_overlay, "$g_presentation_obj_item_select_9", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
    (create_mesh_overlay_with_item_id, reg0, ":player_slot_003"),
    (position_set_x,1,53),
    (position_set_y,1,176),
    (overlay_set_position, reg0, 1),
    (assign,"$g_inside_obj_9",reg0),
(else_try),
    (create_image_button_overlay, "$g_presentation_obj_item_select_9", "mesh_mp_inventory_slot_horse", "mesh_mp_inventory_slot_horse"),
(try_end),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, "$g_presentation_obj_item_select_9", 1),
(position_set_x,1,2),
(position_set_y,1,125),
(overlay_set_position, "$g_presentation_obj_item_select_9", 1),
(create_mesh_overlay, reg0, "mesh_mp_inventory_left"),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, reg0, 1),
(position_set_x,1,0),
(position_set_y,1,14),
(overlay_set_position, reg0, 1),
(create_mesh_overlay, reg0, "mesh_mp_inventory_right"),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, reg0, 1),
(position_set_x,1,894),
(position_set_y,1,65),
(overlay_set_position, reg0, 1),
(create_in_game_button_overlay, "$g_presentation_obj_item_select_10", "str_reset_to_default"),
(overlay_set_color, "$g_presentation_obj_item_select_10", 16777215),
(position_set_x,1,605),
(position_set_y,1,25),
(overlay_set_position, "$g_presentation_obj_item_select_10", 1),
(create_in_game_button_overlay, "$g_presentation_obj_item_select_11", "str_done"),
(overlay_set_color, "$g_presentation_obj_item_select_11", 16777215),
(position_set_x,1,395),
(position_set_y,1,25),
(overlay_set_position, "$g_presentation_obj_item_select_11", 1),
(assign,":var004",725),
(multiplayer_get_my_player, ":my_player"),
(player_get_team_no,  ":team_no_005", ":my_player"),
(assign,":var006",0),
(try_begin),
    (call_script, "script_cf_multiplayer_can_buy_squad"),
    (assign,":var006",1),
(else_try),
    (neq,"$g_multiplayer_is_game_type_captain",1),
    (eq,":team_no_005",0),
    (gt,"$g_multiplayer_num_bots_team_1",0),
    (assign,":var006",1),
(else_try),
    (neq,"$g_multiplayer_is_game_type_captain",1),
    (eq,":team_no_005",1),
    (gt,"$g_multiplayer_num_bots_team_2",0),
    (assign,":var006",1),
(try_end),
(team_get_faction, ":team_faction_007", ":team_no_005"),
(try_begin),
    (eq,":var006",1),
    (neq,"$g_multiplayer_game_type",0),
    (neq,"$g_multiplayer_game_type",7),
    (assign,":var008",0),
    (try_begin),
        (eq,":var006",1),
        (try_for_range, ":trp_009", ":trp.swadian_crossbowman_multiplayer_ai", ":trp.swadian_crossbowman_multiplayer"),
            (store_troop_faction,":troop_faction_010",":trp_009"),
            (try_begin),
                (eq,":troop_faction_010",":team_faction_007"),
                (val_add, ":var008", 1),
            (try_end),
        (try_end),
    (try_end),
    (try_begin),
        (eq,"$g_multiplayer_is_game_type_captain",1),
        (assign,":var008",3),
    (try_end),
    (store_mul, ":var011", ":var008", 20),
    (val_add, ":var011", 40),
    (try_begin),
        (eq,"$g_multiplayer_is_game_type_captain",1),
        (create_in_game_button_overlay, "$g_presentation_obj_item_select_17", "str_mp_add_troop"),
        (overlay_set_color, "$g_presentation_obj_item_select_17", 16777215),
        (position_set_x,1,500),
        (position_set_y,1,650),
        (overlay_set_position, "$g_presentation_obj_item_select_17", 1),
    (else_try),
        (create_mesh_overlay, reg0, "mesh_mp_ui_command_border_r"),
        (position_set_x,1,280),
        (position_set_y,1,680),
        (overlay_set_position, reg0, 1),
        (position_set_x,1,2500),
        (position_set_y,1,2500),
        (overlay_set_size, reg0, 1),
        (create_mesh_overlay, reg0, "mesh_mp_ui_command_border_l"),
        (position_set_x,1,650),
        (position_set_y,1,680),
        (overlay_set_position, reg0, 1),
        (position_set_x,1,2500),
        (position_set_y,1,2500),
        (overlay_set_size, reg0, 1),
        (create_mesh_overlay, reg0, "mesh_mp_ui_command_panel"),
        (position_set_x,1,350),
        (store_sub, ":var012", 750, ":var011"),
        (position_set_y,1,":var012"),
        (overlay_set_position, reg0, 1),
        (position_set_x,1,3000),
        (position_set_y,1,3000),
        (overlay_set_size, reg0, 1),
        (create_text_overlay, reg0, "str_command"),
        (overlay_set_color, reg0, 16777215),
        (position_set_x,1,800),
        (position_set_y,1,800),
        (overlay_set_size, reg0, 1),
        (position_set_x,1,370),
        (position_set_y,1,":var004"),
        (overlay_set_position, reg0, 1),
        (val_sub, ":var004", 20),
    (try_end),
    (assign,":var013",0),
    (try_begin),
        (eq,"$g_multiplayer_is_game_type_captain",0),
        (try_for_range, ":trp_009", ":trp.swadian_crossbowman_multiplayer_ai", ":trp.swadian_crossbowman_multiplayer"),
            (store_troop_faction,":troop_faction_010",":trp_009"),
            (try_begin),
                (eq,":troop_faction_010",":team_faction_007"),
                (create_check_box_overlay, reg0),
                (position_set_x,1,800),
                (position_set_y,1,800),
                (overlay_set_size, reg0, 1),
                (position_set_x,1,377),
                (store_add, ":var014", ":var004", 2),
                (position_set_y,1,":var014"),
                (overlay_set_position, reg0, 1),
                (try_begin),
                    (eq,":var013",0),
                    (overlay_set_val, reg0, "$g_multiplayer_bot_type_1_wanted"),
                    (assign,"$g_presentation_obj_item_select_13",reg0),
                (else_try),
                    (eq,":var013",1),
                    (overlay_set_val, reg0, "$g_multiplayer_bot_type_2_wanted"),
                    (assign,"$g_presentation_obj_item_select_14",reg0),
                (else_try),
                    (eq,":var013",2),
                    (overlay_set_val, reg0, "$g_multiplayer_bot_type_3_wanted"),
                    (assign,"$g_presentation_obj_item_select_15",reg0),
                (else_try),
                    (overlay_set_val, reg0, "$g_multiplayer_bot_type_4_wanted"),
                    (assign,"$g_presentation_obj_item_select_16",reg0),
                (try_end),
            (try_end),
            (str_store_troop_name,s0,":trp_009"),
            (create_text_overlay, reg0, "str_s0"),
            (overlay_set_color, reg0, 16777215),
            (position_set_x,1,800),
            (position_set_y,1,800),
            (overlay_set_size, reg0, 1),
            (position_set_x,1,397),
            (position_set_y,1,":var004"),
            (overlay_set_position, reg0, 1),
            (val_sub, ":var004", 20),
            (val_add, ":var013", 1),
        (try_end),
    (try_end),
    (val_sub, ":var004", 20),
(try_end),
(multiplayer_get_my_player, ":my_player"),
(player_get_gold, ":gold_015", ":my_player"),
(call_script, "script_multiplayer_calculate_cur_selected_items_cost", ":my_player", 1),
(create_text_overlay, "$g_presentation_obj_item_select_12", "str_total_item_cost_reg0"),
(try_begin),
    (ge,":gold_015",reg0),
    (overlay_set_color, "$g_presentation_obj_item_select_12", 16777215),
(else_try),
    (overlay_set_color, "$g_presentation_obj_item_select_12", 16711680),
(try_end),
(position_set_x,1,680),
(position_set_y,1,652),
(overlay_set_position, "$g_presentation_obj_item_select_12", 1),
(store_add, "$g_presentation_obj_item_select_next", "$g_presentation_obj_item_select_12", 1),
(player_get_troop_id, ":troop_id_016", ":my_player"),
(try_begin),
    (eq,"$g_presentation_state",1),
    (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":troop_id_016", 1, 18, 781, 474),
    (create_mesh_overlay, reg0, "mesh_mp_inventory_right_arrow"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,881),
    (position_set_y,1,515),
    (overlay_set_position, reg0, 1),
(else_try),
    (eq,"$g_presentation_state",2),
    (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":troop_id_016", 1, 18, 781, 374),
    (create_mesh_overlay, reg0, "mesh_mp_inventory_right_arrow"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,881),
    (position_set_y,1,415),
    (overlay_set_position, reg0, 1),
(else_try),
    (eq,"$g_presentation_state",3),
    (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":troop_id_016", 1, 18, 781, 274),
    (create_mesh_overlay, reg0, "mesh_mp_inventory_right_arrow"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,881),
    (position_set_y,1,315),
    (overlay_set_position, reg0, 1),
(else_try),
    (eq,"$g_presentation_state",4),
    (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":troop_id_016", 1, 18, 781, 174),
    (create_mesh_overlay, reg0, "mesh_mp_inventory_right_arrow"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,881),
    (position_set_y,1,215),
    (overlay_set_position, reg0, 1),
(else_try),
    (eq,"$g_presentation_state",5),
    (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":troop_id_016", 22, 24, 117, 524),
    (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,106),
    (position_set_y,1,565),
    (overlay_set_position, reg0, 1),
(else_try),
    (eq,"$g_presentation_state",6),
    (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":troop_id_016", 19, 22, 117, 424),
    (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,106),
    (position_set_y,1,465),
    (overlay_set_position, reg0, 1),
(else_try),
    (eq,"$g_presentation_state",7),
    (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":troop_id_016", 24, 26, 117, 324),
    (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,106),
    (position_set_y,1,365),
    (overlay_set_position, reg0, 1),
(else_try),
    (eq,"$g_presentation_state",8),
    (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":troop_id_016", 26, 27, 117, 224),
    (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,106),
    (position_set_y,1,265),
    (overlay_set_position, reg0, 1),
(else_try),
    (eq,"$g_presentation_state",9),
    (eq,"$g_horses_are_avaliable",1),
    (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":troop_id_016", 18, 19, 117, 124),
    (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,106),
    (position_set_y,1,165),
    (overlay_set_position, reg0, 1),
(else_try),
    (eq,"$g_presentation_state",10),
    (call_script, "script_mp_set_coop_companions", ":my_player"),
    (create_mesh_overlay, reg0, "mesh_mp_score_b"),
    (position_set_x,1,205),
    (position_set_y,1,150),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (multiplayer_get_my_player, ":my_player"),
    (player_get_slot,":player_slot_017",":my_player",42),
    (assign,"$g_presentation_obj_coop_companion_select_0",-1),
    (assign,"$g_presentation_obj_coop_companion_select_1",-1),
    (try_begin),
        (eq,":player_slot_017",0),
        (create_combo_label_overlay, "$g_presentation_obj_coop_companion_select_0"),
        (position_set_x,1,700),
        (position_set_y,1,700),
        (overlay_set_size, "$g_presentation_obj_coop_companion_select_0", 1),
        (position_set_x,1,360),
        (position_set_y,1,265),
        (overlay_set_position, "$g_presentation_obj_coop_companion_select_0", 1),
        (create_combo_label_overlay, "$g_presentation_obj_coop_companion_select_1"),
        (position_set_x,1,700),
        (position_set_y,1,700),
        (overlay_set_size, "$g_presentation_obj_coop_companion_select_1", 1),
        (position_set_x,1,640),
        (position_set_y,1,265),
        (overlay_set_position, "$g_presentation_obj_coop_companion_select_1", 1),
        (try_for_range, ":trp_018", ":trp.npc1_1", ":trp.npc1_2"),
            (str_store_troop_name,s0,":trp_018"),
            (overlay_add_item, "$g_presentation_obj_coop_companion_select_0", 0),
            (overlay_add_item, "$g_presentation_obj_coop_companion_select_1", 0),
        (try_end),
        (store_sub, ":var019", "$g_presentation_obj_coop_companion_0", ":trp.npc1_1"),
        (overlay_set_val, "$g_presentation_obj_coop_companion_select_0", ":var019"),
        (store_sub, ":var019", "$g_presentation_obj_coop_companion_1", ":trp.npc1_1"),
        (overlay_set_val, "$g_presentation_obj_coop_companion_select_1", ":var019"),
        (create_text_overlay, reg0, "str_ccoop_select_companion"),
        (overlay_set_color, reg0, 16777215),
        (position_set_x,1,222),
        (position_set_y,1,550),
        (overlay_set_position, reg0, 1),
    (else_try),
        (str_store_troop_name,s0,"$g_presentation_obj_coop_companion_0"),
        (create_text_overlay, reg0, 0),
        (position_set_x,1,1000),
        (position_set_y,1,1000),
        (overlay_set_size, reg0, 1),
        (overlay_set_color, reg0, 16777215),
        (position_set_x,1,358),
        (position_set_y,1,265),
        (overlay_set_position, reg0, 1),
        (str_store_troop_name,s0,"$g_presentation_obj_coop_companion_1"),
        (create_text_overlay, reg0, 0),
        (position_set_x,1,1000),
        (position_set_y,1,1000),
        (overlay_set_size, reg0, 1),
        (overlay_set_color, reg0, 16777215),
        (position_set_x,1,638),
        (position_set_y,1,265),
        (overlay_set_position, reg0, 1),
        (create_text_overlay, reg0, "str_ccoop_select_companion_class"),
        (overlay_set_color, reg0, 16777215),
        (position_set_x,1,222),
        (position_set_y,1,550),
        (overlay_set_position, reg0, 1),
    (try_end),
    (player_get_slot,":player_slot_020",":my_player",47),
    (val_add, ":player_slot_020", 1),
    (assign,reg0,":player_slot_020"),
    (str_store_string,s0,"str_ccoop_lvl_reg0"),
    (create_text_overlay, reg0, 0),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,418),
    (position_set_y,1,507),
    (overlay_set_position, reg0, 1),
    (player_get_slot,":player_slot_021",":my_player",48),
    (val_add, ":player_slot_021", 1),
    (assign,reg0,":player_slot_021"),
    (str_store_string,s0,"@Lv. {reg0}"),
    (create_text_overlay, reg0, 0),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,698),
    (position_set_y,1,507),
    (overlay_set_position, reg0, 1),
    (store_sub, ":var022", "$g_presentation_obj_coop_companion_0", ":trp.npc1_1"),
    (assign,":var022 +","str_npc1_1"),
    (str_store_string,s0,":var022"),
    (create_text_overlay, reg0, 0),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,250),
    (position_set_y,1,306),
    (overlay_set_position, reg0, 1),
    (store_sub, ":var022", "$g_presentation_obj_coop_companion_1", ":trp.npc1_1"),
    (assign,":var022 +","str_npc1_1"),
    (str_store_string,s0,":var022"),
    (create_text_overlay, reg0, 0),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,530),
    (position_set_y,1,306),
    (overlay_set_position, reg0, 1),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_random_select_0", "mesh_ccoop_random_class", "mesh_ccoop_random_class"),
    (position_set_x,1,60),
    (position_set_y,1,80),
    (overlay_set_size, "$g_presentation_obj_coop_companion_random_select_0", 1),
    (position_set_x,1,259),
    (position_set_y,1,341),
    (overlay_set_position, "$g_presentation_obj_coop_companion_random_select_0", 1),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_random_select_1", "mesh_ccoop_random_class", "mesh_ccoop_random_class"),
    (position_set_x,1,60),
    (position_set_y,1,80),
    (overlay_set_size, "$g_presentation_obj_coop_companion_random_select_1", 1),
    (position_set_x,1,539),
    (position_set_y,1,341),
    (overlay_set_position, "$g_presentation_obj_coop_companion_random_select_1", 1),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_class_select_0_default", "mesh_ccoop_default_class", "mesh_ccoop_default_class"),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_class_select_1_default", "mesh_ccoop_default_class", "mesh_ccoop_default_class"),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_class_select_0_infantry", "mesh_ccoop_melee_class", "mesh_ccoop_melee_class"),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_class_select_1_infantry", "mesh_ccoop_melee_class", "mesh_ccoop_melee_class"),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_class_select_0_ranged", "mesh_ccoop_ranged_class", "mesh_ccoop_ranged_class"),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_class_select_1_ranged", "mesh_ccoop_ranged_class", "mesh_ccoop_ranged_class"),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_class_select_0_mounted", "mesh_ccoop_mounted_class", "mesh_ccoop_mounted_class"),
    (create_image_button_overlay, "$g_presentation_obj_coop_companion_class_select_1_mounted", "mesh_ccoop_mounted_class", "mesh_ccoop_mounted_class"),
    (position_set_x,1,90),
    (position_set_y,1,120),
    (overlay_set_size, "$g_presentation_obj_coop_companion_class_select_0_default", 1),
    (overlay_set_size, "$g_presentation_obj_coop_companion_class_select_1_default", 1),
    (overlay_set_size, "$g_presentation_obj_coop_companion_class_select_0_infantry", 1),
    (overlay_set_size, "$g_presentation_obj_coop_companion_class_select_1_infantry", 1),
    (overlay_set_size, "$g_presentation_obj_coop_companion_class_select_0_ranged", 1),
    (overlay_set_size, "$g_presentation_obj_coop_companion_class_select_1_ranged", 1),
    (overlay_set_size, "$g_presentation_obj_coop_companion_class_select_0_mounted", 1),
    (overlay_set_size, "$g_presentation_obj_coop_companion_class_select_1_mounted", 1),
    (overlay_set_tooltip, "$g_presentation_obj_coop_companion_class_select_0_default", "str_default"),
    (overlay_set_tooltip, "$g_presentation_obj_coop_companion_class_select_1_default", "str_default"),
    (position_set_y,1,208),
    (assign,":var023",259),
    (position_set_x,1,":var023"),
    (overlay_set_position, "$g_presentation_obj_coop_companion_class_select_0_default", 1),
    (val_add, ":var023", 55),
    (position_set_x,1,":var023"),
    (overlay_set_position, "$g_presentation_obj_coop_companion_class_select_0_infantry", 1),
    (val_add, ":var023", 55),
    (position_set_x,1,":var023"),
    (overlay_set_position, "$g_presentation_obj_coop_companion_class_select_0_ranged", 1),
    (val_add, ":var023", 55),
    (position_set_x,1,":var023"),
    (overlay_set_position, "$g_presentation_obj_coop_companion_class_select_0_mounted", 1),
    (assign,":var023",539),
    (position_set_x,1,":var023"),
    (overlay_set_position, "$g_presentation_obj_coop_companion_class_select_1_default", 1),
    (val_add, ":var023", 55),
    (position_set_x,1,":var023"),
    (overlay_set_position, "$g_presentation_obj_coop_companion_class_select_1_infantry", 1),
    (val_add, ":var023", 55),
    (position_set_x,1,":var023"),
    (overlay_set_position, "$g_presentation_obj_coop_companion_class_select_1_ranged", 1),
    (val_add, ":var023", 55),
    (position_set_x,1,":var023"),
    (overlay_set_position, "$g_presentation_obj_coop_companion_class_select_1_mounted", 1),
    (team_get_faction, ":team_faction_007", 0),
    (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_0_default", 16777215),
    (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_1_default", 16777215),
    (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_0_infantry", 16777215),
    (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_1_infantry", 16777215),
    (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_0_ranged", 16777215),
    (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_1_ranged", 16777215),
    (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_0_mounted", 16777215),
    (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_1_mounted", 16777215),
    (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_0_default", 170),
    (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_1_default", 170),
    (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_0_infantry", 170),
    (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_1_infantry", 170),
    (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_0_ranged", 170),
    (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_1_ranged", 170),
    (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_0_mounted", 170),
    (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_1_mounted", 170),
    (try_begin),
        (eq,"$g_presentation_obj_coop_companion_class_0","$g_presentation_obj_coop_companion_0"),
        (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_0_default", 13750170),
        (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_0_default", 16777215),
    (try_end),
    (try_begin),
        (eq,"$g_presentation_obj_coop_companion_class_1","$g_presentation_obj_coop_companion_1"),
        (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_1_default", 13750170),
        (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_1_default", 16777215),
    (try_end),
    (assign,":var024",0),
    (try_for_range, ":trp_025", ":trp.swadian_crossbowman_multiplayer_coop_tier_1", ":trp.coop_faction_troop_templates_end"),
        (store_troop_faction,":troop_faction_026",":trp_025"),
        (try_begin),
            (eq,":troop_faction_026",":team_faction_007"),
            (store_character_level,":character_lvl_027",":trp_025"),
            (try_begin),
                (eq,":character_lvl_027",4),
                (str_store_troop_name,s0,":trp_025"),
                (val_add, ":var024", 1),
                (try_begin),
                    (eq,":var024",2),
                    (assign,reg0,":var024"),
                    (overlay_set_tooltip, "$g_presentation_obj_coop_companion_class_select_0_infantry", 0),
                    (overlay_set_tooltip, "$g_presentation_obj_coop_companion_class_select_1_infantry", 0),
                    (try_begin),
                        (eq,"$g_presentation_obj_coop_companion_class_0",":trp_025"),
                        (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_0_infantry", 3372352),
                        (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_0_infantry", 255),
                    (try_end),
                (try_end),
            (try_end),
            (try_begin),
                (eq,"$g_presentation_obj_coop_companion_class_1",":trp_025"),
                (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_1_infantry", 3372352),
                (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_1_infantry", 255),
            (try_end),
        (else_try),
            (eq,":var024",1),
            (assign,reg0,":var024"),
            (overlay_set_tooltip, "$g_presentation_obj_coop_companion_class_select_0_ranged", 0),
            (overlay_set_tooltip, "$g_presentation_obj_coop_companion_class_select_1_ranged", 0),
            (try_begin),
                (eq,"$g_presentation_obj_coop_companion_class_0",":trp_025"),
                (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_0_ranged", 11742754),
                (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_0_ranged", 255),
            (try_end),
            (try_begin),
                (eq,"$g_presentation_obj_coop_companion_class_1",":trp_025"),
                (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_1_ranged", 11742754),
                (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_1_ranged", 255),
            (try_end),
        (else_try),
            (eq,":var024",3),
            (assign,reg0,":var024"),
            (overlay_set_tooltip, "$g_presentation_obj_coop_companion_class_select_0_mounted", 0),
            (overlay_set_tooltip, "$g_presentation_obj_coop_companion_class_select_1_mounted", 0),
            (try_begin),
                (eq,"$g_presentation_obj_coop_companion_class_0",":trp_025"),
                (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_0_mounted", 5789635),
                (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_0_mounted", 255),
            (try_end),
            (try_begin),
                (eq,"$g_presentation_obj_coop_companion_class_1",":trp_025"),
                (overlay_set_color, "$g_presentation_obj_coop_companion_class_select_1_mounted", 5789635),
                (overlay_set_alpha, "$g_presentation_obj_coop_companion_class_select_1_mounted", 255),
            (try_end),
        (try_end),
    (try_end),
    (create_mesh_overlay_with_tableau_material, reg0, -1, "tab_coop_companion_select_0", "$g_presentation_obj_coop_companion_0"),
    (position_set_x,1,230),
    (position_set_y,1,349),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,1000),
    (overlay_set_size, reg0, 1),
    (create_mesh_overlay_with_tableau_material, reg0, -1, "tab_coop_companion_select_0", "$g_presentation_obj_coop_companion_1"),
    (position_set_x,1,510),
    (position_set_y,1,349),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,1000),
    (overlay_set_size, reg0, 1),
    (create_button_overlay, "$g_presentation_obj_coop_companion_select_done", "str_done"),
    (position_set_x,1,468),
    (position_set_y,1,170),
    (overlay_set_position, "$g_presentation_obj_coop_companion_select_done", 1),
    (overlay_set_color, "$g_presentation_obj_coop_companion_select_done", 16777215),
(try_end),
(multiplayer_get_my_player, ":my_player"),
(call_script, "script_mp_set_coop_companions", ":my_player"),
(call_script, "script_multiplayer_send_item_selections"),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_mouse_enter_leave, [
(try_begin),
    (eq,"$g_close_equipment_selection",0),
    (eq,"$g_presentation_state",10),
(else_try),
    (eq,"$g_close_equipment_selection",0),
    (try_begin),
        (eq,":var002",0),
        (assign,":troop_slot_003",-1),
        (try_begin),
            (ge,":var001","$g_presentation_obj_item_select_next"),
            (store_sub, ":var004", ":var001", "$g_presentation_obj_item_select_next"),
            (store_mod,":var005",":var004",2),
            (store_sub, ":var005", 1, ":var005"),
            (val_div, ":var004", 2),
            (store_add, ":slot_no_006", 46, ":var004"),
            (troop_get_slot,":troop_slot_003","trp_multiplayer_data",":slot_no_006"),
            (assign,":var007",":var001"),
            (val_add, ":var007", ":var005"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_1"),
            (store_add, ":slot_no_008", 2, 1),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_1"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_2"),
            (store_add, ":slot_no_008", 2, 2),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_2"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_3"),
            (store_add, ":slot_no_008", 2, 3),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_3"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_4"),
            (store_add, ":slot_no_008", 2, 4),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_4"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_5"),
            (store_add, ":slot_no_008", 2, 5),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_5"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_6"),
            (store_add, ":slot_no_008", 2, 6),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_6"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_7"),
            (store_add, ":slot_no_008", 2, 7),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_7"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_8"),
            (store_add, ":slot_no_008", 2, 8),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_8"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_9"),
            (eq,"$g_horses_are_avaliable",1),
            (store_add, ":slot_no_008", 2, 9),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_9"),
        (try_end),
        (try_begin),
            (ge,":troop_slot_003",0),
            (overlay_get_position, pos0, ":var007"),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_troop_id, ":troop_id_010", ":my_player"),
            (try_begin),
                (call_script, "script_cf_multiplayer_is_item_default_for_troop", ":troop_slot_003", ":troop_id_010"),
                (show_item_details, ":troop_slot_003", 0, 0),
            (else_try),
                (store_troop_faction,":troop_faction_011",":troop_id_010"),
                (store_sub, ":slot_no_012", ":troop_faction_011", ":fac.kingdom_1"),
                (val_add, ":slot_no_012", 30),
                (item_get_slot,":item_slot_013",":troop_slot_003",":slot_no_012"),
                (show_item_details, ":troop_slot_003", 0, ":item_slot_013"),
            (try_end),
            (assign,"$g_current_opened_item_details",":troop_slot_003"),
        (try_end),
    (else_try),
        (assign,":troop_slot_003",-1),
        (try_begin),
            (ge,":var001","$g_presentation_obj_item_select_next"),
            (store_sub, ":var004", ":var001", "$g_presentation_obj_item_select_next"),
            (val_div, ":var004", 2),
            (store_add, ":slot_no_006", 46, ":var004"),
            (troop_get_slot,":troop_slot_003","trp_multiplayer_data",":slot_no_006"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_1"),
            (store_add, ":slot_no_008", 2, 1),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_1"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_2"),
            (store_add, ":slot_no_008", 2, 2),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_2"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_3"),
            (store_add, ":slot_no_008", 2, 3),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_3"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_4"),
            (store_add, ":slot_no_008", 2, 4),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_4"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_5"),
            (store_add, ":slot_no_008", 2, 5),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_5"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_6"),
            (store_add, ":slot_no_008", 2, 6),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_6"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_7"),
            (store_add, ":slot_no_008", 2, 7),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_7"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_8"),
            (store_add, ":slot_no_008", 2, 8),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_8"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_9"),
            (eq,"$g_horses_are_avaliable",1),
            (store_add, ":slot_no_008", 2, 9),
            (val_sub, ":slot_no_008", 1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_slot,":troop_slot_003",":my_player",":slot_no_008"),
            (assign,":var007","$g_inside_obj_9"),
        (try_end),
        (try_begin),
            (eq,"$g_current_opened_item_details",":troop_slot_003"),
            (close_item_details),
            (assign,"$g_current_opened_item_details",-1),
        (try_end),
    (try_end),
(else_try),
    (assign,"$g_close_equipment_selection",0),
    (multiplayer_get_my_player, ":my_player"),
    (call_script, "script_mp_set_coop_companions", ":my_player"),
    (call_script, "script_multiplayer_send_item_selections"),
    (presentation_set_duration, 0),
(try_end),
]),

(ti_on_presentation_event_state_change, [
(multiplayer_get_my_player, ":my_player"),
(player_get_troop_id, ":troop_id_004", ":my_player"),
(player_get_team_no,  ":team_no_005", ":my_player"),
(try_begin),
    (eq,"$g_close_equipment_selection",0),
    (try_begin),
        (eq,"$g_presentation_state",0),
        (try_begin),
            (eq,":var001","$g_presentation_obj_item_select_1"),
            (assign,"$g_presentation_state",1),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_2"),
            (assign,"$g_presentation_state",2),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_3"),
            (assign,"$g_presentation_state",3),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_4"),
            (assign,"$g_presentation_state",4),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_5"),
            (assign,"$g_presentation_state",5),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_6"),
            (assign,"$g_presentation_state",6),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_7"),
            (assign,"$g_presentation_state",7),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_8"),
            (assign,"$g_presentation_state",8),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_9"),
            (eq,"$g_horses_are_avaliable",1),
            (assign,"$g_presentation_state",9),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_item_select_17"),
            (assign,"$g_presentation_state",10),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (try_end),
    (else_try),
        (is_between,"$g_presentation_state",0,10),
        (store_sub, ":var006", ":var001", "$g_presentation_obj_item_select_next"),
        (val_div, ":var006", 2),
        (assign,":var007",146),
        (try_for_range, ":slot_no_008", 46, ":var007"),
            (try_begin),
                (neg|troop_slot_eq,"trp_multiplayer_data",":slot_no_008",-1),
                (store_sub, ":var009", ":slot_no_008", 46),
                (try_begin),
                    (eq,":var006",":var009"),
                    (troop_get_slot,":troop_slot_010","trp_multiplayer_data",":slot_no_008"),
                    (try_begin),
                        (eq,1,1),
                        (store_add, ":slot_no_011", 2, "$g_presentation_state"),
                        (val_sub, ":slot_no_011", 1),
                        (player_set_slot,":my_player",":slot_no_011",":troop_slot_010"),
                        (call_script, "script_multiplayer_update_cost_labels"),
                        (assign,":var007",0),
                    (try_end),
                (try_end),
            (try_end),
        (try_end),
        (presentation_set_duration, 0),
        (assign,"$g_presentation_state",0),
        (start_presentation, "prsnt_multiplayer_item_select"),
    (else_try),
        (eq,"$g_presentation_state",10),
        (multiplayer_get_my_player, ":my_player"),
        (player_get_troop_id, ":troop_id_004", ":my_player"),
        (team_get_faction, ":team_faction_012", 0),
        (try_begin),
            (eq,":var001","$g_presentation_obj_coop_companion_select_done"),
            (eq,"$g_multiplayer_game_type",8),
            (call_script, "script_mp_set_coop_companions", ":my_player"),
            (call_script, "script_multiplayer_send_item_selections"),
            (presentation_set_duration, 0),
            (assign,"$g_presentation_state",0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (player_slot_eq,":my_player",42,0),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_random_select_0"),
            (eq,":var001","$g_presentation_obj_coop_companion_select_0"),
            (try_begin),
                (eq,":var001","$g_presentation_obj_coop_companion_random_select_0"),
                (store_random_in_range,":random_x_002","trp_npc1_1","trp_npc1_2"),
            (else_try),
                (assign,":random_x_002 +","trp_npc1_1"),
            (try_end),
            (store_sub, ":var013", ":random_x_002", "$g_presentation_obj_coop_companion_0"),
            (try_begin),
                (eq,":random_x_002","$g_presentation_obj_coop_companion_1"),
                (try_begin),
                    (neq,":var013",15),
                    (this_or_next|gt,":var013",0),
                    (eq,":var013",-15),
                    (val_add, ":random_x_002", 1),
                    (try_begin),
                        (ge,":random_x_002","trp_npc1_2"),
                        (assign,":random_x_002","trp_npc1_1"),
                    (try_end),
                (else_try),
                    (val_sub, ":random_x_002", 1),
                    (try_begin),
                        (lt,":random_x_002","trp_npc1_1"),
                        (assign,":random_x_002","trp_npc1_2"),
                        (val_sub, ":random_x_002", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_coop_companion_0",":random_x_002"),
            (try_begin),
                (is_between,"$g_presentation_obj_coop_companion_class_0","trp_npc1_1","trp_coop_companion_equipment_sets_end"),
                (store_sub, ":random_x_002", "$g_presentation_obj_coop_companion_0", ":trp.npc1_1"),
                (assign,":random_x_002 +","trp_npc1_1"),
                (assign,"$g_presentation_obj_coop_companion_class_0",":random_x_002"),
            (try_end),
            (call_script, "script_mp_set_coop_companions", ":my_player"),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (player_slot_eq,":my_player",42,0),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_random_select_1"),
            (eq,":var001","$g_presentation_obj_coop_companion_select_1"),
            (try_begin),
                (eq,":var001","$g_presentation_obj_coop_companion_random_select_1"),
                (store_random_in_range,":random_x_002","trp_npc1_1","trp_npc1_2"),
            (else_try),
                (assign,":random_x_002 +","trp_npc1_1"),
            (try_end),
            (store_sub, ":var013", ":random_x_002", "$g_presentation_obj_coop_companion_1"),
            (try_begin),
                (eq,":random_x_002","$g_presentation_obj_coop_companion_0"),
                (try_begin),
                    (neq,":var013",15),
                    (this_or_next|gt,":var013",0),
                    (eq,":var013",-15),
                    (val_add, ":random_x_002", 1),
                    (try_begin),
                        (ge,":random_x_002","trp_npc1_2"),
                        (assign,":random_x_002","trp_npc1_1"),
                    (try_end),
                (else_try),
                    (val_sub, ":random_x_002", 1),
                    (try_begin),
                        (lt,":random_x_002","trp_npc1_1"),
                        (assign,":random_x_002","trp_npc1_2"),
                        (val_sub, ":random_x_002", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,"$g_presentation_obj_coop_companion_1",":random_x_002"),
            (try_begin),
                (is_between,"$g_presentation_obj_coop_companion_class_1","trp_npc1_1","trp_coop_companion_equipment_sets_end"),
                (store_sub, ":random_x_002", "$g_presentation_obj_coop_companion_1", ":trp.npc1_1"),
                (assign,":random_x_002 +","trp_npc1_1"),
                (assign,"$g_presentation_obj_coop_companion_class_1",":random_x_002"),
            (try_end),
            (call_script, "script_mp_set_coop_companions", ":my_player"),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_coop_companion_class_select_0_default"),
            (assign,"$g_presentation_obj_coop_companion_class_0","$g_presentation_obj_coop_companion_0"),
            (call_script, "script_mp_set_coop_companions", ":my_player"),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (eq,":var001","$g_presentation_obj_coop_companion_class_select_1_default"),
            (assign,"$g_presentation_obj_coop_companion_class_1","$g_presentation_obj_coop_companion_1"),
            (call_script, "script_mp_set_coop_companions", ":my_player"),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_1_mounted"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_1_ranged"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_1_infantry"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_random_select_1"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_0_mounted"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_0_ranged"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_0_infantry"),
            (eq,":var001","$g_presentation_obj_coop_companion_random_select_0"),
        (else_try),
            (presentation_set_duration, 0),
            (assign,"$g_presentation_state",0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (try_end),
        (try_begin),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_0_mounted"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_0_ranged"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_0_infantry"),
            (eq,":var001","$g_presentation_obj_coop_companion_random_select_0"),
            (try_begin),
                (eq,":var001","$g_presentation_obj_coop_companion_random_select_0"),
                (store_random_in_range,":random_x_014",0,2),
                (assign,":random_x_015",0),
                (try_begin),
                    (eq,":random_x_014",0),
                    (assign,"$g_presentation_obj_coop_companion_class_0","$g_presentation_obj_coop_companion_0"),
                (else_try),
                    (store_random_in_range,":random_x_015",0,4),
                    (try_begin),
                        (eq,":random_x_015",0),
                        (assign,"$g_presentation_obj_coop_companion_class_0","$g_presentation_obj_coop_companion_0"),
                    (else_try),
                        (eq,":random_x_015",1),
                        (assign,":var001","$g_presentation_obj_coop_companion_class_select_0_infantry"),
                    (else_try),
                        (eq,":random_x_015",2),
                        (assign,":var001","$g_presentation_obj_coop_companion_class_select_0_ranged"),
                    (else_try),
                        (eq,":random_x_015",3),
                        (assign,":var001","$g_presentation_obj_coop_companion_class_select_0_mounted"),
                    (try_end),
                (try_end),
                (try_begin),
                    (eq,":random_x_015",0),
                (else_try),
                    (assign,":var016",0),
                    (try_for_range, ":trp_017", ":trp.swadian_crossbowman_multiplayer_coop_tier_1", ":trp.coop_faction_troop_templates_end"),
                        (store_troop_faction,":troop_faction_018",":trp_017"),
                        (try_begin),
                            (eq,":troop_faction_018",":team_faction_012"),
                            (store_character_level,":character_lvl_019",":trp_017"),
                            (try_begin),
                                (eq,":character_lvl_019",4),
                                (str_store_troop_name,s0,":trp_017"),
                                (val_add, ":var016", 1),
                                (assign,reg0,":var016"),
                                (try_begin),
                                    (eq,":var016",2),
                                    (eq,":var001","$g_presentation_obj_coop_companion_class_select_0_infantry"),
                                    (assign,"$g_presentation_obj_coop_companion_class_0",":trp_017"),
                                (else_try),
                                    (eq,":var016",1),
                                    (eq,":var001","$g_presentation_obj_coop_companion_class_select_0_ranged"),
                                    (assign,"$g_presentation_obj_coop_companion_class_0",":trp_017"),
                                (else_try),
                                    (eq,":var016",3),
                                    (eq,":var001","$g_presentation_obj_coop_companion_class_select_0_mounted"),
                                    (assign,"$g_presentation_obj_coop_companion_class_0",":trp_017"),
                                (try_end),
                            (try_end),
                        (try_end),
                    (try_end),
                (try_end),
            (try_end),
            (call_script, "script_mp_set_coop_companions", ":my_player"),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_1_mounted"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_1_ranged"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_1_infantry"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_random_select_1"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_0_mounted"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_0_ranged"),
            (this_or_next|eq,":var001","$g_presentation_obj_coop_companion_class_select_0_infantry"),
            (eq,":var001","$g_presentation_obj_coop_companion_random_select_0"),
            (try_begin),
                (eq,":var001","$g_presentation_obj_coop_companion_random_select_1"),
                (store_random_in_range,":random_x_014",0,2),
                (assign,":random_x_015",0),
                (try_begin),
                    (eq,":random_x_014",0),
                    (assign,"$g_presentation_obj_coop_companion_class_1","$g_presentation_obj_coop_companion_1"),
                (else_try),
                    (store_random_in_range,":random_x_015",0,4),
                    (try_begin),
                        (eq,":random_x_015",0),
                        (assign,"$g_presentation_obj_coop_companion_class_1","$g_presentation_obj_coop_companion_1"),
                    (else_try),
                        (eq,":random_x_015",1),
                        (assign,":var001","$g_presentation_obj_coop_companion_class_select_1_infantry"),
                    (else_try),
                        (eq,":random_x_015",2),
                        (assign,":var001","$g_presentation_obj_coop_companion_class_select_1_ranged"),
                    (else_try),
                        (eq,":random_x_015",3),
                        (assign,":var001","$g_presentation_obj_coop_companion_class_select_1_mounted"),
                    (try_end),
                (try_end),
                (try_begin),
                    (eq,":random_x_015",0),
                (else_try),
                    (assign,":var016",0),
                    (try_for_range, ":trp_017", ":trp.swadian_crossbowman_multiplayer_coop_tier_1", ":trp.coop_faction_troop_templates_end"),
                        (store_troop_faction,":troop_faction_018",":trp_017"),
                        (try_begin),
                            (eq,":troop_faction_018",":team_faction_012"),
                            (store_character_level,":character_lvl_019",":trp_017"),
                            (try_begin),
                                (eq,":character_lvl_019",4),
                                (str_store_troop_name,s0,":trp_017"),
                                (val_add, ":var016", 1),
                                (try_begin),
                                    (eq,":var016",2),
                                    (eq,":var001","$g_presentation_obj_coop_companion_class_select_1_infantry"),
                                    (assign,"$g_presentation_obj_coop_companion_class_1",":trp_017"),
                                (else_try),
                                    (eq,":var016",1),
                                    (eq,":var001","$g_presentation_obj_coop_companion_class_select_1_ranged"),
                                    (assign,"$g_presentation_obj_coop_companion_class_1",":trp_017"),
                                (else_try),
                                    (eq,":var016",3),
                                    (eq,":var001","$g_presentation_obj_coop_companion_class_select_1_mounted"),
                                    (assign,"$g_presentation_obj_coop_companion_class_1",":trp_017"),
                                (try_end),
                            (try_end),
                        (try_end),
                    (try_end),
                (try_end),
            (try_end),
            (call_script, "script_mp_set_coop_companions", ":my_player"),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":var001","$g_presentation_obj_item_select_10"),
        (call_script, "script_multiplayer_set_default_item_selections_for_troop", ":troop_id_004"),
        (presentation_set_duration, 0),
        (assign,"$g_presentation_state",0),
        (start_presentation, "prsnt_multiplayer_item_select"),
    (else_try),
        (eq,":var001","$g_presentation_obj_item_select_11"),
        (call_script, "script_multiplayer_send_item_selections"),
        (presentation_set_duration, 0),
        (try_begin),
            (eq,1,1),
            (try_begin),
                (eq,"$g_multiplayer_game_type",6),
                (gt,"$g_multiplayer_number_of_respawn_count",0),
                (ge,"$g_my_spawn_count","$g_multiplayer_number_of_respawn_count"),
                (multiplayer_get_my_player, ":my_player"),
                (player_get_team_no,  ":team_no_005", ":my_player"),
                (try_begin),
                    (this_or_next|eq,":team_no_005",0),
                    (ge,"$g_my_spawn_count",999),
                    (assign,"$g_show_no_more_respawns_remained",1),
                (else_try),
                    (assign,"$g_show_no_more_respawns_remained",0),
                (try_end),
            (try_end),
            (try_begin),
                (eq,"$g_show_no_more_respawns_remained",1),
                (store_mission_timer_a,"$g_multiplayer_respawn_start_time"),
                (start_presentation, "prsnt_multiplayer_respawn_time_counter"),
            (try_end),
        (try_end),
    (else_try),
        (eq,":var001","$g_presentation_obj_item_select_13"),
        (assign,"$g_multiplayer_bot_type_1_wanted",":random_x_002"),
        (multiplayer_send_2_int_to_server, 1, 35, ":random_x_002"),
    (else_try),
        (eq,":var001","$g_presentation_obj_item_select_14"),
        (assign,"$g_multiplayer_bot_type_2_wanted",":random_x_002"),
        (multiplayer_send_2_int_to_server, 1, 36, ":random_x_002"),
    (else_try),
        (eq,":var001","$g_presentation_obj_item_select_15"),
        (assign,"$g_multiplayer_bot_type_3_wanted",":random_x_002"),
        (multiplayer_send_2_int_to_server, 1, 37, ":random_x_002"),
    (else_try),
        (eq,":var001","$g_presentation_obj_item_select_16"),
        (assign,"$g_multiplayer_bot_type_4_wanted",":random_x_002"),
        (multiplayer_send_2_int_to_server, 1, 38, ":random_x_002"),
    (try_end),
(else_try),
    (assign,"$g_close_equipment_selection",0),
    (call_script, "script_multiplayer_send_item_selections"),
    (presentation_set_duration, 0),
(try_end),
]),

(ti_on_presentation_mouse_press, [
(try_begin),
    (eq,"$g_close_equipment_selection",0),
    (try_begin),
        (eq,":var002",1),
        (try_begin),
            (eq,"$g_presentation_state",0),
            (multiplayer_get_my_player, ":my_player"),
            (try_begin),
                (eq,":var001","$g_presentation_obj_item_select_1"),
                (store_add, ":slot_no_004", 2, 0),
                (player_set_slot,":my_player",":slot_no_004",-1),
                (presentation_set_duration, 0),
                (assign,"$g_presentation_state",0),
                (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
                (eq,":var001","$g_presentation_obj_item_select_2"),
                (store_add, ":slot_no_004", 2, 1),
                (player_set_slot,":my_player",":slot_no_004",-1),
                (presentation_set_duration, 0),
                (assign,"$g_presentation_state",0),
                (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
                (eq,":var001","$g_presentation_obj_item_select_3"),
                (store_add, ":slot_no_004", 2, 2),
                (player_set_slot,":my_player",":slot_no_004",-1),
                (presentation_set_duration, 0),
                (assign,"$g_presentation_state",0),
                (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
                (eq,":var001","$g_presentation_obj_item_select_4"),
                (store_add, ":slot_no_004", 2, 3),
                (player_set_slot,":my_player",":slot_no_004",-1),
                (presentation_set_duration, 0),
                (assign,"$g_presentation_state",0),
                (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
                (eq,":var001","$g_presentation_obj_item_select_5"),
                (store_add, ":slot_no_004", 2, 4),
                (player_set_slot,":my_player",":slot_no_004",-1),
                (presentation_set_duration, 0),
                (assign,"$g_presentation_state",0),
                (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
                (eq,":var001","$g_presentation_obj_item_select_6"),
                (store_add, ":slot_no_004", 2, 5),
                (player_set_slot,":my_player",":slot_no_004",-1),
                (presentation_set_duration, 0),
                (assign,"$g_presentation_state",0),
                (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
                (eq,":var001","$g_presentation_obj_item_select_7"),
                (store_add, ":slot_no_004", 2, 6),
                (player_set_slot,":my_player",":slot_no_004",-1),
                (presentation_set_duration, 0),
                (assign,"$g_presentation_state",0),
                (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
                (eq,":var001","$g_presentation_obj_item_select_8"),
                (store_add, ":slot_no_004", 2, 7),
                (player_set_slot,":my_player",":slot_no_004",-1),
                (presentation_set_duration, 0),
                (assign,"$g_presentation_state",0),
                (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
                (eq,":var001","$g_presentation_obj_item_select_9"),
                (eq,"$g_horses_are_avaliable",1),
                (store_add, ":slot_no_004", 2, 8),
                (player_set_slot,":my_player",":slot_no_004",-1),
                (presentation_set_duration, 0),
                (assign,"$g_presentation_state",0),
                (start_presentation, "prsnt_multiplayer_item_select"),
            (try_end),
        (else_try),
            (eq,"$g_presentation_state",10),
        (else_try),
            (gt,"$g_presentation_state",0),
            (presentation_set_duration, 0),
            (assign,"$g_presentation_state",0),
            (start_presentation, "prsnt_multiplayer_item_select"),
        (try_end),
    (try_end),
(else_try),
    (assign,"$g_close_equipment_selection",0),
    (call_script, "script_multiplayer_send_item_selections"),
    (presentation_set_duration, 0),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (eq,"$g_close_equipment_selection",0),
    (try_begin),
        (this_or_next|key_clicked, 1),
        (key_clicked, 248),
        (try_begin),
            (neq,"$g_current_opened_item_details",-1),
            (close_item_details),
            (assign,"$g_current_opened_item_details",-1),
        (try_end),
        (try_begin),
            (gt,":var001",200),
            (multiplayer_get_my_player, ":my_player"),
            (call_script, "script_mp_set_coop_companions", ":my_player"),
            (call_script, "script_multiplayer_send_item_selections"),
            (presentation_set_duration, 0),
        (try_end),
    (try_end),
(else_try),
    (assign,"$g_close_equipment_selection",0),
    (call_script, "script_multiplayer_send_item_selections"),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_message_1",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(try_begin),
    (eq,"$g_multiplayer_message_type",12),
    (assign,":team_id_001","$g_multiplayer_message_value_1"),
    (try_begin),
        (eq,":team_id_001",-1),
        (assign,":var002",4294967295),
        (str_store_string,s0,"str_round_draw_no_one_remained"),
    (else_try),
        (try_begin),
            (eq,":team_id_001",0),
            (assign,":var002",4281589009),
        (else_try),
            (assign,":var002",4294919202),
        (try_end),
        (try_begin),
            (lt,"$my_team_at_start_of_round",2),
            (try_begin),
                (eq,"$my_team_at_start_of_round",":team_id_001"),
                (assign,":var002",4281589009),
            (else_try),
                (assign,":var002",4294919202),
            (try_end),
        (try_end),
        (team_get_faction, ":team_faction_003", ":team_id_001"),
        (str_store_faction_name,s1,":team_faction_003"),
        (str_store_string,s0,"str_s1_won_round"),
    (try_end),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (try_begin),
        (neq,":team_id_001",-1),
        (position_set_x,1,375),
    (else_try),
        (position_set_x,1,400),
    (try_end),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 300),
(else_try),
    (eq,"$g_multiplayer_message_type",4),
    (agent_get_team, ":team_id_001", "$g_multiplayer_message_value_1"),
    (team_get_faction, ":team_faction_004", ":team_id_001"),
    (str_store_faction_name,s1,":team_faction_004"),
    (try_begin),
        (eq,":team_id_001",0),
        (assign,":var002",4281589009),
    (else_try),
        (assign,":var002",4294919202),
    (try_end),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (agent_get_team, ":agent_team_no_007", ":agent_id_006"),
            (try_begin),
                (eq,":agent_team_no_007",":team_id_001"),
                (assign,":var002",4281589009),
                (play_sound,"snd_team_scored_a_point"),
            (else_try),
                (assign,":var002",4294919202),
                (play_sound,"snd_enemy_scored_a_point"),
            (try_end),
        (try_end),
    (try_end),
    (str_store_string,s0,"str_s1_captured_flag"),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,350),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",5),
    (try_begin),
        (ge,"$g_multiplayer_message_value_1",0),
        (agent_get_team, ":agent_team_no_008", "$g_multiplayer_message_value_1"),
        (team_get_faction, ":team_faction_009", ":agent_team_no_008"),
        (str_store_faction_name,s1,":team_faction_009"),
        (str_store_string,s0,"str_s1_returned_flag"),
    (else_try),
        (val_add, "$g_multiplayer_message_value_1", 1),
        (val_mul, "$g_multiplayer_message_value_1", -1),
        (assign,":agent_team_no_008","$g_multiplayer_message_value_1"),
        (team_get_faction, ":team_faction_009", ":agent_team_no_008"),
        (str_store_faction_name,s1,":team_faction_009"),
        (str_store_string,s0,"str_s1_auto_returned_flag"),
    (try_end),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (play_sound,"snd_flag_returned"),
        (try_end),
    (try_end),
    (assign,":var002",4294967295),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,325),
    (position_set_y,1,400),
    (position_set_x,1,500),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",6),
    (agent_get_team, ":agent_team_no_010", "$g_multiplayer_message_value_1"),
    (team_get_faction, ":team_faction_011", ":agent_team_no_010"),
    (str_store_faction_name,s1,":team_faction_011"),
    (assign,":var002",4294967295),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (agent_get_team, ":agent_team_no_007", ":agent_id_006"),
            (try_begin),
                (eq,":agent_team_no_007",":agent_team_no_010"),
                (play_sound,"snd_enemy_flag_taken"),
            (else_try),
                (play_sound,"snd_your_flag_taken"),
            (try_end),
        (try_end),
    (try_end),
    (str_store_string,s0,"str_s1_taken_flag"),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,365),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",9),
    (store_div, ":var___x1", "$g_multiplayer_message_value_1", 100),
    (assign,":team_id_001",":var___x1"),
    (store_mod,reg0,"$g_multiplayer_message_value_1",100),
    (val_sub, ":team_id_001", 1),
    (try_begin),
        (eq,":team_id_001",0),
        (assign,":var002",4281589009),
    (else_try),
        (assign,":var002",4294919202),
    (try_end),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (agent_get_team, ":agent_team_no_007", ":agent_id_006"),
            (try_begin),
                (eq,":agent_team_no_007",":team_id_001"),
                (assign,":var002",4281589009),
                (play_sound,"snd_team_scored_a_point"),
            (else_try),
                (assign,":var002",4294919202),
                (play_sound,"snd_enemy_scored_a_point"),
            (try_end),
        (try_end),
    (try_end),
    (team_get_faction, ":team_faction_004", ":team_id_001"),
    (str_store_faction_name,s1,":team_faction_004"),
    (str_store_string,s0,"str_s1_captured_flag_reg0"),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,345),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",10),
    (store_div, ":var___x1", "$g_multiplayer_message_value_1", 100),
    (assign,":team_id_001",":var___x1"),
    (store_mod,reg0,"$g_multiplayer_message_value_1",100),
    (val_sub, ":team_id_001", 1),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (agent_get_team, ":agent_team_no_007", ":agent_id_006"),
            (try_begin),
                (eq,":agent_team_no_007",":team_id_001"),
                (play_sound,"snd_enemy_flag_taken"),
            (else_try),
                (play_sound,"snd_your_flag_taken"),
            (try_end),
        (try_end),
    (try_end),
    (assign,":var002",4294967295),
    (team_get_faction, ":team_faction_004", ":team_id_001"),
    (str_store_faction_name,s1,":team_faction_004"),
    (str_store_string,s0,"str_s1_pulling_flag_reg0"),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,345),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",8),
    (store_div, ":var___x1", "$g_multiplayer_message_value_1", 100),
    (assign,":team_id_001",":var___x1"),
    (store_mod,reg0,"$g_multiplayer_message_value_1",100),
    (val_sub, ":team_id_001", 1),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (play_sound,"snd_flag_returned"),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":team_id_001",0),
        (assign,":var002",4281589009),
    (else_try),
        (assign,":var002",4294919202),
    (try_end),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (agent_get_team, ":agent_team_no_007", ":agent_id_006"),
            (try_begin),
                (eq,":agent_team_no_007",":team_id_001"),
                (assign,":var002",4281589009),
            (else_try),
                (assign,":var002",4294919202),
            (try_end),
        (try_end),
    (try_end),
    (team_get_faction, ":team_faction_004", ":team_id_001"),
    (str_store_faction_name,s1,":team_faction_004"),
    (str_store_string,s0,"str_s1_neutralized_flag_reg0"),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,345),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",13),
    (assign,":team_id_001","$g_multiplayer_message_value_1"),
    (try_begin),
        (eq,":team_id_001",0),
        (assign,":var002",4281589009),
    (else_try),
        (assign,":var002",4294919202),
    (try_end),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (agent_get_team, ":agent_team_no_007", ":agent_id_006"),
            (try_begin),
                (eq,":agent_team_no_007",":team_id_001"),
                (assign,":var002",4281589009),
            (else_try),
                (assign,":var002",4294919202),
            (try_end),
        (try_end),
    (try_end),
    (try_begin),
        (eq,"$g_multiplayer_message_value_1",0),
        (str_store_string,s0,"str_s1_defended_castle"),
    (else_try),
        (eq,"$g_multiplayer_message_value_1",1),
        (str_store_string,s0,"str_s1_captured_castle"),
    (else_try),
        (str_store_string,s0,"str_round_draw"),
        (assign,":var002",4294967295),
    (try_end),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (try_begin),
        (neq,"$g_multiplayer_message_value_1",-1),
        (position_set_x,1,325),
    (else_try),
        (position_set_x,1,400),
    (try_end),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",14),
    (assign,":var002",4294967295),
    (str_store_string,s0,"str_round_draw"),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,375),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",18),
    (assign,":var002",4294967295),
    (str_store_string,s0,"str_death_mode_started"),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,350),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",15),
    (try_begin),
        (lt,"$g_multiplayer_message_value_1",0),
        (val_mul, "$g_multiplayer_message_value_1", -1),
        (assign,":var012",0),
        (team_get_faction, ":team_faction_003", 1),
        (str_store_faction_name,s1,":team_faction_003"),
    (else_try),
        (assign,":var012",1),
        (team_get_faction, ":team_faction_003", 0),
        (str_store_faction_name,s1,":team_faction_003"),
    (try_end),
    (try_begin),
        (eq,"$g_multiplayer_message_value_1",1),
        (assign,":var002",4281589009),
    (else_try),
        (assign,":var002",4294919202),
    (try_end),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (try_begin),
            (eq,1,1),
            (multiplayer_get_my_player, ":my_player"),
            (player_get_team_no,  ":team_no_013", ":my_player"),
            (try_begin),
                (neq,":var012",":team_no_013"),
                (assign,":var002",4281589009),
            (else_try),
                (assign,":var002",4294919202),
            (try_end),
        (try_end),
    (try_end),
    (try_begin),
        (eq,"$g_multiplayer_message_value_1",9),
        (str_store_string,s0,"str_s1_destroyed_all_targets"),
    (else_try),
        (eq,"$g_multiplayer_message_value_1",1),
        (str_store_string,s0,"str_s1_destroyed_catapult"),
    (else_try),
        (eq,"$g_multiplayer_message_value_1",2),
        (str_store_string,s0,"str_s1_destroyed_trebuchet"),
    (try_end),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,350),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",16),
    (try_begin),
        (eq,"$g_defender_team",0),
        (assign,":var002",4281589009),
    (else_try),
        (assign,":var002",4294919202),
    (try_end),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (agent_get_team, ":agent_team_no_007", ":agent_id_006"),
            (try_begin),
                (eq,":agent_team_no_007","$g_defender_team"),
                (assign,":var002",4281589009),
            (else_try),
                (assign,":var002",4294919202),
            (try_end),
        (try_end),
    (try_end),
    (assign,":var014","$g_multiplayer_message_value_1"),
    (team_get_faction, ":team_faction_003", "$g_defender_team"),
    (str_store_faction_name,s1,":team_faction_003"),
    (try_begin),
        (eq,":var014",1),
        (str_store_string,s0,"str_s1_saved_1_target"),
    (else_try),
        (eq,":var014",2),
        (str_store_string,s0,"str_s1_saved_2_targets"),
    (try_end),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,350),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(else_try),
    (eq,"$g_multiplayer_message_type",17),
    (assign,":team_id_001","$g_multiplayer_message_value_1"),
    (try_begin),
        (eq,":team_id_001",0),
        (assign,":var002",4281589009),
    (else_try),
        (assign,":var002",4294919202),
    (try_end),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_agent_id, ":agent_id_006", ":my_player"),
        (try_begin),
            (ge,":agent_id_006",0),
            (agent_get_team, ":agent_team_no_007", ":agent_id_006"),
            (try_begin),
                (eq,":agent_team_no_007",":team_id_001"),
                (assign,":var002",4281589009),
            (else_try),
                (assign,":var002",4294919202),
            (try_end),
        (try_end),
    (try_end),
    (try_begin),
        (eq,"$g_defender_team",0),
        (team_get_faction, ":team_faction_003", 1),
    (else_try),
        (team_get_faction, ":team_faction_003", 0),
    (try_end),
    (str_store_faction_name,s1,":team_faction_003"),
    (str_store_string,s0,"str_s1_won_round"),
    (create_text_overlay, "$g_multiplayer_message_1", 0),
    (overlay_set_color, "$g_multiplayer_message_1", ":var002"),
    (position_set_x,1,350),
    (position_set_x,1,500),
    (position_set_y,1,400),
    (overlay_set_position, "$g_multiplayer_message_1", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_1", 1),
    (presentation_set_duration, 400),
(try_end),
]),

(ti_on_presentation_run, [
]),

]),
("multiplayer_message_2",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(try_begin),
    (eq,"$g_multiplayer_message_type",2),
    (assign,":var001",4294967295),
    (str_store_string,s0,"str_auto_team_balance_done"),
    (create_text_overlay, "$g_multiplayer_message_2", 0),
    (overlay_set_color, "$g_multiplayer_message_2", ":var001"),
    (position_set_x,1,375),
    (position_set_x,1,500),
    (position_set_y,1,550),
    (overlay_set_position, "$g_multiplayer_message_2", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_2", 1),
    (presentation_set_duration, 300),
(else_try),
    (eq,"$g_multiplayer_message_type",3),
    (assign,":var001",4294967295),
    (try_begin),
        (neq,"$g_multiplayer_game_type",2),
        (neq,"$g_multiplayer_game_type",3),
        (neq,"$g_multiplayer_game_type",6),
        (str_store_string,s0,"str_auto_team_balance_in_20_seconds"),
        (position_set_x,1,375),
    (else_try),
        (str_store_string,s0,"str_auto_team_balance_next_round"),
        (position_set_x,1,375),
    (try_end),
    (create_text_overlay, "$g_multiplayer_message_2", 0),
    (overlay_set_color, "$g_multiplayer_message_2", ":var001"),
    (position_set_y,1,550),
    (position_set_x,1,500),
    (overlay_set_position, "$g_multiplayer_message_2", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_2", 1),
    (presentation_set_duration, 300),
(try_end),
]),

(ti_on_presentation_run, [
]),

]),
("multiplayer_message_3",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(try_begin),
    (eq,"$g_multiplayer_message_type",7),
    (assign,":var001",4294967295),
    (try_begin),
        (eq,"$g_multiplayer_message_value_3",1),
        (str_store_string,s0,"str_poll_result_yes"),
    (else_try),
        (str_store_string,s0,"str_poll_result_no"),
    (try_end),
    (create_text_overlay, "$g_multiplayer_message_3", 0),
    (overlay_set_color, "$g_multiplayer_message_3", ":var001"),
    (position_set_x,1,380),
    (position_set_x,1,500),
    (position_set_y,1,475),
    (overlay_set_position, "$g_multiplayer_message_3", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_message_3", 1),
    (presentation_set_duration, 400),
(try_end),
]),

(ti_on_presentation_run, [
]),

]),
("multiplayer_round_time_counter",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(assign,"$g_multiplayer_last_round_time_counter_value",-1),
(str_clear, 0),
(create_text_overlay, "$g_multiplayer_round_time_counter_overlay", 0),
(overlay_set_color, "$g_multiplayer_round_time_counter_overlay", 16777215),
(position_set_x,1,900),
(position_set_y,1,690),
(overlay_set_position, "$g_multiplayer_round_time_counter_overlay", 1),
(position_set_x,1,2000),
(position_set_y,1,2000),
(overlay_set_size, "$g_multiplayer_round_time_counter_overlay", 1),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(store_mission_timer_a,":m_timer_a_001"),
(store_sub, ":var002", ":m_timer_a_001", "$g_round_start_time"),
(store_sub, ":var003", "$g_multiplayer_round_max_seconds", ":var002"),
(val_max,":var003",0),
(try_begin),
    (neq,"$g_multiplayer_last_round_time_counter_value",":var003"),
    (assign,"$g_multiplayer_last_round_time_counter_value",":var003"),
    (store_div, ":var___x1", ":var003", 60),
    (assign,reg0,":var___x1"),
    (store_div, ":var___x1", ":var003", 10),
    (assign,reg1,":var___x1"),
    (val_mod, reg1, 6),
    (assign,reg2,":var003"),
    (val_mod, reg2, 10),
    (str_store_string,s0,"str_reg0_dd_reg1reg2"),
    (overlay_set_text, "$g_multiplayer_round_time_counter_overlay", 0),
(try_end),
]),

]),
("multiplayer_team_score_display",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(assign,"$g_multiplayer_team_1_last_displayed_score",-1),
(assign,"$g_multiplayer_team_2_last_displayed_score",-1),
(str_clear, 0),
(create_text_overlay, "$g_multiplayer_team_1_score_display_overlay", 0),
(overlay_set_color, "$g_multiplayer_team_1_score_display_overlay", 16777215),
(position_set_x,1,40),
(position_set_y,1,700),
(overlay_set_position, "$g_multiplayer_team_1_score_display_overlay", 1),
(position_set_x,1,1500),
(position_set_y,1,1500),
(overlay_set_size, "$g_multiplayer_team_1_score_display_overlay", 1),
(create_text_overlay, "$g_multiplayer_team_2_score_display_overlay", 0),
(overlay_set_color, "$g_multiplayer_team_2_score_display_overlay", 16777215),
(position_set_x,1,40),
(position_set_y,1,645),
(overlay_set_position, "$g_multiplayer_team_2_score_display_overlay", 1),
(position_set_x,1,1500),
(position_set_y,1,1500),
(overlay_set_size, "$g_multiplayer_team_2_score_display_overlay", 1),
(try_begin),
    (eq,"$g_multiplayer_team_1_faction","fac_kingdom_4"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_1"),
(else_try),
    (eq,"$g_multiplayer_team_1_faction","fac_kingdom_2"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_2"),
(else_try),
    (eq,"$g_multiplayer_team_1_faction","fac_kingdom_3"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_3"),
(else_try),
    (eq,"$g_multiplayer_team_1_faction","fac_kingdom_5"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_4"),
(else_try),
    (eq,"$g_multiplayer_team_1_faction","fac_kingdom_6"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_5"),
(else_try),
    (eq,"$g_multiplayer_team_1_faction","fac_kingdom_1"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_6"),
(try_end),
(position_set_x,3,25),
(position_set_y,3,715),
(overlay_set_position, reg0, 3),
(position_set_x,1,50),
(position_set_y,1,50),
(overlay_set_size, reg0, 1),
(try_begin),
    (eq,"$g_multiplayer_team_1_faction","$g_multiplayer_team_2_faction"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_7"),
(else_try),
    (eq,"$g_multiplayer_team_2_faction","fac_kingdom_4"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_1"),
(else_try),
    (eq,"$g_multiplayer_team_2_faction","fac_kingdom_2"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_2"),
(else_try),
    (eq,"$g_multiplayer_team_2_faction","fac_kingdom_3"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_3"),
(else_try),
    (eq,"$g_multiplayer_team_2_faction","fac_kingdom_5"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_4"),
(else_try),
    (eq,"$g_multiplayer_team_2_faction","fac_kingdom_6"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_5"),
(else_try),
    (eq,"$g_multiplayer_team_2_faction","fac_kingdom_1"),
    (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_6"),
(try_end),
(position_set_x,3,25),
(position_set_y,3,660),
(overlay_set_position, reg0, 3),
(position_set_x,1,50),
(position_set_y,1,50),
(overlay_set_size, reg0, 1),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(team_get_score, ":team_score_001", 0),
(team_get_score, ":team_score_002", 1),
(try_begin),
    (this_or_next|eq,":team_score_001","$g_multiplayer_team_1_last_displayed_score"),
    (neq,":team_score_002","$g_multiplayer_team_2_last_displayed_score"),
    (assign,"$g_multiplayer_team_1_last_displayed_score",":team_score_001"),
    (assign,"$g_multiplayer_team_2_last_displayed_score",":team_score_002"),
    (str_store_faction_name,s0,"$g_multiplayer_team_1_faction"),
    (assign,reg0,":team_score_001"),
    (overlay_set_text, "$g_multiplayer_team_1_score_display_overlay", "str_reg0"),
    (str_store_faction_name,s0,"$g_multiplayer_team_2_faction"),
    (assign,reg0,":team_score_002"),
    (overlay_set_text, "$g_multiplayer_team_2_score_display_overlay", "str_reg0"),
(try_end),
]),

]),
("multiplayer_flag_projection_display",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(store_sub, ":var001", "$g_multiplayer_team_1_faction", ":fac.kingdom_1"),
(assign,":var001 +","mesh_flag_project_sw"),
(create_mesh_overlay, "$g_presentation_obj_flag_projection_display_1", ":var001"),
(assign,":var001 -","mesh_flag_project_sw"),
(assign,":var001 +","mesh_flag_project_sw_miss"),
(create_mesh_overlay, "$g_presentation_obj_flag_projection_display_2", ":var001"),
(try_begin),
    (neq,"$g_multiplayer_team_1_faction","$g_multiplayer_team_2_faction"),
    (store_sub, ":var001", "$g_multiplayer_team_2_faction", ":fac.kingdom_1"),
    (assign,":var001 +","mesh_flag_project_sw"),
    (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_3", ":var001"),
    (assign,":var001 -","mesh_flag_project_sw"),
    (assign,":var001 +","mesh_flag_project_sw_miss"),
    (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_4", ":var001"),
(else_try),
    (assign,":var001","mesh_flag_project_rb"),
    (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_3", ":var001"),
    (assign,":var001","mesh_flag_project_rb_miss"),
    (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_4", ":var001"),
(try_end),
(position_set_x,1,250),
(position_set_y,1,250),
(overlay_set_size, "$g_presentation_obj_flag_projection_display_1", 1),
(overlay_set_size, "$g_presentation_obj_flag_projection_display_2", 1),
(overlay_set_size, "$g_presentation_obj_flag_projection_display_3", 1),
(overlay_set_size, "$g_presentation_obj_flag_projection_display_4", 1),
(overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
(overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 0),
(overlay_set_display, "$g_presentation_obj_flag_projection_display_3", 0),
(overlay_set_display, "$g_presentation_obj_flag_projection_display_4", 0),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(set_fixed_point_multiplier, 1000),
(scene_prop_get_instance, ":scp_instance_001", "$team_1_flag_scene_prop", 0),
(team_get_slot,":team_slot_002",0,0),
(try_begin),
    (neq,":team_slot_002",1),
    (prop_instance_get_position, pos1, ":scp_instance_001"),
(else_try),
    (entry_point_get_position, pos1, 64),
(try_end),
(position_move_z,1,200,1),
(scene_prop_get_instance, ":scp_instance_003", "$team_2_flag_scene_prop", 0),
(team_get_slot,":team_slot_004",1,0),
(try_begin),
    (neq,":team_slot_004",1),
    (prop_instance_get_position, pos2, ":scp_instance_003"),
(else_try),
    (entry_point_get_position, pos2, 65),
(try_end),
(position_move_z,2,200,1),
(position_get_screen_projection, pos3, 1),
(position_get_x,":pos_x_005",3),
(position_get_y,":pos_y_006",3),
(position_set_y,3,":pos_y_006"),
(try_begin),
    (is_between,":pos_x_005",-100,1100),
    (is_between,":pos_y_006",-100,850),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_team_no,  ":team_no_008", ":my_player"),
    (else_try),
        (assign,":team_no_008",2),
    (try_end),
    (try_begin),
        (neq,":team_no_008",1),
        (try_begin),
            (neq,":team_slot_002",1),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 1),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 0),
        (else_try),
            (try_begin),
                (eq,":team_no_008",0),
                (assign,":var009",64),
            (else_try),
                (assign,":var009",65),
            (try_end),
            (entry_point_get_position, pos5, ":var009"),
            (position_get_screen_projection, pos3, 5),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_2", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 1),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
        (try_end),
    (else_try),
        (try_begin),
            (neq,":team_slot_002",1),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 1),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 0),
        (try_end),
    (try_end),
(else_try),
    (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
    (overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 0),
(try_end),
(position_get_screen_projection, pos3, 2),
(position_get_x,":pos_x_005",3),
(position_get_y,":pos_y_006",3),
(position_set_y,3,":pos_y_006"),
(try_begin),
    (is_between,":pos_x_005",-100,1100),
    (is_between,":pos_y_006",-100,850),
    (team_get_slot,":team_slot_004",1,0),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_team_no,  ":team_no_008", ":my_player"),
    (else_try),
        (assign,":team_no_008",2),
    (try_end),
    (try_begin),
        (neq,":team_no_008",0),
        (try_begin),
            (neq,":team_slot_004",1),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_3", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_3", 1),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_4", 0),
        (else_try),
            (try_begin),
                (eq,":team_no_008",0),
                (assign,":var009",64),
            (else_try),
                (assign,":var009",65),
            (try_end),
            (entry_point_get_position, pos5, ":var009"),
            (position_get_screen_projection, pos3, 5),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_4", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_4", 1),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_3", 0),
        (try_end),
    (else_try),
        (try_begin),
            (neq,":team_slot_004",1),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_3", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_3", 1),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_4", 0),
        (try_end),
    (try_end),
(else_try),
    (overlay_set_display, "$g_presentation_obj_flag_projection_display_3", 0),
    (overlay_set_display, "$g_presentation_obj_flag_projection_display_4", 0),
(try_end),
]),

]),
("multiplayer_flag_projection_display_bt",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(store_sub, ":var001", "$g_multiplayer_team_1_faction", ":fac.kingdom_1"),
(assign,":var001 +","mesh_flag_project_sw"),
(create_mesh_overlay, "$g_presentation_obj_flag_projection_display_1", ":var001"),
(try_begin),
    (neq,"$g_multiplayer_team_1_faction","$g_multiplayer_team_2_faction"),
    (store_sub, ":var001", "$g_multiplayer_team_2_faction", ":fac.kingdom_1"),
    (assign,":var001 +","mesh_flag_project_sw"),
(else_try),
    (assign,":var001","mesh_flag_project_rb"),
(try_end),
(create_mesh_overlay, "$g_presentation_obj_flag_projection_display_3", ":var001"),
(position_set_x,1,250),
(position_set_y,1,250),
(overlay_set_size, "$g_presentation_obj_flag_projection_display_1", 1),
(overlay_set_size, "$g_presentation_obj_flag_projection_display_3", 1),
(overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
(overlay_set_display, "$g_presentation_obj_flag_projection_display_3", 0),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(try_begin),
    (eq,"$g_round_ended",0),
    (set_fixed_point_multiplier, 1000),
    (scene_prop_get_instance, ":scp_instance_001", "$team_1_flag_scene_prop", 0),
    (prop_instance_get_position, pos1, ":scp_instance_001"),
    (position_move_z,1,250,1),
    (scene_prop_get_instance, ":scp_instance_002", "$team_2_flag_scene_prop", 0),
    (prop_instance_get_position, pos2, ":scp_instance_002"),
    (position_move_z,2,250,1),
    (position_get_screen_projection, pos3, 1),
    (position_get_x,":pos_x_003",3),
    (position_get_y,":pos_y_004",3),
    (position_set_y,3,":pos_y_004"),
    (try_begin),
        (is_between,":pos_x_003",-100,1100),
        (is_between,":pos_y_004",-100,850),
        (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", 3),
        (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 1),
    (else_try),
        (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
    (try_end),
    (position_get_screen_projection, pos3, 2),
    (position_get_x,":pos_x_003",3),
    (position_get_y,":pos_y_004",3),
    (position_set_y,3,":pos_y_004"),
    (try_begin),
        (is_between,":pos_x_003",-100,1100),
        (is_between,":pos_y_004",-100,850),
        (overlay_set_position, "$g_presentation_obj_flag_projection_display_3", 3),
        (overlay_set_display, "$g_presentation_obj_flag_projection_display_3", 1),
    (else_try),
        (overlay_set_display, "$g_presentation_obj_flag_projection_display_3", 0),
    (try_end),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_destructible_targets_display",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(try_begin),
    (eq,"$g_defender_team",0),
    (store_sub, ":var001", "$g_multiplayer_team_1_faction", ":fac.kingdom_1"),
(else_try),
    (store_sub, ":var001", "$g_multiplayer_team_2_faction", ":fac.kingdom_1"),
(try_end),
(assign,":var001 +","mesh_flag_project_sw"),
(create_mesh_overlay, "$g_presentation_obj_flag_projection_display_1", ":var001"),
(create_mesh_overlay, "$g_presentation_obj_flag_projection_display_2", ":var001"),
(position_set_x,1,250),
(position_set_y,1,250),
(overlay_set_size, "$g_presentation_obj_flag_projection_display_1", 1),
(overlay_set_size, "$g_presentation_obj_flag_projection_display_2", 1),
(overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
(overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 0),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(try_begin),
    (eq,"$g_round_ended",0),
    (set_fixed_point_multiplier, 1000),
    (scene_prop_get_instance, ":scp_instance_001", "$g_destructible_target_1", 0),
    (prop_instance_get_position, pos1, ":scp_instance_001"),
    (prop_instance_get_position, pos1, ":scp_instance_001"),
    (position_move_z,1,250,1),
    (scene_prop_get_instance, ":scp_instance_002", "$g_destructible_target_2", 0),
    (prop_instance_get_position, pos2, ":scp_instance_002"),
    (prop_instance_get_position, pos2, ":scp_instance_002"),
    (position_move_z,2,250,1),
    (position_get_screen_projection, pos3, 1),
    (position_get_x,":pos_x_003",3),
    (position_get_y,":pos_y_004",3),
    (position_set_y,3,":pos_y_004"),
    (try_begin),
        (is_between,":pos_x_003",-100,1100),
        (is_between,":pos_y_004",-100,850),
        (prop_instance_get_starting_position, pos0, ":scp_instance_001"),
        (prop_instance_get_position, pos1, ":scp_instance_001"),
        (get_sq_distance_between_positions_in_meters,":sq_distance_005",0,1),
        (try_begin),
            (le,":sq_distance_005",2),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 1),
        (else_try),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
        (try_end),
    (try_end),
    (position_get_screen_projection, pos3, 2),
    (position_get_x,":pos_x_003",3),
    (position_get_y,":pos_y_004",3),
    (position_set_y,3,":pos_y_004"),
    (try_begin),
        (is_between,":pos_x_003",-100,1100),
        (is_between,":pos_y_004",-100,850),
        (prop_instance_get_starting_position, pos0, ":scp_instance_002"),
        (prop_instance_get_position, pos1, ":scp_instance_002"),
        (get_sq_distance_between_positions_in_meters,":sq_distance_005",0,1),
        (try_begin),
            (le,":sq_distance_005",2),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_2", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 1),
        (else_try),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 0),
        (try_end),
    (try_end),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_respawn_time_counter",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(assign,"$g_multiplayer_respawn_counter_overlay",-1),
(assign,"$g_multiplayer_respawn_remained_overlay",-1),
(assign,":var001",0),
(try_begin),
    (eq,"$g_multiplayer_message_type",13),
    (this_or_next|eq,"$g_round_ended",1),
    (neg|eq,"$g_flag_is_not_ready",1),
    (assign,":var001",1),
(try_end),
(try_begin),
    (eq,":var001",0),
    (assign,"$g_multiplayer_last_respawn_counter_value",-1),
    (str_clear, 0),
    (create_text_overlay, "$g_multiplayer_respawn_counter_overlay", 0),
    (overlay_set_color, "$g_multiplayer_respawn_counter_overlay", 16777215),
    (position_set_x,1,500),
    (position_set_y,1,600),
    (overlay_set_position, "$g_multiplayer_respawn_counter_overlay", 1),
    (position_set_x,1,2000),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_multiplayer_respawn_counter_overlay", 1),
    (str_clear, 0),
    (create_text_overlay, "$g_multiplayer_respawn_remained_overlay", 0),
    (overlay_set_color, "$g_multiplayer_respawn_remained_overlay", 16777215),
    (position_set_x,1,500),
    (position_set_y,1,570),
    (overlay_set_position, "$g_multiplayer_respawn_remained_overlay", 1),
    (position_set_x,1,1400),
    (position_set_y,1,1400),
    (overlay_set_size, "$g_multiplayer_respawn_remained_overlay", 1),
    (presentation_set_duration, 999999),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (ge,"$g_multiplayer_respawn_counter_overlay",0),
    (multiplayer_get_my_player, ":my_player"),
    (try_begin),
        (ge,":my_player",0),
        (player_get_team_no,  ":team_no_002", ":my_player"),
        (store_mission_timer_a,":m_timer_a_003"),
        (store_sub, ":var004", ":m_timer_a_003", "$g_multiplayer_respawn_start_time"),
        (try_begin),
            (eq,":team_no_002",2),
            (presentation_set_duration, 0),
        (else_try),
            (eq,"$g_show_no_more_respawns_remained",0),
            (assign,":var005","$g_multiplayer_respawn_period"),
            (try_begin),
                (eq,"$g_multiplayer_game_type",6),
                (player_get_team_no,  ":team_no_002", ":my_player"),
                (try_begin),
                    (eq,":team_no_002",0),
                    (val_add, ":var005", 27),
                (try_end),
            (try_end),
        (else_try),
            (assign,":var005",6),
        (try_end),
        (store_sub, ":var006", ":var005", ":var004"),
        (try_begin),
            (le,":var006",0),
            (presentation_set_duration, 0),
        (else_try),
            (neq,"$g_multiplayer_last_respawn_counter_value",":var006"),
            (assign,"$g_multiplayer_last_respawn_counter_value",":var006"),
            (try_begin),
                (eq,"$g_show_no_more_respawns_remained",0),
                (assign,reg0,":var006"),
                (str_store_string,s0,"str_respawning_in_reg0_seconds"),
                (try_begin),
                    (gt,"$g_multiplayer_number_of_respawn_count",0),
                    (store_sub, reg0, "$g_multiplayer_number_of_respawn_count", "$g_my_spawn_count"),
                    (multiplayer_get_my_player, ":my_player"),
                    (player_get_team_no,  ":team_no_007", ":my_player"),
                    (try_begin),
                        (eq,":team_no_007",0),
                        (try_begin),
                            (gt,reg0,1),
                            (str_store_string,s1,"str_reg0_respawns_remained"),
                        (else_try),
                            (str_store_string,s1,"str_this_is_your_last_respawn"),
                        (try_end),
                    (try_end),
                (else_try),
                    (str_clear, 1),
                (try_end),
            (else_try),
                (eq,"$g_show_no_more_respawns_remained",1),
                (str_store_string,s0,"str_no_more_respawns_remained_this_round"),
                (str_clear, 1),
                (str_store_string,s1,"str_wait_next_round"),
            (try_end),
            (overlay_set_text, "$g_multiplayer_respawn_counter_overlay", 0),
            (overlay_set_text, "$g_multiplayer_respawn_remained_overlay", 1),
        (try_end),
    (try_end),
(else_try),
    (presentation_set_duration, 0),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_message_type",13),
    (this_or_next|eq,"$g_round_ended",1),
    (neg|eq,"$g_flag_is_not_ready",1),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_stats_chart",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_score_b"),
(position_set_x,1,100),
(position_set_y,1,100),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(assign,":var001",0),
(assign,":var002",0),
(assign,":var003",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_005", 0, ":max_players"),
    (store_add, ":slot_no_006", ":player_id_005", 211),
    (try_begin),
        (player_is_active, ":player_id_005"),
        (troop_set_slot,"trp_multiplayer_data",":slot_no_006",1),
        (player_get_team_no,  ":team_no_007", ":player_id_005"),
        (try_begin),
            (eq,":team_no_007",0),
            (val_add, ":var001", 1),
        (else_try),
            (eq,":team_no_007",1),
            (val_add, ":var002", 1),
        (else_try),
            (eq,":team_no_007",2),
            (val_add, ":var003", 1),
        (try_end),
    (else_try),
        (troop_set_slot,"trp_multiplayer_data",":slot_no_006",0),
    (try_end),
(try_end),
(try_begin),
    (gt,"$g_multiplayer_num_bots_team_1",0),
    (val_add, ":var001", 1),
(try_end),
(try_begin),
    (gt,"$g_multiplayer_num_bots_team_2",0),
    (val_add, ":var002", 1),
(try_end),
(assign,":var008",":var001"),
(val_max,":var008",":var002"),
(val_add, ":var008", ":var003"),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_stats_chart_container", 0),
(position_set_x,1,100),
(position_set_y,1,120),
(overlay_set_position, "$g_presentation_obj_stats_chart_container", 1),
(position_set_x,1,746),
(position_set_y,1,530),
(overlay_set_area_size, "$g_presentation_obj_stats_chart_container", 1),
(set_container_overlay, "$g_presentation_obj_stats_chart_container"),
(store_mul, ":var009", ":var008", 20),
(val_add, ":var009", 100),
(try_begin),
    (gt,":var003",0),
    (val_add, ":var009", 70),
(try_end),
(multiplayer_get_my_player, ":my_player"),
(try_begin),
    (gt,":var009",490),
    (assign,"$g_stats_chart_update_period",8),
(else_try),
    (assign,"$g_stats_chart_update_period",1),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_game_type",5),
    (call_script, "script_get_headquarters_scores"),
    (assign,":var011",reg0),
    (assign,":var012",reg1),
(try_end),
(try_for_range, ":team_id_013", 0, 2),
    (assign,":var014",0),
    (get_max_players, ":max_players"),
    (try_for_range, ":player_id_005", 0, ":max_players"),
        (try_begin),
            (player_is_active, ":player_id_005"),
            (player_get_team_no,  ":team_no_015", ":player_id_005"),
            (try_begin),
                (eq,":team_no_015",":team_id_013"),
                (val_add, ":var014", 1),
            (try_end),
        (try_end),
    (try_end),
    (assign,reg0,":var014"),
    (try_begin),
        (neq,":var014",1),
        (create_text_overlay, reg1, "str_reg0_players"),
    (else_try),
        (create_text_overlay, reg1, "str_reg0_player"),
    (try_end),
    (assign,":var016",":var009"),
    (team_get_faction, ":team_faction_017", ":team_id_013"),
    (str_store_faction_name,s1,":team_faction_017"),
    (create_text_overlay, reg0, 1),
    (try_begin),
        (eq,":team_id_013",0),
        (overlay_set_color, reg0, 16711680),
        (overlay_set_color, reg1, 16711680),
    (else_try),
        (overlay_set_color, reg0, 39423),
        (overlay_set_color, reg1, 39423),
    (try_end),
    (assign,":var018",373),
    (store_mul, ":var019", ":var018", ":team_id_013"),
    (val_add, ":var019", 42),
    (store_add, ":var020", ":var019", 15),
    (position_set_x,3,":var020"),
    (position_set_y,3,":var016"),
    (store_add, ":var021", ":var019", 35),
    (position_set_x,1,":var021"),
    (position_set_y,1,":var016"),
    (copy_position,2,1),
    (store_sub, ":var022", ":var016", 10),
    (position_set_x,2,":var021"),
    (position_set_y,2,":var022"),
    (overlay_set_position, reg0, 1),
    (overlay_set_position, reg1, 2),
    (position_set_x,1,1000),
    (position_set_y,1,1000),
    (position_set_x,2,600),
    (position_set_y,2,600),
    (overlay_set_size, reg0, 1),
    (overlay_set_size, reg1, 2),
    (team_get_faction, ":team_faction_023", 0),
    (team_get_faction, ":team_faction_024", 1),
    (try_begin),
        (eq,":team_faction_023",":team_faction_024"),
        (eq,":team_id_013",1),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_7"),
    (else_try),
        (eq,":team_faction_017","fac_kingdom_4"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_1"),
    (else_try),
        (eq,":team_faction_017","fac_kingdom_2"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_2"),
    (else_try),
        (eq,":team_faction_017","fac_kingdom_3"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_3"),
    (else_try),
        (eq,":team_faction_017","fac_kingdom_5"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_4"),
    (else_try),
        (eq,":team_faction_017","fac_kingdom_6"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_5"),
    (else_try),
        (eq,":team_faction_017","fac_kingdom_1"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_6"),
    (try_end),
    (position_set_x,1,100),
    (position_set_y,1,100),
    (overlay_set_position, reg0, 3),
    (position_set_x,1,50),
    (position_set_y,1,50),
    (overlay_set_size, reg0, 1),
    (team_get_score, reg0, ":team_id_013"),
    (create_text_overlay, reg0, "str_score_reg0"),
    (overlay_set_color, reg0, 16777215),
    (store_add, ":var025", ":var019", 325),
    (store_add, ":var026", ":var016", 0),
    (position_set_x,1,":var025"),
    (position_set_y,1,":var026"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,1200),
    (position_set_y,1,1200),
    (overlay_set_size, reg0, 1),
    (try_begin),
        (eq,"$g_multiplayer_game_type",5),
        (try_begin),
            (eq,":team_id_013",0),
            (assign,reg0,":var011"),
        (else_try),
            (eq,":team_id_013",1),
            (assign,reg0,":var012"),
        (try_end),
        (create_text_overlay, reg0, "str_flags_reg0"),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":var025", ":var019", 258),
        (store_sub, ":var___a2", ":", 10),
        (store_add, ":var026", ":var016", ":var___a2"),
        (position_set_x,1,":var025"),
        (position_set_y,1,":var026"),
        (overlay_set_position, reg0, 1),
        (position_set_x,1,600),
        (position_set_y,1,600),
        (overlay_set_size, reg0, 1),
    (try_end),
    (val_sub, ":var016", 60),
    (create_text_overlay, reg0, "str_player_name"),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,":var019"),
    (position_set_y,1,":var016"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (try_begin),
        (this_or_next|eq,"$g_multiplayer_game_type",5),
        (eq,"$g_multiplayer_game_type",4),
        (create_text_overlay, reg0, "str_score"),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":var025", ":var019", 138),
        (position_set_x,1,":var025"),
        (position_set_y,1,":var016"),
        (overlay_set_position, reg0, 1),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
    (try_end),
    (create_text_overlay, reg0, "str_kills"),
    (overlay_set_color, reg0, 16777215),
    (store_add, ":var025", ":var019", 206),
    (position_set_x,1,":var025"),
    (position_set_y,1,":var016"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (create_text_overlay, reg0, "str_deaths"),
    (overlay_set_color, reg0, 16777215),
    (store_add, ":var025", ":var019", 260),
    (position_set_x,1,":var025"),
    (position_set_y,1,":var016"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (create_text_overlay, reg0, "str_ping"),
    (overlay_set_color, reg0, 16777215),
    (store_add, ":var025", ":var019", 308),
    (position_set_x,1,":var025"),
    (position_set_y,1,":var016"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (create_mesh_overlay, reg0, "mesh_white_plane"),
    (overlay_set_color, reg0, 16777215),
    (overlay_set_alpha, reg0, 208),
    (store_add, ":var025", ":var019", 0),
    (position_set_x,1,":var025"),
    (store_sub, ":var___a2", ":", 10),
    (store_add, ":var026", ":var016", ":var___a2"),
    (position_set_y,1,":var026"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,16500),
    (position_set_y,1,50),
    (overlay_set_size, reg0, 1),
    (val_sub, ":var016", 35),
    (store_add, ":var027", ":max_players", 1),
    (try_for_range, ":var028", 0, ":var027"),
        (assign,":var029",-30030),
        (assign,":player_id_030",-1),
        (try_for_range, ":player_id_005", 0, ":max_players"),
            (store_add, ":slot_no_006", ":player_id_005", 211),
            (try_begin),
                (troop_slot_eq,"trp_multiplayer_data",":slot_no_006",1),
                (player_get_team_no,  ":team_no_007", ":player_id_005"),
                (try_begin),
                    (eq,":team_no_007",":team_id_013"),
                    (try_begin),
                        (this_or_next|eq,"$g_multiplayer_game_type",5),
                        (eq,"$g_multiplayer_game_type",4),
                        (player_get_score, ":score_031", ":player_id_005"),
                    (else_try),
                        (player_get_kill_count, ":score_031", ":player_id_005"),
                    (try_end),
                (try_end),
            (try_end),
            (player_get_death_count, ":death_count_032", ":player_id_005"),
            (store_mul, ":var033", ":score_031", 1000),
            (val_sub, ":var033", ":death_count_032"),
            (try_begin),
                (this_or_next|gt,":var033",":var029"),
                (eq,":var033",-30030),
                (assign,":var029",":var033"),
                (assign,":player_id_030",":player_id_005"),
            (try_end),
        (try_end),
        (try_begin),
            (ge,":player_id_030",0),
            (store_add, ":slot_no_006", ":player_id_030", 211),
            (troop_set_slot,"trp_multiplayer_data",":slot_no_006",0),
            (try_begin),
                (eq,":my_player",":player_id_030"),
                (create_mesh_overlay, reg0, "mesh_white_plane"),
                (overlay_set_color, reg0, 16777215),
                (overlay_set_alpha, reg0, 53),
                (store_add, ":var025", ":var019", 0),
                (position_set_x,1,":var025"),
                (store_add, ":var026", ":var016", 0),
                (position_set_y,1,":var026"),
                (overlay_set_position, reg0, 1),
                (position_set_x,1,16500),
                (position_set_y,1,1000),
                (overlay_set_size, reg0, 1),
            (try_end),
            (try_begin),
                (this_or_next|eq,"$g_multiplayer_game_type",5),
                (eq,"$g_multiplayer_game_type",4),
                (assign,":var034",16777215),
                (player_get_agent_id, ":agent_id_035", ":player_id_030"),
                (try_begin),
                    (this_or_next|ge,":agent_id_035",0),
                    (neg|agent_is_alive,":agent_id_035"),
                    (assign,":var034",16711680),
                (try_end),
                (player_get_score, reg0, ":player_id_030"),
                (create_text_overlay, reg0, "str_reg0"),
                (overlay_set_color, reg0, ":var034"),
                (position_set_x,1,750),
                (position_set_y,1,750),
                (overlay_set_size, reg0, 1),
                (store_add, ":var025", ":var019", 165),
                (position_set_x,1,":var025"),
                (position_set_y,1,":var016"),
                (overlay_set_position, reg0, 1),
            (else_try),
                (assign,":var034",16777215),
                (player_get_agent_id, ":agent_id_035", ":player_id_030"),
                (try_begin),
                    (this_or_next|ge,":agent_id_035",0),
                    (neg|agent_is_alive,":agent_id_035"),
                    (assign,":var034",16711680),
                    (create_text_overlay, reg0, "str_dead"),
                    (overlay_set_color, reg0, ":var034"),
                    (position_set_x,1,750),
                    (position_set_y,1,750),
                    (overlay_set_size, reg0, 1),
                    (store_add, ":var025", ":var019", 130),
                    (position_set_x,1,":var025"),
                    (position_set_y,1,":var016"),
                    (overlay_set_position, reg0, 1),
                (try_end),
            (try_end),
            (str_store_player_username,s1,":player_id_030"),
            (try_begin),
                (eq,"$g_multiplayer_is_game_type_captain",1),
                (create_text_overlay, reg0, "str_s1_team"),
            (else_try),
                (create_text_overlay, reg0, 1),
            (try_end),
            (overlay_set_color, reg0, ":var034"),
            (position_set_x,1,750),
            (position_set_y,1,750),
            (overlay_set_size, reg0, 1),
            (position_set_x,1,":var019"),
            (position_set_y,1,":var016"),
            (overlay_set_position, reg0, 1),
            (player_get_kill_count, reg0, ":player_id_030"),
            (create_text_overlay, reg0, "str_reg0"),
            (overlay_set_color, reg0, ":var034"),
            (position_set_x,1,750),
            (position_set_y,1,750),
            (overlay_set_size, reg0, 1),
            (store_add, ":var025", ":var019", 215),
            (position_set_x,1,":var025"),
            (position_set_y,1,":var016"),
            (overlay_set_position, reg0, 1),
            (player_get_death_count, reg0, ":player_id_030"),
            (create_text_overlay, reg0, "str_reg0"),
            (overlay_set_color, reg0, ":var034"),
            (position_set_x,1,750),
            (position_set_y,1,750),
            (overlay_set_size, reg0, 1),
            (store_add, ":var025", ":var019", 265),
            (position_set_x,1,":var025"),
            (position_set_y,1,":var016"),
            (overlay_set_position, reg0, 1),
            (player_get_ping, reg0, ":player_id_030"),
            (create_text_overlay, reg0, "str_reg0"),
            (overlay_set_color, reg0, ":var034"),
            (position_set_x,1,750),
            (position_set_y,1,750),
            (overlay_set_size, reg0, 1),
            (store_add, ":var025", ":var019", 315),
            (position_set_x,1,":var025"),
            (position_set_y,1,":var016"),
            (overlay_set_position, reg0, 1),
            (val_sub, ":var016", 20),
        (else_try),
            (try_begin),
                (eq,1,1),
                (try_begin),
                    (eq,":team_id_013",0),
                    (assign,":var036","$g_multiplayer_num_bots_team_1"),
                (else_try),
                    (assign,":var036","$g_multiplayer_num_bots_team_2"),
                (try_end),
                (team_get_bot_kill_count, reg0, ":team_id_013"),
                (team_get_bot_death_count, reg1, ":team_id_013"),
                (try_begin),
                    (this_or_next|eq,reg0,0),
                    (this_or_next|eq,reg1,0),
                    (neq,":var036",0),
                    (assign,":var037",1),
                (else_try),
                    (assign,":var037",0),
                (try_end),
                (try_begin),
                    (eq,":var037",1),
                    (assign,":var038",0),
                    (try_for_agents, ":cur_agent"),
                        (try_begin),
                            (agent_is_non_player, ":cur_agent"),
                            (agent_is_alive,":cur_agent"),
                            (agent_get_team, ":agent_team_no_040", ":cur_agent"),
                            (try_begin),
                                (eq,":agent_team_no_040",":team_id_013"),
                                (val_add, ":var038", 1),
                            (try_end),
                        (try_end),
                    (try_end),
                (try_end),
                (store_sub, ":var041", ":var036", ":var038"),
                (try_begin),
                    (eq,":var038",0),
                    (assign,":var034",16711680),
                (else_try),
                    (assign,":var034",13684944),
                (try_end),
                (try_begin),
                    (gt,":var041",0),
                    (try_begin),
                        (eq,":var036",1),
                        (create_text_overlay, reg0, "str_dead"),
                        (store_add, ":var025", ":var019", 130),
                    (else_try),
                        (assign,reg0,":var041"),
                        (create_text_overlay, reg0, "str_reg0_dead"),
                        (store_add, ":var025", ":var019", 123),
                    (try_end),
                    (overlay_set_color, reg0, ":var034"),
                    (position_set_x,1,750),
                    (position_set_y,1,750),
                    (overlay_set_size, reg0, 1),
                    (position_set_x,1,":var025"),
                    (position_set_y,1,":var016"),
                    (overlay_set_position, reg0, 1),
                (try_end),
                (try_begin),
                    (gt,":var036",1),
                    (assign,reg0,":var036"),
                    (create_text_overlay, reg0, "str_bots_reg0_agents"),
                (else_try),
                    (create_text_overlay, reg0, "str_bot_1_agent"),
                (try_end),
                (overlay_set_color, reg0, ":var034"),
                (position_set_x,1,750),
                (position_set_y,1,750),
                (overlay_set_size, reg0, 1),
                (position_set_x,1,":var019"),
                (position_set_y,1,":var016"),
                (overlay_set_position, reg0, 1),
                (team_get_bot_kill_count, reg0, ":team_id_013"),
                (create_text_overlay, reg0, "str_reg0"),
                (overlay_set_color, reg0, ":var034"),
                (position_set_x,1,750),
                (position_set_y,1,750),
                (overlay_set_size, reg0, 1),
                (store_add, ":var025", ":var019", 215),
                (position_set_x,1,":var025"),
                (position_set_y,1,":var016"),
                (overlay_set_position, reg0, 1),
                (team_get_bot_death_count, reg0, ":team_id_013"),
                (create_text_overlay, reg0, "str_reg0"),
                (overlay_set_color, reg0, ":var034"),
                (position_set_x,1,750),
                (position_set_y,1,750),
                (overlay_set_size, reg0, 1),
                (store_add, ":var025", ":var019", 265),
                (position_set_x,1,":var025"),
                (position_set_y,1,":var016"),
                (overlay_set_position, reg0, 1),
                (val_sub, ":var016", 20),
            (try_end),
            (assign,":var027",0),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":team_id_013",0),
        (assign,":var042",":var016"),
    (try_end),
(try_end),
(try_begin),
    (le,":var042",":var016"),
    (assign,":var016",":var042"),
(try_end),
(assign,":var019",42),
(create_mesh_overlay, reg0, "mesh_white_plane"),
(overlay_set_color, reg0, 16777215),
(overlay_set_alpha, reg0, 208),
(store_add, ":var025", ":var019", 0),
(position_set_x,1,":var025"),
(store_add, ":var026", ":var016", 10),
(position_set_y,1,":var026"),
(overlay_set_position, reg0, 1),
(position_set_x,1,36000),
(position_set_y,1,50),
(overlay_set_size, reg0, 1),
(try_begin),
    (gt,":var003",0),
    (assign,":var019",280),
    (val_sub, ":var016", 50),
    (create_text_overlay, reg0, "str_spectators"),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,":var019"),
    (position_set_y,1,":var016"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,1000),
    (position_set_y,1,1000),
    (overlay_set_size, reg0, 1),
    (create_text_overlay, reg0, "str_ping"),
    (overlay_set_color, reg0, 16777215),
    (store_add, ":var025", ":var019", 215),
    (position_set_x,1,":var025"),
    (position_set_y,1,":var016"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (create_mesh_overlay, reg0, "mesh_white_plane"),
    (overlay_set_color, reg0, 16777215),
    (overlay_set_alpha, reg0, 208),
    (store_add, ":var025", ":var019", 0),
    (position_set_x,1,":var025"),
    (store_sub, ":var___a2", ":", 10),
    (store_add, ":var026", ":var016", ":var___a2"),
    (position_set_y,1,":var026"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,12000),
    (position_set_y,1,50),
    (overlay_set_size, reg0, 1),
    (val_sub, ":var016", 30),
    (assign,":var034",12632256),
    (store_add, ":var027", ":max_players", 1),
    (try_for_range, ":player_id_005", 0, ":var027"),
        (store_add, ":slot_no_006", ":player_id_005", 211),
        (try_begin),
            (troop_slot_eq,"trp_multiplayer_data",":slot_no_006",1),
            (player_get_team_no,  ":team_no_007", ":player_id_005"),
            (try_begin),
                (eq,":team_no_007",2),
                (troop_set_slot,"trp_multiplayer_data",":slot_no_006",1),
                (try_begin),
                    (eq,":my_player",":player_id_005"),
                    (create_mesh_overlay, reg0, "mesh_white_plane"),
                    (overlay_set_color, reg0, 16777215),
                    (overlay_set_alpha, reg0, 53),
                    (store_add, ":var025", ":var019", 0),
                    (position_set_x,1,":var025"),
                    (store_add, ":var026", ":var016", 0),
                    (position_set_y,1,":var026"),
                    (overlay_set_position, reg0, 1),
                    (position_set_x,1,12000),
                    (position_set_y,1,1000),
                    (overlay_set_size, reg0, 1),
                (try_end),
            (try_end),
        (try_end),
        (str_store_player_username,s1,":player_id_005"),
        (create_text_overlay, reg0, 1),
        (overlay_set_color, reg0, ":var034"),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (position_set_x,1,":var019"),
        (position_set_y,1,":var016"),
        (overlay_set_position, reg0, 1),
        (player_get_ping, reg0, ":player_id_005"),
        (create_text_overlay, reg0, "str_reg0"),
        (overlay_set_color, reg0, ":var034"),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (store_add, ":var025", ":var019", 215),
        (position_set_x,1,":var025"),
        (position_set_y,1,":var016"),
        (overlay_set_position, reg0, 1),
        (val_sub, ":var016", 20),
    (try_end),
(try_end),
(omit_key_once, 238),
(omit_key_once, 239),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 238),
    (key_clicked, 239),
    (omit_key_once, 238),
    (omit_key_once, 239),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_stats_chart_opened_manually",1),
    (neg|game_key_is_down, 18),
    (assign,"$g_multiplayer_stats_chart_opened_manually",0),
    (clear_omitted_keys),
    (presentation_set_duration, 0),
(try_end),
(try_begin),
    (eq,1,1),
    (store_mul, ":var002", "$g_stats_chart_update_period", 1000),
    (try_begin),
        (gt,":var001",":var002"),
        (clear_omitted_keys),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_stats_chart"),
    (try_end),
(try_end),
]),

]),
("multiplayer_stats_chart_deathmatch",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_score_a"),
(position_set_x,1,295),
(position_set_y,1,115),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(assign,":var001",0),
(assign,":var002",0),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_004", 0, ":max_players"),
    (store_add, ":slot_no_005", ":player_id_004", 211),
    (try_begin),
        (player_is_active, ":player_id_004"),
        (troop_set_slot,"trp_multiplayer_data",":slot_no_005",1),
        (player_get_team_no,  ":team_no_006", ":player_id_004"),
        (try_begin),
            (this_or_next|eq,":team_no_006",1),
            (eq,":team_no_006",0),
            (val_add, ":var001", 1),
        (else_try),
            (eq,":team_no_006",2),
            (val_add, ":var002", 1),
        (try_end),
    (else_try),
        (troop_set_slot,"trp_multiplayer_data",":slot_no_005",0),
    (try_end),
(try_end),
(try_begin),
    (this_or_next|gt,"$g_multiplayer_num_bots_team_1",0),
    (gt,"$g_multiplayer_num_bots_team_2",0),
    (val_add, ":var001", 1),
(try_end),
(store_add, ":var007", ":var001", ":var002"),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_stats_chart_deathmatch_container", 0),
(position_set_x,1,300),
(position_set_y,1,140),
(overlay_set_position, "$g_presentation_obj_stats_chart_deathmatch_container", 1),
(position_set_x,1,346),
(position_set_y,1,530),
(overlay_set_area_size, "$g_presentation_obj_stats_chart_deathmatch_container", 1),
(set_container_overlay, "$g_presentation_obj_stats_chart_deathmatch_container"),
(store_mul, ":var008", ":var007", 20),
(val_add, ":var008", 80),
(try_begin),
    (gt,":var002",0),
    (val_add, ":var008", 70),
(try_end),
(try_begin),
    (ge,":var007",17),
    (assign,"$g_stats_chart_update_period",10),
(else_try),
    (assign,"$g_stats_chart_update_period",1),
(try_end),
(multiplayer_get_my_player, ":my_player"),
(assign,":var010",":var008"),
(assign,":var011",42),
(try_begin),
    (eq,"$g_multiplayer_game_type",8),
    (assign,":var012",0),
    (get_max_players, ":max_players"),
    (try_for_range, ":player_id_004", 0, ":max_players"),
        (try_begin),
            (player_is_active, ":player_id_004"),
            (player_get_team_no,  ":team_no_013", ":player_id_004"),
            (try_begin),
                (eq,":team_no_013",0),
                (assign,":var012",1),
            (try_end),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":var012",1),
        (assign,":var011",40),
        (val_sub, ":var010", 50),
        (create_text_overlay, reg0, "str_wave_info"),
        (overlay_set_color, reg0, 16777215),
        (position_set_x,1,":var011"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (position_set_x,1,850),
        (position_set_y,1,850),
        (overlay_set_size, reg0, 1),
        (val_sub, ":var010", 22),
        (try_begin),
            (gt,"$g_multiplayer_ccoop_wave_no",0),
            (assign,":var014",15790320),
            (store_sub, reg1, "$g_multiplayer_ccoop_wave_no", "$g_mp_coop_last_king_wave"),
            (try_begin),
                (ge,"$g_mp_coop_king_waves",1),
                (create_text_overlay, reg0, "str_elite_wave_no_reg1"),
            (else_try),
                (create_text_overlay, reg0, "str_wave_no_reg1"),
            (try_end),
        (try_end),
        (overlay_set_color, reg0, ":var014"),
        (position_set_x,1,":var011"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (val_sub, ":var010", 22),
    (try_end),
    (call_script, "script_multiplayer_ccoop_get_alive_enemy_count"),
    (assign,":var015",reg0),
    (try_begin),
        (le,"$g_multiplayer_ccoop_enemy_respawn_secs",10000),
        (this_or_next|gt,"$g_multiplayer_ccoop_enemy_respawn_secs",31),
        (gt,":var015",0),
        (eq,"$g_round_ended",0),
        (assign,reg1,"$g_multiplayer_ccoop_enemy_respawn_secs"),
        (try_begin),
            (ge,reg1,60),
            (store_div, ":var___x1", reg1, 60),
            (assign,reg2,":var___x1"),
            (val_mod, reg1, 60),
            (create_text_overlay, reg0, "str_time_left_reg2_mins_reg1_secs"),
        (else_try),
            (create_text_overlay, reg0, "str_time_left_reg1_secs"),
        (try_end),
        (overlay_set_color, reg0, ":var014"),
        (position_set_x,1,":var011"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (val_sub, ":var010", 22),
    (try_end),
    (assign,":var016",0),
    (troop_get_slot,":troop_slot_017","trp_multiplayer_data",186),
    (try_for_range, ":var018", 0, ":troop_slot_017"),
        (store_mul, ":slot_no_019", ":var018", 3),
        (val_add, ":slot_no_019", 188),
        (troop_get_slot,":troop_slot_020","trp_multiplayer_data",":slot_no_019"),
        (val_add, ":var016", ":troop_slot_020"),
    (try_end),
    (assign,":var021",0),
    (try_for_range, ":var018", 0, ":troop_slot_017"),
        (store_mul, ":slot_no_019", ":var018", 3),
        (val_add, ":slot_no_019", 187),
        (troop_get_slot,":troop_slot_022","trp_multiplayer_data",":slot_no_019"),
        (assign,":var023",0),
        (try_for_range, ":var024", 0, ":var018"),
            (try_begin),
                (eq,":var023",0),
                (store_mul, ":slot_no_025", ":var024", 3),
                (val_add, ":slot_no_025", 187),
                (troop_get_slot,":troop_slot_026","trp_multiplayer_data",":slot_no_025"),
                (try_begin),
                    (eq,":troop_slot_022",":troop_slot_026"),
                    (assign,":var023",1),
                (try_end),
            (try_end),
        (try_end),
        (try_begin),
            (eq,":var023",0),
            (val_add, ":slot_no_019", 1),
            (troop_get_slot,":troop_slot_020","trp_multiplayer_data",":slot_no_019"),
            (store_add, ":var027", ":var018", 1),
            (try_for_range, ":var024", ":var027", ":troop_slot_017"),
                (store_mul, ":slot_no_025", ":var024", 3),
                (val_add, ":slot_no_025", 187),
                (troop_get_slot,":troop_slot_026","trp_multiplayer_data",":slot_no_025"),
                (try_begin),
                    (eq,":troop_slot_022",":troop_slot_026"),
                    (val_add, ":slot_no_025", 1),
                    (troop_get_slot,":troop_slot_028","trp_multiplayer_data",":slot_no_025"),
                    (val_add, ":troop_slot_020", ":troop_slot_028"),
                (try_end),
            (try_end),
            (assign,":var029",0),
            (try_for_agents, ":cur_agent"),
                (try_begin),
                    (agent_is_human,":cur_agent"),
                    (agent_is_alive,":cur_agent"),
                    (agent_get_team, ":agent_team_no_031", ":cur_agent"),
                    (try_begin),
                        (eq,":agent_team_no_031",1),
                        (agent_get_troop_id,":troop_id_032", ":cur_agent"),
                        (try_begin),
                            (eq,":troop_id_032",":troop_slot_022"),
                            (val_add, ":var029", 1),
                        (try_end),
                    (try_end),
                (try_end),
            (try_end),
            (try_begin),
                (this_or_next|gt,":troop_slot_020",0),
                (gt,":var029",0),
                (try_begin),
                    (eq,":var021",0),
                    (assign,":var021",1),
                    (assign,reg1,":var015"),
                    (assign,reg2,":var016"),
                    (create_text_overlay, reg0, "str_enemies_reg1_total_reg2_arriving"),
                    (overlay_set_color, reg0, ":var014"),
                    (position_set_x,1,":var011"),
                    (position_set_y,1,":var010"),
                    (overlay_set_position, reg0, 1),
                    (position_set_x,1,750),
                    (position_set_y,1,750),
                    (overlay_set_size, reg0, 1),
                    (val_sub, ":var010", 20),
                (try_end),
                (try_begin),
                    (this_or_next|eq,":var029",1),
                    (this_or_next|is_between,":troop_slot_022","trp_knight_1_1","trp_kingdom_1_pretender"),
                    (is_between,":troop_slot_022","trp_kingdom_1_lord","trp_knight_1_1"),
                    (str_store_troop_name,s0,":troop_slot_022"),
                (else_try),
                    (str_store_troop_name_plural,s0,":troop_slot_022"),
                (try_end),
                (assign,reg3,":troop_slot_020"),
                (assign,reg4,":var029"),
                (create_text_overlay, reg0, "str_ccoop_enemy_info"),
                (overlay_set_color, reg0, ":var014"),
                (position_set_x,1,":var011"),
                (position_set_y,1,":var010"),
                (overlay_set_position, reg0, 1),
                (position_set_x,1,750),
                (position_set_y,1,750),
                (overlay_set_size, reg0, 1),
                (val_sub, ":var010", 18),
            (try_end),
        (try_end),
    (try_end),
    (assign,":var011",42),
    (create_mesh_overlay, reg0, "mesh_white_plane"),
    (overlay_set_color, reg0, 16777215),
    (overlay_set_alpha, reg0, 208),
    (store_add, ":var033", ":var011", 0),
    (position_set_x,1,":var033"),
    (store_add, ":var034", ":var010", 10),
    (position_set_y,1,":var034"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,15250),
    (position_set_y,1,50),
    (overlay_set_size, reg0, 1),
(try_end),
(val_sub, ":var010", 13),
(create_text_overlay, reg0, "str_player_name"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,":var011"),
(position_set_y,1,":var010"),
(overlay_set_position, reg0, 1),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg0, 1),
(create_text_overlay, reg0, "str_kills"),
(overlay_set_color, reg0, 16777215),
(store_add, ":var033", ":var011", 179),
(position_set_x,1,":var033"),
(position_set_y,1,":var010"),
(overlay_set_position, reg0, 1),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg0, 1),
(create_text_overlay, reg0, "str_deaths"),
(overlay_set_color, reg0, 16777215),
(store_add, ":var033", ":var011", 233),
(position_set_x,1,":var033"),
(position_set_y,1,":var010"),
(overlay_set_position, reg0, 1),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg0, 1),
(create_text_overlay, reg0, "str_ping"),
(overlay_set_color, reg0, 16777215),
(store_add, ":var033", ":var011", 282),
(position_set_x,1,":var033"),
(position_set_y,1,":var010"),
(overlay_set_position, reg0, 1),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg0, 1),
(create_mesh_overlay, reg0, "mesh_white_plane"),
(overlay_set_color, reg0, 16777215),
(overlay_set_alpha, reg0, 208),
(store_add, ":var033", ":var011", 0),
(position_set_x,1,":var033"),
(store_sub, ":var___a2", ":", 10),
(store_add, ":var034", ":var010", ":var___a2"),
(position_set_y,1,":var034"),
(overlay_set_position, reg0, 1),
(position_set_x,1,15250),
(position_set_y,1,50),
(overlay_set_size, reg0, 1),
(val_sub, ":var010", 35),
(store_add, ":var035", ":max_players", 1),
(try_for_range, ":var036", 0, ":var035"),
    (assign,":var037",-30030),
    (assign,":player_id_038",-1),
    (try_for_range, ":player_id_004", 0, ":max_players"),
        (store_add, ":slot_no_005", ":player_id_004", 211),
        (try_begin),
            (troop_slot_eq,"trp_multiplayer_data",":slot_no_005",1),
            (player_get_team_no,  ":team_no_006", ":player_id_004"),
            (try_begin),
                (this_or_next|eq,":team_no_006",1),
                (eq,":team_no_006",0),
                (player_get_kill_count, ":kill_count_039", ":player_id_004"),
                (player_get_death_count, ":death_count_040", ":player_id_004"),
                (store_mul, ":var041", ":kill_count_039", 1000),
                (val_sub, ":var041", ":death_count_040"),
                (try_begin),
                    (this_or_next|gt,":var041",":var037"),
                    (eq,":var041",-30030),
                    (assign,":var037",":var041"),
                    (assign,":player_id_038",":player_id_004"),
                (try_end),
            (try_end),
        (try_end),
    (try_end),
    (store_add, ":var043", "$g_multiplayer_num_bots_team_1", "$g_multiplayer_num_bots_team_2"),
    (try_begin),
        (ge,":player_id_038",0),
        (store_add, ":slot_no_005", ":player_id_038", 211),
        (troop_set_slot,"trp_multiplayer_data",":slot_no_005",0),
        (str_store_player_username,s1,":player_id_038"),
        (try_begin),
            (eq,":my_player",":player_id_038"),
            (create_mesh_overlay, reg0, "mesh_white_plane"),
            (overlay_set_color, reg0, 16777215),
            (overlay_set_alpha, reg0, 53),
            (store_add, ":var033", ":var011", 0),
            (position_set_x,1,":var033"),
            (store_add, ":var034", ":var010", 0),
            (position_set_y,1,":var034"),
            (overlay_set_position, reg0, 1),
            (position_set_x,1,16000),
            (position_set_y,1,1000),
            (overlay_set_size, reg0, 1),
        (try_end),
        (assign,":var014",16777215),
        (try_begin),
            (eq,"$g_multiplayer_game_type",8),
            (player_get_agent_id, ":agent_id_042", ":player_id_038"),
            (try_begin),
                (this_or_next|ge,":agent_id_042",0),
                (neg|agent_is_alive,":agent_id_042"),
                (assign,":var014",16711680),
                (create_text_overlay, reg0, "str_dead"),
                (overlay_set_color, reg0, ":var014"),
                (position_set_x,1,750),
                (position_set_y,1,750),
                (overlay_set_size, reg0, 1),
                (store_add, ":var033", ":var011", 130),
                (position_set_x,1,":var033"),
                (position_set_y,1,":var010"),
                (overlay_set_position, reg0, 1),
            (try_end),
        (try_end),
        (try_begin),
            (eq,"$g_multiplayer_game_type",8),
            (create_text_overlay, reg0, "str_s1_team"),
        (else_try),
            (create_text_overlay, reg0, 1),
        (try_end),
        (overlay_set_color, reg0, ":var014"),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (position_set_x,1,":var011"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (player_get_kill_count, reg0, ":player_id_038"),
        (create_text_overlay, reg0, "str_reg0"),
        (overlay_set_color, reg0, 16777215),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (store_add, ":var033", ":var011", 188),
        (position_set_x,1,":var033"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (player_get_death_count, reg0, ":player_id_038"),
        (create_text_overlay, reg0, "str_reg0"),
        (overlay_set_color, reg0, 16777215),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (store_add, ":var033", ":var011", 238),
        (position_set_x,1,":var033"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (player_get_ping, reg0, ":player_id_038"),
        (create_text_overlay, reg0, "str_reg0"),
        (overlay_set_color, reg0, 16777215),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (store_add, ":var033", ":var011", 288),
        (position_set_x,1,":var033"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (val_sub, ":var010", 20),
    (else_try),
        (ge,":var043",1),
        (try_begin),
            (gt,":var043",1),
            (assign,reg0,":var043"),
            (create_text_overlay, reg0, "str_bots_reg0_agents"),
        (else_try),
            (create_text_overlay, reg0, "str_bot_1_agent"),
        (try_end),
        (overlay_set_color, reg0, 13684944),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (position_set_x,1,":var011"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (team_get_bot_kill_count, reg0, 0),
        (assign,":var044",reg0),
        (team_get_bot_kill_count, reg0, 1),
        (val_add, ":var044", reg0),
        (assign,reg0,":var044"),
        (create_text_overlay, reg0, "str_reg0"),
        (overlay_set_color, reg0, 13684944),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (store_add, ":var033", ":var011", 188),
        (position_set_x,1,":var033"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (team_get_bot_death_count, reg0, 0),
        (assign,":var045",reg0),
        (team_get_bot_death_count, reg0, 1),
        (val_add, ":var045", reg0),
        (assign,reg0,":var045"),
        (create_text_overlay, reg0, "str_reg0"),
        (overlay_set_color, reg0, 13684944),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (store_add, ":var033", ":var011", 238),
        (position_set_x,1,":var033"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (val_sub, ":var010", 20),
        (assign,":var035",0),
    (else_try),
        (assign,":var035",0),
    (try_end),
(try_end),
(assign,":var011",42),
(create_mesh_overlay, reg0, "mesh_white_plane"),
(overlay_set_color, reg0, 16777215),
(overlay_set_alpha, reg0, 208),
(store_add, ":var033", ":var011", 0),
(position_set_x,1,":var033"),
(store_add, ":var034", ":var010", 10),
(position_set_y,1,":var034"),
(overlay_set_position, reg0, 1),
(position_set_x,1,15250),
(position_set_y,1,50),
(overlay_set_size, reg0, 1),
(try_begin),
    (gt,":var002",0),
    (assign,":var011",75),
    (val_sub, ":var010", 50),
    (create_text_overlay, reg0, "str_spectators"),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,":var011"),
    (position_set_y,1,":var010"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,1000),
    (position_set_y,1,1000),
    (overlay_set_size, reg0, 1),
    (create_text_overlay, reg0, "str_ping"),
    (overlay_set_color, reg0, 16777215),
    (store_add, ":var033", ":var011", 218),
    (position_set_x,1,":var033"),
    (position_set_y,1,":var010"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,750),
    (overlay_set_size, reg0, 1),
    (create_mesh_overlay, reg0, "mesh_white_plane"),
    (overlay_set_color, reg0, 16777215),
    (overlay_set_alpha, reg0, 208),
    (store_add, ":var033", ":var011", 0),
    (position_set_x,1,":var033"),
    (store_sub, ":var___a2", ":", 10),
    (store_add, ":var034", ":var010", ":var___a2"),
    (position_set_y,1,":var034"),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,12000),
    (position_set_y,1,50),
    (overlay_set_size, reg0, 1),
    (val_sub, ":var010", 30),
    (assign,":var014",12632256),
    (store_add, ":var035", ":max_players", 1),
    (try_for_range, ":player_id_004", 0, ":var035"),
        (store_add, ":slot_no_005", ":player_id_004", 211),
        (try_begin),
            (troop_slot_eq,"trp_multiplayer_data",":slot_no_005",1),
            (player_get_team_no,  ":team_no_006", ":player_id_004"),
            (try_begin),
                (eq,":team_no_006",2),
                (troop_set_slot,"trp_multiplayer_data",":slot_no_005",1),
                (try_begin),
                    (eq,":my_player",":player_id_004"),
                    (create_mesh_overlay, reg0, "mesh_white_plane"),
                    (overlay_set_color, reg0, 16777215),
                    (overlay_set_alpha, reg0, 53),
                    (store_add, ":var033", ":var011", 0),
                    (position_set_x,1,":var033"),
                    (store_add, ":var034", ":var010", 0),
                    (position_set_y,1,":var034"),
                    (overlay_set_position, reg0, 1),
                    (position_set_x,1,12000),
                    (position_set_y,1,1000),
                    (overlay_set_size, reg0, 1),
                (try_end),
            (try_end),
        (try_end),
        (str_store_player_username,s1,":player_id_004"),
        (create_text_overlay, reg0, 1),
        (overlay_set_color, reg0, ":var014"),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (position_set_x,1,":var011"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (player_get_ping, reg0, ":player_id_004"),
        (create_text_overlay, reg0, "str_reg0"),
        (overlay_set_color, reg0, ":var014"),
        (position_set_x,1,750),
        (position_set_y,1,750),
        (overlay_set_size, reg0, 1),
        (store_add, ":var033", ":var011", 215),
        (position_set_x,1,":var033"),
        (position_set_y,1,":var010"),
        (overlay_set_position, reg0, 1),
        (val_sub, ":var010", 20),
    (try_end),
(try_end),
(omit_key_once, 238),
(omit_key_once, 239),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 238),
    (key_clicked, 239),
    (omit_key_once, 238),
    (omit_key_once, 239),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_stats_chart_opened_manually",1),
    (neg|game_key_is_down, 18),
    (assign,"$g_multiplayer_stats_chart_opened_manually",0),
    (clear_omitted_keys),
    (presentation_set_duration, 0),
(try_end),
(try_begin),
    (eq,1,1),
    (store_mul, ":var002", "$g_stats_chart_update_period", 1000),
    (try_begin),
        (gt,":var001",":var002"),
        (clear_omitted_keys),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_stats_chart_deathmatch"),
    (try_end),
(try_end),
]),

]),
("multiplayer_escape_menu",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
(position_set_x,1,250),
(position_set_y,1,80),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_escape_menu_container", 0),
(position_set_x,1,285),
(position_set_y,1,75),
(overlay_set_position, "$g_presentation_obj_escape_menu_container", 1),
(position_set_x,1,405),
(position_set_y,1,550),
(overlay_set_area_size, "$g_presentation_obj_escape_menu_container", 1),
(set_container_overlay, "$g_presentation_obj_escape_menu_container"),
(assign,":var001",500),
(create_text_overlay, reg0, "str_choose_an_option"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,0),
(position_set_y,1,":var001"),
(overlay_set_position, reg0, 1),
(val_sub, ":var001", 40),
(create_button_overlay, "$g_presentation_obj_escape_menu_1", "str_choose_faction"),
(overlay_set_color, "$g_presentation_obj_escape_menu_1", 16777215),
(multiplayer_get_my_team, ":my_team_no"),
(assign,"$g_presentation_obj_escape_menu_2",-1),
(assign,"$g_presentation_obj_escape_menu_3",-1),
(assign,"$g_presentation_obj_escape_menu_6",-1),
(assign,"$g_presentation_obj_escape_menu_7",-1),
(assign,"$g_presentation_obj_escape_menu_8",-1),
(assign,"$g_presentation_obj_escape_menu_9",-1),
(assign,"$g_presentation_obj_escape_menu_10",-1),
(assign,"$g_presentation_obj_escape_menu_11",-1),
(assign,"$g_presentation_obj_escape_menu_12",-1),
(assign,"$g_presentation_obj_escape_menu_13",-1),
(try_begin),
    (lt,":my_team_no",2),
    (create_button_overlay, "$g_presentation_obj_escape_menu_2", "str_choose_troop"),
    (overlay_set_color, "$g_presentation_obj_escape_menu_2", 16777215),
    (multiplayer_get_my_troop, ":my_troop_id"),
    (try_begin),
        (ge,":my_troop_id",0),
        (create_button_overlay, "$g_presentation_obj_escape_menu_3", "str_choose_items"),
        (overlay_set_color, "$g_presentation_obj_escape_menu_3", 16777215),
    (try_end),
(try_end),
(create_button_overlay, "$g_presentation_obj_escape_menu_4", "str_options"),
(overlay_set_color, "$g_presentation_obj_escape_menu_4", 16777215),
(create_button_overlay, "$g_presentation_obj_escape_menu_5", "str_redefine_keys"),
(overlay_set_color, "$g_presentation_obj_escape_menu_5", 16777215),
(create_button_overlay, "$g_presentation_obj_escape_menu_13", "@Show game rules"),
(overlay_set_color, "$g_presentation_obj_escape_menu_13", 16777215),
(multiplayer_get_my_player, ":my_player"),
(try_begin),
    (this_or_next|eq,"$g_multiplayer_maps_voteable",1),
    (this_or_next|eq,"$g_multiplayer_factions_voteable",1),
    (this_or_next|gt,"$g_multiplayer_num_bots_voteable",0),
    (this_or_next|eq,"$g_multiplayer_kick_voteable",1),
    (eq,"$g_multiplayer_ban_voteable",1),
    (create_button_overlay, "$g_presentation_obj_escape_menu_6", "str_submit_a_poll"),
    (overlay_set_color, "$g_presentation_obj_escape_menu_6", 16777215),
    (assign,"$g_presentation_obj_escape_menu_6_available",1),
    (try_begin),
        (ge,":my_player",0),
        (player_get_slot,":player_slot_005",":my_player",26),
        (store_mission_timer_a,":m_timer_a_006"),
        (try_begin),
            (lt,":m_timer_a_006",":player_slot_005"),
            (overlay_set_color, "$g_presentation_obj_escape_menu_6", 8947848),
            (overlay_set_hilight_color, "$g_presentation_obj_escape_menu_6", 8947848),
            (assign,"$g_presentation_obj_escape_menu_6_available",0),
        (try_end),
    (try_end),
(try_end),
(try_begin),
    (ge,":my_player",0),
    (player_is_admin, ":my_player"),
    (create_button_overlay, "$g_presentation_obj_escape_menu_7", "str_administrator_panel"),
    (overlay_set_color, "$g_presentation_obj_escape_menu_7", 16777215),
    (create_button_overlay, "$g_presentation_obj_escape_menu_8", "str_kick_player"),
    (overlay_set_color, "$g_presentation_obj_escape_menu_8", 16777215),
    (create_button_overlay, "$g_presentation_obj_escape_menu_9", "str_ban_player"),
    (overlay_set_color, "$g_presentation_obj_escape_menu_9", 16777215),
(try_end),
(create_button_overlay, "$g_presentation_obj_escape_menu_11", "str_mute_player"),
(overlay_set_color, "$g_presentation_obj_escape_menu_11", 16777215),
(try_begin),
    (eq,1,1),
    (assign,"$g_presentation_obj_escape_menu_12",-1),
    (assign,":var007",0),
    (get_max_players, ":max_players"),
    (try_for_range, ":player_id_009", 0, ":max_players"),
        (try_begin),
            (player_is_active, ":player_id_009"),
            (player_get_is_muted, ":is_muted_010", ":player_id_009"),
            (try_begin),
                (eq,":is_muted_010",1),
                (assign,":var007",1),
            (try_end),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":var007",1),
        (create_button_overlay, "$g_presentation_obj_escape_menu_12", "str_unmute_player"),
        (overlay_set_color, "$g_presentation_obj_escape_menu_12", 16777215),
    (try_end),
(try_end),
(create_button_overlay, "$g_presentation_obj_escape_menu_10", "str_quit"),
(overlay_set_color, "$g_presentation_obj_escape_menu_10", 16777215),
(position_set_x,1,130),
(position_set_y,1,":var001"),
(overlay_set_position, "$g_presentation_obj_escape_menu_1", 1),
(try_begin),
    (ge,"$g_presentation_obj_escape_menu_2",0),
    (val_sub, ":var001", 40),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_escape_menu_2", 1),
(try_end),
(try_begin),
    (ge,"$g_presentation_obj_escape_menu_3",0),
    (val_sub, ":var001", 40),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_escape_menu_3", 1),
(try_end),
(val_sub, ":var001", 40),
(position_set_y,1,":var001"),
(overlay_set_position, "$g_presentation_obj_escape_menu_4", 1),
(val_sub, ":var001", 40),
(position_set_y,1,":var001"),
(overlay_set_position, "$g_presentation_obj_escape_menu_5", 1),
(val_sub, ":var001", 40),
(position_set_y,1,":var001"),
(overlay_set_position, "$g_presentation_obj_escape_menu_13", 1),
(try_begin),
    (ge,"$g_presentation_obj_escape_menu_6",0),
    (val_sub, ":var001", 40),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_escape_menu_6", 1),
(try_end),
(try_begin),
    (ge,"$g_presentation_obj_escape_menu_7",0),
    (val_sub, ":var001", 40),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_escape_menu_7", 1),
(try_end),
(try_begin),
    (ge,"$g_presentation_obj_escape_menu_8",0),
    (val_sub, ":var001", 40),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_escape_menu_8", 1),
(try_end),
(try_begin),
    (ge,"$g_presentation_obj_escape_menu_9",0),
    (val_sub, ":var001", 40),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_escape_menu_9", 1),
(try_end),
(val_sub, ":var001", 40),
(position_set_y,1,":var001"),
(overlay_set_position, "$g_presentation_obj_escape_menu_11", 1),
(try_begin),
    (ge,"$g_presentation_obj_escape_menu_12",0),
    (val_sub, ":var001", 40),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_escape_menu_12", 1),
(try_end),
(val_sub, ":var001", 40),
(position_set_y,1,":var001"),
(overlay_set_position, "$g_presentation_obj_escape_menu_10", 1),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_escape_menu_1"),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_multiplayer_team_select"),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_2"),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_multiplayer_troop_select"),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_3"),
    (presentation_set_duration, 0),
    (assign,"$g_presentation_state",0),
    (start_presentation, "prsnt_multiplayer_item_select"),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_4"),
    (presentation_set_duration, 0),
    (change_screen_options),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_5"),
    (presentation_set_duration, 0),
    (change_screen_controls),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_6"),
    (eq,"$g_presentation_obj_escape_menu_6_available",1),
    (presentation_set_duration, 0),
    (start_presentation, "prsnt_multiplayer_poll_menu"),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_7"),
    (presentation_set_duration, 0),
    (multiplayer_send_int_to_server, 18),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_8"),
    (presentation_set_duration, 0),
    (assign,"$g_multiplayer_players_list_action_type",3),
    (start_presentation, "prsnt_multiplayer_show_players_list"),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_9"),
    (presentation_set_duration, 0),
    (assign,"$g_multiplayer_players_list_action_type",4),
    (start_presentation, "prsnt_multiplayer_show_players_list"),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_10"),
    (presentation_set_duration, 0),
    (finish_mission, 0),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_11"),
    (presentation_set_duration, 0),
    (assign,"$g_multiplayer_players_list_action_type",5),
    (start_presentation, "prsnt_multiplayer_show_players_list"),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_12"),
    (presentation_set_duration, 0),
    (assign,"$g_multiplayer_players_list_action_type",6),
    (start_presentation, "prsnt_multiplayer_show_players_list"),
(else_try),
    (eq,":var001","$g_presentation_obj_escape_menu_13"),
    (presentation_set_duration, 0),
    (multiplayer_send_int_to_server, 45),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (gt,":var001",200),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_poll_menu",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
(position_set_x,1,250),
(position_set_y,1,80),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_poll_menu_container", 0),
(position_set_x,1,285),
(position_set_y,1,125),
(overlay_set_position, "$g_presentation_obj_poll_menu_container", 1),
(position_set_x,1,405),
(position_set_y,1,500),
(overlay_set_area_size, "$g_presentation_obj_poll_menu_container", 1),
(set_container_overlay, "$g_presentation_obj_poll_menu_container"),
(assign,"$g_presentation_obj_poll_menu_1",-1),
(assign,"$g_presentation_obj_poll_menu_4",-1),
(assign,"$g_presentation_obj_poll_menu_5",-1),
(assign,":var001",450),
(create_text_overlay, reg0, "str_choose_a_poll_type"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,0),
(position_set_y,1,":var001"),
(overlay_set_position, reg0, 1),
(val_sub, ":var001", 40),
(position_set_x,1,60),
(try_begin),
    (eq,"$g_multiplayer_maps_voteable",1),
    (create_button_overlay, "$g_presentation_obj_poll_menu_1", "str_poll_for_changing_the_map"),
    (overlay_set_color, "$g_presentation_obj_poll_menu_1", 16777215),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_poll_menu_1", 1),
    (val_sub, ":var001", 40),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_factions_voteable",1),
    (create_button_overlay, "$g_presentation_obj_poll_menu_4", "str_poll_for_changing_the_map_and_factions"),
    (overlay_set_color, "$g_presentation_obj_poll_menu_4", 16777215),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_poll_menu_4", 1),
    (val_sub, ":var001", 40),
(try_end),
(try_begin),
    (gt,"$g_multiplayer_num_bots_voteable",0),
    (create_button_overlay, "$g_presentation_obj_poll_menu_5", "str_poll_for_changing_number_of_bots"),
    (overlay_set_color, "$g_presentation_obj_poll_menu_5", 16777215),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_poll_menu_5", 1),
    (val_sub, ":var001", 40),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_kick_voteable",1),
    (create_button_overlay, "$g_presentation_obj_poll_menu_2", "str_poll_for_kicking_a_player"),
    (overlay_set_color, "$g_presentation_obj_poll_menu_2", 16777215),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_poll_menu_2", 1),
    (val_sub, ":var001", 40),
(try_end),
(try_begin),
    (eq,"$g_multiplayer_ban_voteable",1),
    (create_button_overlay, "$g_presentation_obj_poll_menu_3", "str_poll_for_banning_a_player"),
    (overlay_set_color, "$g_presentation_obj_poll_menu_3", 16777215),
    (position_set_y,1,":var001"),
    (overlay_set_position, "$g_presentation_obj_poll_menu_3", 1),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_poll_menu_1"),
    (presentation_set_duration, 0),
    (assign,"$g_multiplayer_maps_list_action_type",1),
    (start_presentation, "prsnt_multiplayer_show_maps_list"),
(else_try),
    (eq,":var001","$g_presentation_obj_poll_menu_2"),
    (presentation_set_duration, 0),
    (assign,"$g_multiplayer_players_list_action_type",1),
    (start_presentation, "prsnt_multiplayer_show_players_list"),
(else_try),
    (eq,":var001","$g_presentation_obj_poll_menu_3"),
    (presentation_set_duration, 0),
    (assign,"$g_multiplayer_players_list_action_type",2),
    (start_presentation, "prsnt_multiplayer_show_players_list"),
(else_try),
    (eq,":var001","$g_presentation_obj_poll_menu_4"),
    (presentation_set_duration, 0),
    (assign,"$g_multiplayer_maps_list_action_type",2),
    (start_presentation, "prsnt_multiplayer_show_maps_list"),
(else_try),
    (eq,":var001","$g_presentation_obj_poll_menu_5"),
    (presentation_set_duration, 0),
    (assign,"$g_multiplayer_number_of_bots_list_action_type",1),
    (start_presentation, "prsnt_multiplayer_show_number_of_bots_list"),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (gt,":var001",200),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_show_players_list",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
(position_set_x,1,250),
(position_set_y,1,80),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_show_players_1", 0),
(position_set_x,1,285),
(position_set_y,1,125),
(overlay_set_position, "$g_presentation_obj_show_players_1", 1),
(position_set_x,1,405),
(position_set_y,1,500),
(overlay_set_area_size, "$g_presentation_obj_show_players_1", 1),
(set_container_overlay, "$g_presentation_obj_show_players_1"),
(multiplayer_get_my_player, ":my_player"),
(assign,":var002",10),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_004", 1, ":max_players"),
    (try_begin),
        (player_is_active, ":player_id_004"),
        (assign,":var005",0),
        (try_begin),
            (neq,"$g_multiplayer_players_list_action_type",5),
            (neq,"$g_multiplayer_players_list_action_type",6),
            (assign,":var005",1),
        (else_try),
            (eq,"$g_multiplayer_players_list_action_type",5),
            (neq,":player_id_004",":my_player"),
            (player_get_is_muted, ":is_muted_006", ":player_id_004"),
            (try_begin),
                (eq,":is_muted_006",0),
                (assign,":var005",1),
            (else_try),
                (eq,"$g_multiplayer_players_list_action_type",6),
                (neq,":player_id_004",":my_player"),
                (player_get_is_muted, ":is_muted_006", ":player_id_004"),
                (try_begin),
                    (eq,":is_muted_006",1),
                    (assign,":var005",1),
                (try_end),
            (try_end),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":var005",1),
        (val_add, ":var002", 40),
    (try_end),
(try_end),
(create_text_overlay, reg0, "str_choose_a_player"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(val_sub, ":var002", 40),
(get_max_players, ":max_players"),
(try_for_range, ":player_id_004", 1, ":max_players"),
    (try_begin),
        (player_is_active, ":player_id_004"),
        (player_set_slot,":player_id_004",22,-1),
        (assign,":var005",0),
        (try_begin),
            (neq,"$g_multiplayer_players_list_action_type",5),
            (neq,"$g_multiplayer_players_list_action_type",6),
            (assign,":var005",1),
        (else_try),
            (eq,"$g_multiplayer_players_list_action_type",5),
            (neq,":player_id_004",":my_player"),
            (player_get_is_muted, ":is_muted_006", ":player_id_004"),
            (try_begin),
                (eq,":is_muted_006",0),
                (assign,":var005",1),
            (else_try),
                (eq,"$g_multiplayer_players_list_action_type",6),
                (neq,":player_id_004",":my_player"),
                (player_get_is_muted, ":is_muted_006", ":player_id_004"),
                (try_begin),
                    (eq,":is_muted_006",1),
                    (assign,":var005",1),
                (try_end),
            (try_end),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":var005",1),
        (str_store_player_username,s0,":player_id_004"),
        (create_button_overlay, ":button_overlay_007", 0),
        (overlay_set_color, ":button_overlay_007", 16777215),
        (position_set_x,1,130),
        (position_set_y,1,":var002"),
        (overlay_set_position, ":button_overlay_007", 1),
        (val_sub, ":var002", 40),
        (player_set_slot,":player_id_004",22,":button_overlay_007"),
    (try_end),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(get_max_players, ":max_players"),
(try_for_range, ":player_id_003", 1, ":max_players"),
    (try_begin),
        (player_is_active, ":player_id_003"),
        (player_slot_eq,":player_id_003",22,":var001"),
        (try_begin),
            (is_between,"$g_multiplayer_players_list_action_type",1,3),
            (try_begin),
                (eq,1,1),
                (multiplayer_get_my_player, ":my_player"),
                (try_begin),
                    (ge,":my_player",0),
                    (multiplayer_send_2_int_to_server, 21, "$g_multiplayer_players_list_action_type", ":player_id_003"),
                    (store_mission_timer_a,":m_timer_a_005"),
                    (val_add, ":m_timer_a_005", 900),
                    (player_set_slot,":my_player",26,":m_timer_a_005"),
                (try_end),
            (try_end),
        (try_end),
    (else_try),
        (eq,"$g_multiplayer_players_list_action_type",3),
        (multiplayer_send_int_to_server, 23, ":player_id_003"),
    (else_try),
        (eq,"$g_multiplayer_players_list_action_type",4),
        (multiplayer_send_int_to_server, 24, ":player_id_003"),
    (else_try),
        (eq,"$g_multiplayer_players_list_action_type",5),
        (player_set_is_muted, ":player_id_003", 1),
    (else_try),
        (eq,"$g_multiplayer_players_list_action_type",6),
        (player_set_is_muted, ":player_id_003", 0),
    (try_end),
    (assign,":max_players",0),
    (presentation_set_duration, 0),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (gt,":var001",200),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_show_maps_list",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
(position_set_x,1,250),
(position_set_y,1,80),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_show_maps_list_menu_container", 0),
(position_set_x,1,285),
(position_set_y,1,125),
(overlay_set_position, "$g_presentation_obj_show_maps_list_menu_container", 1),
(position_set_x,1,405),
(position_set_y,1,500),
(overlay_set_area_size, "$g_presentation_obj_show_maps_list_menu_container", 1),
(set_container_overlay, "$g_presentation_obj_show_maps_list_menu_container"),
(call_script, "script_multiplayer_fill_map_game_types", "$g_multiplayer_game_type"),
(assign,":var001",reg0),
(store_mul, ":var002", ":var001", 40),
(val_add, ":var002", 10),
(create_text_overlay, reg0, "str_choose_a_map"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(val_sub, ":var002", 40),
(assign,":button_overlay_003",-1),
(try_for_range, ":var004", 0, ":var001"),
    (store_add, ":slot_no_005", ":var004", 0),
    (troop_get_slot,":troop_slot_006","trp_multiplayer_data",":slot_no_005"),
    (store_sub, ":var007", ":troop_slot_006", ":scn.multi_scene_1"),
    (assign,":var007 +","str_multi_scene_1"),
    (str_store_string,s0,":var007"),
    (create_button_overlay, ":button_overlay_003", 0),
    (overlay_set_color, ":button_overlay_003", 16777215),
    (position_set_x,1,100),
    (position_set_y,1,":var002"),
    (overlay_set_position, ":button_overlay_003", 1),
    (val_sub, ":var002", 40),
(try_end),
(store_add, "$g_show_maps_list_button_list_end_index", ":button_overlay_003", 1),
(store_sub, "$g_show_maps_list_button_list_first_index", "$g_show_maps_list_button_list_end_index", ":var001"),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_for_range, ":var002", "$g_show_maps_list_button_list_first_index", "$g_show_maps_list_button_list_end_index"),
    (try_begin),
        (eq,":var001",":var002"),
        (call_script, "script_multiplayer_fill_map_game_types", "$g_multiplayer_game_type"),
        (store_sub, ":slot_no_003", ":var001", "$g_show_maps_list_button_list_first_index"),
        (val_add, ":slot_no_003", 0),
        (troop_get_slot,":troop_slot_004","trp_multiplayer_data",":slot_no_003"),
        (presentation_set_duration, 0),
        (try_begin),
            (eq,"$g_multiplayer_maps_list_action_type",1),
            (try_begin),
                (eq,1,1),
                (multiplayer_get_my_player, ":my_player"),
                (try_begin),
                    (ge,":my_player",0),
                    (multiplayer_send_2_int_to_server, 21, 0, ":troop_slot_004"),
                    (store_mission_timer_a,":m_timer_a_006"),
                    (val_add, ":m_timer_a_006", 900),
                    (player_set_slot,":my_player",26,":m_timer_a_006"),
                (try_end),
            (try_end),
        (try_end),
    (else_try),
        (assign,"$g_multiplayer_factions_list_action_type",1),
        (assign,"$g_multiplayer_poll_for_map_and_faction_data_map",":troop_slot_004"),
        (start_presentation, "prsnt_multiplayer_show_factions_list"),
    (try_end),
    (assign,"$g_show_maps_list_button_list_end_index",0),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (gt,":var001",200),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_show_factions_list",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
(position_set_x,1,250),
(position_set_y,1,80),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_show_factions_list_menu_container", 0),
(position_set_x,1,285),
(position_set_y,1,125),
(overlay_set_position, "$g_presentation_obj_show_factions_list_menu_container", 1),
(position_set_x,1,405),
(position_set_y,1,500),
(overlay_set_area_size, "$g_presentation_obj_show_factions_list_menu_container", 1),
(set_container_overlay, "$g_presentation_obj_show_factions_list_menu_container"),
(assign,":var001","fac_kingdoms_end"),
(assign,":var001 -","fac_kingdom_1"),
(try_begin),
    (eq,"$g_multiplayer_factions_list_action_type",2),
    (val_sub, ":var001", 1),
(try_end),
(store_mul, ":var002", ":var001", 40),
(val_add, ":var002", 10),
(assign,reg0,"$g_multiplayer_factions_list_action_type"),
(create_text_overlay, reg0, "str_choose_a_faction_for_team_reg0"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,0),
(position_set_y,1,":var002"),
(overlay_set_position, reg0, 1),
(val_sub, ":var002", 40),
(assign,":button_overlay_003",-1),
(try_for_range, ":fac_004", ":fac.kingdom_1", ":fac.kingdoms_end"),
    (try_begin),
        (this_or_next|eq,"$g_multiplayer_factions_list_action_type",1),
        (neq,"$g_multiplayer_poll_for_map_and_faction_data_faction_1",":fac_004"),
        (str_store_faction_name,s0,":fac_004"),
        (create_button_overlay, ":button_overlay_003", 0),
        (overlay_set_color, ":button_overlay_003", 16777215),
        (position_set_x,1,100),
        (position_set_y,1,":var002"),
        (overlay_set_position, ":button_overlay_003", 1),
        (val_sub, ":var002", 40),
    (try_end),
(try_end),
(store_add, "$g_show_factions_list_button_list_end_index", ":button_overlay_003", 1),
(store_sub, "$g_show_factions_list_button_list_first_index", "$g_show_factions_list_button_list_end_index", ":var001"),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_for_range, ":var002", "$g_show_factions_list_button_list_first_index", "$g_show_factions_list_button_list_end_index"),
    (try_begin),
        (eq,":var001",":var002"),
        (store_sub, ":var003", ":var001", "$g_show_factions_list_button_list_first_index"),
        (assign,":var003 +","fac_kingdom_1"),
        (presentation_set_duration, 0),
        (try_begin),
            (eq,"$g_multiplayer_factions_list_action_type",2),
            (try_begin),
                (ge,":var003","$g_multiplayer_poll_for_map_and_faction_data_faction_1"),
                (val_add, ":var003", 1),
            (try_end),
        (try_end),
        (try_begin),
            (eq,1,1),
            (multiplayer_get_my_player, ":my_player"),
            (try_begin),
                (ge,":my_player",0),
                (multiplayer_send_4_int_to_server, 21, 3, "$g_multiplayer_poll_for_map_and_faction_data_map", "$g_multiplayer_poll_for_map_and_faction_data_faction_1", ":var003"),
                (store_mission_timer_a,":m_timer_a_005"),
                (val_add, ":m_timer_a_005", 900),
                (player_set_slot,":my_player",26,":m_timer_a_005"),
            (try_end),
        (try_end),
    (else_try),
        (assign,"$g_multiplayer_factions_list_action_type",2),
        (assign,"$g_multiplayer_poll_for_map_and_faction_data_faction_1",":var003"),
        (start_presentation, "prsnt_multiplayer_show_factions_list"),
    (try_end),
    (assign,"$g_show_factions_list_button_list_end_index",0),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (gt,":var001",200),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_show_number_of_bots_list",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
(position_set_x,1,250),
(position_set_y,1,80),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_show_number_of_bots_list_menu_container", 0),
(position_set_x,1,285),
(position_set_y,1,125),
(overlay_set_position, "$g_presentation_obj_show_number_of_bots_list_menu_container", 1),
(position_set_x,1,405),
(position_set_y,1,500),
(overlay_set_area_size, "$g_presentation_obj_show_number_of_bots_list_menu_container", 1),
(set_container_overlay, "$g_presentation_obj_show_number_of_bots_list_menu_container"),
(assign,":var001",0),
(store_add, ":var002", "$g_multiplayer_num_bots_voteable", 1),
(try_for_range, ":var003", 0, ":var002"),
    (assign,":var004",":var003"),
    (val_mod, ":var004", 5),
    (try_begin),
        (this_or_next|ge,":var003",10),
        (eq,":var004",0),
        (val_add, ":var001", 1),
    (try_end),
(try_end),
(store_mul, ":var005", ":var001", 40),
(val_add, ":var005", 10),
(assign,reg0,"$g_multiplayer_number_of_bots_list_action_type"),
(create_text_overlay, reg0, "str_choose_number_of_bots_for_team_reg0"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,0),
(position_set_y,1,":var005"),
(overlay_set_position, reg0, 1),
(val_sub, ":var005", 40),
(assign,":button_overlay_006",-1),
(try_for_range, ":var003", 0, ":var002"),
    (assign,":var004",":var003"),
    (val_mod, ":var004", 5),
    (try_begin),
        (this_or_next|ge,":var003",10),
        (eq,":var004",0),
        (assign,reg0,":var003"),
        (str_store_string,s0,"str_reg0"),
        (create_button_overlay, ":button_overlay_006", 0),
        (overlay_set_color, ":button_overlay_006", 16777215),
        (position_set_x,1,100),
        (position_set_y,1,":var005"),
        (overlay_set_position, ":button_overlay_006", 1),
        (val_sub, ":var005", 40),
    (try_end),
(try_end),
(store_add, "$g_show_number_of_bots_list_button_list_end_index", ":button_overlay_006", 1),
(store_sub, "$g_show_number_of_bots_list_button_list_first_index", "$g_show_number_of_bots_list_button_list_end_index", ":var001"),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_for_range, ":var002", "$g_show_number_of_bots_list_button_list_first_index", "$g_show_number_of_bots_list_button_list_end_index"),
    (try_begin),
        (eq,":var001",":var002"),
        (store_sub, ":var003", ":var001", "$g_show_number_of_bots_list_button_list_first_index"),
        (try_begin),
            (lt,":var003",10),
            (assign,":var004",":var003"),
        (else_try),
            (store_sub, ":var004", ":var003", 8),
            (val_mul, ":var004", 5),
        (try_end),
    (try_end),
    (presentation_set_duration, 0),
    (try_begin),
        (eq,"$g_multiplayer_number_of_bots_list_action_type",2),
        (try_begin),
            (eq,1,1),
            (multiplayer_get_my_player, ":my_player"),
            (try_begin),
                (ge,":my_player",0),
                (multiplayer_send_3_int_to_server, 21, 4, "$g_multiplayer_poll_number_of_bots_team_1", ":var004"),
                (store_mission_timer_a,":m_timer_a_006"),
                (val_add, ":m_timer_a_006", 900),
                (player_set_slot,":my_player",26,":m_timer_a_006"),
            (try_end),
        (try_end),
    (else_try),
        (assign,"$g_multiplayer_number_of_bots_list_action_type",2),
        (assign,"$g_multiplayer_poll_number_of_bots_team_1",":var004"),
        (start_presentation, "prsnt_multiplayer_show_number_of_bots_list"),
    (try_end),
    (assign,"$g_show_number_of_bots_list_button_list_end_index",0),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (gt,":var001",200),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_poll",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg0, "mesh_white_plane"),
(overlay_set_color, reg0, 0),
(overlay_set_alpha, reg0, 68),
(position_set_x,1,50),
(position_set_y,1,50),
(overlay_set_position, reg0, 1),
(position_set_x,1,37500),
(position_set_y,1,4500),
(overlay_set_size, reg0, 1),
(try_begin),
    (eq,"$g_multiplayer_poll_to_show",0),
    (store_sub, ":var001", "$g_multiplayer_poll_value_to_show", ":scn.multi_scene_1"),
    (assign,":var001 +","str_multi_scene_1"),
    (str_store_string,s0,":var001"),
    (create_text_overlay, reg0, "str_poll_change_map"),
(else_try),
    (eq,"$g_multiplayer_poll_to_show",1),
    (str_store_player_username,s0,"$g_multiplayer_poll_value_to_show"),
    (create_text_overlay, reg0, "str_poll_kick_player"),
(else_try),
    (eq,"$g_multiplayer_poll_to_show",2),
    (str_store_player_username,s0,"$g_multiplayer_poll_value_to_show"),
    (create_text_overlay, reg0, "str_poll_ban_player"),
(else_try),
    (eq,"$g_multiplayer_poll_to_show",3),
    (store_sub, ":var001", "$g_multiplayer_poll_value_to_show", ":scn.multi_scene_1"),
    (assign,":var001 +","str_multi_scene_1"),
    (str_store_string,s0,":var001"),
    (str_store_faction_name,s1,"$g_multiplayer_poll_value_2_to_show"),
    (str_store_faction_name,s2,"$g_multiplayer_poll_value_3_to_show"),
    (create_text_overlay, reg0, "str_poll_change_map_with_faction"),
(else_try),
    (assign,reg0,"$g_multiplayer_poll_value_to_show"),
    (assign,reg1,"$g_multiplayer_poll_value_2_to_show"),
    (str_store_faction_name,s0,"$g_multiplayer_team_1_faction"),
    (str_store_faction_name,s1,"$g_multiplayer_team_2_faction"),
    (create_text_overlay, reg0, "str_poll_change_number_of_bots"),
(try_end),
(overlay_set_color, reg0, 16777215),
(try_begin),
    (neq,"$g_multiplayer_poll_to_show",3),
    (neq,"$g_multiplayer_poll_to_show",4),
    (position_set_x,1,400),
    (position_set_y,1,100),
    (overlay_set_position, reg0, 1),
(else_try),
    (position_set_x,1,50),
    (position_set_y,1,70),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,750),
    (position_set_y,1,60),
    (overlay_set_area_size, reg0, 1),
(try_end),
(store_mission_timer_a,":m_timer_a_002"),
(store_sub, "$g_multiplayer_poll_last_written_seconds_left", "$g_multiplayer_poll_client_end_time", ":m_timer_a_002"),
(assign,reg0,"$g_multiplayer_poll_last_written_seconds_left"),
(create_text_overlay, "$g_presentation_obj_poll_1", "str_poll_time_left"),
(overlay_set_color, "$g_presentation_obj_poll_1", 16777215),
(position_set_x,1,790),
(position_set_y,1,60),
(overlay_set_position, "$g_presentation_obj_poll_1", 1),
(omit_key_once, 2),
(omit_key_once, 3),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 1),
    (this_or_next|key_clicked, 248),
    (key_clicked, 3),
    (gt,":var001",500),
    (multiplayer_send_int_to_server, 22, 0),
    (clear_omitted_keys),
    (presentation_set_duration, 0),
(else_try),
    (key_clicked, 2),
    (gt,":var001",500),
    (multiplayer_send_int_to_server, 22, 1),
    (clear_omitted_keys),
    (presentation_set_duration, 0),
(try_end),
(store_mission_timer_a,":m_timer_a_002"),
(store_sub, ":var003", "$g_multiplayer_poll_client_end_time", ":m_timer_a_002"),
(try_begin),
    (neq,":var003","$g_multiplayer_poll_last_written_seconds_left"),
    (try_begin),
        (lt,":var003",0),
        (clear_omitted_keys),
        (presentation_set_duration, 0),
    (else_try),
        (assign,"$g_multiplayer_poll_last_written_seconds_left",":var003"),
        (assign,reg0,"$g_multiplayer_poll_last_written_seconds_left"),
        (overlay_set_text, "$g_presentation_obj_poll_1", "str_poll_time_left"),
    (try_end),
(try_end),
]),

]),
("tutorial_show_mouse_movement",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(try_begin),
    (this_or_next|eq,"$g_tutorial_mouse_dir",-1),
    (eq,"$g_tutorial_mouse_click",-1),
    (presentation_set_duration, 0),
(else_try),
    (set_fixed_point_multiplier, 1000),
    (assign,"$g_tutorial_displayed_mouse_dir","$g_tutorial_mouse_dir"),
    (assign,"$g_tutorial_displayed_mouse_click","$g_tutorial_mouse_click"),
    (store_add, ":var001", "$g_tutorial_mouse_dir", ":mesh.mouse_arrow_down"),
    (create_mesh_overlay, reg0, ":var001"),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,380),
    (position_set_y,1,500),
    (overlay_set_position, reg0, 1),
    (try_begin),
        (eq,"$g_tutorial_mouse_click",0),
        (create_mesh_overlay, reg0, "mesh_mouse_left_click"),
    (else_try),
        (create_mesh_overlay, reg0, "mesh_mouse_right_click"),
    (try_end),
    (position_set_x,1,800),
    (position_set_y,1,800),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,540),
    (position_set_y,1,500),
    (overlay_set_position, reg0, 1),
    (create_mesh_overlay, reg0, "mesh_mouse_arrow_plus"),
    (overlay_set_color, reg0, 16777215),
    (position_set_x,1,600),
    (position_set_y,1,600),
    (overlay_set_size, reg0, 1),
    (position_set_x,1,470),
    (position_set_y,1,510),
    (overlay_set_position, reg0, 1),
    (presentation_set_duration, 999999),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|eq,"$g_tutorial_displayed_mouse_dir","$g_tutorial_mouse_dir"),
    (neq,"$g_tutorial_displayed_mouse_click","$g_tutorial_mouse_click"),
    (presentation_set_duration, 0),
    (try_begin),
        (ge,"$g_tutorial_mouse_dir",0),
        (ge,"$g_tutorial_mouse_click",0),
        (start_presentation, "prsnt_tutorial_show_mouse_movement"),
    (try_end),
(try_end),
]),

]),
("name_kingdom",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(str_store_string,s1,"str_name_kingdom_text"),
(create_text_overlay, reg1, 1),
(position_set_x,1,500),
(position_set_y,1,500),
(overlay_set_position, reg1, 1),
(overlay_set_text, reg1, 1),
(create_simple_text_box_overlay, "$g_presentation_obj_name_kingdom_1"),
(position_set_x,1,400),
(position_set_y,1,400),
(overlay_set_position, "$g_presentation_obj_name_kingdom_1", 1),
(try_begin),
    (eq,"$players_kingdom_name_set",1),
    (str_store_faction_name,s7,"fac_player_supporters_faction"),
    (overlay_set_text, "$g_presentation_obj_name_kingdom_1", 7),
(else_try),
    (str_store_troop_name,s0,"trp_player"),
    (overlay_set_text, "$g_presentation_obj_name_kingdom_1", "str_default_kingdom_name"),
    (str_store_string,s7,"str_default_kingdom_name"),
(try_end),
(create_button_overlay, "$g_presentation_obj_name_kingdom_2", "@Continue..."),
(position_set_x,1,500),
(position_set_y,1,300),
(overlay_set_position, "$g_presentation_obj_name_kingdom_2", 1),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_name_kingdom_1"),
    (str_store_string,s7,0),
(else_try),
    (eq,":var001","$g_presentation_obj_name_kingdom_2"),
    (faction_set_name, "fac_player_supporters_faction", 7),
    (faction_set_color, "fac_player_supporters_faction", 16711680),
    (assign,"$players_kingdom_name_set",1),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("banner_selection",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(str_store_string,s1,"str_banner_selection_text"),
(create_text_overlay, reg1, 1),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, reg1, 1),
(overlay_set_text, reg1, 1),
(create_button_overlay, "$g_presentation_obj_banner_selection_1", "@Next Page"),
(position_set_x,1,500),
(position_set_y,1,50),
(overlay_set_position, "$g_presentation_obj_banner_selection_1", 1),
(assign,":var001",150),
(assign,":var002",575),
(assign,":var003","mesh_banner_f21"),
(assign,":var004","fac_kingdoms_end"),
(assign,":var004 -","fac_kingdom_1"),
(val_sub, ":var003", ":var004"),
(store_mul, ":var005", 16, "$g_presentation_page_no"),
(assign,":var005 +","mesh_banner_a01"),
(store_add, ":var006", ":var005", 16),
(val_min,":var003",":var006"),
(store_add, "$g_presentation_banner_start", "$g_presentation_obj_banner_selection_1", 1),
(try_for_range, ":var007", ":var005", ":var003"),
    (create_image_button_overlay, reg1, ":var007", ":var007"),
    (position_set_x,1,":var001"),
    (position_set_y,1,":var002"),
    (overlay_set_position, reg1, 1),
    (position_set_x,1,100),
    (position_set_y,1,100),
    (overlay_set_size, reg1, 1),
    (val_add, ":var001", 100),
    (try_begin),
        (ge,":var001",900),
        (assign,":var001",150),
        (val_sub, ":var002", 250),
    (try_end),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_banner_selection_1"),
    (val_add, "$g_presentation_page_no", 1),
    (val_mod, "$g_presentation_page_no", 8),
    (start_presentation, "prsnt_banner_selection"),
(else_try),
    (store_sub, ":var002", ":var001", "$g_presentation_banner_start"),
    (store_mul, ":var003", 16, "$g_presentation_page_no"),
    (val_add, ":var002", ":var003"),
    (store_add, ":var004", ":var002", 1297036692682702894),
    (party_set_banner_icon, "p_main_party", ":var004"),
    (store_add, ":var005", ":var002", ":spr.banner_a"),
    (troop_set_slot,"trp_player",13,":var005"),
    (presentation_set_duration, 0),
    (assign,":var006",0),
    (assign,":var007","trp_knight_1_1_wife"),
    (try_for_range, ":troop_id_008", ":trp.npc1", ":var007"),
        (try_begin),
            (troop_slot_eq,":troop_id_008",13,":var005"),
            (assign,":var006",":troop_id_008"),
            (assign,":var007",0),
            (troop_set_slot,":troop_id_008",13,"spr_banner_f21"),
            (troop_get_slot,":troop_slot_009",":troop_id_008",10),
            (try_begin),
                (gt,":troop_slot_009",0),
                (party_set_banner_icon, ":troop_slot_009", 1297036692682703035),
            (try_end),
        (try_end),
    (try_end),
    (try_for_range, ":p_010", ":p.town_1", ":p.village_1"),
        (try_begin),
            (party_slot_eq,":p_010",7,"trp_player"),
            (party_set_banner_icon, ":p_010", ":var004"),
        (else_try),
            (party_slot_eq,":p_010",7,":var006"),
            (party_set_banner_icon, ":p_010", 1297036692682703035),
        (try_end),
    (try_end),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|key_clicked, 57),
    (this_or_next|key_clicked, 28),
    (this_or_next|key_clicked, 1),
    (this_or_next|key_clicked, 14),
    (this_or_next|key_clicked, 252),
    (key_clicked, 253),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("custom_banner",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(troop_get_slot,":troop_slot_001","trp_player",96),
(val_max,":troop_slot_001",0),
(assign,":troop_slot_001 +","mesh_custom_banner_01"),
(troop_get_slot,":troop_slot_002","trp_player",99),
(val_max,":troop_slot_002",0),
(assign,":troop_slot_002 +","mesh_custom_map_banner_01"),
(troop_get_slot,":troop_slot_003","trp_player",85),
(troop_get_slot,":troop_slot_004","trp_player",86),
(create_text_overlay, reg1, "str_color_no_1"),
(position_set_x,1,40),
(position_set_y,1,550),
(overlay_set_position, reg1, 1),
(create_text_overlay, reg1, "str_color_no_2"),
(position_set_x,1,40),
(position_set_y,1,500),
(overlay_set_position, reg1, 1),
(create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_22", "mesh_color_picker", "tab_color_picker", ":troop_slot_003"),
(create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_23", "mesh_color_picker", "tab_color_picker", ":troop_slot_004"),
(position_set_x,1,200),
(position_set_y,1,565),
(overlay_set_position, "$g_presentation_obj_custom_banner_22", 1),
(position_set_y,1,515),
(overlay_set_position, "$g_presentation_obj_custom_banner_23", 1),
(position_set_x,1,250),
(position_set_y,1,250),
(overlay_set_size, "$g_presentation_obj_custom_banner_22", 1),
(overlay_set_size, "$g_presentation_obj_custom_banner_23", 1),
(create_button_overlay, "$g_presentation_obj_custom_banner_2", "str_change"),
(create_button_overlay, "$g_presentation_obj_custom_banner_3", "str_change"),
(create_button_overlay, "$g_presentation_obj_custom_banner_4", "str_change_background"),
(create_button_overlay, "$g_presentation_obj_custom_banner_5", "str_change"),
(create_button_overlay, "$g_presentation_obj_custom_banner_19", "str_change"),
(create_button_overlay, "$g_presentation_obj_custom_banner_20", "str_accept"),
(troop_get_slot,":troop_slot_005","trp_player",97),
(create_button_overlay, "$g_presentation_obj_custom_banner_16", "str_randomize"),
(create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_17", ":troop_slot_001", "tab_custom_banner_default", "trp_player"),
(try_begin),
    (eq,":troop_slot_002","mesh_custom_map_banner_01"),
    (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_18", ":troop_slot_002", "tab_custom_banner_square", "trp_player"),
(else_try),
    (eq,":troop_slot_002","mesh_custom_map_banner_02"),
    (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_18", ":troop_slot_002", "tab_custom_banner_short", "trp_player"),
(else_try),
    (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_18", ":troop_slot_002", "tab_custom_banner_tall", "trp_player"),
(try_end),
(create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_1", -1, "tab_custom_banner_square_no_mesh", "trp_player"),
(create_text_overlay, reg1, "str_sample_banner"),
(position_set_x,1,825),
(position_set_y,1,650),
(overlay_set_position, reg1, 1),
(create_text_overlay, reg1, "str_sample_map_banner"),
(position_set_y,1,500),
(overlay_set_position, reg1, 1),
(position_set_x,1,800),
(position_set_y,1,640),
(overlay_set_position, "$g_presentation_obj_custom_banner_17", 1),
(position_set_x,1,780),
(position_set_y,1,315),
(overlay_set_position, "$g_presentation_obj_custom_banner_18", 1),
(position_set_x,1,50),
(position_set_y,1,50),
(overlay_set_size, "$g_presentation_obj_custom_banner_17", 1),
(position_set_x,1,50),
(position_set_y,1,50),
(overlay_set_size, "$g_presentation_obj_custom_banner_18", 1),
(create_text_overlay, reg1, "str_number_of_charges"),
(position_set_x,1,40),
(position_set_y,1,350),
(overlay_set_position, reg1, 1),
(assign,reg1,":troop_slot_005"),
(create_text_overlay, reg2, "str_reg1"),
(position_set_x,1,350),
(position_set_y,1,350),
(overlay_set_position, reg2, 1),
(try_begin),
    (lt,":troop_slot_005",4),
    (create_button_overlay, "$g_presentation_obj_custom_banner_15", "str_plus"),
    (position_set_x,1,385),
    (position_set_y,1,350),
    (overlay_set_position, "$g_presentation_obj_custom_banner_15", 1),
(else_try),
    (assign,"$g_presentation_obj_custom_banner_15",-1),
(try_end),
(try_begin),
    (gt,":troop_slot_005",0),
    (create_button_overlay, "$g_presentation_obj_custom_banner_21", "str_minus"),
    (position_set_x,1,370),
    (position_set_y,1,350),
    (overlay_set_position, "$g_presentation_obj_custom_banner_21", 1),
(else_try),
    (assign,"$g_presentation_obj_custom_banner_21",-1),
(try_end),
(try_begin),
    (ge,":troop_slot_005",1),
    (create_text_overlay, reg1, "str_charge"),
    (position_set_x,1,300),
    (position_set_y,1,300),
    (overlay_set_position, reg1, 1),
    (create_text_overlay, reg1, "str_color"),
    (position_set_x,1,550),
    (position_set_y,1,300),
    (overlay_set_position, reg1, 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_14", "str_change_charge_position"),
    (position_set_y,1,350),
    (position_set_x,1,550),
    (overlay_set_position, "$g_presentation_obj_custom_banner_14", 1),
    (create_text_overlay, reg1, "str_charge_no_1"),
    (position_set_x,1,40),
    (position_set_y,1,240),
    (overlay_set_position, reg1, 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_6", "str_change"),
    (position_set_x,1,310),
    (overlay_set_position, "$g_presentation_obj_custom_banner_6", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_7", "str_change"),
    (position_set_x,1,560),
    (overlay_set_position, "$g_presentation_obj_custom_banner_7", 1),
    (troop_get_slot,":troop_slot_006","trp_player",92),
    (val_mod, ":troop_slot_006", 256),
    (assign,":troop_slot_006 +","mesh_custom_banner_charge_01"),
    (create_image_button_overlay, "$g_presentation_obj_custom_banner_24", ":troop_slot_006", ":troop_slot_006"),
    (position_set_x,1,260),
    (position_set_y,1,255),
    (overlay_set_position, "$g_presentation_obj_custom_banner_24", 1),
    (position_set_x,1,50),
    (position_set_y,1,50),
    (overlay_set_size, "$g_presentation_obj_custom_banner_24", 1),
    (troop_get_slot,":troop_slot_007","trp_player",87),
    (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_28", "mesh_color_picker", "tab_color_picker", ":troop_slot_007"),
    (position_set_x,1,530),
    (position_set_y,1,255),
    (overlay_set_position, "$g_presentation_obj_custom_banner_28", 1),
    (position_set_x,1,250),
    (position_set_y,1,250),
    (overlay_set_size, "$g_presentation_obj_custom_banner_28", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_32", "str_flip_horizontal"),
    (position_set_x,1,700),
    (position_set_y,1,240),
    (overlay_set_position, "$g_presentation_obj_custom_banner_32", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_33", "str_flip_vertical"),
    (position_set_x,1,800),
    (overlay_set_position, "$g_presentation_obj_custom_banner_33", 1),
(try_end),
(try_begin),
    (ge,":troop_slot_005",2),
    (create_text_overlay, reg1, "str_charge_no_2"),
    (position_set_x,1,40),
    (position_set_y,1,180),
    (overlay_set_position, reg1, 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_8", "str_change"),
    (position_set_x,1,310),
    (overlay_set_position, "$g_presentation_obj_custom_banner_8", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_9", "str_change"),
    (position_set_x,1,560),
    (overlay_set_position, "$g_presentation_obj_custom_banner_9", 1),
    (troop_get_slot,":troop_slot_006","trp_player",93),
    (val_mod, ":troop_slot_006", 256),
    (assign,":troop_slot_006 +","mesh_custom_banner_charge_01"),
    (create_image_button_overlay, "$g_presentation_obj_custom_banner_25", ":troop_slot_006", ":troop_slot_006"),
    (position_set_x,1,260),
    (position_set_y,1,195),
    (overlay_set_position, "$g_presentation_obj_custom_banner_25", 1),
    (position_set_x,1,50),
    (position_set_y,1,50),
    (overlay_set_size, "$g_presentation_obj_custom_banner_25", 1),
    (troop_get_slot,":troop_slot_007","trp_player",88),
    (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_29", "mesh_color_picker", "tab_color_picker", ":troop_slot_007"),
    (position_set_x,1,530),
    (position_set_y,1,195),
    (overlay_set_position, "$g_presentation_obj_custom_banner_29", 1),
    (position_set_x,1,250),
    (position_set_y,1,250),
    (overlay_set_size, "$g_presentation_obj_custom_banner_29", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_34", "str_flip_horizontal"),
    (position_set_x,1,700),
    (position_set_y,1,180),
    (overlay_set_position, "$g_presentation_obj_custom_banner_34", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_35", "str_flip_vertical"),
    (position_set_x,1,800),
    (overlay_set_position, "$g_presentation_obj_custom_banner_35", 1),
(try_end),
(try_begin),
    (ge,":troop_slot_005",3),
    (create_text_overlay, reg1, "str_charge_no_3"),
    (position_set_x,1,40),
    (position_set_y,1,120),
    (overlay_set_position, reg1, 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_10", "str_change"),
    (position_set_x,1,310),
    (overlay_set_position, "$g_presentation_obj_custom_banner_10", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_11", "str_change"),
    (position_set_x,1,560),
    (overlay_set_position, "$g_presentation_obj_custom_banner_11", 1),
    (troop_get_slot,":troop_slot_006","trp_player",94),
    (val_mod, ":troop_slot_006", 256),
    (assign,":troop_slot_006 +","mesh_custom_banner_charge_01"),
    (create_image_button_overlay, "$g_presentation_obj_custom_banner_26", ":troop_slot_006", ":troop_slot_006"),
    (position_set_x,1,260),
    (position_set_y,1,135),
    (overlay_set_position, "$g_presentation_obj_custom_banner_26", 1),
    (position_set_x,1,50),
    (position_set_y,1,50),
    (overlay_set_size, "$g_presentation_obj_custom_banner_26", 1),
    (troop_get_slot,":troop_slot_007","trp_player",89),
    (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_30", "mesh_color_picker", "tab_color_picker", ":troop_slot_007"),
    (position_set_x,1,530),
    (position_set_y,1,135),
    (overlay_set_position, "$g_presentation_obj_custom_banner_30", 1),
    (position_set_x,1,250),
    (position_set_y,1,250),
    (overlay_set_size, "$g_presentation_obj_custom_banner_30", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_36", "str_flip_horizontal"),
    (position_set_x,1,700),
    (position_set_y,1,120),
    (overlay_set_position, "$g_presentation_obj_custom_banner_36", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_37", "str_flip_vertical"),
    (position_set_x,1,800),
    (overlay_set_position, "$g_presentation_obj_custom_banner_37", 1),
(try_end),
(try_begin),
    (ge,":troop_slot_005",4),
    (create_text_overlay, reg1, "str_charge_no_4"),
    (position_set_x,1,40),
    (position_set_y,1,60),
    (overlay_set_position, reg1, 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_12", "str_change"),
    (position_set_x,1,310),
    (overlay_set_position, "$g_presentation_obj_custom_banner_12", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_13", "str_change"),
    (position_set_x,1,560),
    (overlay_set_position, "$g_presentation_obj_custom_banner_13", 1),
    (troop_get_slot,":troop_slot_006","trp_player",95),
    (val_mod, ":troop_slot_006", 256),
    (assign,":troop_slot_006 +","mesh_custom_banner_charge_01"),
    (create_image_button_overlay, "$g_presentation_obj_custom_banner_27", ":troop_slot_006", ":troop_slot_006"),
    (position_set_x,1,260),
    (position_set_y,1,75),
    (overlay_set_position, "$g_presentation_obj_custom_banner_27", 1),
    (position_set_x,1,50),
    (position_set_y,1,50),
    (overlay_set_size, "$g_presentation_obj_custom_banner_27", 1),
    (troop_get_slot,":troop_slot_007","trp_player",90),
    (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_31", "mesh_color_picker", "tab_color_picker", ":troop_slot_007"),
    (position_set_x,1,530),
    (position_set_y,1,75),
    (overlay_set_position, "$g_presentation_obj_custom_banner_31", 1),
    (position_set_x,1,250),
    (position_set_y,1,250),
    (overlay_set_size, "$g_presentation_obj_custom_banner_31", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_38", "str_flip_horizontal"),
    (position_set_x,1,700),
    (position_set_y,1,60),
    (overlay_set_position, "$g_presentation_obj_custom_banner_38", 1),
    (create_button_overlay, "$g_presentation_obj_custom_banner_39", "str_flip_vertical"),
    (position_set_x,1,800),
    (overlay_set_position, "$g_presentation_obj_custom_banner_39", 1),
(try_end),
(position_set_x,1,350),
(position_set_y,1,400),
(overlay_set_position, "$g_presentation_obj_custom_banner_1", 1),
(position_set_x,1,275),
(position_set_y,1,550),
(overlay_set_position, "$g_presentation_obj_custom_banner_2", 1),
(position_set_y,1,500),
(overlay_set_position, "$g_presentation_obj_custom_banner_3", 1),
(position_set_x,1,175),
(position_set_y,1,600),
(overlay_set_position, "$g_presentation_obj_custom_banner_4", 1),
(position_set_x,1,880),
(position_set_y,1,575),
(overlay_set_position, "$g_presentation_obj_custom_banner_5", 1),
(position_set_y,1,400),
(overlay_set_position, "$g_presentation_obj_custom_banner_19", 1),
(position_set_y,1,650),
(position_set_x,1,175),
(overlay_set_position, "$g_presentation_obj_custom_banner_16", 1),
(position_set_y,1,150),
(position_set_x,1,850),
(overlay_set_position, "$g_presentation_obj_custom_banner_20", 1),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(troop_get_slot,":troop_slot_002","trp_player",97),
(try_begin),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_22"),
    (eq,":var001","$g_presentation_obj_custom_banner_2"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",85),
    (start_presentation, "prsnt_color_selection"),
(else_try),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_23"),
    (eq,":var001","$g_presentation_obj_custom_banner_3"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",86),
    (start_presentation, "prsnt_color_selection"),
(else_try),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_23"),
    (eq,":var001","$g_presentation_obj_custom_banner_3"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (start_presentation, "prsnt_banner_background_selection"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_5"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (start_presentation, "prsnt_banner_flag_type_selection"),
(else_try),
    (ge,":troop_slot_002",1),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_6"),
    (eq,":var001","$g_presentation_obj_custom_banner_24"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",92),
    (start_presentation, "prsnt_banner_charge_selection"),
(else_try),
    (ge,":troop_slot_002",1),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_7"),
    (eq,":var001","$g_presentation_obj_custom_banner_28"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",87),
    (start_presentation, "prsnt_color_selection"),
(else_try),
    (ge,":troop_slot_002",2),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_8"),
    (eq,":var001","$g_presentation_obj_custom_banner_25"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",93),
    (start_presentation, "prsnt_banner_charge_selection"),
(else_try),
    (ge,":troop_slot_002",2),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_9"),
    (eq,":var001","$g_presentation_obj_custom_banner_29"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",88),
    (start_presentation, "prsnt_color_selection"),
(else_try),
    (ge,":troop_slot_002",3),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_10"),
    (eq,":var001","$g_presentation_obj_custom_banner_26"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",94),
    (start_presentation, "prsnt_banner_charge_selection"),
(else_try),
    (ge,":troop_slot_002",3),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_11"),
    (eq,":var001","$g_presentation_obj_custom_banner_30"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",89),
    (start_presentation, "prsnt_color_selection"),
(else_try),
    (ge,":troop_slot_002",4),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_12"),
    (eq,":var001","$g_presentation_obj_custom_banner_27"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",95),
    (start_presentation, "prsnt_banner_charge_selection"),
(else_try),
    (ge,":troop_slot_002",4),
    (this_or_next|eq,":var001","$g_presentation_obj_custom_banner_13"),
    (eq,":var001","$g_presentation_obj_custom_banner_31"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (assign,"$g_presentation_output_slot",90),
    (start_presentation, "prsnt_color_selection"),
(else_try),
    (ge,":troop_slot_002",1),
    (eq,":var001","$g_presentation_obj_custom_banner_14"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (start_presentation, "prsnt_banner_charge_positioning"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_15"),
    (troop_get_slot,":troop_slot_002","trp_player",97),
    (val_add, ":troop_slot_002", 1),
    (val_clamp,":troop_slot_002",0, 5),
    (troop_set_slot,"trp_player",97,":troop_slot_002"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_21"),
    (troop_get_slot,":troop_slot_002","trp_player",97),
    (val_sub, ":troop_slot_002", 1),
    (val_clamp,":troop_slot_002",0, 5),
    (troop_set_slot,"trp_player",97,":troop_slot_002"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_16"),
    (call_script, "script_get_random_custom_banner", "trp_player"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_17"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (start_presentation, "prsnt_banner_flag_type_selection"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_18"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (start_presentation, "prsnt_banner_flag_map_type_selection"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_19"),
    (assign,"$g_presentation_next_presentation","prsnt_custom_banner"),
    (start_presentation, "prsnt_banner_flag_map_type_selection"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_32"),
    (troop_get_slot,":troop_slot_003","trp_player",92),
    (store_mod,":var004",":troop_slot_003",256),
    (val_div, ":troop_slot_003", 256),
    (store_mod,":var005",":troop_slot_003",2),
    (val_div, ":troop_slot_003", 2),
    (val_add, ":var005", 1),
    (val_mod, ":var005", 2),
    (val_mul, ":troop_slot_003", 2),
    (val_add, ":troop_slot_003", ":var005"),
    (val_mul, ":troop_slot_003", 256),
    (val_add, ":troop_slot_003", ":var004"),
    (troop_set_slot,"trp_player",92,":troop_slot_003"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_34"),
    (troop_get_slot,":troop_slot_003","trp_player",93),
    (store_mod,":var004",":troop_slot_003",256),
    (val_div, ":troop_slot_003", 256),
    (store_mod,":var005",":troop_slot_003",2),
    (val_div, ":troop_slot_003", 2),
    (val_add, ":var005", 1),
    (val_mod, ":var005", 2),
    (val_mul, ":troop_slot_003", 2),
    (val_add, ":troop_slot_003", ":var005"),
    (val_mul, ":troop_slot_003", 256),
    (val_add, ":troop_slot_003", ":var004"),
    (troop_set_slot,"trp_player",93,":troop_slot_003"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_36"),
    (troop_get_slot,":troop_slot_003","trp_player",94),
    (store_mod,":var004",":troop_slot_003",256),
    (val_div, ":troop_slot_003", 256),
    (store_mod,":var005",":troop_slot_003",2),
    (val_div, ":troop_slot_003", 2),
    (val_add, ":var005", 1),
    (val_mod, ":var005", 2),
    (val_mul, ":troop_slot_003", 2),
    (val_add, ":troop_slot_003", ":var005"),
    (val_mul, ":troop_slot_003", 256),
    (val_add, ":troop_slot_003", ":var004"),
    (troop_set_slot,"trp_player",94,":troop_slot_003"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_38"),
    (troop_get_slot,":troop_slot_003","trp_player",95),
    (store_mod,":var004",":troop_slot_003",256),
    (val_div, ":troop_slot_003", 256),
    (store_mod,":var005",":troop_slot_003",2),
    (val_div, ":troop_slot_003", 2),
    (val_add, ":var005", 1),
    (val_mod, ":var005", 2),
    (val_mul, ":troop_slot_003", 2),
    (val_add, ":troop_slot_003", ":var005"),
    (val_mul, ":troop_slot_003", 256),
    (val_add, ":troop_slot_003", ":var004"),
    (troop_set_slot,"trp_player",95,":troop_slot_003"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_33"),
    (troop_get_slot,":troop_slot_003","trp_player",92),
    (store_div, ":var___x1", ":troop_slot_003", 512),
    (assign,":var005",":var___x1"),
    (val_add, ":var005", 1),
    (val_mod, ":var005", 2),
    (val_mul, ":var005", 512),
    (val_mod, ":troop_slot_003", 512),
    (val_add, ":troop_slot_003", ":var005"),
    (troop_set_slot,"trp_player",92,":troop_slot_003"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_35"),
    (troop_get_slot,":troop_slot_003","trp_player",93),
    (store_div, ":var___x1", ":troop_slot_003", 512),
    (assign,":var005",":var___x1"),
    (val_add, ":var005", 1),
    (val_mod, ":var005", 2),
    (val_mul, ":var005", 512),
    (val_mod, ":troop_slot_003", 512),
    (val_add, ":troop_slot_003", ":var005"),
    (troop_set_slot,"trp_player",93,":troop_slot_003"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_37"),
    (troop_get_slot,":troop_slot_003","trp_player",94),
    (store_div, ":var___x1", ":troop_slot_003", 512),
    (assign,":var005",":var___x1"),
    (val_add, ":var005", 1),
    (val_mod, ":var005", 2),
    (val_mul, ":var005", 512),
    (val_mod, ":troop_slot_003", 512),
    (val_add, ":troop_slot_003", ":var005"),
    (troop_set_slot,"trp_player",94,":troop_slot_003"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_39"),
    (troop_get_slot,":troop_slot_003","trp_player",95),
    (store_div, ":var___x1", ":troop_slot_003", 512),
    (assign,":var005",":var___x1"),
    (val_add, ":var005", 1),
    (val_mod, ":var005", 2),
    (val_mul, ":var005", 512),
    (val_mod, ":troop_slot_003", 512),
    (val_add, ":troop_slot_003", ":var005"),
    (troop_set_slot,"trp_player",95,":troop_slot_003"),
    (start_presentation, "prsnt_custom_banner"),
(else_try),
    (eq,":var001","$g_presentation_obj_custom_banner_20"),
    (troop_get_slot,":troop_slot_006","trp_player",99),
    (try_begin),
        (ge,":troop_slot_006",0),
        (val_add, ":troop_slot_006", 1297036692682702891),
        (party_set_banner_icon, "p_main_party", ":troop_slot_006"),
    (try_end),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("banner_charge_positioning",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_text_overlay, reg1, "str_choose_position"),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, reg1, 1),
(assign,":var001",125),
(assign,":var002",400),
(call_script, "script_get_troop_custom_banner_num_positionings", "trp_player"),
(assign,":var003",reg0),
(store_mul, ":var004", ":var003", 125),
(val_sub, ":var004", 25),
(store_div, ":var___x1", ":var004", 2),
(assign,":var001",":var___x1"),
(store_sub, ":var001", 500, ":var001"),
(try_for_range, ":slot_no_005", 0, ":var003"),
    (create_image_button_overlay_with_tableau_material, reg1, -1, "tab_positioning_selection", ":slot_no_005"),
    (position_set_x,1,":var001"),
    (position_set_y,1,":var002"),
    (val_add, ":var001", 125),
    (overlay_set_position, reg1, 1),
    (troop_set_slot,"trp_temp_array_a",":slot_no_005",reg1),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(call_script, "script_get_troop_custom_banner_num_positionings", "trp_player"),
(assign,":var002",reg0),
(try_for_range, ":var003", 0, ":var002"),
    (try_begin),
        (troop_slot_eq,"trp_temp_array_a",":var003",":var001"),
        (troop_set_slot,"trp_player",98,":var003"),
        (assign,":var002",0),
    (try_end),
(try_end),
(try_begin),
    (gt,"$g_presentation_next_presentation",0),
    (start_presentation, "$g_presentation_next_presentation"),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("banner_charge_selection",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_text_overlay, reg1, "str_choose_charge"),
(position_set_x,1,500),
(position_set_y,1,650),
(overlay_set_position, reg1, 1),
(assign,":var001",100),
(assign,":var002",600),
(try_for_range, ":mesh_003", ":mesh.custom_banner_charge_01", ":mesh.tableau_mesh_custom_banner"),
    (create_image_button_overlay, reg1, ":mesh_003", ":mesh_003"),
    (position_set_x,1,":var001"),
    (position_set_y,1,":var002"),
    (val_add, ":var001", 100),
    (try_begin),
        (gt,":var001",900),
        (assign,":var001",100),
        (val_sub, ":var002", 100),
    (try_end),
    (overlay_set_position, reg1, 1),
    (position_set_x,1,80),
    (position_set_y,1,80),
    (overlay_set_size, reg1, 1),
    (store_sub, ":slot_no_004", ":mesh_003", ":mesh.custom_banner_charge_01"),
    (troop_set_slot,"trp_temp_array_a",":slot_no_004",reg1),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(assign,":var002","mesh_tableau_mesh_custom_banner"),
(assign,":var002 -","mesh_custom_banner_charge_01"),
(try_for_range, ":var003", 0, ":var002"),
    (try_begin),
        (troop_slot_eq,"trp_temp_array_a",":var003",":var001"),
        (troop_set_slot,"trp_player","$g_presentation_output_slot",":var003"),
        (assign,":var002",0),
    (try_end),
(try_end),
(try_begin),
    (gt,"$g_presentation_next_presentation",0),
    (start_presentation, "$g_presentation_next_presentation"),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("banner_background_selection",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_text_overlay, reg1, "str_choose_background"),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, reg1, 1),
(assign,":var001",75),
(assign,":var002",450),
(try_for_range, ":mesh_003", ":mesh.custom_banner_bg", ":mesh.custom_banner_charge_01"),
    (store_sub, ":slot_no_004", ":mesh_003", ":mesh.custom_banner_bg"),
    (create_image_button_overlay_with_tableau_material, reg1, -1, "tab_background_selection", ":slot_no_004"),
    (position_set_x,1,":var001"),
    (position_set_y,1,":var002"),
    (val_add, ":var001", 125),
    (try_begin),
        (gt,":var001",900),
        (assign,":var001",75),
        (val_sub, ":var002", 125),
    (try_end),
    (overlay_set_position, reg1, 1),
    (troop_set_slot,"trp_temp_array_a",":slot_no_004",reg1),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(assign,":var002","mesh_custom_banner_charge_01"),
(assign,":var002 -","mesh_custom_banner_bg"),
(try_for_range, ":var003", 0, ":var002"),
    (try_begin),
        (troop_slot_eq,"trp_temp_array_a",":var003",":var001"),
        (troop_set_slot,"trp_player",91,":var003"),
        (assign,":var002",0),
    (try_end),
(try_end),
(try_begin),
    (gt,"$g_presentation_next_presentation",0),
    (start_presentation, "$g_presentation_next_presentation"),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("banner_flag_type_selection",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_text_overlay, reg1, "str_choose_flag_type"),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, reg1, 1),
(assign,":var001",435),
(assign,":var002",450),
(try_for_range, ":mesh_003", ":mesh.custom_banner_01", ":mesh.custom_banner_bg"),
    (store_sub, ":slot_no_004", ":mesh_003", ":mesh.custom_banner_01"),
    (troop_set_slot,"trp_player",96,":slot_no_004"),
    (create_image_button_overlay_with_tableau_material, reg1, ":mesh_003", "tab_custom_banner_default", "trp_player"),
    (position_set_x,1,":var001"),
    (position_set_y,1,":var002"),
    (val_add, ":var001", 130),
    (overlay_set_position, reg1, 1),
    (position_set_x,1,100),
    (position_set_y,1,100),
    (overlay_set_size, reg1, 1),
    (troop_set_slot,"trp_temp_array_a",":slot_no_004",reg1),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(assign,":var002","mesh_custom_banner_bg"),
(assign,":var002 -","mesh_custom_banner_01"),
(try_for_range, ":var003", 0, ":var002"),
    (try_begin),
        (troop_slot_eq,"trp_temp_array_a",":var003",":var001"),
        (troop_set_slot,"trp_player",96,":var003"),
        (assign,":var002",0),
    (try_end),
(try_end),
(try_begin),
    (gt,"$g_presentation_next_presentation",0),
    (start_presentation, "$g_presentation_next_presentation"),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("banner_flag_map_type_selection",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_text_overlay, reg1, "str_choose_map_flag_type"),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, reg1, 1),
(troop_get_slot,":troop_slot_001","trp_player",91),
(assign,":troop_slot_001 +","mesh_custom_banner_bg"),
(assign,":var002",250),
(assign,":var003",150),
(try_for_range, ":mesh_004", ":mesh.custom_map_banner_01", ":mesh.custom_banner_01"),
    (store_sub, ":slot_no_005", ":mesh_004", ":mesh.custom_map_banner_01"),
    (troop_set_slot,"trp_player",99,":slot_no_005"),
    (try_begin),
        (eq,":mesh_004","mesh_custom_map_banner_01"),
        (create_image_button_overlay_with_tableau_material, reg1, ":mesh_004", "tab_custom_banner_square", "trp_player"),
    (else_try),
        (eq,":mesh_004","mesh_custom_map_banner_02"),
        (create_image_button_overlay_with_tableau_material, reg1, ":mesh_004", "tab_custom_banner_short", "trp_player"),
    (else_try),
        (create_image_button_overlay_with_tableau_material, reg1, ":mesh_004", "tab_custom_banner_tall", "trp_player"),
    (try_end),
    (position_set_x,1,":var002"),
    (position_set_y,1,":var003"),
    (val_add, ":var002", 200),
    (overlay_set_position, reg1, 1),
    (position_set_x,1,100),
    (position_set_y,1,100),
    (overlay_set_size, reg1, 1),
    (troop_set_slot,"trp_temp_array_a",":slot_no_005",reg1),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(assign,":var002","mesh_custom_banner_01"),
(assign,":var002 -","mesh_custom_map_banner_01"),
(try_for_range, ":var003", 0, ":var002"),
    (try_begin),
        (troop_slot_eq,"trp_temp_array_a",":var003",":var001"),
        (troop_set_slot,"trp_player",99,":var003"),
        (assign,":var002",0),
    (try_end),
(try_end),
(try_begin),
    (gt,"$g_presentation_next_presentation",0),
    (start_presentation, "$g_presentation_next_presentation"),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("color_selection",0,mesh_load_window,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_text_overlay, reg1, "str_choose_color"),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, reg1, 1),
(assign,":var001",125),
(assign,":var002",450),
(try_for_range, ":var003", 0, 42),
    (call_script, "script_get_custom_banner_color_from_index", ":var003"),
    (assign,":var004",reg0),
    (create_image_button_overlay_with_tableau_material, reg1, "mesh_color_picker", "tab_color_picker", ":var004"),
    (position_set_x,1,":var001"),
    (position_set_y,1,":var002"),
    (val_add, ":var001", 50),
    (try_begin),
        (eq,1,1),
        (store_mod,":var005",":var003",7),
        (try_begin),
            (eq,":var005",6),
            (assign,":var001",125),
            (val_sub, ":var002", 50),
        (try_end),
    (try_end),
    (overlay_set_position, reg1, 1),
    (position_set_x,1,500),
    (position_set_y,1,500),
    (overlay_set_size, reg1, 1),
    (store_mul, ":slot_no_006", ":var003", 2),
    (store_add, ":slot_no_007", ":slot_no_006", 1),
    (troop_set_slot,"trp_temp_array_a",":slot_no_006",reg1),
    (troop_set_slot,"trp_temp_array_a",":slot_no_007",":var004"),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(assign,":var002",64),
(try_for_range, ":var003", 0, ":var002"),
    (store_mul, ":var004", ":var003", 2),
    (try_begin),
        (troop_slot_eq,"trp_temp_array_a",":var004",":var001"),
        (store_add, ":slot_no_005", ":var004", 1),
        (troop_get_slot,":troop_slot_006","trp_temp_array_a",":slot_no_005"),
        (troop_set_slot,"trp_player","$g_presentation_output_slot",":troop_slot_006"),
        (assign,":var002",0),
    (try_end),
(try_end),
(try_begin),
    (gt,"$g_presentation_next_presentation",0),
    (start_presentation, "$g_presentation_next_presentation"),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("marshall_selection",0,mesh_load_window,[

(ti_on_presentation_load, [
(assign,"$g_presentation_obj_marshall_selection_1",-1),
(assign,"$g_presentation_obj_marshall_selection_2",-1),
(assign,"$g_presentation_obj_marshall_selection_3",-1),
(set_fixed_point_multiplier, 1000),
(assign,"$g_presentation_next_presentation",-1),
(store_add, ":var001", "$g_presentation_marshall_selection_max_renown_1", "$g_presentation_marshall_selection_max_renown_2"),
(faction_get_slot,":faction_slot_002","$players_kingdom",11),
(str_store_troop_name,s1,"$g_presentation_marshall_selection_max_renown_1_troop"),
(position_set_x,1,200),
(position_set_y,1,600),
(overlay_set_position, reg1, 1),
(str_store_troop_name,s1,"$g_presentation_marshall_selection_max_renown_2_troop"),
(position_set_x,1,800),
(position_set_y,1,600),
(overlay_set_position, reg1, 1),
(create_mesh_overlay_with_tableau_material, reg1, -1, "tab_troop_note_mesh", "$g_presentation_marshall_selection_max_renown_1_troop"),
(position_set_x,1,500),
(position_set_y,1,500),
(overlay_set_size, reg1, 1),
(position_set_x,1,100),
(position_set_y,1,300),
(overlay_set_position, reg1, 1),
(create_mesh_overlay_with_tableau_material, reg1, -1, "tab_troop_note_mesh", "$g_presentation_marshall_selection_max_renown_2_troop"),
(position_set_x,1,500),
(position_set_y,1,500),
(overlay_set_size, reg1, 1),
(position_set_x,1,700),
(position_set_y,1,300),
(overlay_set_position, reg1, 1),
(assign,":var003","$g_presentation_input"),
(val_add, "$g_presentation_input", 1),
(try_begin),
    (lt,":var003",0),
    (str_store_troop_name,s1,"$g_presentation_marshall_selection_max_renown_1_troop"),
    (str_store_troop_name,s2,"$g_presentation_marshall_selection_max_renown_2_troop"),
    (str_store_troop_name,s3,":faction_slot_002"),
    (str_store_faction_name,s4,"$players_kingdom"),
    (create_text_overlay, reg1, "@{s3} of {s4} wishes to select a new marshall and invites his vassals for a counsel. {s1} and {s2} are the likely candidates."),
    (position_set_x,1,500),
    (position_set_y,1,200),
    (overlay_set_position, reg1, 1),
    (create_button_overlay, "$g_presentation_obj_marshall_selection_1", "@Continue..."),
    (position_set_x,1,500),
    (position_set_y,1,100),
    (overlay_set_position, "$g_presentation_obj_marshall_selection_1", 1),
    (assign,"$g_presentation_next_presentation","prsnt_marshall_selection"),
(else_try),
    (assign,":var004",":var003"),
    (try_for_range, ":trp_005", ":trp.kingdom_heroes_including_player_begin", ":trp.knight_1_1_wife"),
        (try_begin),
            (ge,":var004",0),
            (assign,":troop_id_006",":trp_005"),
            (assign,":var007",0),
            (try_begin),
                (eq,":trp_005","trp_kingdom_heroes_including_player_begin"),
                (assign,":troop_id_006","trp_player"),
                (try_begin),
                    (eq,"$g_player_is_captive",0),
                    (assign,":var007",1),
                (try_end),
            (try_end),
        (else_try),
            (store_troop_faction,":troop_faction_008",":troop_id_006"),
            (try_begin),
                (eq,"$players_kingdom",":troop_faction_008"),
                (neg|troop_slot_ge,":troop_id_006",8,0),
                (troop_slot_ge,":troop_id_006",10,1),
                (troop_slot_eq,":troop_id_006",2,2),
                (neg|faction_slot_eq,":troop_faction_008",11,":troop_id_006"),
                (assign,":var007",1),
            (try_end),
        (try_end),
        (try_begin),
            (eq,":var007",1),
            (neq,"$g_presentation_marshall_selection_max_renown_1_troop",":troop_id_006"),
            (neq,"$g_presentation_marshall_selection_max_renown_2_troop",":troop_id_006"),
            (val_sub, ":var004", 1),
            (try_begin),
                (lt,":var004",0),
                (assign,"$g_presentation_next_presentation","prsnt_marshall_selection"),
                (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_troop_note_mesh", ":troop_id_006"),
                (position_set_x,1,300),
                (position_set_y,1,300),
                (overlay_set_size, reg1, 1),
                (position_set_x,1,440),
                (position_set_y,1,400),
                (overlay_set_position, reg1, 1),
                (try_begin),
                    (eq,":troop_id_006","trp_player"),
                    (create_text_overlay, reg1, "@Who do you wish to support?"),
                    (position_set_x,1,500),
                    (position_set_y,1,200),
                    (overlay_set_position, reg1, 1),
                    (str_store_troop_name,s1,"$g_presentation_marshall_selection_max_renown_1_troop"),
                    (create_button_overlay, "$g_presentation_obj_marshall_selection_2", "@{!}{s1}"),
                    (position_set_x,1,300),
                    (position_set_y,1,100),
                    (overlay_set_position, "$g_presentation_obj_marshall_selection_2", 1),
                    (str_store_troop_name,s1,"$g_presentation_marshall_selection_max_renown_2_troop"),
                    (create_button_overlay, "$g_presentation_obj_marshall_selection_3", "@{!}{s1}"),
                    (position_set_x,1,700),
                    (position_set_y,1,100),
                    (overlay_set_position, "$g_presentation_obj_marshall_selection_3", 1),
                (else_try),
                    (str_store_troop_name,s1,":troop_id_006"),
                    (store_random_in_range,":random_x_009",0,":var001"),
                    (val_sub, ":random_x_009", "$g_presentation_marshall_selection_max_renown_1"),
                    (try_begin),
                        (lt,":random_x_009",0),
                        (val_add, "$g_presentation_marshall_selection_1_vote", 1),
                        (str_store_troop_name,s2,"$g_presentation_marshall_selection_max_renown_1_troop"),
                    (else_try),
                        (val_add, "$g_presentation_marshall_selection_2_vote", 1),
                        (str_store_troop_name,s2,"$g_presentation_marshall_selection_max_renown_2_troop"),
                    (try_end),
                (try_end),
            (try_end),
            (create_text_overlay, reg1, "@{s1} gives his support to {s2}."),
            (position_set_x,1,500),
            (position_set_y,1,200),
            (overlay_set_position, reg1, 1),
            (create_button_overlay, "$g_presentation_obj_marshall_selection_1", "@Continue..."),
            (position_set_x,1,500),
            (position_set_y,1,100),
            (overlay_set_position, "$g_presentation_obj_marshall_selection_1", 1),
        (try_end),
    (try_end),
(try_end),
(assign,reg0,"$g_presentation_marshall_selection_1_vote"),
(create_text_overlay, reg1, 16),
(position_set_x,1,200),
(position_set_y,1,550),
(overlay_set_position, reg1, 1),
(assign,reg0,"$g_presentation_marshall_selection_2_vote"),
(create_text_overlay, reg1, 16),
(position_set_x,1,800),
(position_set_y,1,550),
(overlay_set_position, reg1, 1),
(try_begin),
    (lt,"$g_presentation_next_presentation",0),
    (try_begin),
        (gt,"$g_presentation_marshall_selection_2_vote","$g_presentation_marshall_selection_1_vote"),
        (assign,":var010","$g_presentation_marshall_selection_max_renown_1_troop"),
        (assign,"$g_presentation_marshall_selection_max_renown_1_troop","$g_presentation_marshall_selection_max_renown_2_troop"),
        (assign,"$g_presentation_marshall_selection_max_renown_2_troop",":var010"),
    (try_end),
    (str_store_troop_name,s1,"$g_presentation_marshall_selection_max_renown_1_troop"),
    (str_store_troop_name,s2,":faction_slot_002"),
    (str_store_faction_name,s3,"$players_kingdom"),
    (create_text_overlay, reg1, "@{s2} has heard his vassals' counsel. He selects {s1} as the marshall of {s3}."),
    (position_set_x,1,500),
    (position_set_y,1,200),
    (overlay_set_position, reg1, 1),
    (create_button_overlay, "$g_presentation_obj_marshall_selection_1", "@Continue..."),
    (position_set_x,1,500),
    (position_set_y,1,100),
    (overlay_set_position, "$g_presentation_obj_marshall_selection_1", 1),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_marshall_selection_2"),
    (val_add, "$g_presentation_marshall_selection_1_vote", 1),
    (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_1_troop", 2),
    (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_2_troop", -2),
(else_try),
    (eq,":var001","$g_presentation_obj_marshall_selection_3"),
    (val_add, "$g_presentation_marshall_selection_2_vote", 1),
    (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_1_troop", -2),
    (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_2_troop", 2),
(try_end),
(try_begin),
    (this_or_next|eq,":var001","$g_presentation_obj_marshall_selection_3"),
    (this_or_next|eq,":var001","$g_presentation_obj_marshall_selection_2"),
    (eq,":var001","$g_presentation_obj_marshall_selection_1"),
    (try_begin),
        (ge,"$g_presentation_next_presentation",0),
        (start_presentation, "$g_presentation_next_presentation"),
    (else_try),
        (try_begin),
            (neg|faction_slot_eq,"$players_kingdom",8,"$g_presentation_marshall_selection_max_renown_1_troop"),
            (call_script, "script_check_and_finish_active_army_quests_for_faction", "$players_kingdom"),
        (try_end),
        (faction_get_slot,":faction_slot_002","$players_kingdom",8),
        (try_begin),
            (ge,":faction_slot_002",0),
            (party_is_active,":faction_slot_002"),
            (party_set_marshall, ":faction_slot_002", 0),
        (try_end),
        (faction_set_slot,"$players_kingdom",8,"$g_presentation_marshall_selection_max_renown_1_troop"),
        (try_begin),
            (eq,"$g_presentation_marshall_selection_max_renown_1_troop","trp_player"),
            (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_2_troop", -3),
        (try_end),
        (assign,"$g_recalculate_ais",1),
        (assign,"$g_presentation_marshall_selection_ended",1),
        (presentation_set_duration, 0),
    (try_end),
(try_end),
]),

]),
("battle",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(assign,"$g_formation_group0_selected",0),
(assign,"$g_formation_group1_selected",0),
(assign,"$g_formation_group2_selected",0),
(assign,"$g_formation_group3_selected",0),
(assign,"$g_formation_group4_selected",0),
(assign,"$g_formation_group5_selected",0),
(assign,"$g_formation_group6_selected",0),
(assign,"$g_formation_group7_selected",0),
(assign,"$g_formation_group8_selected",0),
(assign,"$g_presentation_obj_battle_but0",-1),
(assign,"$g_presentation_obj_battle_but1",-1),
(assign,"$g_presentation_obj_battle_but2",-1),
(assign,"$g_presentation_obj_battle_but3",-1),
(assign,"$g_presentation_obj_battle_but4",-1),
(assign,"$g_presentation_obj_battle_but5",-1),
(assign,"$g_presentation_obj_battle_but6",-1),
(assign,"$g_presentation_obj_battle_but7",-1),
(assign,"$g_presentation_obj_battle_but8",-1),
(str_clear, 7),
(try_for_agents, ":cur_agent"),
    (agent_set_slot,":cur_agent",10,0),
(try_end),
(get_player_agent_no,":agent_no_002"),
(agent_get_troop_id,":troop_id_003", ":agent_no_002"),
(position_set_y,1,700),
(create_text_overlay, reg1, "@Action"),
(overlay_set_color, reg1, 4289374890),
(position_set_x,1,270),
(overlay_set_position, reg1, 1),
(create_text_overlay, reg1, "@Mount"),
(overlay_set_color, reg1, 4289374890),
(position_set_x,1,410),
(overlay_set_position, reg1, 1),
(create_text_overlay, reg1, "@Attack Type"),
(overlay_set_color, reg1, 4289374890),
(position_set_x,1,550),
(overlay_set_position, reg1, 1),
(assign,"$group0_has_troops",0),
(assign,"$group1_has_troops",0),
(assign,"$group2_has_troops",0),
(assign,"$group3_has_troops",0),
(assign,"$group4_has_troops",0),
(assign,"$group5_has_troops",0),
(assign,"$group6_has_troops",0),
(assign,"$group7_has_troops",0),
(assign,"$group8_has_troops",0),
(party_get_num_companion_stacks,":party_num_companions_stacks_004","p_main_party"),
(assign,"$num_classes",0),
(try_for_range, ":stack_no_005", 0, ":party_num_companions_stacks_004"),
    (party_stack_get_troop_id,      ":troop_id_006","p_main_party",":stack_no_005"),
    (troop_get_class, ":troop_class_007", ":troop_id_006"),
    (try_begin),
        (neq,":troop_id_003",":troop_id_006"),
        (try_begin),
            (eq,":troop_class_007",0),
            (try_begin),
                (neq,"$group0_has_troops",1),
                (val_add, "$num_classes", 1),
            (try_end),
        (try_end),
        (assign,"$group0_has_troops",1),
    (else_try),
        (eq,":troop_class_007",1),
        (try_begin),
            (neq,"$group1_has_troops",1),
            (val_add, "$num_classes", 1),
        (try_end),
        (assign,"$group1_has_troops",1),
    (else_try),
        (eq,":troop_class_007",2),
        (try_begin),
            (neq,"$group2_has_troops",1),
            (val_add, "$num_classes", 1),
        (try_end),
        (assign,"$group2_has_troops",1),
    (else_try),
        (eq,":troop_class_007",3),
        (try_begin),
            (neq,"$group3_has_troops",1),
            (val_add, "$num_classes", 1),
        (try_end),
        (assign,"$group3_has_troops",1),
    (else_try),
        (eq,":troop_class_007",4),
        (try_begin),
            (neq,"$group4_has_troops",1),
            (val_add, "$num_classes", 1),
        (try_end),
        (assign,"$group4_has_troops",1),
    (else_try),
        (eq,":troop_class_007",5),
        (try_begin),
            (neq,"$group5_has_troops",1),
            (val_add, "$num_classes", 1),
        (try_end),
        (assign,"$group5_has_troops",1),
    (else_try),
        (eq,":troop_class_007",6),
        (try_begin),
            (neq,"$group6_has_troops",1),
            (val_add, "$num_classes", 1),
        (try_end),
        (assign,"$group6_has_troops",1),
    (else_try),
        (eq,":troop_class_007",7),
        (try_begin),
            (neq,"$group7_has_troops",1),
            (val_add, "$num_classes", 1),
        (try_end),
        (assign,"$group7_has_troops",1),
    (else_try),
        (eq,":troop_class_007",8),
        (try_begin),
            (neq,"$group8_has_troops",1),
            (val_add, "$num_classes", 1),
        (try_end),
        (assign,"$group8_has_troops",1),
    (try_end),
(try_end),
(assign,":var008",0),
(assign,":var009",653),
(assign,":var010",20),
(assign,":var011",662),
(assign,":var012",50),
(assign,":var013",660),
(try_begin),
    (eq,"$group0_has_troops",1),
    (create_image_button_overlay, "$g_presentation_obj_battle_but0", "mesh_white_plane", "mesh_white_plane"),
    (position_set_x,1,":var008"),
    (position_set_y,1,":var009"),
    (overlay_set_position, "$g_presentation_obj_battle_but0", 1),
    (val_add, ":var009", -40),
    (position_set_x,1,32500),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_presentation_obj_battle_but0", 1),
    (overlay_set_alpha, "$g_presentation_obj_battle_but0", 0),
    (overlay_set_color, "$g_presentation_obj_battle_but0", 16776960),
    (create_check_box_overlay, "$g_presentation_obj_battle_check0"),
    (position_set_x,2,":var010"),
    (position_set_y,2,":var011"),
    (overlay_set_position, "$g_presentation_obj_battle_check0", 2),
    (val_add, ":var011", -40),
    (create_text_overlay, "$g_presentation_obj_battle_name0", 7),
    (position_set_x,3,":var012"),
    (position_set_y,3,":var013"),
    (overlay_set_position, "$g_presentation_obj_battle_name0", 3),
    (val_add, ":var013", -40),
    (create_text_overlay, "$g_presentation_but0_movement", 7),
    (create_text_overlay, "$g_presentation_but0_riding", 7),
    (create_text_overlay, "$g_presentation_but0_weapon_usage", 7),
(try_end),
(try_begin),
    (eq,"$group1_has_troops",1),
    (create_image_button_overlay, "$g_presentation_obj_battle_but1", "mesh_white_plane", "mesh_white_plane"),
    (position_set_x,1,":var008"),
    (position_set_y,1,":var009"),
    (overlay_set_position, "$g_presentation_obj_battle_but1", 1),
    (val_add, ":var009", -40),
    (position_set_x,1,32500),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_presentation_obj_battle_but1", 1),
    (overlay_set_alpha, "$g_presentation_obj_battle_but1", 0),
    (overlay_set_color, "$g_presentation_obj_battle_but1", 16776960),
    (create_check_box_overlay, "$g_presentation_obj_battle_check1"),
    (position_set_x,2,":var010"),
    (position_set_y,2,":var011"),
    (overlay_set_position, "$g_presentation_obj_battle_check1", 2),
    (val_add, ":var011", -40),
    (create_text_overlay, "$g_presentation_obj_battle_name1", 7),
    (position_set_x,3,":var012"),
    (position_set_y,3,":var013"),
    (overlay_set_position, "$g_presentation_obj_battle_name1", 3),
    (val_add, ":var013", -40),
    (create_text_overlay, "$g_presentation_but1_movement", 7),
    (create_text_overlay, "$g_presentation_but1_riding", 7),
    (create_text_overlay, "$g_presentation_but1_weapon_usage", 7),
(try_end),
(try_begin),
    (eq,"$group2_has_troops",1),
    (create_image_button_overlay, "$g_presentation_obj_battle_but2", "mesh_white_plane", "mesh_white_plane"),
    (position_set_x,1,":var008"),
    (position_set_y,1,":var009"),
    (overlay_set_position, "$g_presentation_obj_battle_but2", 1),
    (val_add, ":var009", -40),
    (position_set_x,1,32500),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_presentation_obj_battle_but2", 1),
    (overlay_set_alpha, "$g_presentation_obj_battle_but2", 0),
    (overlay_set_color, "$g_presentation_obj_battle_but2", 16776960),
    (create_check_box_overlay, "$g_presentation_obj_battle_check2"),
    (position_set_x,2,":var010"),
    (position_set_y,2,":var011"),
    (overlay_set_position, "$g_presentation_obj_battle_check2", 2),
    (val_add, ":var011", -40),
    (create_text_overlay, "$g_presentation_obj_battle_name2", 7),
    (position_set_x,3,":var012"),
    (position_set_y,3,":var013"),
    (overlay_set_position, "$g_presentation_obj_battle_name2", 3),
    (val_add, ":var013", -40),
    (create_text_overlay, "$g_presentation_but2_movement", 7),
    (create_text_overlay, "$g_presentation_but2_riding", 7),
    (create_text_overlay, "$g_presentation_but2_weapon_usage", 7),
(try_end),
(try_begin),
    (eq,"$group3_has_troops",1),
    (create_image_button_overlay, "$g_presentation_obj_battle_but3", "mesh_white_plane", "mesh_white_plane"),
    (position_set_x,1,":var008"),
    (position_set_y,1,":var009"),
    (overlay_set_position, "$g_presentation_obj_battle_but3", 1),
    (val_add, ":var009", -40),
    (position_set_x,1,32500),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_presentation_obj_battle_but3", 1),
    (overlay_set_alpha, "$g_presentation_obj_battle_but3", 0),
    (overlay_set_color, "$g_presentation_obj_battle_but3", 16776960),
    (create_check_box_overlay, "$g_presentation_obj_battle_check3"),
    (position_set_x,2,":var010"),
    (position_set_y,2,":var011"),
    (overlay_set_position, "$g_presentation_obj_battle_check3", 2),
    (val_add, ":var011", -40),
    (create_text_overlay, "$g_presentation_obj_battle_name3", 7),
    (position_set_x,3,":var012"),
    (position_set_y,3,":var013"),
    (overlay_set_position, "$g_presentation_obj_battle_name3", 3),
    (val_add, ":var013", -40),
    (create_text_overlay, "$g_presentation_but3_movement", 7),
    (create_text_overlay, "$g_presentation_but3_riding", 7),
    (create_text_overlay, "$g_presentation_but3_weapon_usage", 7),
(try_end),
(try_begin),
    (eq,"$group4_has_troops",1),
    (create_image_button_overlay, "$g_presentation_obj_battle_but4", "mesh_white_plane", "mesh_white_plane"),
    (position_set_x,1,":var008"),
    (position_set_y,1,":var009"),
    (overlay_set_position, "$g_presentation_obj_battle_but4", 1),
    (val_add, ":var009", -40),
    (position_set_x,1,32500),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_presentation_obj_battle_but4", 1),
    (overlay_set_alpha, "$g_presentation_obj_battle_but4", 0),
    (overlay_set_color, "$g_presentation_obj_battle_but4", 16776960),
    (create_check_box_overlay, "$g_presentation_obj_battle_check4"),
    (position_set_x,2,":var010"),
    (position_set_y,2,":var011"),
    (overlay_set_position, "$g_presentation_obj_battle_check4", 2),
    (val_add, ":var011", -40),
    (create_text_overlay, "$g_presentation_obj_battle_name4", 7),
    (position_set_x,3,":var012"),
    (position_set_y,3,":var013"),
    (overlay_set_position, "$g_presentation_obj_battle_name4", 3),
    (val_add, ":var013", -40),
    (create_text_overlay, "$g_presentation_but4_movement", 7),
    (create_text_overlay, "$g_presentation_but4_riding", 7),
    (create_text_overlay, "$g_presentation_but4_weapon_usage", 7),
(try_end),
(try_begin),
    (eq,"$group5_has_troops",1),
    (create_image_button_overlay, "$g_presentation_obj_battle_but5", "mesh_white_plane", "mesh_white_plane"),
    (position_set_x,1,":var008"),
    (position_set_y,1,":var009"),
    (overlay_set_position, "$g_presentation_obj_battle_but5", 1),
    (val_add, ":var009", -40),
    (position_set_x,1,32500),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_presentation_obj_battle_but5", 1),
    (overlay_set_alpha, "$g_presentation_obj_battle_but5", 0),
    (overlay_set_color, "$g_presentation_obj_battle_but5", 16776960),
    (create_check_box_overlay, "$g_presentation_obj_battle_check5"),
    (position_set_x,2,":var010"),
    (position_set_y,2,":var011"),
    (overlay_set_position, "$g_presentation_obj_battle_check5", 2),
    (val_add, ":var011", -40),
    (create_text_overlay, "$g_presentation_obj_battle_name5", 7),
    (position_set_x,3,":var012"),
    (position_set_y,3,":var013"),
    (overlay_set_position, "$g_presentation_obj_battle_name5", 3),
    (val_add, ":var013", -40),
    (create_text_overlay, "$g_presentation_but5_movement", 7),
    (create_text_overlay, "$g_presentation_but5_riding", 7),
    (create_text_overlay, "$g_presentation_but5_weapon_usage", 7),
(try_end),
(try_begin),
    (eq,"$group6_has_troops",1),
    (create_image_button_overlay, "$g_presentation_obj_battle_but6", "mesh_white_plane", "mesh_white_plane"),
    (position_set_x,1,":var008"),
    (position_set_y,1,":var009"),
    (overlay_set_position, "$g_presentation_obj_battle_but6", 1),
    (val_add, ":var009", -40),
    (position_set_x,1,32500),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_presentation_obj_battle_but6", 1),
    (overlay_set_alpha, "$g_presentation_obj_battle_but6", 0),
    (overlay_set_color, "$g_presentation_obj_battle_but6", 16776960),
    (create_check_box_overlay, "$g_presentation_obj_battle_check6"),
    (position_set_x,2,":var010"),
    (position_set_y,2,":var011"),
    (overlay_set_position, "$g_presentation_obj_battle_check6", 2),
    (val_add, ":var011", -40),
    (create_text_overlay, "$g_presentation_obj_battle_name6", 7),
    (position_set_x,3,":var012"),
    (position_set_y,3,":var013"),
    (overlay_set_position, "$g_presentation_obj_battle_name6", 3),
    (val_add, ":var013", -40),
    (create_text_overlay, "$g_presentation_but6_movement", 7),
    (create_text_overlay, "$g_presentation_but6_riding", 7),
    (create_text_overlay, "$g_presentation_but6_weapon_usage", 7),
(try_end),
(try_begin),
    (eq,"$group7_has_troops",1),
    (create_image_button_overlay, "$g_presentation_obj_battle_but7", "mesh_white_plane", "mesh_white_plane"),
    (position_set_x,1,":var008"),
    (position_set_y,1,":var009"),
    (overlay_set_position, "$g_presentation_obj_battle_but7", 1),
    (val_add, ":var009", -40),
    (position_set_x,1,32500),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_presentation_obj_battle_but7", 1),
    (overlay_set_alpha, "$g_presentation_obj_battle_but7", 0),
    (overlay_set_color, "$g_presentation_obj_battle_but7", 16776960),
    (create_check_box_overlay, "$g_presentation_obj_battle_check7"),
    (position_set_x,2,":var010"),
    (position_set_y,2,":var011"),
    (overlay_set_position, "$g_presentation_obj_battle_check7", 2),
    (val_add, ":var011", -40),
    (create_text_overlay, "$g_presentation_obj_battle_name7", 7),
    (position_set_x,3,":var012"),
    (position_set_y,3,":var013"),
    (overlay_set_position, "$g_presentation_obj_battle_name7", 3),
    (val_add, ":var013", -40),
    (create_text_overlay, "$g_presentation_but7_movement", 7),
    (create_text_overlay, "$g_presentation_but7_riding", 7),
    (create_text_overlay, "$g_presentation_but7_weapon_usage", 7),
(try_end),
(try_begin),
    (eq,"$group8_has_troops",1),
    (create_image_button_overlay, "$g_presentation_obj_battle_but8", "mesh_white_plane", "mesh_white_plane"),
    (position_set_x,1,":var008"),
    (position_set_y,1,":var009"),
    (overlay_set_position, "$g_presentation_obj_battle_but8", 1),
    (val_add, ":var009", -40),
    (position_set_x,1,32500),
    (position_set_y,1,2000),
    (overlay_set_size, "$g_presentation_obj_battle_but8", 1),
    (overlay_set_alpha, "$g_presentation_obj_battle_but8", 0),
    (overlay_set_color, "$g_presentation_obj_battle_but8", 16776960),
    (create_check_box_overlay, "$g_presentation_obj_battle_check8"),
    (position_set_x,2,":var010"),
    (position_set_y,2,":var011"),
    (overlay_set_position, "$g_presentation_obj_battle_check8", 2),
    (val_add, ":var011", -40),
    (create_text_overlay, "$g_presentation_obj_battle_name8", 7),
    (position_set_x,3,":var012"),
    (position_set_y,3,":var013"),
    (overlay_set_position, "$g_presentation_obj_battle_name8", 3),
    (val_add, ":var013", -40),
    (create_text_overlay, "$g_presentation_but8_movement", 7),
    (create_text_overlay, "$g_presentation_but8_riding", 7),
    (create_text_overlay, "$g_presentation_but8_weapon_usage", 7),
(try_end),
(get_player_agent_no,":agent_no_002"),
(agent_get_team, ":agent_team_no_014", ":agent_no_002"),
(call_script, "script_update_order_panel", ":agent_team_no_014"),
(assign,":var015",640),
(assign,":var016","$num_classes"),
(val_mul, ":var016", -40),
(val_add, ":var015", ":var016"),
(create_listbox_overlay, "$g_presentation_obj_battle_10"),
(create_listbox_overlay, "$g_presentation_obj_battle_11"),
(create_listbox_overlay, "$g_presentation_obj_battle_12"),
(create_listbox_overlay, "$g_presentation_obj_battle_13"),
(overlay_add_item, "$g_presentation_obj_battle_10", "@Stand Ground"),
(overlay_add_item, "$g_presentation_obj_battle_10", "@Charge"),
(overlay_add_item, "$g_presentation_obj_battle_10", "@Follow Me"),
(overlay_add_item, "$g_presentation_obj_battle_10", "@Hold This Position"),
(create_button_overlay, "$g_presentation_obj_battle_14", "@Spread Out"),
(overlay_set_color, "$g_presentation_obj_battle_14", 4294967295),
(create_button_overlay, "$g_presentation_obj_battle_15", "@Stand Closer"),
(overlay_set_color, "$g_presentation_obj_battle_15", 4294967295),
(create_button_overlay, "$g_presentation_obj_battle_16", "@Fall Back"),
(overlay_set_color, "$g_presentation_obj_battle_16", 4294967295),
(create_button_overlay, "$g_presentation_obj_battle_17", "@Advance"),
(overlay_set_color, "$g_presentation_obj_battle_17", 4294967295),
(position_set_x,1,600),
(position_set_y,1,600),
(overlay_set_size, "$g_presentation_obj_battle_10", 1),
(val_add, ":var015", -35),
(position_set_x,1,205),
(position_set_y,1,":var015"),
(val_add, ":var015", 35),
(overlay_set_position, "$g_presentation_obj_battle_10", 1),
(overlay_set_alpha, "$g_presentation_obj_battle_10", 96),
(overlay_set_val, "$g_presentation_obj_battle_10", "$g_latest_order_1"),
(val_add, ":var015", -40),
(position_set_x,1,130),
(position_set_y,1,":var015"),
(val_add, ":var015", 40),
(overlay_set_position, "$g_presentation_obj_battle_14", 1),
(val_add, ":var015", -20),
(position_set_x,1,130),
(position_set_y,1,":var015"),
(val_add, ":var015", 20),
(overlay_set_position, "$g_presentation_obj_battle_15", 1),
(val_add, ":var015", 0),
(position_set_x,1,130),
(position_set_y,1,":var015"),
(val_add, ":var015", 0),
(overlay_set_position, "$g_presentation_obj_battle_16", 1),
(val_add, ":var015", 20),
(position_set_x,1,130),
(position_set_y,1,":var015"),
(val_add, ":var015", -20),
(overlay_set_position, "$g_presentation_obj_battle_17", 1),
(overlay_add_item, "$g_presentation_obj_battle_11", "@Dismount"),
(overlay_add_item, "$g_presentation_obj_battle_11", "@Mount"),
(position_set_x,1,600),
(position_set_y,1,600),
(overlay_set_size, "$g_presentation_obj_battle_11", 1),
(position_set_x,1,350),
(position_set_y,1,":var015"),
(overlay_set_position, "$g_presentation_obj_battle_11", 1),
(overlay_set_alpha, "$g_presentation_obj_battle_11", 96),
(overlay_set_val, "$g_presentation_obj_battle_11", "$g_latest_order_2"),
(overlay_add_item, "$g_presentation_obj_battle_12", "@Fire At Will"),
(overlay_add_item, "$g_presentation_obj_battle_12", "@Hold Your Fire"),
(position_set_x,1,600),
(position_set_y,1,600),
(overlay_set_size, "$g_presentation_obj_battle_12", 1),
(position_set_x,1,495),
(position_set_y,1,":var015"),
(overlay_set_position, "$g_presentation_obj_battle_12", 1),
(overlay_set_alpha, "$g_presentation_obj_battle_12", 96),
(overlay_set_val, "$g_presentation_obj_battle_12", "$g_latest_order_3"),
(overlay_add_item, "$g_presentation_obj_battle_13", "@Use Blunt Weapons"),
(overlay_add_item, "$g_presentation_obj_battle_13", "@Use Any Weapon"),
(position_set_x,1,600),
(position_set_y,1,600),
(overlay_set_size, "$g_presentation_obj_battle_13", 1),
(val_add, ":var015", -35),
(position_set_x,1,495),
(position_set_y,1,":var015"),
(val_add, ":var015", 35),
(overlay_set_position, "$g_presentation_obj_battle_13", 1),
(overlay_set_alpha, "$g_presentation_obj_battle_13", 96),
(overlay_set_val, "$g_presentation_obj_battle_13", "$g_latest_order_4"),
(create_text_overlay, "$g_presentation_obj_battle_22", "str_us_"),
(create_text_overlay, "$g_presentation_obj_battle_23", "str_allies_"),
(create_text_overlay, "$g_presentation_obj_battle_24", "str_enemies_"),
(create_text_overlay, "$g_presentation_obj_battle_25", "@Ready"),
(create_text_overlay, "$g_presentation_obj_battle_26", "@Wounded"),
(create_text_overlay, "$g_presentation_obj_battle_28", "str_routed"),
(create_text_overlay, "$g_presentation_obj_battle_27", "@Dead"),
(create_text_overlay, "$g_battle_us_ready", 7),
(create_text_overlay, "$g_battle_us_wounded", 7),
(create_text_overlay, "$g_battle_us_routed", 7),
(create_text_overlay, "$g_battle_us_dead", 7),
(create_text_overlay, "$g_battle_enemies_ready", 7),
(create_text_overlay, "$g_battle_enemies_wounded", 7),
(create_text_overlay, "$g_battle_enemies_routed", 7),
(create_text_overlay, "$g_battle_enemies_dead", 7),
(create_text_overlay, "$g_battle_allies_ready", 7),
(create_text_overlay, "$g_battle_allies_wounded", 7),
(create_text_overlay, "$g_battle_allies_routed", 7),
(create_text_overlay, "$g_battle_allies_dead", 7),
(create_image_button_overlay, "$g_battle_report_plane", "mesh_white_plane", "mesh_white_plane"),
(overlay_set_color, "$g_battle_report_plane", 0),
(position_set_x,1,15500),
(position_set_y,1,6000),
(overlay_set_size, "$g_battle_report_plane", 1),
(position_set_x,1,672),
(position_set_y,1,275),
(overlay_set_position, "$g_battle_report_plane", 1),
(overlay_set_alpha, "$g_battle_report_plane", 68),
(overlay_set_color, "$g_battle_report_plane", 1140411),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, "$g_presentation_obj_battle_14", 1),
(overlay_set_size, "$g_presentation_obj_battle_15", 1),
(overlay_set_size, "$g_presentation_obj_battle_16", 1),
(overlay_set_size, "$g_presentation_obj_battle_17", 1),
(overlay_set_size, "$g_presentation_obj_battle_22", 1),
(overlay_set_size, "$g_presentation_obj_battle_23", 1),
(overlay_set_size, "$g_presentation_obj_battle_24", 1),
(overlay_set_size, "$g_presentation_obj_battle_25", 1),
(overlay_set_size, "$g_presentation_obj_battle_26", 1),
(overlay_set_size, "$g_presentation_obj_battle_27", 1),
(overlay_set_size, "$g_presentation_obj_battle_28", 1),
(overlay_set_size, "$g_battle_us_ready", 1),
(overlay_set_size, "$g_battle_us_wounded", 1),
(overlay_set_size, "$g_battle_us_routed", 1),
(overlay_set_size, "$g_battle_us_dead", 1),
(overlay_set_size, "$g_battle_enemies_ready", 1),
(overlay_set_size, "$g_battle_enemies_wounded", 1),
(overlay_set_size, "$g_battle_enemies_routed", 1),
(overlay_set_size, "$g_battle_enemies_dead", 1),
(overlay_set_size, "$g_battle_allies_ready", 1),
(overlay_set_size, "$g_battle_allies_wounded", 1),
(overlay_set_size, "$g_battle_allies_routed", 1),
(overlay_set_size, "$g_battle_allies_dead", 1),
(assign,":var008",675),
(assign,":var009",280),
(val_add, ":var008", 70),
(val_add, ":var009", 90),
(position_set_x,1,":var008"),
(position_set_y,1,":var009"),
(overlay_set_position, "$g_presentation_obj_battle_25", 1),
(val_add, ":var008", 70),
(position_set_x,1,":var008"),
(overlay_set_position, "$g_presentation_obj_battle_26", 1),
(val_add, ":var008", 70),
(position_set_x,1,":var008"),
(overlay_set_position, "$g_presentation_obj_battle_28", 1),
(val_add, ":var008", 70),
(position_set_x,1,":var008"),
(overlay_set_position, "$g_presentation_obj_battle_27", 1),
(val_add, ":var008", -280),
(val_add, ":var009", -30),
(position_set_x,1,":var008"),
(position_set_y,1,":var009"),
(overlay_set_position, "$g_presentation_obj_battle_22", 1),
(val_add, ":var009", -30),
(position_set_y,1,":var009"),
(overlay_set_position, "$g_presentation_obj_battle_23", 1),
(val_add, ":var009", -30),
(position_set_y,1,":var009"),
(overlay_set_position, "$g_presentation_obj_battle_24", 1),
(get_scene_boundaries,s2,3),
(position_transform_position_to_local, 4,2,3),
(set_fixed_point_multiplier, 1000),
(position_get_x,":pos_x_017",4),
(position_get_y,":pos_y_018",4),
(set_fixed_point_multiplier, 1000),
(store_div, ":var___x1", ":pos_y_018", 100),
(assign,":var019",":var___x1"),
(store_div, ":var___x1", ":pos_x_017", ":var019"),
(assign,":var019",":var___x1"),
(try_begin),
    (gt,":var019",100),
    (assign,"$g_battle_map_width",300),
    (store_div, ":var___x1", ":pos_x_017", "$g_battle_map_width"),
    (assign,"$g_battle_map_scale",":var___x1"),
    (store_div, ":var___x1", ":pos_y_018", "$g_battle_map_scale"),
    (assign,"$g_battle_map_height",":var___x1"),
(else_try),
    (assign,"$g_battle_map_height",300),
    (store_div, ":var___x1", ":pos_y_018", "$g_battle_map_height"),
    (assign,"$g_battle_map_scale",":var___x1"),
    (store_div, ":var___x1", ":pos_x_017", "$g_battle_map_scale"),
    (assign,"$g_battle_map_width",":var___x1"),
(try_end),
(create_image_button_overlay, "$g_battle_map_plane", "mesh_white_plane", "mesh_white_plane"),
(overlay_set_color, "$g_battle_map_plane", 0),
(store_add, ":var020", "$g_battle_map_width", 20),
(store_add, ":var021", "$g_battle_map_height", 20),
(store_mul, ":var022", ":var020", 50),
(store_mul, ":var023", ":var021", 50),
(position_set_x,1,":var022"),
(position_set_y,1,":var023"),
(overlay_set_size, "$g_battle_map_plane", 1),
(store_sub, ":var024", 990, ":var020"),
(store_sub, ":var025", 740, ":var021"),
(position_set_x,1,":var024"),
(position_set_y,1,":var025"),
(overlay_set_position, "$g_battle_map_plane", 1),
(overlay_set_alpha, "$g_battle_map_plane", 68),
(create_mesh_overlay, "$g_battle_map_infantry_order_flag", "mesh_flag_infantry"),
(create_mesh_overlay, "$g_battle_map_archers_order_flag", "mesh_flag_archers"),
(create_mesh_overlay, "$g_battle_map_cavalry_order_flag", "mesh_flag_cavalry"),
(overlay_set_alpha, "$g_battle_map_infantry_order_flag", 0),
(overlay_set_alpha, "$g_battle_map_archers_order_flag", 0),
(overlay_set_alpha, "$g_battle_map_cavalry_order_flag", 0),
(call_script, "script_update_order_panel_checked_classes"),
(call_script, "script_update_order_panel_statistics_and_map"),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(get_player_agent_no,":agent_no_003"),
(agent_get_team, ":agent_team_no_004", ":agent_no_003"),
(assign,":var005",0),
(try_begin),
    (eq,"$group0_has_troops",1),
    (eq,":var001","$g_presentation_obj_battle_check0"),
    (assign,":var005",1),
    (assign,"$g_formation_group0_selected",":var002"),
    (try_begin),
        (eq,":var002",1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 68),
    (else_try),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
    (try_end),
(else_try),
    (eq,"$group1_has_troops",1),
    (eq,":var001","$g_presentation_obj_battle_check1"),
    (assign,":var005",1),
    (assign,"$g_formation_group1_selected",":var002"),
    (try_begin),
        (eq,":var002",1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 68),
    (else_try),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
    (try_end),
(else_try),
    (eq,"$group2_has_troops",1),
    (eq,":var001","$g_presentation_obj_battle_check2"),
    (assign,":var005",1),
    (assign,"$g_formation_group2_selected",":var002"),
    (try_begin),
        (eq,":var002",1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 68),
    (else_try),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
    (try_end),
(else_try),
    (eq,"$group3_has_troops",1),
    (eq,":var001","$g_presentation_obj_battle_check3"),
    (assign,":var005",1),
    (assign,"$g_formation_group3_selected",":var002"),
    (try_begin),
        (eq,":var002",1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 68),
    (else_try),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
    (try_end),
(else_try),
    (eq,"$group4_has_troops",1),
    (eq,":var001","$g_presentation_obj_battle_check4"),
    (assign,":var005",1),
    (assign,"$g_formation_group4_selected",":var002"),
    (try_begin),
        (eq,":var002",1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 68),
    (else_try),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
    (try_end),
(else_try),
    (eq,"$group5_has_troops",1),
    (eq,":var001","$g_presentation_obj_battle_check5"),
    (assign,":var005",1),
    (assign,"$g_formation_group5_selected",":var002"),
    (try_begin),
        (eq,":var002",1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 68),
    (else_try),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
    (try_end),
(else_try),
    (eq,"$group6_has_troops",1),
    (eq,":var001","$g_presentation_obj_battle_check6"),
    (assign,":var005",1),
    (assign,"$g_formation_group6_selected",":var002"),
    (try_begin),
        (eq,":var002",1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 68),
    (else_try),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
    (try_end),
(else_try),
    (eq,"$group7_has_troops",1),
    (eq,":var001","$g_presentation_obj_battle_check7"),
    (assign,":var005",1),
    (assign,"$g_formation_group7_selected",":var002"),
    (try_begin),
        (eq,":var002",1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 68),
    (else_try),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
    (try_end),
(else_try),
    (eq,"$group8_has_troops",1),
    (eq,":var001","$g_presentation_obj_battle_check8"),
    (assign,":var005",1),
    (assign,"$g_formation_group8_selected",":var002"),
    (try_begin),
        (eq,":var002",1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 68),
    (else_try),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but0"),
    (assign,":var005",1),
    (assign,"$g_formation_group0_selected",1),
    (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 68),
    (overlay_set_val, "$g_presentation_obj_battle_check0", 1),
    (try_begin),
        (eq,"$group1_has_troops",1),
        (assign,"$g_formation_group1_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group2_has_troops",1),
        (assign,"$g_formation_group2_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group3_has_troops",1),
        (assign,"$g_formation_group3_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group4_has_troops",1),
        (assign,"$g_formation_group4_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group5_has_troops",1),
        (assign,"$g_formation_group5_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group6_has_troops",1),
        (assign,"$g_formation_group6_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group7_has_troops",1),
        (assign,"$g_formation_group7_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group8_has_troops",1),
        (assign,"$g_formation_group8_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but1"),
    (assign,":var005",1),
    (assign,"$g_formation_group1_selected",1),
    (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 68),
    (overlay_set_val, "$g_presentation_obj_battle_check1", 1),
    (try_begin),
        (eq,"$group0_has_troops",1),
        (assign,"$g_formation_group0_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group2_has_troops",1),
        (assign,"$g_formation_group2_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group3_has_troops",1),
        (assign,"$g_formation_group3_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group4_has_troops",1),
        (assign,"$g_formation_group4_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group5_has_troops",1),
        (assign,"$g_formation_group5_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group6_has_troops",1),
        (assign,"$g_formation_group6_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group7_has_troops",1),
        (assign,"$g_formation_group7_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group8_has_troops",1),
        (assign,"$g_formation_group8_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but2"),
    (assign,":var005",1),
    (assign,"$g_formation_group2_selected",1),
    (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 68),
    (overlay_set_val, "$g_presentation_obj_battle_check2", 1),
    (try_begin),
        (eq,"$group0_has_troops",1),
        (assign,"$g_formation_group0_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group1_has_troops",1),
        (assign,"$g_formation_group1_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group3_has_troops",1),
        (assign,"$g_formation_group3_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group4_has_troops",1),
        (assign,"$g_formation_group4_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group5_has_troops",1),
        (assign,"$g_formation_group5_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group6_has_troops",1),
        (assign,"$g_formation_group6_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group7_has_troops",1),
        (assign,"$g_formation_group7_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group8_has_troops",1),
        (assign,"$g_formation_group8_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but3"),
    (assign,":var005",1),
    (assign,"$g_formation_group3_selected",1),
    (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 68),
    (overlay_set_val, "$g_presentation_obj_battle_check3", 1),
    (try_begin),
        (eq,"$group0_has_troops",1),
        (assign,"$g_formation_group0_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group1_has_troops",1),
        (assign,"$g_formation_group1_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group2_has_troops",1),
        (assign,"$g_formation_group2_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group4_has_troops",1),
        (assign,"$g_formation_group4_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group5_has_troops",1),
        (assign,"$g_formation_group5_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group6_has_troops",1),
        (assign,"$g_formation_group6_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group7_has_troops",1),
        (assign,"$g_formation_group7_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group8_has_troops",1),
        (assign,"$g_formation_group8_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but4"),
    (assign,":var005",1),
    (assign,"$g_formation_group4_selected",1),
    (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 68),
    (overlay_set_val, "$g_presentation_obj_battle_check4", 1),
    (try_begin),
        (eq,"$group0_has_troops",1),
        (assign,"$g_formation_group0_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group1_has_troops",1),
        (assign,"$g_formation_group1_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group2_has_troops",1),
        (assign,"$g_formation_group2_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group3_has_troops",1),
        (assign,"$g_formation_group3_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group5_has_troops",1),
        (assign,"$g_formation_group5_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group6_has_troops",1),
        (assign,"$g_formation_group6_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group7_has_troops",1),
        (assign,"$g_formation_group7_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group8_has_troops",1),
        (assign,"$g_formation_group8_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but5"),
    (assign,":var005",1),
    (assign,"$g_formation_group5_selected",1),
    (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 68),
    (overlay_set_val, "$g_presentation_obj_battle_check5", 1),
    (try_begin),
        (eq,"$group0_has_troops",1),
        (assign,"$g_formation_group0_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group1_has_troops",1),
        (assign,"$g_formation_group1_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group2_has_troops",1),
        (assign,"$g_formation_group2_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group3_has_troops",1),
        (assign,"$g_formation_group3_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group4_has_troops",1),
        (assign,"$g_formation_group4_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group6_has_troops",1),
        (assign,"$g_formation_group6_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group7_has_troops",1),
        (assign,"$g_formation_group7_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group8_has_troops",1),
        (assign,"$g_formation_group8_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but6"),
    (assign,":var005",1),
    (assign,"$g_formation_group6_selected",1),
    (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 68),
    (overlay_set_val, "$g_presentation_obj_battle_check6", 1),
    (try_begin),
        (eq,"$group0_has_troops",1),
        (assign,"$g_formation_group0_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group1_has_troops",1),
        (assign,"$g_formation_group1_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group2_has_troops",1),
        (assign,"$g_formation_group2_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group3_has_troops",1),
        (assign,"$g_formation_group3_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group4_has_troops",1),
        (assign,"$g_formation_group4_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group5_has_troops",1),
        (assign,"$g_formation_group5_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group7_has_troops",1),
        (assign,"$g_formation_group7_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group8_has_troops",1),
        (assign,"$g_formation_group8_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but7"),
    (assign,":var005",1),
    (assign,"$g_formation_group7_selected",1),
    (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 68),
    (overlay_set_val, "$g_presentation_obj_battle_check7", 1),
    (try_begin),
        (eq,"$group0_has_troops",1),
        (assign,"$g_formation_group0_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group1_has_troops",1),
        (assign,"$g_formation_group1_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group2_has_troops",1),
        (assign,"$g_formation_group2_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group3_has_troops",1),
        (assign,"$g_formation_group3_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group4_has_troops",1),
        (assign,"$g_formation_group4_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group5_has_troops",1),
        (assign,"$g_formation_group5_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group6_has_troops",1),
        (assign,"$g_formation_group6_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group8_has_troops",1),
        (assign,"$g_formation_group8_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but8"),
    (assign,":var005",1),
    (assign,"$g_formation_group8_selected",1),
    (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 68),
    (overlay_set_val, "$g_presentation_obj_battle_check8", 1),
    (try_begin),
        (eq,"$group0_has_troops",1),
        (assign,"$g_formation_group0_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group1_has_troops",1),
        (assign,"$g_formation_group1_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group2_has_troops",1),
        (assign,"$g_formation_group2_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group3_has_troops",1),
        (assign,"$g_formation_group3_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group4_has_troops",1),
        (assign,"$g_formation_group4_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group5_has_troops",1),
        (assign,"$g_formation_group5_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group6_has_troops",1),
        (assign,"$g_formation_group6_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
    (try_end),
    (try_begin),
        (eq,"$group7_has_troops",1),
        (assign,"$g_formation_group7_selected",0),
        (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_14"),
    (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 8),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_15"),
    (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 7),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_16"),
    (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 6),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_17"),
    (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 5),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_10"),
    (try_begin),
        (eq,":var002",3),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 0),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_1",3),
    (else_try),
        (eq,":var002",2),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 1),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_1",2),
    (else_try),
        (eq,":var002",1),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 2),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_1",1),
    (else_try),
        (eq,":var002",0),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 11),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_1",0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_11"),
    (try_begin),
        (eq,":var002",1),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 3),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_2",1),
    (else_try),
        (eq,":var002",0),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 4),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_2",0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_12"),
    (try_begin),
        (eq,":var002",1),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 12),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_3",1),
    (else_try),
        (eq,":var002",0),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 13),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_3",0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_13"),
    (try_begin),
        (eq,":var002",1),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 10),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_4",1),
    (else_try),
        (eq,":var002",0),
        (call_script, "script_team_give_order_from_order_panel", ":agent_no_003", 9),
        (call_script, "script_update_order_panel", ":agent_team_no_004"),
        (assign,"$g_latest_order_4",0),
    (try_end),
(else_try),
    (eq,":var001","$g_battle_map_plane"),
    (get_scene_boundaries,s2,3),
    (mouse_get_position, pos1),
    (set_fixed_point_multiplier, 1000),
    (position_get_x,":pos_x_006",1),
    (position_get_y,":pos_y_007",1),
    (store_sub, ":var008", 980, "$g_battle_map_width"),
    (store_sub, ":var009", 730, "$g_battle_map_height"),
    (val_sub, ":pos_x_006", ":var008"),
    (val_sub, ":pos_y_007", ":var009"),
    (val_clamp,":pos_x_006",0, "$g_battle_map_width"),
    (val_clamp,":pos_y_007",0, "$g_battle_map_height"),
    (val_mul, ":pos_x_006", "$g_battle_map_scale"),
    (val_mul, ":pos_y_007", "$g_battle_map_scale"),
    (set_fixed_point_multiplier, 1000),
    (position_set_x,1,":pos_x_006"),
    (position_set_y,1,":pos_y_007"),
    (position_transform_position_to_parent,3,2,1),
    (try_begin),
        (eq,"$g_formation_group0_selected",1),
        (team_give_order, ":agent_team_no_004", 0, 0),
        (team_set_order_position, ":agent_team_no_004", 0, 3),
    (try_end),
    (try_begin),
        (eq,"$g_formation_group1_selected",1),
        (team_give_order, ":agent_team_no_004", 1, 0),
        (team_set_order_position, ":agent_team_no_004", 1, 3),
    (try_end),
    (try_begin),
        (eq,"$g_formation_group2_selected",1),
        (team_give_order, ":agent_team_no_004", 2, 0),
        (team_set_order_position, ":agent_team_no_004", 2, 3),
    (try_end),
    (try_begin),
        (eq,"$g_formation_group3_selected",1),
        (team_give_order, ":agent_team_no_004", 3, 0),
        (team_set_order_position, ":agent_team_no_004", 3, 3),
    (try_end),
    (try_begin),
        (eq,"$g_formation_group4_selected",1),
        (team_give_order, ":agent_team_no_004", 4, 0),
        (team_set_order_position, ":agent_team_no_004", 4, 3),
    (try_end),
    (try_begin),
        (eq,"$g_formation_group5_selected",1),
        (team_give_order, ":agent_team_no_004", 5, 0),
        (team_set_order_position, ":agent_team_no_004", 5, 3),
    (try_end),
    (try_begin),
        (eq,"$g_formation_group6_selected",1),
        (team_give_order, ":agent_team_no_004", 6, 0),
        (team_set_order_position, ":agent_team_no_004", 6, 3),
    (try_end),
    (try_begin),
        (eq,"$g_formation_group7_selected",1),
        (team_give_order, ":agent_team_no_004", 7, 0),
        (team_set_order_position, ":agent_team_no_004", 7, 3),
    (try_end),
    (try_begin),
        (eq,"$g_formation_group8_selected",1),
        (team_give_order, ":agent_team_no_004", 8, 0),
        (team_set_order_position, ":agent_team_no_004", 8, 3),
    (try_end),
    (call_script, "script_update_order_flags_on_map"),
    (call_script, "script_update_order_panel", ":agent_team_no_004"),
(try_end),
(try_begin),
    (eq,":var005",1),
    (team_set_order_listener, ":agent_team_no_004", -1),
    (try_begin),
        (this_or_next|eq,"$g_formation_group0_selected",1),
        (eq,"$group0_has_troops",0),
        (this_or_next|eq,"$g_formation_group1_selected",1),
        (eq,"$group1_has_troops",0),
        (this_or_next|eq,"$g_formation_group2_selected",1),
        (eq,"$group2_has_troops",0),
        (this_or_next|eq,"$g_formation_group3_selected",1),
        (eq,"$group3_has_troops",0),
        (this_or_next|eq,"$g_formation_group4_selected",1),
        (eq,"$group4_has_troops",0),
        (this_or_next|eq,"$g_formation_group5_selected",1),
        (eq,"$group5_has_troops",0),
        (this_or_next|eq,"$g_formation_group6_selected",1),
        (eq,"$group6_has_troops",0),
        (this_or_next|eq,"$g_formation_group7_selected",1),
        (eq,"$group7_has_troops",0),
        (this_or_next|eq,"$g_formation_group8_selected",1),
        (eq,"$group8_has_troops",0),
        (team_set_order_listener, ":agent_team_no_004", 9),
    (else_try),
        (eq,"$g_formation_group0_selected",1),
        (team_set_order_listener, ":agent_team_no_004", 0, 1),
    (else_try),
        (eq,"$g_formation_group1_selected",1),
        (team_set_order_listener, ":agent_team_no_004", 1, 1),
    (else_try),
        (eq,"$g_formation_group2_selected",1),
        (team_set_order_listener, ":agent_team_no_004", 2, 1),
    (else_try),
        (eq,"$g_formation_group3_selected",1),
        (team_set_order_listener, ":agent_team_no_004", 3, 1),
    (else_try),
        (eq,"$g_formation_group4_selected",1),
        (team_set_order_listener, ":agent_team_no_004", 4, 1),
    (else_try),
        (eq,"$g_formation_group5_selected",1),
        (team_set_order_listener, ":agent_team_no_004", 5, 1),
    (else_try),
        (eq,"$g_formation_group6_selected",1),
        (team_set_order_listener, ":agent_team_no_004", 6, 1),
    (else_try),
        (eq,"$g_formation_group7_selected",1),
        (team_set_order_listener, ":agent_team_no_004", 7, 1),
    (else_try),
        (eq,"$g_formation_group8_selected",1),
        (team_set_order_listener, ":agent_team_no_004", 8, 1),
    (try_end),
(try_end),
]),

(ti_on_presentation_mouse_enter_leave, [
(try_begin),
    (eq,":var001","$g_presentation_obj_battle_but0"),
    (try_begin),
        (eq,":var002",0),
        (overlay_animate_to_color, "$g_presentation_but0_movement", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but0_riding", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but0_weapon_usage", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name0", 250, 16777215),
    (else_try),
        (overlay_animate_to_color, "$g_presentation_but0_movement", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but0_riding", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but0_weapon_usage", 250, 0),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name0", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but1"),
    (try_begin),
        (eq,":var002",0),
        (overlay_animate_to_color, "$g_presentation_but1_movement", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but1_riding", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but1_weapon_usage", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name1", 250, 16777215),
    (else_try),
        (overlay_animate_to_color, "$g_presentation_but1_movement", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but1_riding", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but1_weapon_usage", 250, 0),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name1", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but2"),
    (try_begin),
        (eq,":var002",0),
        (overlay_animate_to_color, "$g_presentation_but2_movement", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but2_riding", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but2_weapon_usage", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name2", 250, 16777215),
    (else_try),
        (overlay_animate_to_color, "$g_presentation_but2_movement", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but2_riding", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but2_weapon_usage", 250, 0),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name2", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but3"),
    (try_begin),
        (eq,":var002",0),
        (overlay_animate_to_color, "$g_presentation_but3_movement", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but3_riding", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but3_weapon_usage", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name3", 250, 16777215),
    (else_try),
        (overlay_animate_to_color, "$g_presentation_but3_movement", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but3_riding", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but3_weapon_usage", 250, 0),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name3", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but4"),
    (try_begin),
        (eq,":var002",0),
        (overlay_animate_to_color, "$g_presentation_but4_movement", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but4_riding", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but4_weapon_usage", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name4", 250, 16777215),
    (else_try),
        (overlay_animate_to_color, "$g_presentation_but4_movement", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but4_riding", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but4_weapon_usage", 250, 0),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name4", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but5"),
    (try_begin),
        (eq,":var002",0),
        (overlay_animate_to_color, "$g_presentation_but5_movement", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but5_riding", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but5_weapon_usage", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name5", 250, 16777215),
    (else_try),
        (overlay_animate_to_color, "$g_presentation_but5_movement", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but5_riding", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but5_weapon_usage", 250, 0),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name5", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but6"),
    (try_begin),
        (eq,":var002",0),
        (overlay_animate_to_color, "$g_presentation_but6_movement", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but6_riding", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but6_weapon_usage", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name6", 250, 16777215),
    (else_try),
        (overlay_animate_to_color, "$g_presentation_but6_movement", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but6_riding", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but6_weapon_usage", 250, 0),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name6", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but7"),
    (try_begin),
        (eq,":var002",0),
        (overlay_animate_to_color, "$g_presentation_but7_movement", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but7_riding", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but7_weapon_usage", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name7", 250, 16777215),
    (else_try),
        (overlay_animate_to_color, "$g_presentation_but7_movement", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but7_riding", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but7_weapon_usage", 250, 0),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name7", 250, 0),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_battle_but8"),
    (try_begin),
        (eq,":var002",0),
        (overlay_animate_to_color, "$g_presentation_but8_movement", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but8_riding", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_but8_weapon_usage", 250, 16777215),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name8", 250, 16777215),
    (else_try),
        (overlay_animate_to_color, "$g_presentation_but8_movement", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but8_riding", 250, 0),
        (overlay_animate_to_color, "$g_presentation_but8_weapon_usage", 250, 0),
        (overlay_animate_to_color, "$g_presentation_obj_battle_name8", 250, 0),
    (try_end),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (this_or_next|game_key_clicked, 30),
    (this_or_next|game_key_clicked, 31),
    (this_or_next|game_key_clicked, 32),
    (this_or_next|game_key_clicked, 33),
    (this_or_next|game_key_clicked, 34),
    (this_or_next|game_key_clicked, 35),
    (this_or_next|game_key_clicked, 36),
    (this_or_next|game_key_clicked, 37),
    (this_or_next|game_key_clicked, 38),
    (this_or_next|game_key_clicked, 29),
    (game_key_clicked, 39),
    (call_script, "script_update_order_panel_checked_classes"),
(try_end),
(try_begin),
    (this_or_next|game_key_clicked, 23),
    (this_or_next|game_key_clicked, 24),
    (this_or_next|game_key_clicked, 25),
    (this_or_next|game_key_clicked, 26),
    (this_or_next|game_key_clicked, 27),
    (game_key_clicked, 28),
    (get_player_agent_no,":agent_no_002"),
    (agent_get_team, ":agent_team_no_003", ":agent_no_002"),
    (call_script, "script_update_order_panel", ":agent_team_no_003"),
(try_end),
(try_begin),
    (gt,":var001",200),
    (game_key_clicked, 22),
    (try_for_agents, ":cur_agent"),
        (agent_set_slot,":cur_agent",10,0),
    (try_end),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("sliders",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_slider_overlay, "$g_presentation_obj_sliders_1", 0, 100),
(create_slider_overlay, "$g_presentation_obj_sliders_2", 0, 100),
(create_slider_overlay, "$g_presentation_obj_sliders_3", 0, 100),
(create_slider_overlay, "$g_presentation_obj_sliders_4", 0, 100),
(assign,reg1,25),
(str_store_string,s1,"str_reg1"),
(create_text_overlay, "$g_presentation_obj_sliders_5", 1),
(create_text_overlay, "$g_presentation_obj_sliders_6", 1),
(create_text_overlay, "$g_presentation_obj_sliders_7", 1),
(create_text_overlay, "$g_presentation_obj_sliders_8", 1),
(assign,"$g_presentation_obj_sliders_1_val",25),
(overlay_set_val, "$g_presentation_obj_sliders_1", 25),
(assign,"$g_presentation_obj_sliders_2_val",25),
(overlay_set_val, "$g_presentation_obj_sliders_2", 25),
(assign,"$g_presentation_obj_sliders_3_val",25),
(overlay_set_val, "$g_presentation_obj_sliders_3", 25),
(assign,"$g_presentation_obj_sliders_4_val",25),
(overlay_set_val, "$g_presentation_obj_sliders_4", 25),
(position_set_x,1,600),
(position_set_y,1,200),
(overlay_set_position, "$g_presentation_obj_sliders_1", 1),
(position_set_y,1,300),
(overlay_set_position, "$g_presentation_obj_sliders_2", 1),
(position_set_y,1,400),
(overlay_set_position, "$g_presentation_obj_sliders_3", 1),
(position_set_y,1,500),
(overlay_set_position, "$g_presentation_obj_sliders_4", 1),
(position_set_x,1,800),
(position_set_y,1,200),
(overlay_set_position, "$g_presentation_obj_sliders_5", 1),
(position_set_y,1,300),
(overlay_set_position, "$g_presentation_obj_sliders_6", 1),
(position_set_y,1,400),
(overlay_set_position, "$g_presentation_obj_sliders_7", 1),
(position_set_y,1,500),
(overlay_set_position, "$g_presentation_obj_sliders_8", 1),
(position_set_x,1,500),
(overlay_set_size, "$g_presentation_obj_sliders_3", 1),
]),

(ti_on_presentation_run, [
]),

(ti_on_presentation_event_state_change, [
(assign,":var003",0),
(try_begin),
    (eq,":var001","$g_presentation_obj_sliders_1"),
    (try_begin),
        (neq,"$g_presentation_obj_sliders_1_val",":var002"),
        (assign,"$g_presentation_obj_sliders_1_val",":var002"),
        (assign,":var003",1),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_sliders_2"),
    (try_begin),
        (neq,"$g_presentation_obj_sliders_2_val",":var002"),
        (assign,"$g_presentation_obj_sliders_2_val",":var002"),
        (assign,":var003",1),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_sliders_3"),
    (try_begin),
        (neq,"$g_presentation_obj_sliders_3_val",":var002"),
        (assign,"$g_presentation_obj_sliders_3_val",":var002"),
        (assign,":var003",1),
    (try_end),
(else_try),
    (eq,":var001","$g_presentation_obj_sliders_4"),
    (try_begin),
        (neq,"$g_presentation_obj_sliders_4_val",":var002"),
        (assign,"$g_presentation_obj_sliders_4_val",":var002"),
        (assign,":var003",1),
    (try_end),
(try_end),
(try_begin),
    (eq,":var003",1),
    (assign,":var004",0),
    (val_add, ":var004", "$g_presentation_obj_sliders_1_val"),
    (val_add, ":var004", "$g_presentation_obj_sliders_2_val"),
    (val_add, ":var004", "$g_presentation_obj_sliders_3_val"),
    (val_add, ":var004", "$g_presentation_obj_sliders_4_val"),
    (store_sub, ":var005", 100, ":var004"),
    (assign,":var006","$g_presentation_obj_sliders_1_val"),
    (assign,":var007","$g_presentation_obj_sliders_2_val"),
    (assign,":var008","$g_presentation_obj_sliders_3_val"),
    (assign,":var009","$g_presentation_obj_sliders_4_val"),
    (assign,":var010",1),
    (assign,":var011",0),
    (assign,":var012",100),
    (try_begin),
        (lt,":var005",0),
        (val_mul, ":var005", -1),
        (assign,":var010",-1),
        (assign,":var011",1),
        (assign,":var012",101),
    (try_end),
    (store_sub, ":var013", ":var004", ":var002"),
    (val_add, ":var013", 30),
    (try_for_range, ":var014", 0, ":var005"),
        (store_random_in_range,":random_x_015",0,":var013"),
        (try_begin),
            (neq,":var001","$g_presentation_obj_sliders_1"),
            (val_sub, ":random_x_015", "$g_presentation_obj_sliders_1_val"),
            (val_sub, ":random_x_015", 10),
            (try_begin),
                (lt,":random_x_015",0),
                (is_between,":var006",":var011",":var012"),
                (val_add, ":var006", ":var010"),
            (else_try),
                (neq,":var001","$g_presentation_obj_sliders_2"),
                (val_sub, ":random_x_015", "$g_presentation_obj_sliders_2_val"),
                (val_sub, ":random_x_015", 10),
                (try_begin),
                    (lt,":random_x_015",0),
                    (is_between,":var007",":var011",":var012"),
                    (val_add, ":var007", ":var010"),
                (else_try),
                    (neq,":var001","$g_presentation_obj_sliders_3"),
                    (val_sub, ":random_x_015", "$g_presentation_obj_sliders_3_val"),
                    (val_sub, ":random_x_015", 10),
                    (try_begin),
                        (lt,":random_x_015",0),
                        (is_between,":var008",":var011",":var012"),
                        (val_add, ":var008", ":var010"),
                    (else_try),
                        (is_between,":var009",":var011",":var012"),
                        (val_add, ":var009", ":var010"),
                    (else_try),
                        (val_add, ":var005", 1),
                    (try_end),
                (try_end),
            (try_end),
        (try_end),
    (try_end),
    (assign,"$g_presentation_obj_sliders_1_val",":var006"),
    (assign,"$g_presentation_obj_sliders_2_val",":var007"),
    (assign,"$g_presentation_obj_sliders_3_val",":var008"),
    (assign,"$g_presentation_obj_sliders_4_val",":var009"),
(try_end),
(overlay_set_val, "$g_presentation_obj_sliders_1", "$g_presentation_obj_sliders_1_val"),
(overlay_set_val, "$g_presentation_obj_sliders_2", "$g_presentation_obj_sliders_2_val"),
(overlay_set_val, "$g_presentation_obj_sliders_3", "$g_presentation_obj_sliders_3_val"),
(overlay_set_val, "$g_presentation_obj_sliders_4", "$g_presentation_obj_sliders_4_val"),
(assign,reg1,"$g_presentation_obj_sliders_1_val"),
(str_store_string,s1,"str_reg1"),
(overlay_set_text, "$g_presentation_obj_sliders_5", 1),
(assign,reg1,"$g_presentation_obj_sliders_2_val"),
(str_store_string,s1,"str_reg1"),
(overlay_set_text, "$g_presentation_obj_sliders_6", 1),
(assign,reg1,"$g_presentation_obj_sliders_3_val"),
(str_store_string,s1,"str_reg1"),
(overlay_set_text, "$g_presentation_obj_sliders_7", 1),
(assign,reg1,"$g_presentation_obj_sliders_4_val"),
(str_store_string,s1,"str_reg1"),
(overlay_set_text, "$g_presentation_obj_sliders_8", 1),
]),

]),
("arena_training",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(presentation_set_duration, 999999),
(set_fixed_point_multiplier, 1000),
(get_player_agent_no,":agent_no_001"),
(agent_get_kill_count,reg1,":agent_no_001",1),
(str_store_string,s1,"@Number of men knocked down: {reg1}"),
(create_text_overlay, "$g_presentation_obj_arena_training_1", 1),
(overlay_set_color, "$g_presentation_obj_arena_training_1", 16777215),
(position_set_x,1,10),
(position_set_y,1,700),
(overlay_set_position, "$g_presentation_obj_arena_training_1", 1),
(assign,reg1,0),
(str_store_string,s1,"@Number of men left: {reg1}"),
(create_text_overlay, "$g_presentation_obj_arena_training_2", 1),
(overlay_set_color, "$g_presentation_obj_arena_training_2", 16777215),
(position_set_x,1,10),
(position_set_y,1,670),
(overlay_set_position, "$g_presentation_obj_arena_training_2", 1),
]),

(ti_on_presentation_run, [
(get_player_agent_no,":agent_no_001"),
(agent_get_kill_count,reg1,":agent_no_001",1),
(str_store_string,s1,"@Opponents Beaten: {reg1}"),
(overlay_set_text, "$g_presentation_obj_arena_training_1", 1),
(assign,":var002","$g_arena_training_max_opponents"),
(try_for_agents, ":cur_agent"),
    (try_begin),
        (agent_is_human,":cur_agent"),
        (neg|agent_is_alive,":cur_agent"),
        (neq,":cur_agent",":agent_no_001"),
        (val_sub, ":var002", 1),
    (try_end),
(try_end),
(assign,reg1,":var002"),
(str_store_string,s1,"@Opponents Remaining: {reg1}"),
(overlay_set_text, "$g_presentation_obj_arena_training_2", 1),
]),

]),
("retirement",0,mesh_load_window,[

(ti_on_presentation_load, [
(presentation_set_duration, 999999),
(set_fixed_point_multiplier, 1000),
(create_button_overlay, "$g_presentation_obj_retirement_1", "@Remain in retirement."),
(create_button_overlay, "$g_presentation_obj_retirement_2", "@Go back to the adventuring."),
(position_set_x,1,500),
(position_set_y,1,80),
(overlay_set_position, "$g_presentation_obj_retirement_1", 1),
(position_set_y,1,40),
(overlay_set_position, "$g_presentation_obj_retirement_2", 1),
(assign,":var001",0),
(store_troop_gold,":troop_gold_002","trp_player"),
(store_div, ":var___x1", ":troop_gold_002", 200),
(assign,":var003",":var___x1"),
(val_add, ":var001", ":var003"),
(assign,":var004",0),
(assign,":var005",0),
(assign,":var006",0),
(assign,":var007",0),
(assign,":var008",0),
(assign,":var009",0),
(assign,":var010",0),
(try_for_range, ":p_011", ":p.town_1", ":p.salt_mine"),
    (party_get_slot,":party_slot_012",":p_011",0),
    (try_begin),
        (party_slot_eq,":p_011",7,"trp_player"),
        (try_begin),
            (eq,":party_slot_012",3),
            (val_add, ":var004", 1),
        (else_try),
            (eq,":party_slot_012",2),
            (val_add, ":var005", 1),
        (else_try),
            (val_add, ":var006", 1),
        (try_end),
    (try_end),
    (party_get_slot,":party_slot_013",":p_011",26),
    (try_begin),
        (ge,":party_slot_013",40),
        (try_begin),
            (eq,":party_slot_012",3),
            (val_add, ":var007", 1),
        (else_try),
            (eq,":party_slot_012",4),
            (val_add, ":var008", 1),
        (try_end),
    (else_try),
        (le,":party_slot_013",-40),
        (try_begin),
            (eq,":party_slot_012",3),
            (val_add, ":var009", 1),
        (else_try),
            (eq,":party_slot_012",4),
            (val_add, ":var010", 1),
        (try_end),
    (try_end),
(try_end),
(store_mul, ":var014", ":var004", 100),
(store_mul, ":var015", ":var005", 50),
(store_mul, ":var016", ":var006", 20),
(store_add, ":var017", ":var004", ":var005"),
(val_add, ":var017", ":var006"),
(store_add, ":var018", ":var014", ":var015"),
(val_add, ":var018", ":var016"),
(val_add, ":var001", ":var018"),
(store_mul, ":var019", ":var007", 20),
(store_mul, ":var020", ":var008", 4),
(store_add, ":var021", ":var007", ":var008"),
(store_add, ":var022", ":var019", ":var020"),
(val_add, ":var001", ":var022"),
(store_mul, ":var023", ":var009", -40),
(store_mul, ":var024", ":var010", -8),
(store_add, ":var025", ":var009", ":var010"),
(store_add, ":var026", ":var023", ":var024"),
(val_add, ":var001", ":var026"),
(assign,":var027",0),
(troop_get_inventory_capacity,":troop_inv_capacity_028","trp_player"),
(try_for_range, ":inventory_slot_no_029", 0, ":troop_inv_capacity_028"),
    (troop_get_inventory_slot,":troop_inv_slot_030","trp_player",":inventory_slot_no_029"),
    (try_begin),
        (ge,":troop_inv_slot_030",0),
        (store_item_value,":item_value_031",":troop_inv_slot_030"),
        (val_add, ":var027", ":item_value_031"),
    (try_end),
(try_end),
(store_div, ":var___x1", ":var027", 200),
(assign,":var032",":var___x1"),
(val_add, ":var001", ":var032"),
(troop_get_slot,":troop_slot_033","trp_player",7),
(store_div, ":var___x1", ":troop_slot_033", 1),
(assign,":var034",":var___x1"),
(val_add, ":var001", ":var034"),
(assign,":var035",0),
(assign,":var036",0),
(try_for_range, ":trp_037", ":trp.npc1", ":trp.heroes_end"),
    (try_begin),
        (this_or_next|troop_slot_eq,":trp_037",2,2),
        (troop_slot_eq,":trp_037",2,6),
        (call_script, "script_troop_get_player_relation", ":trp_037"),
        (assign,":party_slot_013",reg0),
        (try_begin),
            (ge,":party_slot_013",40),
            (val_add, ":var036", 1),
        (else_try),
            (le,":party_slot_013",-40),
            (val_add, ":var035", 1),
        (try_end),
    (try_end),
(try_end),
(store_mul, ":var038", ":var036", 10),
(val_add, ":var001", ":var038"),
(store_mul, ":var039", ":var035", -10),
(val_add, ":var001", ":var039"),
(store_current_day,":cur_day_040"),
(store_div, ":var___x1", ":cur_day_040", -1),
(assign,":var041",":var___x1"),
(val_add, ":var001", ":var041"),
(store_mul, ":var042", "$g_total_victories", 2),
(val_add, ":var001", ":var042"),
(store_mul, ":var043", "$g_total_defeats", -3),
(val_add, ":var001", ":var043"),
(store_mul, ":var044", "$g_total_quests_completed", 4),
(val_add, ":var001", ":var044"),
(troop_get_xp, ":troop_xp_045", "trp_player"),
(store_div, ":var___x1", ":troop_xp_045", 5000),
(assign,":var046",":var___x1"),
(val_add, ":var001", ":var046"),
(assign,":var047",0),
(assign,":var048",0),
(try_for_range, ":trp_037", ":trp.npc1", ":trp.kingdom_1_lord"),
    (try_begin),
        (troop_slot_eq,":trp_037",2,5),
        (val_add, ":var047", 1),
    (else_try),
        (troop_slot_ge,":trp_037",82,1),
        (val_add, ":var048", 1),
    (try_end),
(try_end),
(store_div, ":var___x1", ":var047", 2),
(assign,":var049",":var___x1"),
(val_add, ":var001", ":var049"),
(store_div, ":var___x1", ":var048", -4),
(assign,":var050",":var___x1"),
(val_add, ":var001", ":var050"),
(get_average_game_difficulty, ":average_game_difficulty"),
(assign,":var052",":var001"),
(val_mul, ":var001", ":average_game_difficulty"),
(val_div, ":var001", 75),
(val_mul, ":var001", ":average_game_difficulty"),
(val_div, ":var001", 75),
(store_sub, ":var052", ":var001", ":var052"),
(assign,reg5,":cur_day_040"),
(store_character_level,reg4,"trp_player"),
(create_text_overlay, reg1, "@You have retired at level {reg4} after {reg5} days of adventuring."),
(position_set_x,1,700),
(position_set_y,1,700),
(overlay_set_position, reg1, 1),
(position_set_x,1,950),
(position_set_y,1,950),
(overlay_set_size, reg1, 1),
(create_text_overlay, reg2, "@Effect on Score"),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg2, 1),
(position_set_x,1,850),
(position_set_y,1,670),
(overlay_set_position, reg2, 1),
(assign,reg0,":var017"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,650),
(overlay_set_position, reg1, 1),
(assign,reg0,":var018"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,650),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,":var021"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,630),
(overlay_set_position, reg1, 1),
(assign,reg0,":var022"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,630),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,":var025"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,610),
(overlay_set_position, reg1, 1),
(assign,reg0,":var026"),
(create_text_overlay, reg1, "@{!}{reg0}"),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,610),
(overlay_set_position, reg1, 1),
(try_begin),
    (lt,reg0,0),
    (overlay_set_color, reg1, 16711680),
(try_end),
(assign,reg0,":var036"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,590),
(overlay_set_position, reg1, 1),
(assign,reg0,":var038"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,590),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,":var035"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,570),
(overlay_set_position, reg1, 1),
(assign,reg0,":var039"),
(create_text_overlay, reg1, "@{!}{reg0}"),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,570),
(overlay_set_position, reg1, 1),
(try_begin),
    (lt,reg0,0),
    (overlay_set_color, reg1, 16711680),
(try_end),
(assign,reg0,"$g_total_victories"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,550),
(overlay_set_position, reg1, 1),
(assign,reg0,":var042"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,550),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,"$g_total_defeats"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,530),
(overlay_set_position, reg1, 1),
(assign,reg0,":var043"),
(create_text_overlay, reg1, "@{!}{reg0}"),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,530),
(overlay_set_position, reg1, 1),
(try_begin),
    (lt,reg0,0),
    (overlay_set_color, reg1, 16711680),
(try_end),
(assign,reg0,"$g_total_quests_completed"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,510),
(overlay_set_position, reg1, 1),
(assign,reg0,":var044"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,510),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,":var047"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,490),
(overlay_set_position, reg1, 1),
(assign,reg0,":var049"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,490),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,":var048"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,470),
(overlay_set_position, reg1, 1),
(assign,reg0,":var050"),
(create_text_overlay, reg1, "@{!}{reg0}"),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,470),
(overlay_set_position, reg1, 1),
(try_begin),
    (lt,reg0,0),
    (overlay_set_color, reg1, 16711680),
(try_end),
(assign,reg0,":troop_gold_002"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,450),
(overlay_set_position, reg1, 1),
(assign,reg0,":var003"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,450),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,":var027"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,430),
(overlay_set_position, reg1, 1),
(assign,reg0,":var032"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,430),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,":troop_slot_033"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,410),
(overlay_set_position, reg1, 1),
(assign,reg0,":var034"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,410),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,":troop_xp_045"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,390),
(overlay_set_position, reg1, 1),
(assign,reg0,":var046"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,390),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(try_end),
(assign,reg0,":cur_day_040"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,370),
(overlay_set_position, reg1, 1),
(assign,reg0,":var041"),
(create_text_overlay, reg1, "@{!}{reg0}"),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,370),
(overlay_set_position, reg1, 1),
(try_begin),
    (lt,reg0,0),
    (overlay_set_color, reg1, 16711680),
(try_end),
(assign,reg0,":average_game_difficulty"),
(create_text_overlay, reg1, 0),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,600),
(position_set_y,1,350),
(overlay_set_position, reg1, 1),
(assign,reg0,":var052"),
(assign,reg3,reg0),
(val_max,reg3,0),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg1, 1),
(position_set_x,1,850),
(position_set_y,1,350),
(overlay_set_position, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(else_try),
    (lt,reg0,0),
    (overlay_set_color, reg1, 16711680),
(try_end),
(assign,reg0,":var001"),
(create_text_overlay, reg1, 16),
(position_set_x,1,750),
(position_set_y,1,320),
(overlay_set_position, reg1, 1),
(assign,":var053",0),
(assign,":var054",0),
(assign,":var055",0),
(assign,":var056",0),
(assign,":var057",0),
(assign,":var058",0),
(try_for_range, ":p_059", ":p.town_1", ":p.salt_mine"),
    (try_begin),
        (party_slot_eq,":p_059",7,"trp_player"),
        (try_begin),
            (party_slot_eq,":p_059",0,3),
            (val_add, ":var055", 1),
        (else_try),
            (party_slot_eq,":p_059",0,2),
            (val_add, ":var054", 1),
        (else_try),
            (val_add, ":var053", 1),
        (try_end),
    (else_try),
        (party_get_slot,":party_slot_060",":p_059",26),
        (try_begin),
            (gt,":party_slot_060",0),
            (try_begin),
                (party_slot_eq,":p_059",0,3),
                (val_add, ":var058", ":party_slot_060"),
            (else_try),
                (party_slot_eq,":p_059",0,2),
                (val_add, ":var057", ":party_slot_060"),
            (else_try),
                (val_add, ":var056", ":party_slot_060"),
            (try_end),
        (try_end),
    (try_end),
(try_end),
(try_begin),
    (gt,":var055",0),
    (store_random_in_range,":random_x_061",0,":var055"),
    (try_for_range, ":p_059", ":p.town_1", ":p.castle_1"),
        (try_begin),
            (party_slot_eq,":p_059",7,"trp_player"),
            (val_sub, ":random_x_061", 1),
            (try_begin),
                (lt,":random_x_061",0),
                (str_store_party_name,s9,":p_059"),
            (try_end),
        (try_end),
    (try_end),
(else_try),
    (gt,":var058",0),
    (store_random_in_range,":random_x_062",0,":var058"),
    (try_for_range, ":p_059", ":p.town_1", ":p.castle_1"),
        (party_get_slot,":party_slot_060",":p_059",26),
        (try_begin),
            (gt,":party_slot_060",0),
            (val_sub, ":random_x_062", ":party_slot_060"),
            (try_begin),
                (lt,":random_x_062",0),
                (str_store_party_name,s9,":p_059"),
            (try_end),
        (try_end),
    (try_end),
(else_try),
    (store_random_in_range,":random_x_061","p_town_1","p_castle_1"),
    (str_store_party_name,s9,":random_x_061"),
(try_end),
(try_begin),
    (gt,":var054",0),
    (store_random_in_range,":random_x_063",0,":var054"),
    (try_for_range, ":p_059", ":p.castle_1", ":p.village_1"),
        (try_begin),
            (party_slot_eq,":p_059",7,"trp_player"),
            (val_sub, ":random_x_063", 1),
            (try_begin),
                (lt,":random_x_063",0),
                (str_store_party_name,s8,":p_059"),
            (try_end),
        (try_end),
    (try_end),
(else_try),
    (gt,":var057",0),
    (store_random_in_range,":random_x_064",0,":var057"),
    (try_for_range, ":p_059", ":p.castle_1", ":p.village_1"),
        (party_get_slot,":party_slot_060",":p_059",26),
        (try_begin),
            (gt,":party_slot_060",0),
            (val_sub, ":random_x_064", ":party_slot_060"),
            (try_begin),
                (lt,":random_x_064",0),
                (str_store_party_name,s8,":p_059"),
            (try_end),
        (try_end),
    (try_end),
(else_try),
    (store_random_in_range,":random_x_063","p_castle_1","p_village_1"),
    (str_store_party_name,s8,":random_x_063"),
(try_end),
(try_begin),
    (gt,":var053",0),
    (store_random_in_range,":random_x_065",0,":var053"),
    (try_for_range, ":p_059", ":p.village_1", ":p.salt_mine"),
        (try_begin),
            (party_slot_eq,":p_059",7,"trp_player"),
            (val_sub, ":random_x_065", 1),
            (try_begin),
                (lt,":random_x_065",0),
                (str_store_party_name,s7,":p_059"),
            (try_end),
        (try_end),
    (try_end),
(else_try),
    (gt,":var056",0),
    (store_random_in_range,":random_x_066",0,":var056"),
    (try_for_range, ":p_059", ":p.village_1", ":p.salt_mine"),
        (party_get_slot,":party_slot_060",":p_059",26),
        (try_begin),
            (gt,":party_slot_060",0),
            (val_sub, ":random_x_066", ":party_slot_060"),
            (try_begin),
                (lt,":random_x_066",0),
                (str_store_party_name,s7,":p_059"),
            (try_end),
        (try_end),
    (try_end),
(else_try),
    (store_random_in_range,":random_x_065","p_village_1","p_salt_mine"),
    (str_store_party_name,s7,":random_x_065"),
(try_end),
(try_begin),
    (lt,":var001",100),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 0),
    (str_store_string,s0,"str_retirement_text_1"),
(else_try),
    (lt,":var001",200),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 1),
    (str_store_string,s0,"str_retirement_text_2"),
(else_try),
    (lt,":var001",400),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 2),
    (str_store_string,s0,"str_retirement_text_3"),
(else_try),
    (lt,":var001",700),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 3),
    (str_store_string,s0,"str_retirement_text_4"),
(else_try),
    (lt,":var001",1200),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 4),
    (str_store_string,s0,"str_retirement_text_5"),
(else_try),
    (lt,":var001",1850),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 5),
    (str_store_string,s0,"str_retirement_text_6"),
(else_try),
    (lt,":var001",2500),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 6),
    (str_store_string,s0,"str_retirement_text_7"),
(else_try),
    (lt,":var001",3500),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 7),
    (str_store_string,s0,"str_retirement_text_8"),
(else_try),
    (lt,":var001",5000),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 8),
    (str_store_string,s0,"str_retirement_text_9"),
(else_try),
    (create_mesh_overlay_with_tableau_material, reg1, -1, "tab_retirement_troop", 9),
    (str_store_string,s0,"str_retirement_text_10"),
(try_end),
(position_set_x,1,0),
(position_set_y,1,120),
(overlay_set_position, reg1, 1),
(create_text_overlay, reg1, 0),
(position_set_x,1,600),
(position_set_y,1,120),
(overlay_set_position, reg1, 1),
(position_set_x,1,360),
(position_set_y,1,190),
(overlay_set_area_size, reg1, 1),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, reg1, 1),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_retirement_1"),
    (jump_to_menu,"mnu_end_game"),
    (start_presentation, "prsnt_game_credits"),
(else_try),
    (eq,":var001","$g_presentation_obj_retirement_2"),
    (presentation_set_duration, 0),
    (change_screen_return),
(try_end),
]),

]),
("budget_report",0,mesh_load_window,[

(ti_on_presentation_load, [
(presentation_set_duration, 999999),
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, reg1, "mesh_pic_payment"),
(position_set_x,1,800),
(position_set_y,1,800),
(overlay_set_size, reg1, 1),
(position_set_x,1,170),
(position_set_y,1,0),
(overlay_set_position, reg1, 1),
(create_text_overlay, reg1, "str_weekly_budget"),
(position_set_x,1,1500),
(position_set_y,1,1500),
(overlay_set_size, reg1, 1),
(position_set_x,1,260),
(position_set_y,1,650),
(overlay_set_position, reg1, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_bugdet_report_container", 0),
(position_set_x,1,0),
(position_set_y,1,100),
(overlay_set_position, "$g_presentation_obj_bugdet_report_container", 1),
(position_set_x,1,505),
(position_set_y,1,500),
(overlay_set_area_size, "$g_presentation_obj_bugdet_report_container", 1),
(set_container_overlay, "$g_presentation_obj_bugdet_report_container"),
(game_get_reduce_campaign_ai, ":campaign_ai"),
(try_begin),
    (eq,":campaign_ai",0),
    (assign,":var002",2),
    (assign,":var003",5),
(else_try),
    (eq,":campaign_ai",1),
    (assign,":var002",4),
    (assign,":var003",4),
(else_try),
    (eq,":campaign_ai",2),
    (assign,":var002",6),
    (assign,":var003",3),
(try_end),
(assign,":var004",0),
(assign,":var005",0),
(assign,":var006",0),
(assign,":var007",0),
(try_for_range, ":p_008", ":p.town_1", ":p.salt_mine"),
    (try_begin),
        (party_slot_ge,":p_008",137,1),
        (val_add, ":var004", 1),
    (try_end),
    (try_begin),
        (party_slot_eq,":p_008",7,"trp_player"),
        (val_add, ":var004", 1),
        (val_add, ":var005", 1),
        (try_begin),
            (is_between,":p_008","p_town_1","p_castle_1"),
            (val_add, ":var004", 1),
            (val_add, ":var005", 1),
        (try_end),
    (try_end),
(try_end),
(try_begin),
    (gt,"$players_kingdom",0),
    (neq,"$players_kingdom","fac_player_supporters_faction"),
    (neq,"$players_kingdom","fac_player_faction"),
    (eq,"$player_has_homage",0),
    (val_add, ":var004", 1),
(try_end),
(try_begin),
    (gt,":var005",":var002"),
    (val_add, ":var004", 1),
(try_end),
(try_for_parties, ":cur_party"),
    (assign,":var010",0),
    (try_begin),
        (this_or_next|party_slot_eq,":cur_party",0,3),
        (party_slot_eq,":cur_party",0,2),
        (party_slot_eq,":cur_party",7,"trp_player"),
        (assign,":var010",1),
    (else_try),
        (this_or_next|party_slot_eq,":cur_party",0,3),
        (party_slot_eq,":cur_party",0,2),
        (neg|party_slot_ge,":cur_party",7,1),
        (store_faction_of_party, ":party_faction_011", ":cur_party"),
        (try_begin),
            (eq,":party_faction_011","fac_player_supporters_faction"),
            (faction_slot_eq,"fac_player_supporters_faction",11,"trp_player"),
            (assign,":var010",1),
        (try_end),
    (try_end),
    (try_begin),
        (this_or_next|eq,":cur_party","p_main_party"),
        (eq,":var010",1),
        (val_add, ":var004", 1),
    (try_end),
(try_end),
(try_begin),
    (gt,"$g_player_debt_to_party_members",0),
    (val_add, ":var004", 2),
(try_end),
(val_add, ":var004", 3),
(store_mul, ":var012", 27, ":var004"),
(assign,":var013",0),
(try_for_range, ":p_008", ":p.town_1", ":p.salt_mine"),
    (try_begin),
        (eq,1,1),
        (party_get_slot,":party_slot_014",":p_008",137),
        (try_begin),
            (gt,":party_slot_014",1),
            (neg|party_slot_ge,":p_008",139,1),
            (str_store_party_name,s0,":p_008"),
            (call_script, "script_process_player_enterprise", ":party_slot_014", ":p_008"),
            (assign,":var015",reg0),
            (assign,":var016",reg4),
            (assign,":var017",reg5),
            (assign,":var018",reg10),
            (store_sub, ":var019", ":p_008", ":p.town_1"),
            (store_add, ":troop_id_020", ":var019", ":trp.town_1_master_craftsman"),
            (item_get_slot,":item_slot_021",":party_slot_014",55),
            (assign,":add_amount_022",0),
            (try_begin),
                (party_slot_eq,":p_008",138,1),
                (assign,":var023",0),
                (troop_get_inventory_capacity,":troop_inv_capacity_024",":troop_id_020"),
                (try_for_range, ":inventory_slot_no_025", 0, ":troop_inv_capacity_024"),
                    (troop_get_inventory_slot,":troop_inv_slot_026",":troop_id_020",":inventory_slot_no_025"),
                    (try_begin),
                        (lt,":troop_inv_slot_026",1),
                        (val_add, ":var023", 1),
                    (try_end),
                (try_end),
            (try_end),
            (assign,":add_amount_022",":item_slot_021"),
            (val_min,":add_amount_022",":var023"),
            (try_begin),
                (gt,":add_amount_022",0),
                (store_mul, ":var027", ":var016", ":add_amount_022"),
                (val_sub, ":var015", ":var027"),
                (val_sub, ":item_slot_021", ":add_amount_022"),
            (try_end),
        (try_end),
        (try_begin),
            (eq,"$g_apply_budget_report_to_gold",1),
            (troop_add_items,":troop_id_020",":party_slot_014",":add_amount_022"),
            (store_sub, ":slot_no_028", ":party_slot_014", ":itm.spice"),
            (val_add, ":slot_no_028", 250),
            (party_get_slot,":party_slot_029",":p_008",":slot_no_028"),
            (store_mul, ":var030", ":item_slot_021", 15),
            (val_sub, ":party_slot_029", ":var030"),
            (party_set_slot,":p_008",":slot_no_028",":party_slot_029"),
            (try_begin),
                (gt,"$cheat_mode",0),
                (str_store_troop_name,s3,":troop_id_020"),
                (assign,reg3,":add_amount_022"),
                (display_message, "@@{!}DEBUG -- Adding {reg3} items to {s3}"),
            (try_end),
        (try_end),
        (item_get_slot,":item_slot_031",":party_slot_014",52),
        (try_begin),
            (item_slot_ge,":party_slot_014",57,1),
            (assign,":var032",":item_slot_031"),
        (else_try),
            (assign,":var032",0),
        (try_end),
        (assign,":remove_amount_033",0),
        (assign,":remove_amount_034",0),
        (try_begin),
            (eq,1,1),
            (troop_get_inventory_capacity,":troop_inv_capacity_024",":troop_id_020"),
            (try_for_range, ":inventory_slot_no_025", 0, ":troop_inv_capacity_024"),
                (troop_get_inventory_slot,":troop_inv_slot_035",":troop_id_020",":inventory_slot_no_025"),
                (try_begin),
                    (lt,":remove_amount_033",":item_slot_031"),
                    (item_slot_eq,":party_slot_014",50,":troop_inv_slot_035"),
                    (val_add, ":remove_amount_033", 1),
                (else_try),
                    (lt,":remove_amount_034",":var032"),
                    (item_slot_eq,":party_slot_014",57,":troop_inv_slot_035"),
                    (val_add, ":remove_amount_034", 1),
                (try_end),
            (try_end),
            (try_begin),
                (gt,":remove_amount_033",0),
                (val_sub, ":item_slot_031", ":remove_amount_033"),
                (store_mul, ":var036", ":var017", ":remove_amount_033"),
                (val_add, ":var015", ":var036"),
            (try_end),
            (try_begin),
                (gt,":remove_amount_034",0),
                (val_sub, ":var032", ":remove_amount_034"),
                (assign,":var036",":var018"),
                (val_add, ":var015", ":var036"),
            (try_end),
        (try_end),
        (try_begin),
            (eq,"$g_apply_budget_report_to_gold",1),
            (item_get_slot,":item_slot_037",":party_slot_014",50),
            (troop_remove_items,":troop_id_020",":item_slot_037",":remove_amount_033"),
            (item_get_slot,":item_slot_038",":party_slot_014",57),
            (troop_remove_items,":troop_id_020",":item_slot_038",":remove_amount_034"),
            (store_sub, ":slot_no_028", ":item_slot_037", ":itm.spice"),
            (val_add, ":slot_no_028", 250),
            (party_get_slot,":party_slot_029",":p_008",":slot_no_028"),
            (store_mul, ":var030", ":item_slot_021", 15),
            (val_add, ":party_slot_029", ":var030"),
            (party_set_slot,":p_008",":slot_no_028",":party_slot_029"),
            (try_begin),
                (gt,":var032",0),
                (store_sub, ":slot_no_028", ":item_slot_038", ":itm.spice"),
                (val_add, ":slot_no_028", 250),
                (party_get_slot,":party_slot_029",":p_008",":slot_no_028"),
                (val_add, ":party_slot_029", 15),
                (party_set_slot,":p_008",":slot_no_028",":party_slot_029"),
            (try_end),
        (try_end),
        (call_script, "script_get_enterprise_name", ":party_slot_014"),
        (str_store_string,s5,reg0),
        (create_text_overlay, reg1, "str_enterprise_s5_at_s0"),
        (position_set_x,1,900),
        (position_set_y,1,900),
        (overlay_set_size, reg1, 1),
        (position_set_x,1,25),
        (position_set_y,1,":var012"),
        (overlay_set_position, reg1, 1),
        (assign,reg0,":var015"),
        (try_begin),
            (eq,1,1),
            (store_faction_of_party, ":party_faction_039", ":p_008"),
            (store_relation,":faction_relation_040",":party_faction_039","$players_kingdom"),
            (try_begin),
                (lt,":faction_relation_040",0),
                (assign,reg0,0),
                (assign,":var015",0),
                (create_text_overlay, reg1, "str_under_sequestration"),
                (overlay_set_color, reg1, 16711680),
            (else_try),
                (ge,reg0,0),
                (create_text_overlay, reg1, "@{!}{reg0}"),
                (overlay_set_color, reg1, 43520),
            (else_try),
                (create_text_overlay, reg1, "@{!}{reg0}"),
                (overlay_set_color, reg1, 16711680),
            (try_end),
        (try_end),
        (val_add, ":var006", ":var015"),
        (val_add, ":var013", ":var015"),
        (position_set_x,1,900),
        (position_set_y,1,900),
        (overlay_set_size, reg1, 1),
        (position_set_x,1,500),
        (position_set_y,1,":var012"),
        (overlay_set_position, reg1, 1),
        (val_sub, ":var012", 27),
    (try_end),
    (try_begin),
        (party_slot_eq,":p_008",7,"trp_player"),
        (party_get_slot,":party_slot_041",":p_008",47),
        (party_get_slot,":party_slot_042",":p_008",48),
        (store_add, ":var043", ":party_slot_041", ":party_slot_042"),
        (val_add, ":var006", ":var043"),
        (val_add, ":var007", ":var043"),
        (val_add, ":var013", ":var043"),
        (str_store_party_name,s0,":p_008"),
        (create_text_overlay, reg1, "str_rents_from_s0"),
        (position_set_x,1,900),
        (position_set_y,1,900),
        (overlay_set_size, reg1, 1),
        (position_set_x,1,25),
        (position_set_y,1,":var012"),
        (overlay_set_position, reg1, 1),
        (try_begin),
            (gt,":party_slot_041",0),
            (assign,reg0,":party_slot_041"),
            (create_text_overlay, reg1, "@{!}{reg0}"),
            (overlay_set_color, reg1, 43520),
        (else_try),
            (create_text_overlay, reg1, "@None"),
        (try_end),
    (try_end),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (position_set_x,1,500),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (val_sub, ":var012", 27),
    (try_begin),
        (is_between,":p_008","p_town_1","p_castle_1"),
        (create_text_overlay, reg1, "str_tariffs_from_s0"),
        (position_set_x,1,900),
        (position_set_y,1,900),
        (overlay_set_size, reg1, 1),
        (position_set_x,1,25),
        (position_set_y,1,":var012"),
        (overlay_set_position, reg1, 1),
        (try_begin),
            (gt,":party_slot_042",0),
            (assign,reg0,":party_slot_042"),
            (create_text_overlay, reg1, "@{!}{reg0}"),
            (overlay_set_color, reg1, 43520),
        (else_try),
            (create_text_overlay, reg1, "@None"),
        (try_end),
        (position_set_x,1,900),
        (position_set_y,1,900),
        (overlay_set_size, reg1, 1),
        (position_set_x,1,500),
        (position_set_y,1,":var012"),
        (overlay_set_position, reg1, 1),
        (val_sub, ":var012", 27),
    (try_end),
(try_end),
(try_begin),
    (gt,"$players_kingdom",0),
    (neq,"$players_kingdom","fac_player_supporters_faction"),
    (neq,"$players_kingdom","fac_player_faction"),
    (eq,"$player_has_homage",0),
    (str_store_faction_name,s0,"$players_kingdom"),
    (create_text_overlay, reg1, "str_mercenary_payment_from_s0"),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (position_set_x,1,25),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (call_script, "script_party_calculate_strength", "p_main_party", 0),
    (assign,":var044",reg0),
    (val_div, ":var044", 2),
    (val_add, ":var044", 30),
    (call_script, "script_round_value", ":var044"),
    (val_add, ":var013", reg0),
    (create_text_overlay, reg1, "@{!}{reg0}"),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (overlay_set_color, reg1, 43520),
    (position_set_x,1,500),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (val_sub, ":var012", 27),
(try_end),
(try_begin),
    (gt,":var005",":var002"),
    (gt,":var006",0),
    (store_sub, ":var045", ":var005", ":var002"),
    (val_mul, ":var045", ":var003"),
    (val_min,":var045",65),
    (store_mul, ":var046", ":var007", ":var045"),
    (val_div, ":var046", 100),
    (val_sub, ":var013", ":var046"),
    (create_text_overlay, reg1, "str_loss_due_to_tax_inefficiency"),
    (position_set_x,1,25),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (store_mul, ":reg0", ":var046", -1),
    (create_text_overlay, reg1, "@{!}{reg0}"),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (overlay_set_color, reg1, 16711680),
    (position_set_x,1,500),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (val_sub, ":var012", 27),
(try_end),
(try_for_parties, ":cur_party"),
    (assign,":var010",0),
    (try_begin),
        (this_or_next|party_slot_eq,":cur_party",0,3),
        (party_slot_eq,":cur_party",0,2),
        (party_slot_eq,":cur_party",7,"trp_player"),
        (assign,":var010",1),
    (else_try),
        (this_or_next|party_slot_eq,":cur_party",0,3),
        (party_slot_eq,":cur_party",0,2),
        (neg|party_slot_ge,":cur_party",7,1),
        (store_faction_of_party, ":party_faction_011", ":cur_party"),
        (try_begin),
            (eq,":party_faction_011","fac_player_supporters_faction"),
            (faction_slot_eq,"fac_player_supporters_faction",11,"trp_player"),
            (assign,":var010",1),
        (try_end),
    (try_end),
    (try_begin),
        (this_or_next|eq,":cur_party","p_main_party"),
        (eq,":var010",1),
        (assign,":var047",0),
        (party_get_num_companion_stacks,":party_num_companions_stacks_048",":cur_party"),
        (try_for_range, ":stack_no_049", 0, ":party_num_companions_stacks_048"),
            (party_stack_get_troop_id,      ":troop_id_050",":cur_party",":stack_no_049"),
            (party_stack_get_size,          ":party_stack_size_051",":cur_party",":stack_no_049"),
            (call_script, "script_game_get_troop_wage", ":troop_id_050", ":cur_party"),
            (assign,":var052",reg0),
            (val_mul, ":var052", ":party_stack_size_051"),
            (val_add, ":var047", ":var052"),
        (try_end),
    (try_end),
    (try_begin),
        (eq,":var010",1),
        (val_div, ":var047", 2),
    (else_try),
        (eq,":cur_party","p_main_party"),
        (store_sub, ":var053", 14, "$g_cur_week_half_daily_wage_payments"),
        (val_mul, ":var047", ":var053"),
        (val_div, ":var047", 14),
    (try_end),
    (val_mul, ":var047", -1),
    (val_add, ":var013", ":var047"),
    (str_store_party_name,s0,":cur_party"),
    (try_begin),
        (eq,":cur_party","p_main_party"),
        (str_store_string,s0,"str_s0s_party"),
    (try_end),
    (create_text_overlay, reg1, "str_wages_for_s0"),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (position_set_x,1,25),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (try_begin),
        (lt,":var047",0),
        (assign,reg0,":var047"),
        (create_text_overlay, reg1, "@{!}{reg0}"),
        (overlay_set_color, reg1, 16711680),
    (else_try),
        (create_text_overlay, reg1, "@None"),
    (try_end),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (position_set_x,1,500),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (val_sub, ":var012", 27),
(try_end),
(try_begin),
    (gt,"$g_player_debt_to_party_members",0),
    (val_sub, ":var013", "$g_player_debt_to_party_members"),
    (create_text_overlay, reg1, "str_earlier_debts"),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (position_set_x,1,25),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (store_mul, ":reg0", "$g_player_debt_to_party_members", -1),
    (create_text_overlay, reg1, "@{!}{reg0}"),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (overlay_set_color, reg1, 16711680),
    (position_set_x,1,500),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (val_sub, ":var012", 27),
(try_end),
(create_mesh_overlay, reg1, "mesh_white_plane"),
(overlay_set_color, reg1, 0),
(position_set_x,1,24000),
(position_set_y,1,50),
(overlay_set_size, reg1, 1),
(position_set_x,1,25),
(store_add, ":var054", ":var012", 25),
(position_set_y,1,":var054"),
(overlay_set_position, reg1, 1),
(create_text_overlay, reg1, "str_net_change"),
(position_set_x,1,900),
(position_set_y,1,900),
(overlay_set_size, reg1, 1),
(position_set_x,1,25),
(position_set_y,1,":var012"),
(overlay_set_position, reg1, 1),
(assign,reg0,":var013"),
(create_text_overlay, reg1, "@{!}{reg0}"),
(position_set_x,1,900),
(position_set_y,1,900),
(overlay_set_size, reg1, 1),
(try_begin),
    (gt,reg0,0),
    (overlay_set_color, reg1, 43520),
(else_try),
    (lt,reg0,0),
    (overlay_set_color, reg1, 16711680),
(try_end),
(position_set_x,1,500),
(position_set_y,1,":var012"),
(overlay_set_position, reg1, 1),
(val_sub, ":var012", 27),
(create_text_overlay, reg1, "str_earlier_wealth"),
(position_set_x,1,900),
(position_set_y,1,900),
(overlay_set_size, reg1, 1),
(position_set_x,1,25),
(position_set_y,1,":var012"),
(overlay_set_position, reg1, 1),
(store_troop_gold,":troop_gold_055","trp_player"),
(assign,reg0,":troop_gold_055"),
(create_text_overlay, reg1, "@{!}{reg0}"),
(position_set_x,1,900),
(position_set_y,1,900),
(overlay_set_size, reg1, 1),
(position_set_x,1,500),
(position_set_y,1,":var012"),
(overlay_set_position, reg1, 1),
(val_sub, ":var012", 27),
(val_mul, ":var013", -1),
(try_begin),
    (ge,":troop_gold_055",":var013"),
    (assign,":gold_056",":var013"),
    (assign,":var057",0),
(else_try),
    (assign,":gold_056",":troop_gold_055"),
    (store_sub, ":var057", ":var013", ":troop_gold_055"),
(try_end),
(create_text_overlay, reg1, "str_new_wealth"),
(position_set_x,1,900),
(position_set_y,1,900),
(overlay_set_size, reg1, 1),
(position_set_x,1,25),
(position_set_y,1,":var012"),
(overlay_set_position, reg1, 1),
(store_sub, reg0, ":troop_gold_055", ":gold_056"),
(create_text_overlay, reg1, "@{!}{reg0}"),
(position_set_x,1,900),
(position_set_y,1,900),
(overlay_set_size, reg1, 1),
(position_set_x,1,500),
(position_set_y,1,":var012"),
(overlay_set_position, reg1, 1),
(val_sub, ":var012", 27),
(try_begin),
    (gt,":var057",0),
    (create_text_overlay, reg1, "str_new_debts"),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (position_set_x,1,25),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (assign,reg0,":var057"),
    (create_text_overlay, reg1, "@{!}{reg0}"),
    (position_set_x,1,900),
    (position_set_y,1,900),
    (overlay_set_size, reg1, 1),
    (position_set_x,1,500),
    (position_set_y,1,":var012"),
    (overlay_set_position, reg1, 1),
    (val_sub, ":var012", 27),
    (try_begin),
        (neq,"$g_apply_budget_report_to_gold",0),
        (call_script, "script_objectionable_action", 2, "str_men_unpaid"),
    (try_end),
(try_end),
(set_container_overlay, -1),
(create_button_overlay, "$g_presentation_obj_budget_report_1", "@Continue..."),
(position_set_x,1,225),
(position_set_y,1,60),
(overlay_set_position, "$g_presentation_obj_budget_report_1", 1),
(try_begin),
    (eq,"$g_apply_budget_report_to_gold",1),
    (assign,"$g_player_debt_to_party_members",":var057"),
    (try_begin),
        (gt,":gold_056",0),
        (troop_remove_gold,"trp_player",":gold_056"),
    (else_try),
        (val_mul, ":gold_056", -1),
        (call_script, "script_troop_add_gold", "trp_player", ":gold_056"),
    (try_end),
    (try_for_range, ":p_008", ":p.town_1", ":p.salt_mine"),
        (try_begin),
            (party_slot_eq,":p_008",7,"trp_player"),
            (party_set_slot,":p_008",47,0),
            (party_set_slot,":p_008",48,0),
        (try_end),
    (try_end),
    (assign,"$g_cur_week_half_daily_wage_payments",0),
(try_end),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_budget_report_1"),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("game_before_quit",0,mesh_load_window,[

(ti_on_presentation_load, [
(try_begin),
    (is_trial_version),
    (set_fixed_point_multiplier, 1000),
    (create_mesh_overlay, reg0, "mesh_quit_adv"),
    (position_set_x,1,-1),
    (position_set_y,1,-1),
    (overlay_set_position, reg0, 1),
    (position_set_x,1,1002),
    (position_set_y,1,1002),
    (overlay_set_size, reg0, 1),
    (assign,"$g_game_before_quit_state",0),
    (presentation_set_duration, 999999),
(try_end),
]),

(ti_on_presentation_run, [
(try_begin),
    (gt,":var001",500),
    (try_begin),
        (this_or_next|key_clicked, 57),
        (this_or_next|key_clicked, 28),
        (this_or_next|key_clicked, 1),
        (this_or_next|key_clicked, 14),
        (this_or_next|key_clicked, 224),
        (this_or_next|key_clicked, 225),
        (this_or_next|key_clicked, 252),
        (key_clicked, 253),
        (try_begin),
            (eq,"$g_game_before_quit_state",0),
            (val_add, "$g_game_before_quit_state", 1),
            (create_mesh_overlay, reg0, "mesh_quit_adv_b"),
            (position_set_x,1,-1),
            (position_set_y,1,-1),
            (overlay_set_position, reg0, 1),
            (position_set_x,1,1002),
            (position_set_y,1,1002),
            (overlay_set_size, reg0, 1),
        (else_try),
            (presentation_set_duration, 0),
        (try_end),
    (try_end),
(try_end),
]),

]),
("multiplayer_duel_start_counter",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(assign,"$g_multiplayer_duel_start_counter_overlay",-1),
(assign,"$g_multiplayer_last_duel_start_counter_value",-1),
(str_clear, 0),
(create_text_overlay, "$g_multiplayer_duel_start_counter_overlay", 0),
(overlay_set_color, "$g_multiplayer_duel_start_counter_overlay", 16777215),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, "$g_multiplayer_duel_start_counter_overlay", 1),
(position_set_x,1,2000),
(position_set_y,1,2000),
(overlay_set_size, "$g_multiplayer_duel_start_counter_overlay", 1),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(try_begin),
    (ge,"$g_multiplayer_duel_start_counter_overlay",0),
    (store_mission_timer_a,":m_timer_a_001"),
    (store_sub, ":var002", ":m_timer_a_001", "$g_multiplayer_duel_start_time"),
    (store_sub, ":var003", 3, ":var002"),
    (try_begin),
        (le,":var003",0),
        (presentation_set_duration, 0),
    (else_try),
        (neq,"$g_multiplayer_last_duel_start_counter_value",":var003"),
        (assign,"$g_multiplayer_last_duel_start_counter_value",":var003"),
        (assign,reg0,":var003"),
        (str_store_string,s0,"str_duel_starts_in_reg0_seconds"),
        (overlay_set_text, "$g_multiplayer_duel_start_counter_overlay", 0),
    (try_end),
(try_end),
]),

]),
("multiplayer_flag_projection_display_ccoop",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(create_mesh_overlay, "$g_presentation_obj_flag_projection_display_1", "mesh_prison_cart_pos"),
(position_set_x,1,69),
(position_set_y,1,92),
(overlay_set_size, "$g_presentation_obj_flag_projection_display_1", 1),
(overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(try_begin),
    (eq,1,1),
    (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
    (try_begin),
        (gt,"$g_prison_cart_point",0),
        (scene_prop_get_instance, ":scp_instance_001", "spr_prison_cart_door_left", 0),
        (scene_prop_get_instance, ":scp_instance_002", "spr_prison_cart_door_right", 0),
        (prop_instance_get_position, pos1, ":scp_instance_001"),
        (prop_instance_get_position, pos2, ":scp_instance_002"),
        (call_script, "script_avarage_of_two_points"),
        (position_move_z,1,50,1),
        (position_get_screen_projection, pos3, 1),
        (position_get_x,":pos_x_003",3),
        (position_get_y,":pos_y_004",3),
        (try_begin),
            (is_between,":pos_x_003",-100,1100),
            (is_between,":pos_y_004",-100,850),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 1),
        (try_end),
    (try_end),
(try_end),
]),

]),
("multiplayer_flag_projection_display_ccoop_wave",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(assign,":var001",-1),
(assign,":var002",-1),
(troop_get_slot,":troop_slot_003","trp_multiplayer_data",186),
(try_for_range, ":var004", 0, ":troop_slot_003"),
    (store_mul, ":slot_no_005", ":var004", 3),
    (val_add, ":slot_no_005", 188),
    (troop_get_slot,":troop_slot_006","trp_multiplayer_data",":slot_no_005"),
    (val_add, ":slot_no_005", 1),
    (troop_get_slot,":troop_slot_007","trp_multiplayer_data",":slot_no_005"),
    (try_begin),
        (gt,":troop_slot_006",0),
        (try_begin),
            (neq,":var001",-1),
            (neq,":var001",":troop_slot_007"),
            (assign,":var002",":troop_slot_007"),
        (else_try),
            (assign,":var001",":troop_slot_007"),
        (try_end),
    (try_end),
(try_end),
(try_begin),
    (gt,":var001",0),
    (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_1", "mesh_incoming_enemy"),
    (position_set_x,1,250),
    (position_set_y,1,250),
    (overlay_set_size, "$g_presentation_obj_flag_projection_display_1", 1),
    (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
(try_end),
(try_begin),
    (gt,":var002",0),
    (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_2", "mesh_incoming_enemy"),
    (position_set_x,1,250),
    (position_set_y,1,250),
    (overlay_set_size, "$g_presentation_obj_flag_projection_display_2", 1),
    (overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 0),
(try_end),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(assign,":var001",-1),
(assign,":var002",-1),
(troop_get_slot,":troop_slot_003","trp_multiplayer_data",186),
(try_for_range, ":var004", 0, ":troop_slot_003"),
    (store_mul, ":slot_no_005", ":var004", 3),
    (val_add, ":slot_no_005", 188),
    (troop_get_slot,":troop_slot_006","trp_multiplayer_data",":slot_no_005"),
    (val_add, ":slot_no_005", 1),
    (troop_get_slot,":troop_slot_007","trp_multiplayer_data",":slot_no_005"),
    (try_begin),
        (gt,":troop_slot_006",0),
        (try_begin),
            (neq,":var001",-1),
            (neq,":var001",":troop_slot_007"),
            (assign,":var002",":troop_slot_007"),
        (else_try),
            (assign,":var001",":troop_slot_007"),
        (try_end),
    (try_end),
(try_end),
(try_begin),
    (this_or_next|gt,":var001",0),
    (gt,":var002",0),
    (try_begin),
        (gt,":var001",0),
        (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 0),
        (entry_point_get_position, pos1, ":var001"),
        (position_move_z,1,150,1),
        (position_get_screen_projection, pos3, 1),
        (position_get_x,":pos_x_008",3),
        (position_get_y,":pos_y_009",3),
        (try_begin),
            (is_between,":pos_x_008",-100,1100),
            (is_between,":pos_y_009",-100,850),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_1", 1),
        (try_end),
    (try_end),
    (try_begin),
        (gt,":var002",0),
        (overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 0),
        (entry_point_get_position, pos1, ":var002"),
        (position_move_z,1,50,1),
        (position_get_screen_projection, pos3, 1),
        (position_get_x,":pos_x_008",3),
        (position_get_y,":pos_y_009",3),
        (try_begin),
            (is_between,":pos_x_008",-100,1100),
            (is_between,":pos_y_009",-100,850),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_2", 3),
            (overlay_set_display, "$g_presentation_obj_flag_projection_display_2", 1),
        (try_end),
    (try_end),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("coop_assign_drop_to_group_member",0,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(assign,":var001",reg0),
(assign,":var002",reg1),
(assign,":var003",reg2),
(play_sound,"snd_draw_shield"),
(create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
(position_set_x,1,250),
(position_set_y,1,80),
(overlay_set_position, reg0, 1),
(position_set_x,1,1000),
(position_set_y,1,1000),
(overlay_set_size, reg0, 1),
(create_mesh_overlay, reg0, "mesh_ccoop_drop_chest_top"),
(position_set_x,1,387),
(position_set_y,1,474),
(overlay_set_position, reg0, 1),
(position_set_x,1,562),
(position_set_y,1,374),
(overlay_set_size, reg0, 1),
(create_mesh_overlay_with_item_id, reg0, ":var001"),
(position_set_x,1,500),
(position_set_y,1,450),
(overlay_set_position, reg0, 1),
(position_set_y,1,528),
(overlay_animate_to_position, reg0, 400, 1),
(position_set_x,1,900),
(position_set_y,1,1200),
(overlay_set_size, reg0, 1),
(position_set_x,1,900),
(position_set_y,1,1200),
(create_mesh_overlay, reg0, "mesh_ccoop_drop_chest_bottom"),
(position_set_x,1,387),
(position_set_y,1,375),
(overlay_set_position, reg0, 1),
(position_set_x,1,562),
(position_set_y,1,250),
(overlay_set_size, reg0, 1),
(str_clear, 0),
(create_text_overlay, "$g_presentation_obj_assign_drop_container", 0),
(position_set_x,1,285),
(position_set_y,1,75),
(overlay_set_position, "$g_presentation_obj_assign_drop_container", 1),
(position_set_x,1,405),
(position_set_y,1,550),
(overlay_set_area_size, "$g_presentation_obj_assign_drop_container", 1),
(set_container_overlay, "$g_presentation_obj_assign_drop_container"),
(create_text_overlay, reg0, "str_ccoop_assign_drop"),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,0),
(position_set_y,1,500),
(overlay_set_position, reg0, 1),
(set_container_overlay, -1),
(assign,":var004",355),
(str_store_item_name_plural,s0,":var001"),
(val_sub, ":var004", 3),
(create_text_overlay, reg0, 0),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,500),
(position_set_y,1,":var004"),
(overlay_set_position, reg0, 1),
(val_sub, ":var004", 25),
(store_sub, ":var005", ":var001", ":itm.javelin_bow"),
(assign,":var005 +","str_javelin_bow"),
(try_begin),
    (is_between,":var005","str_javelin_bow","str_npc1_1"),
    (str_store_string,s0,":var005"),
(else_try),
    (str_clear, 0),
(try_end),
(create_text_overlay, reg0, 0),
(overlay_set_color, reg0, 16777215),
(position_set_x,1,750),
(position_set_y,1,750),
(overlay_set_size, reg0, 1),
(position_set_x,1,500),
(position_set_y,1,":var004"),
(overlay_set_position, reg0, 1),
(multiplayer_get_my_player, ":my_player"),
(str_store_player_username,s0,":my_player"),
(val_sub, ":var004", 176),
(try_begin),
    (ge,":var002",0),
    (ge,":var003",0),
    (assign,":var007",270),
(else_try),
    (this_or_next|ge,":var002",0),
    (ge,":var003",0),
    (assign,":var007",331),
(else_try),
    (assign,":var007",393),
(try_end),
(create_image_button_overlay_with_tableau_material, "$g_presentation_obj_coop_assign_drop_player", -1, "tab_coop_companion_select_0", -1),
(overlay_set_tooltip, "$g_presentation_obj_coop_assign_drop_player", 0),
(overlay_set_color, "$g_presentation_obj_coop_assign_drop_player", 16777215),
(position_set_x,1,":var007"),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_coop_assign_drop_player", 1),
(position_set_x,1,563),
(position_set_y,1,750),
(overlay_set_size, "$g_presentation_obj_coop_assign_drop_player", 1),
(try_begin),
    (ge,":var002",0),
    (val_add, ":var007", 123),
    (assign,"$g_coop_assign_drop_companion_1",":var002"),
    (agent_get_troop_id,":troop_id_008", ":var002"),
    (str_store_troop_name,s0,":troop_id_008"),
    (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_coop_assign_drop_companion_1", -1, "tab_coop_companion_select_0", ":troop_id_008"),
    (overlay_set_tooltip, "$g_presentation_obj_coop_assign_drop_companion_1", 0),
    (position_set_x,1,":var007"),
    (position_set_y,1,":var004"),
    (overlay_set_position, "$g_presentation_obj_coop_assign_drop_companion_1", 1),
    (position_set_x,1,563),
    (position_set_y,1,750),
    (overlay_set_size, "$g_presentation_obj_coop_assign_drop_companion_1", 1),
(try_end),
(try_begin),
    (ge,":var003",0),
    (val_add, ":var007", 123),
    (assign,"$g_coop_assign_drop_companion_2",":var003"),
    (agent_get_troop_id,":troop_id_008", ":var003"),
    (str_store_troop_name,s0,":troop_id_008"),
    (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_coop_assign_drop_companion_2", -1, "tab_coop_companion_select_0", ":troop_id_008"),
    (overlay_set_tooltip, "$g_presentation_obj_coop_assign_drop_companion_2", 0),
    (position_set_x,1,":var007"),
    (position_set_y,1,":var004"),
    (overlay_set_position, "$g_presentation_obj_coop_assign_drop_companion_2", 1),
    (position_set_x,1,563),
    (position_set_y,1,750),
    (overlay_set_size, "$g_presentation_obj_coop_assign_drop_companion_2", 1),
(try_end),
(val_sub, ":var004", 40),
(val_sub, ":var004", 2),
(create_button_overlay, "$g_presentation_obj_coop_assign_drop_noone", "str_noone"),
(overlay_set_color, "$g_presentation_obj_coop_assign_drop_noone", 16777215),
(position_set_x,1,645),
(position_set_y,1,":var004"),
(overlay_set_position, "$g_presentation_obj_coop_assign_drop_noone", 1),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_event_state_change, [
(try_begin),
    (eq,":var001","$g_presentation_obj_coop_assign_drop_player"),
    (multiplayer_send_2_int_to_server, 48, 17, 0),
    (presentation_set_duration, 0),
(else_try),
    (eq,":var001","$g_presentation_obj_coop_assign_drop_companion_1"),
    (multiplayer_send_2_int_to_server, 48, 17, "$g_coop_assign_drop_companion_1"),
    (presentation_set_duration, 0),
(else_try),
    (eq,":var001","$g_presentation_obj_coop_assign_drop_companion_2"),
    (multiplayer_send_2_int_to_server, 48, 17, "$g_coop_assign_drop_companion_2"),
    (presentation_set_duration, 0),
(else_try),
    (eq,":var001","$g_presentation_obj_coop_assign_drop_noone"),
    (multiplayer_send_2_int_to_server, 48, 17, -1),
    (presentation_set_duration, 0),
(try_end),
]),

(ti_on_presentation_run, [
(close_item_details),
(try_begin),
    (this_or_next|key_clicked, 1),
    (key_clicked, 248),
    (gt,":var001",200),
    (presentation_set_duration, 0),
    (multiplayer_send_2_int_to_server, 48, 17, -1),
(try_end),
]),

]),
("multiplayer_ccoop_next_wave_time_counter",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(assign,"$g_multiplayer_respawn_counter_overlay",-1),
(assign,"$g_multiplayer_respawn_remained_overlay",-1),
(assign,"$g_multiplayer_last_respawn_counter_value",-1),
(str_clear, 0),
(create_text_overlay, "$g_multiplayer_respawn_counter_overlay", 0),
(overlay_set_color, "$g_multiplayer_respawn_counter_overlay", 16777215),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, "$g_multiplayer_respawn_counter_overlay", 1),
(position_set_x,1,2000),
(position_set_y,1,2000),
(overlay_set_size, "$g_multiplayer_respawn_counter_overlay", 1),
(str_clear, 0),
(create_text_overlay, "$g_multiplayer_respawn_remained_overlay", 0),
(overlay_set_color, "$g_multiplayer_respawn_remained_overlay", 16777215),
(position_set_x,1,500),
(position_set_y,1,570),
(overlay_set_position, "$g_multiplayer_respawn_remained_overlay", 1),
(position_set_x,1,1400),
(position_set_y,1,1400),
(overlay_set_size, "$g_multiplayer_respawn_remained_overlay", 1),
(str_clear, 0),
(create_text_overlay, "$g_multiplayer_respawn_wave_hint_overlay", 0),
(overlay_set_color, "$g_multiplayer_respawn_wave_hint_overlay", 16777215),
(position_set_x,1,500),
(position_set_y,1,480),
(overlay_set_position, "$g_multiplayer_respawn_wave_hint_overlay", 1),
(position_set_x,1,1400),
(position_set_y,1,1400),
(overlay_set_size, "$g_multiplayer_respawn_wave_hint_overlay", 1),
(presentation_set_duration, 999999),
]),

(ti_on_presentation_run, [
(multiplayer_get_my_player, ":my_player"),
(try_begin),
    (ge,"$g_multiplayer_respawn_counter_overlay",0),
    (store_mission_timer_a,":m_timer_a_001"),
    (store_sub, ":var002", "$g_multiplayer_ccoop_next_wave_start_time", ":m_timer_a_001"),
    (try_begin),
        (gt,":var002",0),
        (gt,"$g_multiplayer_ccoop_wave_no",0),
        (assign,reg0,":var002"),
        (store_sub, reg1, "$g_multiplayer_ccoop_wave_no", "$g_mp_coop_last_king_wave"),
        (str_store_string,s1,"str_blank_string"),
        (try_begin),
            (eq,1,1),
            (troop_get_slot,":troop_slot_003","trp_multiplayer_data",187),
            (try_begin),
                (this_or_next|is_between,":troop_slot_003","trp_knight_1_1","trp_kingdom_1_pretender"),
                (is_between,":troop_slot_003","trp_quick_battle_troop_1","trp_quick_battle_troops_end"),
                (str_store_troop_name,s0,":troop_slot_003"),
                (str_store_string,s1,"str_ccoop_lord_s0_wave_hint"),
            (else_try),
                (is_between,":troop_slot_003","trp_kingdom_1_lord","trp_knight_1_1"),
                (str_store_troop_name,s0,":troop_slot_003"),
                (str_store_string,s1,"str_ccoop_king_s0_wave_hint"),
            (try_end),
        (try_end),
        (str_store_string,s0,"str_ccoop_wave_reg1_is_coming_in_reg0_seconds"),
    (else_try),
        (ge,"$g_mp_coop_king_waves",1),
        (assign,reg2,"$g_mp_coop_king_waves"),
        (str_store_string,s0,"str_ccoop_elite_wave_reg1_is_coming_in_reg0_seconds"),
        (try_begin),
            (gt,reg1,0),
            (lt,reg1,4),
            (str_store_string,s1,"str_elite_wave_hint"),
        (try_end),
    (try_end),
    (overlay_set_text, "$g_multiplayer_respawn_counter_overlay", 0),
    (overlay_set_text, "$g_multiplayer_respawn_wave_hint_overlay", 1),
(else_try),
    (player_is_active, ":my_player"),
    (player_get_agent_id, ":agent_id_005", ":my_player"),
    (try_begin),
        (ge,":agent_id_005",0),
        (agent_get_team, ":agent_team_no_006", ":agent_id_005"),
        (try_begin),
            (lt,":agent_team_no_006",2),
            (neg|agent_is_alive,":agent_id_005"),
            (player_get_slot,":player_slot_007",":my_player",24),
            (try_begin),
                (ge,":player_slot_007",0),
                (str_store_string,s0,"str_ask_for_help_to_respawn_hint"),
            (else_try),
                (str_store_string,s0,"str_wait_for_next_turn_to_respawn_hint"),
            (try_end),
        (try_end),
    (try_end),
    (overlay_set_text, "$g_multiplayer_respawn_counter_overlay", 0),
(else_try),
    (presentation_set_duration, 0),
(try_end),
]),

]),
("multiplayer_ccoop_victory_message",prsntf_read_only|prsntf_manual_end_only,0,[

(ti_on_presentation_load, [
(set_fixed_point_multiplier, 1000),
(team_get_faction, ":team_faction_001", 1),
(str_store_faction_name,s0,":team_faction_001"),
(try_begin),
    (is_between,":team_faction_001","fac_player_supporters_faction","fac_kingdoms_end"),
    (assign,reg1,0),
(else_try),
    (assign,reg1,1),
(try_end),
(try_begin),
    (ge,"$g_multiplayer_ccoop_difficulty_string_i",0),
    (str_store_string,s1,"$g_multiplayer_ccoop_difficulty_string_i"),
    (str_store_string,s2,"str_ccoop_s0_enemy_defeated_s1"),
(else_try),
    (str_store_string,s2,"str_ccoop_s0_enemy_defeated_endless_reg0"),
(try_end),
(create_text_overlay, "$g_multiplayer_ccoop_victory_overlay", "str_ccoop_victory"),
(overlay_set_color, "$g_multiplayer_ccoop_victory_overlay", 6875982),
(position_set_x,1,500),
(position_set_y,1,600),
(overlay_set_position, "$g_multiplayer_ccoop_victory_overlay", 1),
(position_set_x,1,2000),
(position_set_y,1,2000),
(overlay_set_size, "$g_multiplayer_ccoop_victory_overlay", 1),
(create_text_overlay, "$g_multiplayer_ccoop_victory_subtitle_overlay", 2),
(overlay_set_color, "$g_multiplayer_ccoop_victory_subtitle_overlay", 6875982),
(position_set_x,1,500),
(position_set_y,1,480),
(overlay_set_position, "$g_multiplayer_ccoop_victory_subtitle_overlay", 1),
(position_set_x,1,1400),
(position_set_y,1,1400),
(overlay_set_size, "$g_multiplayer_ccoop_victory_subtitle_overlay", 1),
(presentation_set_duration, 2000),
]),

(ti_on_presentation_run, [
(try_begin),
    (is_presentation_active, "prsnt_multiplayer_ccoop_next_wave_time_counter"),
    (presentation_set_duration, 0),
(try_end),
]),

]),

] # PRESENTATIONS END
